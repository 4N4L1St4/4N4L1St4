<p align="center">
  <a href="https://www.scnsoft.com/blog-pictures/infrastructure/noc.png">
    <img src="./images/guia.png" alt="Guia de Casos de Uso SIEM" width="160" height="160">
  </a>
  <h1 align="center">ðŸ”Ž Casos de Uso SIEM</h1>
</p>

## :dart: O guia para alavancar a sua carreira

Este guia explora os principais casos de uso de um SIEM (Security Information and Event Management), destacando como essa ferramenta essencial pode ser utilizada para identificar, investigar e mitigar ameaÃ§as de seguranÃ§a dentro de uma organizaÃ§Ã£o. Com exemplos prÃ¡ticos e cenÃ¡rios comuns, vocÃª entenderÃ¡ melhor o valor do SIEM na proteÃ§Ã£o da infraestrutura de TI.

## :dart: ConteÃºdo

### 1. DetecÃ§Ã£o de AmeaÃ§as Internas

#### DescriÃ§Ã£o:
O SIEM pode monitorar e correlacionar eventos em tempo real para detectar atividades anÃ´malas vindas de dentro da organizaÃ§Ã£o, como acessos nÃ£o autorizados, uso indevido de dados sensÃ­veis, e comportamentos fora do padrÃ£o de usuÃ¡rios internos.

#### Planilha de Exemplo de DetecÃ§Ã£o de AmeaÃ§as Internas

| Nome da Regra | Categoria da Regra | DescriÃ§Ã£o da Regra | Tipo de Evento | CondiÃ§Ã£o de Filtro |
|---------------|--------------------|--------------------|----------------|--------------------|
| Baseline De Processos WAF | Disponibilidade | Detecta o Processo de Aumento de RequisiÃ§Ã£o Para uma AplicaÃ§Ã£o |  |  |
| Carbon Black Fatal Errors | Security | Detects fatal Carbon Black errors | Carbon Black Fatal Errors | eventType IN (Group@PH_SYS_EVENT_Fatal) AND eventType CONTAIN ""CarbonBlack-"" |
| Cisco AVC: Application Flows with QoS Queue Packet Drops | Performance | Detecta quedas de pacotes de fila de QoS conforme relatado pelo Cisco AVC. As quedas de fila podem afetar um ou mais fluxos mapeados para a fila afetada | Cisco AVC: Application Flows with QoS Queue Packet Drops | (eventType = ""IOS-AVC-NETFLOW"" OR eventType = ""Cisco-WLC-AVC-NETFLOW"") AND qosQueueDrops >= 1 |
| Cisco AVC: Application Response Time Late | Performance | Detecta tempos de resposta de aplicativos atrasados, conforme relatado pelo Cisco AVC, onde os tempos de resposta excedem 1 segundo. Tempo de resposta Ã© a quantidade de tempo entre a solicitaÃ§Ã£o TCP do cliente e a primeira resposta do servidor. | Cisco AVC: Application Response Time Late | (eventType = ""IOS-AVC-NETFLOW"" OR eventType = ""Cisco-WLC-AVC-NETFLOW"") AND ARTCountLateResponses >= 1 |
| Excessive Web Request Failures | Disponibilidade | Calls to one or more web server URIs has returned a status code other than 200 greater than 10 times in a 5 minute interval. | Excessive Web Request Failures | ( eventType CONTAIN ""Nginx-"" OR eventType CONTAIN ""Apache-"" ) AND httpStatusCode NOT IN (""200"",""201"",""202"",""204"") |
|  |  |  |  |  |
| Windows: NTLMv1 Logon Between Client and Server | Security | Detects the reporting of NTLMv1 being used between a client and server. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/lsasrv/win_system_lsasrv_ntlmv1.yml | Windows: NTLMv1 Logon Between Client and Server | eventType=""Win-System-LsaSrv-6038"" |
| Windows: OceanLotus Registry Activity | Security | Detects registry keys created in OceanLotus (also known as APT32) attacks. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_apt_oceanlotus_registry.yml | Windows: OceanLotus Registry Activity | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND (regKeyPath=""HKCU\\SOFTWARE\\Classes\\CLSID\\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1}\\Model"" OR (regKeyPath REGEXP ""HKCU\\SOFTWARE\\App\\.*|HKLM\\SOFTWARE\\App\\.*"" AND regKeyPath REGEXP "".*AppX37cc7fdccd644b4f85f4b22d5a3f105a\\.*|.*AppX70162486c7554f7f80f481985d67586d\\.*|.*AppXbf13d4ea2945444d8b13e2121cb6b663\\.*"" AND regKeyPath REGEXP "".*Application|.*DefaultIcon"") OR (regKeyPath REGEXP ""HKCU\\.*"" AND regKeyPath REGEXP "".*Classes\\AppX3bbba44c6cae4d9695755183472171e2\\.*|.*Classes\\AppXc52346ec40fb4061ad96be0e6cb7d16a\\.*|.*Classes\\CLSID\\\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1\}\\Model.*|.*Classes\\CLSID\\\{E3517E26-8E93-458D-A6DF-8030BC80528B\}\\.*"")) |
| Windows: Outbound Network Connection To Public IP Via Winlogon | Security | Detects a ""winlogon.exe"" process that initiate network communications with public IP addresses. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_winlogon_net_connections.yml | Windows: Outbound Network Connection To Public IP Via Winlogon | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (procName REGEXP "".*\\winlogon\.exe"" AND initiated=""true"") AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Windows: Outlook EnableUnsafeClientMailRules Setting Enabled | Security | Detects an attacker trying to enable the outlook security setting ""EnableUnsafeClientMailRules"" which allows outlook to run applications or execute macros. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_outlook_enable_unsafe_client_mail_rules.yml | Windows: Outlook EnableUnsafeClientMailRules Setting Enabled | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\Outlook\\Security\\EnableUnsafeClientMailRules.*"" |
| Windows: Pass the Hash Activity 2 | Security | Detects the attack technique pass the hash which is used to move laterally inside the network. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_pass_the_hash_2.yml | Windows: Pass the Hash Activity 2 | (eventType=""Win-Security-4624"" AND ((securityId=""S-1-0-0"" AND winLogonType=3 AND winLogonProc=""NtLmSsp"" AND msgLen IS NULL) OR (winLogonType=9 AND winLogonProc=""seclogo""))) AND (user!=""ANONYMOUS LOGON"") |
| Windows: Ping Hex IP | Security | Detects a ping command that uses a hex encoded IP address. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ping_hex_ip.yml | Windows: Ping Hex IP | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\ping\.exe"" AND command REGEXP "".*0x.*"" |
| Windows: Pingback Backdoor DLL Loading Activity | Security | Detects the use of Pingback backdoor that creates ICMP tunnel for C2 as described in the trustwave report. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_malware_pingback_backdoor.yml | Windows: Pingback Backdoor DLL Loading Activity | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\msdtc\.exe"" AND loadedProcName=""C:\\Windows\\oci.dll"" |
| Windows: Possible DC Shadow Attack | Security | Detects DCShadow via create new SPN. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_possible_dc_shadow.yml | Windows: Possible DC Shadow Attack | ((eventType=""Win-Security-4742"" AND principal REGEXP "".*GC/.*"") OR (eventType=""Win-Security-5136"" AND propName=""servicePrincipalName"" AND propValue REGEXP ""GC/.*"")) AND reptDevIpAddr NOT IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER) |
| Windows: Possible Privilege Escalation via Weak Service Permissions | Security | Detection of sc.exe utility spawning by user with Medium integrity level to change service ImagePath or FailureCommand. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_change_sevice_image_path_by_non_admin.yml | Windows: Possible Privilege Escalation via Weak Service Permissions | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\sc\.exe"" AND integrityLevel=""Medium"") AND ((command REGEXP "".*config.*"" AND command REGEXP "".*binPath.*"") OR (command REGEXP "".*failure.*"" AND command REGEXP "".*command.*"")) |
| Windows: Possible Process Hollowing Image Loading | Security | Detects Loading of samlib.dll, WinSCard.dll from untypical process e.g. through process hollowing by Mimikatz. Mimikatz is a open source malware program that is commonly used by hackers and security professionals to extract sensitive information, such as passwords and credentials, from a system's memory. Process hollowing is a defense evasion technique that runs custom code within the address space of another process, thereby avoiding detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_susp_uncommon_image_load.yml | Windows: Possible Process Hollowing Image Loading | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\notepad\.exe"" AND loadedProcName REGEXP "".*\\WinSCard\.dll|.*\\samlib\.dll"" |
| Windows: Potential Access Token Abuse | Security | Detects potential token impersonation and theft. Example, when using ""DuplicateToken(Ex)"" and ""ImpersonateLoggedOnUser"" with the ""LOGON32_LOGON_NEW_CREDENTIALS flag"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_access_token_abuse.yml | Windows: Potential Access Token Abuse | eventType=""Win-Security-4624"" AND winLogonType=9 AND winLogonProc=""Advapi"" AND authenMethod=""Negotiate"" AND permissionLevelID=""%%1833"" |
| Windows: Potential AMSI Bypass Using NULL Bits | Security | Detects usage of special strings/null bits in order to potentially bypass AMSI functionalities. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_amsi_null_bits_bypass.yml | Windows: Potential AMSI Bypass Using NULL Bits | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*#<NULL>.*|.*if\(0\)\{\{\{0\}\}\}' -f \$\(0 -as \[char\]\) \+.*"" |
| Windows: Potential AMSI Bypass Via .NET Reflection | Security | Detects Request to ""amsiInitFailed"" that can be used to disable AMSI Scanning. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_amsi_init_failed_bypass.yml | Windows: Potential AMSI Bypass Via .NET Reflection | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*System\.Management\.Automation\.AmsiUtils.*|.*amsiInitFailed.*"" OR (command REGEXP "".*\[Ref\]\.Assembly\.GetType.*"" AND command REGEXP "".*SetValue\(\$null,\$true\).*"" AND command REGEXP "".*NonPublic,Static.*"")) |
| Windows: Potential Antivirus Software DLL Sideloading | Security | Detects potential DLL sideloading of DLLs that are part of antivirus software suchas McAfee, Symantec...etc. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_antivirus.yml | Windows: Potential Antivirus Software DLL Sideloading | eventType=""Win-Sysmon-7-Image-Loaded"" AND (((((((loadedProcName REGEXP "".*\\log\.dll"" AND ((loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Bitdefender Antivirus Free\\.*|C:\\Program Files\\Bitdefender Antivirus Free\\.*"") AND (procName!=""C:\\Program Files\\Dell\\SARemediation\\audit\\TelemetryUtility.exe"" OR loadedProcName NOT IN (""C:\\Program Files\\Dell\\SARemediation\\audit\\log.dll"",""C:\\Program Files\\Dell\\SARemediation\\plugin\\log.dll"")) AND (loadedProcName NOT REGEXP ""C:\\Program Files\\Canon\\MyPrinter\\.*""))) OR (loadedProcName REGEXP "".*\\qrt\.dll"" AND (loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\F-Secure\\Anti-Virus\\.*|C:\\Program Files\\F-Secure\\Anti-Virus\\.*""))) OR (loadedProcName REGEXP "".*\\ashldres\.dll|.*\\lockdown\.dll|.*\\vsodscpl\.dll"" AND (loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\McAfee\\.*|C:\\Program Files\\McAfee\\.*""))) OR (loadedProcName REGEXP "".*\\vftrace\.dll"" AND (loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\CyberArk\\Endpoint Privilege Manager\\Agent\\x32\\.*|C:\\Program Files\\CyberArk\\Endpoint Privilege Manager\\Agent\\x32\\.*""))) OR (loadedProcName REGEXP "".*\\wsc\.dll"" AND (loadedProcName NOT REGEXP ""C:\\program Files \(x86\)\\AVAST Software\\Avast\\.*|C:\\program Files\\AVAST Software\\Avast\\.*""))) OR (loadedProcName REGEXP "".*\\tmdbglog\.dll"" AND (loadedProcName NOT REGEXP ""C:\\program Files \(x86\)\\Trend Micro\\Titanium\\.*|C:\\program Files\\Trend Micro\\Titanium\\.*""))) OR (loadedProcName REGEXP "".*\\DLPPREM32\.dll"" AND (loadedProcName NOT REGEXP ""C:\\program Files \(x86\)\\ESET.*|C:\\program Files\\ESET.*""))) |
| Windows: Potential Arbitrary DLL Load Using Winword | Security | Detects potential DLL sideloading using the Microsoft Office winword process via the '/l' flag. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_winword_dll_load.yml | Windows: Potential Arbitrary DLL Load Using Winword | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\WINWORD\.exe"" OR srcFileName=""WinWord.exe"") AND (command REGEXP "".*/l .*"" AND command REGEXP "".*\.dll.*"") |
| Windows: Potential Arbitrary File Download Using Office Application | Security | Detects potential arbitrary file download using a Microsoft Office application. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_arbitrary_cli_download.yml | Windows: Potential Arbitrary File Download Using Office Application | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\EXCEL\.EXE|.*\\POWERPNT\.EXE|.*\\WINWORD\.exe"" OR srcFileName IN (""Excel.exe"",""POWERPNT.EXE"",""WinWord.exe"")) AND command REGEXP "".*http://.*|.*https://.*"" |
| Windows: Potential Azure Browser SSO Abuse | Security | Detects abusing Azure Browser SSO by requesting OAuth 2.0 refresh tokens for an Azure-AD-authenticated Windows user (i.e. the machine is joined to Azure AD and a user logs in with their Azure AD account) wanting to perform SSO authentication in the browser. An attacker can use this to authenticate to Azure AD in a browser as that user. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_abusing_azure_browser_sso.yml | Windows: Potential Azure Browser SSO Abuse | eventType=""Win-Sysmon-7-Image-Loaded"" AND (loadedProcName=""C:\\Windows\\System32\\MicrosoftAccountTokenProvider.dll"" AND ((procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*"" OR procName NOT REGEXP "".*\\BackgroundTaskHost\.exe""))) AND ((procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft Visual Studio\\.*|C:\\Program Files\\Microsoft Visual Studio\\.*"" OR procName NOT REGEXP "".*\\IDE\\devenv\.exe"") AND (procName NOT IN (""C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe"",""C:\\Program Files\\Internet Explorer\\iexplore.exe"")) AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeWebView\\Application\\.*"" AND procName NOT REGEXP "".*\\WindowsApps\\MicrosoftEdge\.exe"" AND procName NOT IN (""C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe"",""C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"")) AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeCore\\.*|C:\\Program Files\\Microsoft\\EdgeCore\\.*"" OR procName NOT REGEXP "".*\\msedge\.exe|.*\\msedgewebview2\.exe"") AND (procName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\OneDrive\\OneDrive\.exe"") AND (procName IS NOT NULL)) |
| Windows: Potential Chrome Frame Helper DLL Sideloading | Security | Detects potential DLL sideloading of ""chrome_frame_helper.dll"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_chrome_frame_helper.yml | Windows: Potential Chrome Frame Helper DLL Sideloading | eventType=""Win-Sysmon-7-Image-Loaded"" AND (loadedProcName REGEXP "".*\\chrome_frame_helper\.dll"" AND ((loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Google\\Chrome\\Application\\.*|C:\\Program Files\\Google\\Chrome\\Application\\.*""))) AND ((loadedProcName NOT REGEXP "".*\\AppData\\local\\Google\\Chrome\\Application\\.*"")) |
| Windows: Potential Defense Evasion Via Binary Rename | Security | Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_binary.yml | Windows: Potential Defense Evasion Via Binary Rename | eventType=""Win-Sysmon-1-Create-Process"" AND srcFileName IN (""7z.exe"",""CONHOST.EXE"",""Cmd.Exe"",""InstallUtil.exe"",""WinRAR.exe"",""net.exe"",""net1.exe"",""netsh.exe"",""wevtutil.exe"") AND (procName NOT REGEXP "".*\\7z\.exe|.*\\InstallUtil\.exe|.*\\WinRAR\.exe|.*\\cmd\.exe|.*\\conhost\.exe|.*\\net1\.exe|.*\\net\.exe|.*\\netsh\.exe|.*\\wevtutil\.exe"") |
| Windows: Potential Defense Evasion Via Rename Of Highly Relevant Binaries | Security | Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_binary_highly_relevant.yml | Windows: Potential Defense Evasion Via Rename Of Highly Relevant Binaries | eventType=""Win-Sysmon-1-Create-Process"" AND (description=""Execute processes remotely"" OR product=""Sysinternals PsExec"" OR description REGEXP ""Windows PowerShell.*|pwsh.*"" OR srcFileName IN (""certutil.exe"",""cmstp.exe"",""cscript.exe"",""mshta.exe"",""msiexec.exe"",""powershell.exe"",""powershell_ise.exe"",""psexec.c"",""psexec.exe"",""psexesvc.exe"",""pwsh.dll"",""reg.exe"",""regsvr32.exe"",""rundll32.exe"",""wmic.exe"",""wscript.exe"")) AND (procName NOT REGEXP "".*\\PSEXESVC\.exe|.*\\certutil\.exe|.*\\cmstp\.exe|.*\\cscript\.exe|.*\\mshta\.exe|.*\\msiexec\.exe|.*\\powershell\.exe|.*\\powershell_ise\.exe|.*\\psexec64\.exe|.*\\psexec\.exe|.*\\pwsh\.exe|.*\\reg\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wmic\.exe|.*\\wscript\.exe"") |
| Windows: Potential Defense Evasion Via Right-to-Left Override | Security | Detects the presence of the ""u202+E"" character, which causes a terminal, browser, or operating system to render text in a right-to-left sequence. This is used as an obfuscation and masquerading techniques. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_right_to_left_override.yml | Windows: Potential Defense Evasion Via Right-to-Left Override | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP ""\\u202E"" |
| Windows: Potential DLL Injection Or Execution Using Tracker.exe | Security | Detects potential DLL injection and execution using ""Tracker.exe"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_tracker.yml | Windows: Potential DLL Injection Or Execution Using Tracker.exe | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\tracker\.exe"" OR description=""Tracker"") AND command REGEXP "".* /c .*|.* /d .*"") AND ((command NOT REGEXP "".* /ERRORREPORT:PROMPT .*"") AND (parentProcName NOT REGEXP "".*\\Msbuild\\Current\\Bin\\MSBuild\.exe|.*\\Msbuild\\Current\\Bin\\amd64\\MSBuild\.exe"")) |
| Windows: Potential DLL Sideloading Of DBGCORE.DLL | Security | Detects DLL sideloading of ""dbgcore.dll"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_dbgcore_dll.yml | Windows: Potential DLL Sideloading Of DBGCORE.DLL | eventType=""Win-Sysmon-7-Image-Loaded"" AND (loadedProcName REGEXP "".*\\dbgcore\.dll"" AND ((loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*|C:\\Windows\\SoftwareDistribution\\.*|C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\SystemTemp\\.*|C:\\Windows\\WinSxS\\.*""))) AND ((loadedProcName NOT REGEXP "".*\\Steam\\bin\\cef\\cef\.win7x64\\dbgcore\.dll"")) |
| Windows: Potential DLL Sideloading Of DBGHELP.DLL | Security | Detects DLL sideloading of ""dbghelp.dll"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_dbghelp_dll.yml | Windows: Potential DLL Sideloading Of DBGHELP.DLL | eventType=""Win-Sysmon-7-Image-Loaded"" AND (loadedProcName REGEXP "".*\\dbghelp\.dll"" AND ((loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*|C:\\Windows\\SoftwareDistribution\\.*|C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\SystemTemp\\.*|C:\\Windows\\WinSxS\\.*""))) AND ((loadedProcName NOT REGEXP "".*\\Anaconda3\\Lib\\site-packages\\vtrace\\platforms\\windll\\amd64\\dbghelp\.dll|.*\\Anaconda3\\Lib\\site-packages\\vtrace\\platforms\\windll\\i386\\dbghelp\.dll"") AND (loadedProcName NOT REGEXP "".*\\Epic Games\\Launcher\\Engine\\Binaries\\ThirdParty\\DbgHelp\\dbghelp\.dll|.*\\Epic Games\\MagicLegends\\x86\\dbghelp\.dll"")) |
| Windows: Potential DLL Sideloading Of Libcurl.DLL Via GUP.EXE | Security | Detects potential DLL sideloading of ""libcurl.dll"" by the ""gup.exe"" process from an uncommon location. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_gup_libcurl.yml | Windows: Potential DLL Sideloading Of Libcurl.DLL Via GUP.EXE | eventType=""Win-Sysmon-7-Image-Loaded"" AND (procName REGEXP "".*\\gup\.exe"" AND loadedProcName REGEXP "".*\\libcurl\.dll"") AND ((procName NOT REGEXP "".*\\Notepad\+\+\\updater\\GUP\.exe"")) |
| Windows: Potential DLL Sideloading Of Non-Existent DLLs From System Folders | Security | Detects DLL sideloading of system dlls that are not present on the system by default. Usually to achieve techniques such as UAC bypass and privilege escalation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_non_existent_dlls.yml | Windows: Potential DLL Sideloading Of Non-Existent DLLs From System Folders | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName IN (""C:\\Windows\\System32\\TSMSISrv.dll"",""C:\\Windows\\System32\\TSVIPSrv.dll"",""C:\\Windows\\System32\\WLBSCTRL.dll"",""C:\\Windows\\System32\\WptsExtensions.dll"",""C:\\Windows\\System32\\wbem\\wbemcomn.dll"",""C:\\Windows\\System32\\wow64log.dll"") AND ((authResult!=""true"" OR signatureName!=""Microsoft Windows"")) |
| Windows: Potential DLL Sideloading Via ClassicExplorer32.dll | Security | Detects potential DLL sideloading using ClassicExplorer32.dll from the Classic Shell software. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_classicexplorer32.yml | Windows: Potential DLL Sideloading Via ClassicExplorer32.dll | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\ClassicExplorer32\.dll"" AND (loadedProcName NOT REGEXP ""C:\\Program Files\\Classic Shell\\.*"") |
| Windows: Potential DLL Sideloading Via comctl32.dll | Security | Detects potential DLL sideloading using comctl32.dll to obtain system privileges. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_comctl32.yml | Windows: Potential DLL Sideloading Via comctl32.dll | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP ""C:\\Windows\\System32\\consent\.exe\.local\\.*|C:\\Windows\\System32\\logonUI\.exe\.local\\.*|C:\\Windows\\System32\\narrator\.exe\.local\\.*|C:\\Windows\\System32\\werFault\.exe\.local\\.*|C:\\windows\\system32\\wermgr\.exe\.local\\.*"" AND loadedProcName REGEXP "".*\\comctl32\.dll"" |
| Windows: Potential DLL Sideloading Via DeviceEnroller.EXE | Security | Detects the use of the PhoneDeepLink parameter to potentially sideload a DLL file that does not exist. This non-existent DLL file is named ""ShellChromeAPI.dll"". Adversaries can drop their own renamed DLL and execute it via DeviceEnroller.exe using this parameter . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_deviceenroller_dll_sideloading.yml | Windows: Potential DLL Sideloading Via DeviceEnroller.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\deviceenroller\.exe"" OR srcFileName=""deviceenroller.exe"") AND command REGEXP "".*/PhoneDeepLink.*"" |
| Windows: Potential DLL Sideloading Via JsSchHlp | Security | Detects potential DLL sideloading using JUSTSYSTEMS Japanese word processor. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_jsschhlp.yml | Windows: Potential DLL Sideloading Via JsSchHlp | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\JSESPR\.dll"" AND (loadedProcName NOT REGEXP ""C:\\Program Files\\Common Files\\Justsystem\\JsSchHlp\\.*"") |
| Windows: Potential DLL Sideloading Via VMware Xfer | Security | Detects loading of a DLL by the VMware Xfer utility from the non-default directory which may be an attempt to sideload arbitrary DLL. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_vmware_xfer.yml | Windows: Potential DLL Sideloading Via VMware Xfer | eventType=""Win-Sysmon-7-Image-Loaded"" AND (procName REGEXP "".*\\VMwareXferlogs\.exe"" AND loadedProcName REGEXP "".*\\glib-2\.0\.dll"") AND (loadedProcName NOT REGEXP ""C:\\Program Files\\VMware\\.*"") |
| Windows: Potential Goopdate.DLL Sideloading | Security | Detects potential DLL sideloading of ""goopdate.dll"", a DLL used by googleupdate.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_goopdate.yml | Windows: Potential Goopdate.DLL Sideloading | eventType=""Win-Sysmon-7-Image-Loaded"" AND (loadedProcName REGEXP "".*\\goopdate\.dll"" AND ((procName NOT REGEXP "".*\\GoogleUpdate\.exe"" OR loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Google\\.*|C:\\Program Files\\Google\\.*""))) AND ((procName NOT REGEXP "".*\\GoogleUpdate\.exe"" OR loadedProcName NOT REGEXP "".*\\AppData\\Local\\Google\\Update\\.*"") AND (procName NOT REGEXP "".*\\Dropbox.*"" OR loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Dropbox\\Update\\.*|C:\\Program Files\\Dropbox\\Update\\.*"") AND (procName NOT REGEXP "".*\\AppData\\Local\\Temp\\GUM.*"" OR procName NOT REGEXP "".*\.tmp\\Dropbox.*"" OR loadedProcName NOT REGEXP "".*\\AppData\\Local\\Temp\\GUM.*"" OR loadedProcName NOT REGEXP "".*\.tmp\\goopdate\.dll.*"")) |
| Windows: Potential Homoglyph Attack Using Lookalike Characters | Security | Detects the presence of unicode characters which are homoglyphs, or identical in appearance, to ASCII letter characters. This is used as an obfuscation and masquerading techniques. Only ""perfect"" homoglyphs are included; these are characters that are indistinguishable from ASCII characters and thus may make excellent candidates for homoglyph attack characters. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_homoglyph_cyrillic_lookalikes.yml | Windows: Potential Homoglyph Attack Using Lookalike Characters | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*A.*|.*B.*|.*E.*|.*Z.*|.*H.*|.*I.*|.*K.*|.*M.*|.*N.*|.*O.*|.*P.*|.*T.*|.*Y.*|.*X.*|.*S.*|.*J.*|.*C.*|.*I.*|.*Q.*|.*W.*|.*G.*"" OR command REGEXP "".*o.*|.*a.*|.*e.*|.*p.*|.*c.*|.*x.*|.*s.*|.*i.*|.*j.*|.*h.*|.*q.*|.*w.*"") |
| Windows: Potential Homoglyph Attack Using Lookalike Characters in Filename | Security | Detects the presence of unicode characters which are homoglyphs, or identical in appearance, to ASCII letter characters. This is used as an obfuscation and masquerading techniques. Only ""perfect"" homoglyphs are included; these are characters that are indistinguishable from ASCII characters and thus may make excellent candidates for homoglyph attack characters. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_homoglyph_filename.yml | Windows: Potential Homoglyph Attack Using Lookalike Characters in Filename | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP "".*A.*|.*B.*|.*E.*|.*Z.*|.*H.*|.*I.*|.*K.*|.*M.*|.*N.*|.*O.*|.*P.*|.*T.*|.*Y.*|.*X.*|.*S.*|.*J.*|.*C.*|.*I.*|.*Q.*|.*W.*"" OR fileName REGEXP "".*o.*|.*a.*|.*e.*|.*p.*|.*c.*|.*x.*|.*s.*|.*i.*|.*j.*|.*h.*|.*q.*|.*w.*"") |
| Windows: Potential Initial Access via DLL Search Order Hijacking | Security | Detects attempts to create a DLL file to a known desktop application dependencies folder such as Slack, Teams or OneDrive and by an unusual process. This may indicate an attempt to load a malicious module via DLL search order hijacking. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_initial_access_dll_search_order_hijacking.yml | Windows: Potential Initial Access via DLL Search Order Hijacking | eventType=""Win-Sysmon-11-FileCreate"" AND (procName REGEXP "".*\\MSACCESS\.EXE|.*\\MSPUB\.EXE|.*\\certutil\.exe|.*\\cmd\.exe|.*\\cscript\.exe|.*\\curl\.exe|.*\\excel\.exe|.*\\fltldr\.exe|.*\\mshta\.exe|.*\\powerpnt\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\winword\.exe|.*\\wscript\.exe"" AND fileName REGEXP "".*\.dll"" AND fileName REGEXP "".*\\Users\\.*"" AND fileName REGEXP "".*\\AppData\\.*"" AND fileName REGEXP "".*\\Local\\Programs\\Microsoft VS Code\\.*|.*\\Local\\slack\\app-.*|.*\\Microsoft OneDrive\\.*|.*\\Microsoft\\OneDrive\\.*|.*\\Microsoft\\Teams\\.*"") AND (procName NOT REGEXP "".*\\cmd\.exe"" OR fileName NOT REGEXP "".*\\Users\\.*"" OR fileName NOT REGEXP "".*\\AppData\\.*"" OR fileName NOT REGEXP "".*\\Microsoft\\OneDrive\\.*"" OR fileName NOT REGEXP "".*\\api-ms-win-core-.*"") |
| Windows: Potential Iviewers.DLL Sideloading | Security | Detects potential DLL sideloading of ""iviewers.dll"" (OLE/COM Object Interface Viewer). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_iviewers.yml | Windows: Potential Iviewers.DLL Sideloading | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\iviewers\.dll"" AND (loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Windows Kits\\.*|C:\\Program Files\\Windows Kits\\.*"") |
| Windows: Potential LethalHTA Technique Execution | Security | Detects potential LethalHTA technique where the ""mshta.exe"" is spwaned by an ""svchost.exe"" process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mshta_lethalhta_technique.yml | Windows: Potential LethalHTA Technique Execution | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\svchost\.exe"" AND procName REGEXP "".*\\mshta\.exe"" |
| Windows: Potential Libvlc.DLL Sideloading | Security | Detects potential DLL sideloading of ""libvlc.dll"", a DLL that is legitimately used by ""VLC.exe"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_libvlc.yml | Windows: Potential Libvlc.DLL Sideloading | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\libvlc\.dll"" AND ((loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\VideoLAN\\VLC\\.*|C:\\Program Files\\VideoLAN\\VLC\\.*"")) |
| Windows: Potential Meterpreter/CobaltStrike Activity | Security | Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service starting. Cobalt Strike (https://www.cobaltstrike.com/) is an adversary simulation tool with a post-exploitation agent and covert channels to emulate a quiet long-term embedded actor in your network. It uses Process injection, a defense evasion technique that runs custom code within the address space of another process, thereby avoiding detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_meterpreter_getsystem.yml | Windows: Potential Meterpreter/CobaltStrike Activity | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\services\.exe"" AND ((command REGEXP "".*/c.*"" AND command REGEXP "".*echo.*"" AND command REGEXP "".*\\pipe\\.*"" AND command REGEXP "".*%COMSPEC%.*|.*cmd.*"") OR (command REGEXP "".*rundll32.*"" AND command REGEXP "".*\.dll,a.*"" AND command REGEXP "".*/p:.*""))) AND ((command NOT REGEXP "".*MpCmdRun.*"")) |
| Windows: Potential MsiExec Masquerading | Security | Detects the execution of msiexec.exe from an uncommon directory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msiexec_masquerading.yml | Windows: Potential MsiExec Masquerading | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\msiexec\.exe"" OR srcFileName=""\\msiexec.exe"") AND (procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\WinSxS\\.*"") |
| Windows: Potential NT API Stub Patching | Security | Detects potential NT API stub patching as seen used by the project PatchingAPI. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_invoke_patchingapi.yml | Windows: Potential NT API Stub Patching | eventType=""Win-Sysmon-10-ProcessAccess"" AND (accessKeyId=""0x1FFFFF"" AND procPath REGEXP ""C:\\Windows\\SYSTEM32\\ntdll\.dll\+.*"" AND procPath REGEXP "".*\|UNKNOWN\(.*"" AND procPath REGEXP "".*\)"") AND ((procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*|C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*"" AND targetProcName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*|C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*"") AND (procName NOT REGEXP ""C:\\Windows\\Temp\\asgard2-agent\\.*"" OR procName NOT REGEXP "".*\\thor64\.exe"") AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\GitHubDesktop\\app-.*"" OR procName NOT REGEXP "".*\\GitHubDesktop\.exe|.*\\resources\\app\\git\\usr\\bin\\sh\.exe"" OR targetProcName NOT REGEXP ""C:\\Users\\.*"" OR targetProcName NOT REGEXP "".*\\AppData\\Local\\GitHubDesktop\\app-.*"") AND (procName NOT REGEXP ""C:\\Windows\\Microsoft\.NET\\Framework64\\v.*|C:\\Windows\\Microsoft\.NET\\Framework\\v.*"" OR procName NOT REGEXP "".*\\NGenTask\.exe"" OR targetProcName NOT REGEXP ""C:\\Windows\\Microsoft\.NET\\Framework64\\v.*|C:\\Windows\\Microsoft\.NET\\Framework\\v.*"") AND (procName NOT IN (""C:\\WINDOWS\\system32\\taskhostw.exe"",""C:\\Windows\\system32\\taskhost.exe"") OR targetProcName NOT REGEXP ""C:\\Windows\\Microsoft\.NET\\Framework64\\v.*|C:\\Windows\\Microsoft\.NET\\Framework\\v.*"" OR targetProcName NOT REGEXP "".*\\NGenTask\.exe"") AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams\\stage\\Teams\.exe"" OR targetProcName NOT REGEXP ""C:\\Users\\.*"" OR targetProcName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams\\Update\.exe"") AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams\\Update\.exe"" OR targetProcName!=""C:\\WINDOWS\\SysWOW64\\regsvr32.exe"") AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams\\Update\.exe"" OR targetProcName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams\\stage\\Teams\.exe"")) |
| Windows: Potential Persistence Attempt Via Existing Service Tampering | Security | Detects the modification of an existing service in order to execute an arbitrary payload when the service is started or killed as a potential method for persistence. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_service_tamper_for_persistence.yml | Windows: Potential Persistence Attempt Via Existing Service Tampering | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*sc .*"" AND ((command REGEXP "".*config .*"" AND command REGEXP "".*binpath=.*"") OR (command REGEXP "".*failure.*"" AND command REGEXP "".*command=.*""))) OR (command REGEXP "".*reg .*"" AND command REGEXP "".*add .*"" AND (command REGEXP "".*FailureCommand.*"" OR command REGEXP "".*ImagePath.*"") AND command REGEXP "".*\.bat.*|.*\.bin\$.*|.*\.cmd.*|.*\.dll.*|.*\.exe.*|.*\.jar.*|.*\.js.*|.*\.msh\$.*|.*\.pl.*|.*\.ps.*|.*\.reg\$.*|.*\.scr.*|.*\.sh.*|.*\.vb.*"")) |
| Windows: Potential PowerShell Execution Via DLL | Security | Detects potential PowerShell execution from a DLL instead of the usual PowerShell process as seen used in PowerShdll. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_dll_execution.yml | Windows: Potential PowerShell Execution Via DLL | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\InstallUtil\.exe|.*\\regasm\.exe|.*\\regsvcs\.exe|.*\\rundll32\.exe"" OR srcFileName IN (""InstallUtil.exe"",""RUNDLL32.EXE"",""RegAsm.exe"",""RegSvcs.exe"")) AND command REGEXP "".*Default\.GetString.*|.*DownloadString.*|.*FromBase64String.*|.*ICM .*|.*IEX .*|.*Invoke-Command.*|.*Invoke-Expression.*"" |
| Windows: Potential Privilege Escalation via Service Permissions Weakness | Security | Detect modification of services configuration (ImagePath, FailureCommand and ServiceDLL) in registry by processes with Medium integrity level. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_registry_privilege_escalation_via_service_key.yml | Windows: Potential Privilege Escalation via Service Permissions Weakness | eventType=""Win-Sysmon-1-Create-Process"" AND integrityLevel=""Medium"" AND command REGEXP "".*ControlSet.*"" AND command REGEXP "".*services.*"" AND command REGEXP "".*\\FailureCommand.*|.*\\ImagePath.*|.*\\ServiceDll.*"" |
| Windows: Potential Privileged System Service Operation - SeLoadDriverPrivilege | Security | Detects the usage of the 'SeLoadDriverPrivilege' privilege. This privilege is required to load or unload a device driver. With this privilege, the user can dynamically load and unload device drivers or other code in to kernel mode. This user right does not apply to Plug and Play device drivers. If you exclude privileged users/admins and processes, which are allowed to do so, you are maybe left with bad programs trying to load malicious kernel drivers. This will detect Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs) and the usage of Sysinternals and various other tools. So you have to work with a whitelist to find the bad stuff. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_user_driver_loaded.yml | Windows: Potential Privileged System Service Operation - SeLoadDriverPrivilege | (eventType=""Win-Security-4673"" AND privName=""SeLoadDriverPrivilege"" AND serviceName IS NULL) AND ((procName NOT IN (""C:\\Windows\\HelpPane.exe"",""C:\\Windows\\System32\\Dism.exe"",""C:\\Windows\\System32\\RuntimeBroker.exe"",""C:\\Windows\\System32\\SystemSettingsBroker.exe"",""C:\\Windows\\System32\\fltMC.exe"",""C:\\Windows\\System32\\mmc.exe"",""C:\\Windows\\System32\\rundll32.exe"",""C:\\Windows\\System32\\svchost.exe"",""C:\\Windows\\System32\\wimserv.exe"",""C:\\Windows\\explorer.exe"")) AND (procName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams\\current\\Teams\.exe|.*\\Google\\Chrome\\Application\\chrome\.exe|.*\\procexp64\.exe|.*\\procexp\.exe|.*\\procmon64\.exe|.*\\procmon\.exe"") AND (procName NOT REGEXP ""C:\\Program Files\\WindowsApps\\Microsoft.*"")) |
| Windows: Potential Qakbot Registry Activity | Security | Detects a registry key used by IceID in a campaign that distributes malicious OneNote files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_malware_qakbot_registry.yml | Windows: Potential Qakbot Registry Activity | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*\\Software\\firm\\soft\\Name"" |
| Windows: Potential Ransomware or Unauthorized MBR Tampering Via Bcdedit.EXE | Security | Detects potential malicious and unauthorized usage of bcdedit.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bcdedit_susp_execution.yml | Windows: Potential Ransomware or Unauthorized MBR Tampering Via Bcdedit.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\bcdedit\.exe"" OR srcFileName=""bcdedit.exe"") AND command REGEXP "".*delete.*|.*deletevalue.*|.*import.*|.*network.*|.*safeboot.*"" |
| Windows: Potential Rcdll.DLL Sideloading | Security | Detects potential DLL sideloading of rcdll.dll. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_rcdll.yml | Windows: Potential Rcdll.DLL Sideloading | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\rcdll\.dll"" AND (loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft Visual Studio\\.*|C:\\Program Files \(x86\)\\Windows Kits\\.*"") |
| Windows: Potential RoboForm.DLL Sideloading | Security | Detects potential DLL sideloading of ""roboform.dll"", a DLL used by RoboForm Password Manager. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_robform.yml | Windows: Potential RoboForm.DLL Sideloading | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\roboform-x64\.dll|.*\\roboform\.dll"" AND ((procName NOT REGEXP "" C:\\Program Files \(x86\)\\Siber Systems\\AI RoboForm\\.*| C:\\Program Files\\Siber Systems\\AI RoboForm\\.*"" OR procName NOT REGEXP "".*\\robotaskbaricon-x64\.exe|.*\\robotaskbaricon\.exe"")) |
| Windows: Potential Rundll32 Execution With DLL Stored In ADS | Security | Detects execution of rundll32 where the DLL being called is stored in an Alternate Data Stream (ADS). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_ads_stored_dll_execution.yml | Windows: Potential Rundll32 Execution With DLL Stored In ADS | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"") |
| Windows: Potential SolidPDFCreator.DLL Sideloading | Security | Detects potential DLL sideloading of ""SolidPDFCreator.dll"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_solidpdfcreator.yml | Windows: Potential SolidPDFCreator.DLL Sideloading | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\SolidPDFCreator\.dll"" AND ((procName NOT REGEXP "".*\\SolidPDFCreator\.exe"" OR loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\SolidDocuments\\SolidPDFCreator\\.*|C:\\Program Files\\SolidDocuments\\SolidPDFCreator\\.*"")) |
| Windows: Potential SquiblyTwo Technique Execution | Security | Detects potential SquiblyTwo attack technique with possible renamed WMIC via Imphash and OriginalFileName fields. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_squiblytwo_bypass.yml | Windows: Potential SquiblyTwo Technique Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\wmic\.exe"" OR srcFileName=""wmic.exe"" OR hashIMP IN (""1B1A3F43BF37B5BFE60751F2EE2F326E"",""37777A96245A3C74EB217308F3546F4C"",""9D87C9D67CE724033C0B40CC4CA1B206"") OR hashCode REGEXP "".*IMPHASH=1B1A3F43BF37B5BFE60751F2EE2F326E.*|.*IMPHASH=37777A96245A3C74EB217308F3546F4C.*|.*IMPHASH=9D87C9D67CE724033C0B40CC4CA1B206.*"") AND (command REGEXP "".*format:.*"" AND command REGEXP "".*http.*"") |
| Windows: Potential Suspicious Activity Using SeCEdit | Security | Detects potential suspicious behaviour using secedit.exe. Such as exporting or modifying the security policy. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_secedit_execution.yml | Windows: Potential Suspicious Activity Using SeCEdit | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\secedit\.exe"" OR srcFileName=""SeCEdit"") AND ((command REGEXP "".*/export.*"" AND command REGEXP "".*/cfg.*"") OR (command REGEXP "".*/configure.*"" AND command REGEXP "".*/db.*"")) |
| Windows: Potential Suspicious Registry File Imported Via Reg.EXE | Security | Detects the import of '.reg' files from suspicious paths using the 'reg.exe' utility. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_import_from_suspicious_paths.yml | Windows: Potential Suspicious Registry File Imported Via Reg.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\reg\.exe"" OR srcFileName=""reg.exe"") AND command REGEXP "".* import .*"" AND command REGEXP "".*%appdata%.*|.*%temp%.*|.*%tmp%.*|.*C:\\ProgramData\\.*|.*C:\\Users\\.*|.*C:\\Windows\\Temp\\.*|.*\\AppData\\Local\\Temp\\.*"" |
| Windows: Potential Svchost Memory Access | Security | Detects potential access to svchost process memory such as that used by Invoke-Phantom to kill the winRM windows event logging service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_invoke_phantom.yml | Windows: Potential Svchost Memory Access | eventType=""Win-Sysmon-10-ProcessAccess"" AND (targetProcName REGEXP "".*\\WINDOWS\\System32\\svchost\.exe"" AND accessKeyId=""0x1F3FFF"" AND procPath REGEXP "".*UNKNOWN.*"") AND ((procName NOT REGEXP ""C:\\Program Files\\Microsoft Visual Studio\\.*"" OR procName NOT REGEXP "".*\\MSBuild\\Current\\Bin\\MSBuild\.exe"" OR procPath NOT REGEXP "".*Microsoft\.Build\.ni\.dll.*|.*System\.ni\.dll.*"")) |
| Windows: Potential Tampering With RDP Related Registry Keys Via Reg.EXE | Security | Detects the execution of ""reg.exe"" for enabling/disabling the RDP service on the host by tampering with the 'CurrentControlSet\Control\Terminal Server' values. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_rdp_keys_tamper.yml | Windows: Potential Tampering With RDP Related Registry Keys Via Reg.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\reg\.exe"" OR srcFileName=""reg.exe"") AND (command REGEXP "".* add .*"" AND command REGEXP "".*\\CurrentControlSet\\Control\\Terminal Server.*"" AND command REGEXP "".*REG_DWORD.*"" AND command REGEXP "".* /f.*"")) AND ((command REGEXP "".*Licensing Core.*"" AND command REGEXP "".*EnableConcurrentSessions.*"") OR command REGEXP "".*AllowTSConnections.*|.*IdleWinStationPoolCount.*|.*MaxInstanceCount.*|.*TSAdvertise.*|.*TSAppCompat.*|.*TSEnabled.*|.*TSUserEnabled.*|.*WinStations\\RDP-Tcp.*|.*fDenyTSConnections.*|.*fEnableWinStation.*|.*fSingleSessionPerUser.*"") |
| Windows: Potential Tampering With Security Products Via WMIC | Security | Detects uninstallation or termination of security products using the WMIC utility. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_uninstall_security_products.yml | Windows: Potential Tampering With Security Products Via WMIC | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*wmic.*"" AND command REGEXP "".*product where .*"" AND command REGEXP "".*call.*"" AND command REGEXP "".*uninstall.*"" AND command REGEXP "".*/nointeractive.*"") OR (command REGEXP "".*wmic.*"" AND command REGEXP "".*caption like .*"" AND command REGEXP "".*call delete.*|.*call terminate.*"") OR (command REGEXP "".*process .*"" AND command REGEXP "".*where .*"" AND command REGEXP "".*delete.*"")) AND command REGEXP "".*%Sophos%.*|.*%carbon%.*|.*%cylance%.*|.*%endpoint%.*|.*%eset%.*|.*%malware%.*|.*%symantec%.*|.*AVG .*|.*Antivirus.*|.*Carbon Black.*|.*CarbonBlack.*|.*Cb Defense Sensor 64-bit.*|.*Crowdstrike Sensor.*|.*Cylance .*|.*DLP Endpoint.*|.*Dell Threat Defense.*|.*ESET File Security.*|.*Endpoint Detection.*|.*Endpoint Protection.*|.*Endpoint Security.*|.*Endpoint Sensor.*|.*LogRhythm System Monitor Service.*|.*Malwarebytes.*|.*McAfee Agent.*|.*Microsoft Security Client.*|.*Sophos Anti-Virus.*|.*Sophos AutoUpdate.*|.*Sophos Credential Store.*|.*Sophos Management Console.*|.*Sophos Management Database.*|.*Sophos Management Server.*|.*Sophos Remote Management System.*|.*Sophos Update Manager.*|.*Threat Protection.*|.*VirusScan.*|.*Webroot SecureAnywhere.*|.*Windows Defender.*"" |
| Windows: Potential Wazuh Security Platform DLL Sideloading | Security | Detects potential DLL side loading of DLLs that are part of the Wazuh security platform. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_wazuh.yml | Windows: Potential Wazuh Security Platform DLL Sideloading | eventType=""Win-Sysmon-7-Image-Loaded"" AND (loadedProcName REGEXP "".*\\libwazuhshared\.dll|.*\\libwinpthread-1\.dll"" AND ((loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*""))) AND ((loadedProcName NOT REGEXP "".*\\AppData\\Local\\.*|.*\\ProgramData\\.*"" OR loadedProcName NOT REGEXP "".*\\mingw64\\bin\\libwinpthread-1\.dll"")) |
| Windows: PowerShell Base64 Encoded FromBase64String Cmdlet | Security | Detects usage of a base64 encoded ""FromBase64String"" cmdlet in a process command line. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_base64_frombase64string.yml | Windows: PowerShell Base64 Encoded FromBase64String Cmdlet | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*6OkZyb21CYXNlNjRTdHJpbm.*|.*OjpGcm9tQmFzZTY0U3RyaW5n.*|.*o6RnJvbUJhc2U2NFN0cmluZ.*"" OR command REGEXP "".*6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZw.*|.*OgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcA.*|.*oAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnA.*"") |
| Windows: Powershell Base64 Encoded MpPreference Cmdlet | Security | Detects base64 encoded ""MpPreference"" PowerShell cmdlet code that tries to modifies or tamper with Windows Defender AV. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_base64_mppreference.yml | Windows: Powershell Base64 Encoded MpPreference Cmdlet | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*BZGQtTXBQcmVmZXJlbmNlI.*|.*FkZC1NcFByZWZlcmVuY2Ug.*|.*FkZC1tcHByZWZlcmVuY2Ug.*|.*NldC1NcFByZWZlcmVuY2Ug.*|.*NldC1tcHByZWZlcmVuY2Ug.*|.*QWRkLU1wUHJlZmVyZW5jZS.*|.*TZXQtTXBQcmVmZXJlbmNlI.*|.*U2V0LU1wUHJlZmVyZW5jZS.*|.*YWRkLW1wcHJlZmVyZW5jZS.*|.*c2V0LW1wcHJlZmVyZW5jZS.*|.*hZGQtbXBwcmVmZXJlbmNlI.*|.*zZXQtbXBwcmVmZXJlbmNlI.*"" OR command REGEXP "".*BAGQAZAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA.*|.*EAZABkAC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA.*|.*EAZABkAC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA.*|.*MAZQB0AC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA.*|.*MAZQB0AC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA.*|.*QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA.*|.*TAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA.*|.*UwBlAHQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA.*|.*YQBkAGQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA.*|.*cwBlAHQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA.*|.*hAGQAZAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA.*|.*zAGUAdAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA.*"") |
| Windows: Powershell Defender Disable Scan Feature | Security | Detects requests to disable Microsoft Defender features using PowerShell commands. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_defender_disable_feature.yml | Windows: Powershell Defender Disable Scan Feature | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*Add-MpPreference .*|.*Set-MpPreference .*"" AND command REGEXP "".*DisableBehaviorMonitoring .*|.*DisableBlockAtFirstSeen .*|.*DisableIOAVProtection .*|.*DisableRealtimeMonitoring .*"" AND command REGEXP "".* 1 .*|.*\$true.*"") OR (command REGEXP "".*EaXNhYmxlQmVoYXZpb3JNb25pdG9yaW5nI.*|.*EaXNhYmxlQmxvY2tBdEZpcnN0U2Vlbi.*|.*EaXNhYmxlSU9BVlByb3RlY3Rpb24g.*|.*EaXNhYmxlUmVhbHRpbWVNb25pdG9yaW5nI.*|.*RGlzYWJsZUJlaGF2aW9yTW9uaXRvcmluZy.*|.*RGlzYWJsZUJsb2NrQXRGaXJzdFNlZW4g.*|.*RGlzYWJsZUlPQVZQcm90ZWN0aW9uI.*|.*RGlzYWJsZVJlYWx0aW1lTW9uaXRvcmluZy.*|.*Rpc2FibGVCZWhhdmlvck1vbml0b3Jpbmcg.*|.*Rpc2FibGVCbG9ja0F0Rmlyc3RTZWVuI.*|.*Rpc2FibGVJT0FWUHJvdGVjdGlvbi.*|.*Rpc2FibGVSZWFsdGltZU1vbml0b3Jpbmcg.*|.*Rpc2FibGViZWhhdmlvcm1vbml0b3Jpbmcg.*|.*Rpc2FibGVibG9ja2F0Zmlyc3RzZWVuI.*|.*Rpc2FibGVpb2F2cHJvdGVjdGlvbi.*|.*Rpc2FibGVyZWFsdGltZW1vbml0b3Jpbmcg.*|.*ZGlzYWJsZWJlaGF2aW9ybW9uaXRvcmluZy.*|.*ZGlzYWJsZWJsb2NrYXRmaXJzdHNlZW4g.*|.*ZGlzYWJsZWlvYXZwcm90ZWN0aW9uI.*|.*ZGlzYWJsZXJlYWx0aW1lbW9uaXRvcmluZy.*|.*kaXNhYmxlYmVoYXZpb3Jtb25pdG9yaW5nI.*|.*kaXNhYmxlYmxvY2thdGZpcnN0c2Vlbi.*|.*kaXNhYmxlaW9hdnByb3RlY3Rpb24g.*|.*kaXNhYmxlcmVhbHRpbWVtb25pdG9yaW5nI.*"" AND command REGEXP "".*EAGkAcwBhAGIAbABlAEIAZQBoAGEAdgBpAG8AcgBNAG8AbgBpAHQAbwByAGkAbgBnACAA.*|.*EAGkAcwBhAGIAbABlAEIAbABvAGMAawBBAHQARgBpAHIAcwB0AFMAZQBlAG4AIA.*|.*EAGkAcwBhAGIAbABlAEkATwBBAFYAUAByAG8AdABlAGMAdABpAG8AbgAgA.*|.*EAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAA.*|.*QAaQBzAGEAYgBsAGUAQgBlAGgAYQB2AGkAbwByAE0AbwBuAGkAdABvAHIAaQBuAGcAIA.*|.*QAaQBzAGEAYgBsAGUAQgBsAG8AYwBrAEEAdABGAGkAcgBzAHQAUwBlAGUAbgAgA.*|.*QAaQBzAGEAYgBsAGUASQBPAEEAVgBQAHIAbwB0AGUAYwB0AGkAbwBuACAA.*|.*QAaQBzAGEAYgBsAGUAUgBlAGEAbAB0AGkAbQBlAE0AbwBuAGkAdABvAHIAaQBuAGcAIA.*|.*QAaQBzAGEAYgBsAGUAYgBlAGgAYQB2AGkAbwByAG0AbwBuAGkAdABvAHIAaQBuAGcAIA.*|.*QAaQBzAGEAYgBsAGUAYgBsAG8AYwBrAGEAdABmAGkAcgBzAHQAcwBlAGUAbgAgA.*|.*QAaQBzAGEAYgBsAGUAaQBvAGEAdgBwAHIAbwB0AGUAYwB0AGkAbwBuACAA.*|.*QAaQBzAGEAYgBsAGUAcgBlAGEAbAB0AGkAbQBlAG0AbwBuAGkAdABvAHIAaQBuAGcAIA.*|.*RABpAHMAYQBiAGwAZQBCAGUAaABhAHYAaQBvAHIATQBvAG4AaQB0AG8AcgBpAG4AZwAgA.*|.*RABpAHMAYQBiAGwAZQBCAGwAbwBjAGsAQQB0AEYAaQByAHMAdABTAGUAZQBuACAA.*|.*RABpAHMAYQBiAGwAZQBJAE8AQQBWAFAAcgBvAHQAZQBjAHQAaQBvAG4AIA.*|.*RABpAHMAYQBiAGwAZQBSAGUAYQBsAHQAaQBtAGUATQBvAG4AaQB0AG8AcgBpAG4AZwAgA.*|.*ZABpAHMAYQBiAGwAZQBiAGUAaABhAHYAaQBvAHIAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA.*|.*ZABpAHMAYQBiAGwAZQBiAGwAbwBjAGsAYQB0AGYAaQByAHMAdABzAGUAZQBuACAA.*|.*ZABpAHMAYQBiAGwAZQBpAG8AYQB2AHAAcgBvAHQAZQBjAHQAaQBvAG4AIA.*|.*ZABpAHMAYQBiAGwAZQByAGUAYQBsAHQAaQBtAGUAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA.*|.*kAGkAcwBhAGIAbABlAGIAZQBoAGEAdgBpAG8AcgBtAG8AbgBpAHQAbwByAGkAbgBnACAA.*|.*kAGkAcwBhAGIAbABlAGIAbABvAGMAawBhAHQAZgBpAHIAcwB0AHMAZQBlAG4AIA.*|.*kAGkAcwBhAGIAbABlAGkAbwBhAHYAcAByAG8AdABlAGMAdABpAG8AbgAgA.*|.*kAGkAcwBhAGIAbABlAHIAZQBhAGwAdABpAG0AZQBtAG8AbgBpAHQAbwByAGkAbgBnACAA.*"")) |
| Windows: Powershell Defender Exclusion | Security | Detects requests to exclude files, folders or processes from Antivirus scanning using PowerShell cmdlets. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_defender_exclusion.yml | Windows: Powershell Defender Exclusion | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Add-MpPreference .*|.*Set-MpPreference .*"" AND command REGEXP "".* -ExclusionExtension .*|.* -ExclusionIpAddress .*|.* -ExclusionPath .*|.* -ExclusionProcess .*"" |
| Windows: PowerShell Encoded Character Syntax | Security | Detects suspicious encoded character syntax often used for defense evasion. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_obfuscation_via_utf8.yml | Windows: PowerShell Encoded Character Syntax | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\(WCHAR\)0x.*"" |
| Windows: Powerup Write Hijack DLL | Security | Powerup tool's Write Hijack DLL exploits DLL hijacking for privilege escalation. In it's default mode, it builds a self deleting .bat file which executes malicious command. The detection rule relies on creation of the malicious bat file (debug.bat by default). . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_hktl_powerup_dllhijacking.yml | Windows: Powerup Write Hijack DLL | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND fileName REGEXP "".*\.bat"" |
| Windows: PrintBrm ZIP Creation of Extraction | Security | Detects the execution of the LOLBIN PrintBrm.exe, which can be used to create or extract ZIP files. PrintBrm.exe should not be run on a normal workstation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_printbrm.yml | Windows: PrintBrm ZIP Creation of Extraction | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\PrintBrm\.exe"" AND command REGEXP "".* -f.*"" AND command REGEXP "".*\.zip.*"" |
| Windows: Process Access via TrolleyExpress Exclusion | Security | Detects a possible process memory dump that uses the white-listed Citrix TrolleyExpress.exe filename as a way to dump the lsass process memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_citrix_trolleyexpress_procdump.yml | Windows: Process Access via TrolleyExpress Exclusion | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*\\TrolleyExpress 7.*|.*\\TrolleyExpress 8.*|.*\\TrolleyExpress 9.*|.*\\TrolleyExpress\.exe -ma .*|.*\\TrolleyExpress\.exe 7.*|.*\\TrolleyExpress\.exe 8.*|.*\\TrolleyExpress\.exe 9.*"" OR (procName REGEXP "".*\\TrolleyExpress\.exe"" AND ((srcFileName NOT REGEXP "".*CtxInstall.*"") AND (srcFileName IS NOT NULL)))) |
| Windows: PUA - DefenderCheck Execution | Security | Detects the use of DefenderCheck, a tool to evaluate the signatures used in Microsoft Defender. It can be used to figure out the strings / byte chains used in Microsoft Defender to detect a tool and thus used for AV evasion. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_defendercheck.yml | Windows: PUA - DefenderCheck Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\DefenderCheck\.exe"" OR description=""DefenderCheck"") |
| Windows: PUA - Potential PE Metadata Tamper Using Rcedit | Security | Detects the use of rcedit to potentially alter executable PE metadata properties, which could conceal efforts to rename system utilities for defense evasion. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_rcedit_execution.yml | Windows: PUA - Potential PE Metadata Tamper Using Rcedit | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rcedit-x64\.exe|.*\\rcedit-x86\.exe"" OR description=""Edit resources of exe"" OR product=""rcedit"") AND command REGEXP "".*--set-.*"" AND command REGEXP "".*CompanyName.*|.*FileDescription.*|.*LegalCopyright.*|.*OriginalFileName.*|.*ProductName.*|.*ProductVersion.*"" |
| Windows: Pubprn.vbs Proxy Execution | Security | Detects the use of the 'Pubprn.vbs' Microsoft signed script to execute commands. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_pubprn.yml | Windows: Pubprn.vbs Proxy Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\pubprn\.vbs.*"" AND command REGEXP "".*script:.*"" |
| Windows: Python Py2Exe Image Load | Security | Detects the image load of Python Core indicative of a Python script bundled with Py2Exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_susp_python_image_load.yml | Windows: Python Py2Exe Image Load | eventType=""Win-Sysmon-7-Image-Loaded"" AND description=""Python Core"" AND ((procName NOT REGEXP "".*Python.*"" AND procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*|C:\\ProgramData\\Anaconda3\\.*"") AND (procName IS NOT NULL)) |
| Windows: Raccine Uninstall | Security | Detects commands that indicate a Raccine removal from an end system. Raccine is a free ransomware protection tool. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_disable_raccine.yml | Windows: Raccine Uninstall | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*taskkill .*"" AND command REGEXP "".*RaccineSettings\.exe.*"") OR (command REGEXP "".*reg\.exe.*"" AND command REGEXP "".*delete.*"" AND command REGEXP "".*Raccine Tray.*"") OR (command REGEXP "".*schtasks.*"" AND command REGEXP "".*/DELETE.*"" AND command REGEXP "".*Raccine Rules Updater.*"")) |
| Windows: RDP Connection Allowed Via Netsh.EXE | Security | Detects usage of the netsh command to open and allow connections to port 3389 (RDP). As seen used by Sarwent Malware. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_fw_allow_rdp.yml | Windows: RDP Connection Allowed Via Netsh.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\netsh\.exe"" OR srcFileName=""netsh.exe"") AND (command REGEXP "".*firewall .*"" AND command REGEXP "".*add .*"" AND command REGEXP "".*tcp .*"" AND command REGEXP "".*3389.*"") AND (command REGEXP "".*portopening.*"" OR (command REGEXP "".*advfirewall.*"" AND command REGEXP "".*rule.*"" AND command REGEXP "".*allow.*"")) |
| Windows: RedMimicry Winnti Playbook Registry Manipulation | Security | Detects actions caused by the RedMimicry Winnti playbook. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_redmimicry_winnti_reg.yml | Windows: RedMimicry Winnti Playbook Registry Manipulation | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*HKLM\\SOFTWARE\\Microsoft\\HTMLHelp\\data.*"" |
| Windows: Reg Add Suspicious Paths | Security | Detects when an adversary uses the reg.exe utility to add or modify new keys or subkeys. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_susp_paths.yml | Windows: Reg Add Suspicious Paths | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\reg\.exe"" OR srcFileName=""reg.exe"") AND command REGEXP "".*\\AppDataLow\\Software\\Microsoft\\.*|.*\\CurrentControlSet\\Control\\SecurityProviders\\WDigest.*|.*\\Microsoft\\Windows Defender\\.*|.*\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon.*|.*\\Policies\\Microsoft\\Windows\\OOBE.*|.*\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon.*"" |
| Windows: Reg Disable Security Service | Security | Detects a suspicious reg.exe invocation that looks as if it would disable an important security service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_disable_sec_services.yml | Windows: Reg Disable Security Service | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*reg.*"" AND command REGEXP "".*add.*"") AND ((command REGEXP "".* /d 4.*"" AND command REGEXP "".* /v Start.*"" AND command REGEXP "".*\\AppIDSvc.*|.*\\MsMpSvc.*|.*\\NisSrv.*|.*\\SecurityHealthService.*|.*\\Sense.*|.*\\UsoSvc.*|.*\\WdBoot.*|.*\\WdFilter.*|.*\\WdNisDrv.*|.*\\WdNisSvc.*|.*\\WinDefend.*|.*\\wscsvc.*|.*\\wuauserv.*"") OR (command REGEXP "".* /d 1.*"" AND command REGEXP "".*Windows Defender.*"" AND command REGEXP "".*DisableAntiSpyware.*|.*DisableAntiSpywareRealtimeProtection.*|.*DisableArchiveScanning.*|.*DisableBehaviorMonitoring.*|.*DisableBlockAtFirstSeen.*|.*DisableConfig.*|.*DisableEnhancedNotifications.*|.*DisableIOAVProtection.*|.*DisableIntrusionPreventionSystem.*|.*DisableOnAccessProtection.*|.*DisablePrivacyMode.*|.*DisableRoutinelyTakingAction.*|.*DisableScanOnRealtimeEnable.*|.*DisableScriptScanning.*|.*SignatureDisableUpdateOnStartupWithoutEngine.*"")) |
| Windows: Regasm/Regsvcs Suspicious Execution | Security | Detects suspicious execution of Regasm/Regsvcs utilities. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_regasm.yml | Windows: Regasm/Regsvcs Suspicious Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\Regasm\.exe|.*\\Regsvcs\.exe"" OR srcFileName IN (""RegAsm.exe"",""RegSvcs.exe"")) AND command REGEXP "".*\\AppData\\Local\\Temp\\.*|.*\\Desktop\\.*|.*\\Downloads\\.*|.*\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\.*|.*\\PerfLogs\\.*|.*\\Users\\Public\\.*|.*\\Windows\\Temp\\.*"") OR ((procName REGEXP "".*\\Regasm\.exe|.*\\Regsvcs\.exe"" OR srcFileName IN (""RegAsm.exe"",""RegSvcs.exe"")) AND ((command NOT REGEXP "".*\.dll.*"") AND (command NOT REGEXP "".*\\Regasm\.exe|.*\\Regasm\.exe\""|.*\\Regsvcs\.exe|.*\\Regsvcs\.exe\"""")))) |
| Windows: Registry Entries For Azorult Malware | Security | Detects the presence of a registry key created during Azorult execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_mal_azorult.yml | Windows: Registry Entries For Azorult Malware | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND eventType IN (""Win-Sysmon-12-Registry-CreateKey"",""Win-Sysmon-12-Registry-CreateValue"",""Win-Sysmon-12-Registry-DeleteKey"",""Win-Sysmon-12-Registry-DeleteValue"",""Win-Sysmon-13-Registry-SetValue"") AND regKeyPath REGEXP "".*SYSTEM\\.*"" AND regKeyPath REGEXP "".*\\services\\localNETService"" |
| Windows: Registry Modification Via Regini.EXE | Security | Detects the execution of regini.exe which can be used to modify registry keys, the changes are imported from one or more text files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regini_execution.yml | Windows: Registry Modification Via Regini.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\regini\.exe"" OR srcFileName=""REGINI.EXE"") AND (command NOT REGEXP "":[^ \\\\]"") |
| Windows: Regsvr32 Anomaly | Security | Detects various anomalies in relation to regsvr32.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regsvr32_anomalies.yml | Windows: Regsvr32 Anomaly | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\regsvr32\.exe"" AND command REGEXP "".*\\Temp\\.*"") OR (procName REGEXP "".*\\regsvr32\.exe"" AND parentProcName REGEXP "".*\\powershell\.exe|.*\\powershell_ise\.exe|.*\\pwsh\.exe"") OR (procName REGEXP "".*\\regsvr32\.exe"" AND parentProcName REGEXP "".*\\cmd\.exe"") OR (procName REGEXP "".*\\regsvr32\.exe"" AND command REGEXP "".*/i:.*"" AND command REGEXP "".*http.*"" AND command REGEXP "".*scrobj\.dll"") OR (procName REGEXP "".*\\regsvr32\.exe"" AND command REGEXP "".*/i:.*"" AND command REGEXP "".*ftp.*"" AND command REGEXP "".*scrobj\.dll"") OR (procName REGEXP "".*\\cscript\.exe|.*\\wscript\.exe"" AND parentProcName REGEXP "".*\\regsvr32\.exe"") OR (procName REGEXP "".*\\EXCEL\.EXE"" AND command REGEXP "".*\.\.\\\.\.\\\.\.\\Windows\\System32\\regsvr32\.exe .*"") OR (parentProcName REGEXP "".*\\mshta\.exe"" AND procName REGEXP "".*\\regsvr32\.exe"") OR (procName REGEXP "".*\\regsvr32\.exe"" AND command REGEXP "".*C:\\Users\\Public.*|.*\\AppData\\Local.*"") OR (procName REGEXP "".*\\regsvr32\.exe"" AND command REGEXP "".*\.bin|.*\.gif|.*\.jpeg|.*\.jpg|.*\.png|.*\.temp|.*\.tmp|.*\.txt"")) AND ((command NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams.*|.*\\AppData\\Local\\WebEx\\WebEx64\\Meetings\\atucfobj\.dll.*"") AND (parentProcName!=""C:\\Program Files\\Box\\Box\\FS\\streem.exe"" OR command NOT REGEXP "".*\\Program Files\\Box\\Box\\Temp\\.*"") AND (command NOT REGEXP "".*/s C:\\Windows\\System32\\RpcProxy\\RpcProxy\.dll"")) |
| Windows: Regsvr32 Flags Anomaly | Security | Detects a flag anomaly in which regsvr32.exe uses a /i flag without using a /n flag at the same time. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regsvr32_flags_anomaly.yml | Windows: Regsvr32 Flags Anomaly | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\regsvr32\.exe"" AND command REGEXP "".* /i:.*"") AND (command NOT REGEXP "".* /n .*"") |
| Windows: Remote CHM File Download/Execution Via HH.EXE | Security | Detects the usage of ""hh.exe"" to execute/download remotely hosted "".chm"" files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hh_chm_remote_download_or_execution.yml | Windows: Remote CHM File Download/Execution Via HH.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""HH.exe"" OR procName REGEXP "".*\\hh\.exe"") AND command REGEXP "".*http.*"" |
| Windows: Remotely Hosted HTA File Executed Via Mshta.EXE | Security | Detects execution of the ""mshta"" utility with an argument containing the ""http"" keyword, which could indicate that an attacker is executing a remotely hosted malicious hta file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mshta_http.yml | Windows: Remotely Hosted HTA File Executed Via Mshta.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\mshta\.exe"" OR srcFileName=""MSHTA.EXE"") AND command REGEXP "".*ftp://.*|.*http://.*|.*https://.*"" |
| Windows: Renamed FTP.EXE Execution | Security | Detects the execution of a renamed ""ftp.exe"" binary based on the PE metadata fields. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_ftp.yml | Windows: Renamed FTP.EXE Execution | eventType=""Win-Sysmon-1-Create-Process"" AND srcFileName=""ftp.exe"" AND (procName NOT REGEXP "".*\\ftp\.exe"") |
| Windows: Renamed Jusched.EXE Execution | Security | Detects the execution of a renamed ""jusched.exe"" as seen used by the cobalt group. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_jusched.yml | Windows: Renamed Jusched.EXE Execution | eventType=""Win-Sysmon-1-Create-Process"" AND description IN (""Java Update Scheduler"",""Java(TM) Update Scheduler"") AND (procName NOT REGEXP "".*\\jusched\.exe"") |
| Windows: Renamed Mavinject.EXE Execution | Security | Detects the execution of a renamed version of the ""Mavinject"" process. Which can be abused to perform process injection using the ""/INJECTRUNNING"" flag. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_mavinject.yml | Windows: Renamed Mavinject.EXE Execution | eventType=""Win-Sysmon-1-Create-Process"" AND srcFileName IN (""mavinject32.exe"",""mavinject64.exe"") AND (procName NOT REGEXP "".*\\mavinject32\.exe|.*\\mavinject64\.exe"") |
| Windows: Renamed Msdt.EXE Execution | Security | Detects the execution of a renamed ""Msdt.exe"" binary. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_msdt.yml | Windows: Renamed Msdt.EXE Execution | eventType=""Win-Sysmon-1-Create-Process"" AND srcFileName=""msdt.exe"" AND (procName NOT REGEXP "".*\\msdt\.exe"") |
| Windows: Renamed PAExec Execution | Security | Detects execution of renamed version of PAExec. PAExec is a remote administration tool designed as an alternative to Microsoft's PsExec. The tool is a small remote shell that includes functionality for copying files, remote execution, and fully interactive shell sessions with remote Windows machines without the need to install client software. It relies on the SMB protocol. The tool copies an executable to the hidden Admin$ share and then uses the Windows Service Control Manager API to start it as a service. The service uses named pipes, which connect back to the PAExec tool. PAExec is self-contained and doesn't use an installer. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_paexec.yml | Windows: Renamed PAExec Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (description=""PAExec Application"" OR srcFileName=""PAExec.exe"" OR product REGEXP "".*PAExec.*"" OR hashIMP IN (""11D40A7B7876288F919AB819CC2D9802"",""1a6cca4d5460b1710a12dea39e4a592c"",""6444f8a34e99b8f7d9647de66aabe516"",""dfd6aa3f7b2b1035b76b718f1ddc689f"") OR hashCode REGEXP "".*IMPHASH=11D40A7B7876288F919AB819CC2D9802.*|.*IMPHASH=1a6cca4d5460b1710a12dea39e4a592c.*|.*IMPHASH=6444f8a34e99b8f7d9647de66aabe516.*|.*IMPHASH=dfd6aa3f7b2b1035b76b718f1ddc689f.*"") AND (procName NOT REGEXP "".*\\paexec\.exe"" AND procName NOT REGEXP ""C:\\Windows\\PAExec-.*"") |
| Windows: Renamed ProcDump Execution | Security | Detects the execution of a renamed ProcDump executable often used by attackers or malware. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_sysinternals_procdump.yml | Windows: Renamed ProcDump Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""procdump"" OR (command REGEXP "".* -ma .*|.* /ma .*"" AND command REGEXP "".* -accepteula .*|.* /accepteula .*"")) AND (procName NOT REGEXP "".*\\procdump64\.exe|.*\\procdump\.exe"") |
| Windows: Renamed Vmnat.exe Execution | Security | Detects renamed vmnat.exe or portable version that can be used for DLL side-loading. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_vmnat.yml | Windows: Renamed Vmnat.exe Execution | eventType=""Win-Sysmon-1-Create-Process"" AND srcFileName=""vmnat.exe"" AND ((procName NOT REGEXP "".*vmnat\.exe"")) |
| Windows: Renamed ZOHO Dctask64 Execution | Security | Detects a renamed dctask64.exe used for process injection, command execution, process creation with a signed binary by ZOHO Corporation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_dctask64.yml | Windows: Renamed ZOHO Dctask64 Execution | eventType=""Win-Sysmon-1-Create-Process"" AND hashCode REGEXP "".*6834B1B94E49701D77CCB3C0895E1AFD.*"" AND (procName NOT REGEXP "".*\\dctask64\.exe"") |
| Windows: Root Certificate Installed From Susp Locations | Security | Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_import_cert_susp_locations.yml | Windows: Root Certificate Installed From Susp Locations | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Import-Certificate.*"" AND command REGEXP "".* -FilePath .*"" AND command REGEXP "".*Cert:\\LocalMachine\\Root.*"" AND command REGEXP "".*:\\Users\\Public\\.*|.*:\\Windows\\TEMP\\.*|.*\\AppData\\Local\\Temp\\.*|.*\\Desktop\\.*|.*\\Downloads\\.*|.*\\Perflogs\\.*"" |
| Windows: Run Once Task Configuration in Registry | Security | Detects the configuration of Run Once registry key. Configured payload can be run by runonce.exe /AlternateShellStartup. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_runonce_persistence.yml | Windows: Run Once Task Configuration in Registry | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND (regKeyPath REGEXP ""HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components.*"" AND regKeyPath REGEXP "".*\\StubPath"") AND ((details NOT REGEXP ""\""C:\\Program Files\\Google\\Chrome\\Application\\.*"" OR details NOT REGEXP "".*\\Installer\\chrmstp\.exe\"" --configure-user-settings --verbose-logging --system-level.*"") AND (details NOT REGEXP ""\""C:\\Program Files \(x86\)\\Microsoft\\Edge\\Application\\.*|\""C:\\Program Files\\Microsoft\\Edge\\Application\\.*"" OR details NOT REGEXP "".*\\Installer\\setup\.exe\"" --configure-user-settings --verbose-logging --system-level --msedge --channel=stable"")) |
| Windows: Run Once Task Execution as Configured in Registry | Security | This rule detects the execution of Run Once task as configured in the registry. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_runonce_execution.yml | Windows: Run Once Task Execution as Configured in Registry | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\runonce\.exe"" OR description=""Run Once Wrapper"") AND (command REGEXP "".*/AlternateShellStartup.*"" OR command REGEXP "".*/r"") |
| Windows: Run PowerShell Script from ADS | Security | Detects PowerShell script execution from Alternate Data Stream (ADS). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_run_script_from_ads.yml | Windows: Run PowerShell Script from ADS | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND command REGEXP "".*Get-Content.*"" AND command REGEXP "".*-Stream.*"" |
| Windows: Rundll32 InstallScreenSaver Execution | Security | An attacker may execute an application as a SCR File using rundll32.exe desk.cpl,InstallScreenSaver. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_rundll32_installscreensaver.yml | Windows: Rundll32 InstallScreenSaver Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"") AND command REGEXP "".*InstallScreenSaver.*"" |
| Windows: Rundll32 Internet Connection | Security | Detects a rundll32 that communicates with public IP addresses. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_rundll32_net_connections.yml | Windows: Rundll32 Internet Connection | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (procName REGEXP "".*\\rundll32\.exe"" AND initiated=""true"") AND ((destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND command NOT REGEXP "".*PcaSvc\.dll,PcaPatchSdbTask.*"" AND srcName NOT REGEXP "".*\.internal\.cloudapp\.net"") AND (parentProcName!=""C:\\Windows\\System32\\svchost.exe"" OR destIpPort!=443)) |
| Windows: RunDLL32 Spawning Explorer | Security | Detects RunDLL32.exe spawning explorer.exe as child, which is very uncommon, often observes Gamarue spawning the explorer.exe process in an unusual way. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_spawn_explorer.yml | Windows: RunDLL32 Spawning Explorer | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\rundll32\.exe"" AND procName REGEXP "".*\\explorer\.exe"") AND (parentCommand NOT REGEXP "".*\\shell32\.dll,Control_RunDLL.*"") |
| Windows: Rundll32 UNC Path Execution | Security | Detects rundll32 execution where the DLL is located on a remote location (share). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_unc_path.yml | Windows: Rundll32 UNC Path Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"" OR command REGEXP "".*rundll32.*"") AND command REGEXP "".* \\\\\.*"" |
| Windows: SafeBoot Registry Key Deleted Via Reg.EXE | Security | Detects execution of ""reg.exe"" commands with the ""delete"" flag on safe boot registry keys. Often used by attacker to prevent safeboot execution of security products. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_delete_safeboot.yml | Windows: SafeBoot Registry Key Deleted Via Reg.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*reg\.exe"" OR srcFileName=""reg.exe"") AND (command REGEXP "".* delete .*"" AND command REGEXP "".*\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot.*"") |
| Windows: SCR File Write Event | Security | Detects the creation of screensaver files (.scr) outside of system folders. Attackers may execute an application as an "".SCR"" file using ""rundll32.exe desk.cpl,InstallScreenSaver"" for example. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_new_src_file.yml | Windows: SCR File Write Event | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\.scr"" AND (fileName NOT REGEXP "":\\WUDownloadCache\\.*|C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\WinSxS\\.*|C:\\\$WINDOWS\.~BT\\NewOS\\.*"") |
| Windows: Sdclt Child Processes | Security | A General detection for sdclt spawning new processes. This could be an indicator of sdclt being used for bypass UAC techniques. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sdclt_child_process.yml | Windows: Sdclt Child Processes | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\sdclt\.exe"" |
| Windows: Secure Deletion with SDelete | Security | Detects renaming of file while deletion with SDelete tool. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_sdelete.yml | Windows: Secure Deletion with SDelete | eventType IN (""Win-Security-4656"",""Win-Security-4658"",""Win-Security-4663"") AND osObjName REGEXP "".*\.AAA|.*\.ZZZ"" |
| Windows: Security Event Log Cleared | Security | Checks for event id 1102 which indicates the security event log was cleared. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_event_log_cleared.yml | Windows: Security Event Log Cleared | eventType=""Win-Security-Microsoft-Windows-Eventlog-1102"" |
| Windows: Service DACL Abuse To Hide Services Via Sc.EXE | Security | Detects usage of the ""sc.exe"" utility adding a new service with special permission seen used by threat actors which makes the service hidden and unremovable. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_sdset_hide_sevices.yml | Windows: Service DACL Abuse To Hide Services Via Sc.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\sc\.exe"" OR srcFileName=""sc.exe"") AND (command REGEXP "".*sdset.*"" AND command REGEXP "".*DCLCWPDTSD.*"") |
| Windows: Service ImagePath Change with Reg.exe | Security | Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services. Adversaries may use flaws in the permissions for registry to redirect from the originally specified executable to one that they control, in order to launch their own code at Service start. Windows stores local service configuration information in the Registry under HKLM\SYSTEM\CurrentControlSet\Services . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_service_imagepath_change.yml | Windows: Service ImagePath Change with Reg.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\reg\.exe"" AND command REGEXP "".*add .*"" AND command REGEXP "".*SYSTEM\\CurrentControlSet\\Services\\.*"" AND command REGEXP "".* ImagePath .*"" AND command REGEXP "".* -d .*|.* /d .*"" |
| Windows: Service Registry Key Deleted Via Reg.EXE | Security | Detects execution of ""reg.exe"" commands with the ""delete"" flag on services registry key. Often used by attacker to remove AV software services. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_delete_services.yml | Windows: Service Registry Key Deleted Via Reg.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*reg\.exe"" OR srcFileName=""reg.exe"") AND command REGEXP "".* delete .*"" AND command REGEXP "".*\\SYSTEM\\CurrentControlSet\\services\\.*"" |
| Windows: Service Security Descriptor Tampering Via Sc.EXE | Security | Detection of sc.exe utility adding a new service with special permission which hides that service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_sdset_modification.yml | Windows: Service Security Descriptor Tampering Via Sc.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\sc\.exe"" OR srcFileName=""sc.exe"") AND command REGEXP "".*sdset.*"" |
| Windows: Service StartupType Change Via PowerShell Set-Service | Security | Detects the use of the PowerShell ""Set-Service"" cmdlet to change the startup type of a service to ""disabled"" or ""manual"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_set_service_disabled.yml | Windows: Service StartupType Change Via PowerShell Set-Service | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe"" OR srcFileName=""PowerShell.EXE"") AND (command REGEXP "".*Set-Service.*"" AND command REGEXP "".*-StartupType.*"" AND command REGEXP "".*Disabled.*|.*Manual.*"") |
| Windows: Service StartupType Change Via Sc.EXE | Security | Detect the use of ""sc.exe"" to change the startup type of a service to ""disabled"" or ""demand"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_disable_service.yml | Windows: Service StartupType Change Via Sc.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\sc\.exe"" OR srcFileName=""sc.exe"") AND (command REGEXP "".* config .*"" AND command REGEXP "".*start.*"" AND command REGEXP "".*demand.*|.*disabled.*"") |
| Windows: Set Files as System Files Using Attrib.EXE | Security | Detects the execution of ""attrib"" with the ""+s"" flag to mark files as system files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_attrib_system.yml | Windows: Set Files as System Files Using Attrib.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\attrib\.exe"" OR srcFileName=""ATTRIB.EXE"") AND command REGEXP "".* \+s .*"" |
| Windows: Set Suspicious Files as System Files Using Attrib.EXE | Security | Detects the usage of attrib with the ""+s"" option to set scripts or executables located in suspicious locations as system files to hide them from users and make them unable to be deleted with simple rights. The rule limits the search to specific extensions and directories to avoid FPs . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_attrib_system_susp_paths.yml | Windows: Set Suspicious Files as System Files Using Attrib.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\attrib\.exe"" OR srcFileName=""ATTRIB.EXE"") AND command REGEXP "".* \+s.*"" AND command REGEXP "".* %.*|.*\\AppData\\Local\\.*|.*\\Downloads\\.*|.*\\ProgramData\\.*|.*\\Users\\Public\\.*|.*\\Windows\\Temp\\.*"" AND command REGEXP "".*\.bat.*|.*\.dll.*|.*\.exe.*|.*\.hta.*|.*\.ps1.*|.*\.vbe.*|.*\.vbs.*"") AND (command NOT REGEXP "".*\\Windows\\TEMP\\.*"" OR command NOT REGEXP "".*\.exe.*"") |
| Windows: Shell Open Registry Keys Manipulation | Security | Detects the shell open key manipulation (exefile and ms-settings) used for persistence and the pattern of UAC Bypass using fodhelper.exe, computerdefaults.exe, slui.exe via registry keys (e.g. UACMe 33 or 62). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_shell_open_keys_manipulation.yml | Windows: Shell Open Registry Keys Manipulation | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND (((osObjAction=""SetValue"" AND regKeyPath REGEXP "".*Classes\\ms-settings\\shell\\open\\command\\SymbolicLinkValue"" AND details REGEXP "".*\\Software\\Classes\\\{.*"") OR regKeyPath REGEXP "".*Classes\\ms-settings\\shell\\open\\command\\DelegateExecute"") OR ((osObjAction=""SetValue"" AND regKeyPath REGEXP "".*Classes\\exefile\\shell\\open\\command\\\(Default\)|.*Classes\\ms-settings\\shell\\open\\command\\\(Default\)"") AND (details!=""(Empty)""))) |
| Windows: Shell32 DLL Execution in Suspicious Directory | Security | Detects shell32.dll executing a DLL in a suspicious directory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_shell32_susp_execution.yml | Windows: Shell32 DLL Execution in Suspicious Directory | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"") AND (command REGEXP "".*shell32\.dll.*"" AND command REGEXP "".*Control_RunDLL.*"" AND command REGEXP "".*%AppData%.*|.*%LocalAppData%.*|.*%Temp%.*|.*%tmp%.*|.*\\AppData\\.*|.*\\Temp\\.*|.*\\Users\\Public\\.*"") |
| Windows: ShimCache Flush | Security | Detects actions that clear the local ShimCache and remove forensic evidence. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_susp_shimcache_flush.yml | Windows: ShimCache Flush | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*rundll32.*"" AND ((command REGEXP "".*apphelp\.dll.*"" AND command REGEXP "".*#250.*|.*ShimFlushCache.*"") OR (command REGEXP "".*kernel32\.dll.*"" AND command REGEXP "".*#46.*|.*BaseFlushAppcompatCache.*"")) |
| Windows: Silenttrinity Stager Msbuild Activity | Security | Detects a possible remote connections to Silenttrinity c2. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_silenttrinity_stager_msbuild_activity.yml | Windows: Silenttrinity Stager Msbuild Activity | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND procName REGEXP "".*\\msbuild\.exe"" AND destIpPort IN (443,80) AND initiated=""true"" |
| Windows: Successful Overpass the Hash Attempt | Security | Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module. Mimikatz is a open source malware program that is commonly used by hackers and security professionals to extract sensitive information, such as passwords and credentials, from a system's memory. In an overpass-the-hash attack, an adversary leverages the NTLM hash of a user account to obtain a Kerberos ticket that can be used to access network resources. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_overpass_the_hash.yml | Windows: Successful Overpass the Hash Attempt | eventType=""Win-Security-4624"" AND winLogonType=9 AND winLogonProc=""seclogo"" AND authenMethod=""Negotiate"" |
| Windows: Suspicious Cabinet File Execution Via Msdt.EXE | Security | Detects execution of msdt.exe using the ""cab"" flag which could indicates suspicious diagcab files with embedded answer files leveraging CVE-2022-30190. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msdt_susp_cab_options.yml | Windows: Suspicious Cabinet File Execution Via Msdt.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\msdt\.exe"" OR srcFileName=""msdt.exe"") AND command REGEXP "".* -cab .*|.* /cab .*"" |
| Windows: Suspicious Call by Ordinal | Security | Detects suspicious calls of DLLs in rundll32.dll exports by ordinal. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_by_ordinal.yml | Windows: Suspicious Call by Ordinal | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"") AND command REGEXP "".*, #.*|.*,#.*|.*\.dll #.*|.*\.ocx #.*"") AND ((command NOT REGEXP "".*EDGEHTML\.dll.*"" OR command NOT REGEXP "".*#141.*"") AND (parentProcName NOT REGEXP "".*\\Msbuild\\Current\\Bin\\.*|.*\\Tracker\.exe.*|.*\\VC\\Tools\\MSVC\\.*"" OR command NOT REGEXP "".*\\FileTracker32\.dll,#1.*|.*\\FileTracker32\.dll\"",#1.*|.*\\FileTracker64\.dll,#1.*|.*\\FileTracker64\.dll\"",#1.*"")) |
| Windows: Suspicious Child Process Created as System | Security | Detection of child processes spawned with SYSTEM privileges by parents with LOCAL SERVICE or NETWORK SERVICE accounts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_child_process_as_system_.yml | Windows: Suspicious Child Process Created as System | eventType=""Win-Sysmon-1-Create-Process"" AND (userGrp IN (""AUTORITE NT\\"",""NT AUTHORITY\\LOCAL SERVICE"",""NT AUTHORITY\\NETWORK SERVICE"") AND user REGEXP "".*AUTHORI.*|.*AUTORI.*"" AND user REGEXP "".*\\SYSTEM|.*\\Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐ"" AND integrityLevel=""System"") AND (procName NOT REGEXP "".*\\rundll32\.exe"" OR command NOT REGEXP "".*DavSetCookie.*"") |
| Windows: Suspicious Child Process Created as System | Security | Detection of child processes spawned with SYSTEM privileges by parents with LOCAL SERVICE or NETWORK SERVICE accounts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_child_process_as_system_.yml | Windows: Suspicious Child Process Created as System | eventType=""Win-Sysmon-1-Create-Process"" AND (userGrp REGEXP "".*AUTHORI.*|.*AUTORI.*"" AND userGrp REGEXP "".*\\LOCAL SERVICE|.*\\NETWORK SERVICE"" AND user REGEXP "".*AUTHORI.*|.*AUTORI.*"" AND user REGEXP "".*\\SYSTEM|.*\\Syst.me|.*\\C.CTEMA"" AND integrityLevel=""System"") AND ((procName NOT REGEXP "".*\\rundll32\.exe"" OR command NOT REGEXP "".*DavSetCookie.*"")) |
| Windows: Suspicious Cmdl32 Execution | Security | lolbas Cmdl32 is use to download a payload to evade antivirus. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_cmdl32.yml | Windows: Suspicious Cmdl32 Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmdl32\.exe"" OR srcFileName=""CMDL32.EXE"") AND (command REGEXP "".*/vpn .*"" AND command REGEXP "".*/lan .*"") |
| Windows: Suspicious Commandline Escape | Security | Detects potential commandline obfuscation using known escape characters. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_cli_obfuscation_escape_char.yml | Windows: Suspicious Commandline Escape | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*h\""t\""t\""p.*|.*h\^t\^t\^p.*"" |
| Windows: Suspicious Control Panel DLL Load | Security | Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_susp_control_dll_load.yml | Windows: Suspicious Control Panel DLL Load | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\System32\\control\.exe"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"")) AND (command NOT REGEXP "".*Shell32\.dll.*"") |
| Windows: Suspicious Copy From or To System32 | Security | Detects a suspicious copy operation that tries to copy a program from a system (System32 or SysWOW64) directory to another on disk. Often used to move LOLBINs such as 'certutil' or 'desktopimgdownldr' to a different location with a different name in order to bypass detections based on locations . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_system32.yml | Windows: Suspicious Copy From or To System32 | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\cmd\.exe"" AND command REGEXP "".*copy .*"") OR (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND command REGEXP "".* copy .*|.* cp .*|.*copy-item.*|.*cpi .*"") OR (procName REGEXP "".*\\robocopy\.exe|.*\\xcopy\.exe"" OR srcFileName IN (""XCOPY.EXE"",""robocopy.exe""))) AND command REGEXP "".*\\SysWOW64.*|.*\\System32.*"" |
| Windows: Suspicious Csc.exe Source File Folder | Security | Detects a suspicious execution of csc.exe, which uses a source in a suspicious folder (e.g. AppData). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_csc_susp_folder.yml | Windows: Suspicious Csc.exe Source File Folder | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\csc\.exe"" AND command REGEXP "".*\\AppData\\.*|.*\\Windows\\Temp\\.*"") AND (parentProcName NOT REGEXP ""C:\\Program Files.*"" AND parentProcName NOT REGEXP "".*\\choco\.exe|.*\\sdiagnhost\.exe|.*\\w3wp\.exe"" AND parentCommand NOT REGEXP "".*\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection.*"") |
| Windows: Suspicious Diantz Alternate Data Stream Execution | Security | Compress target file into a cab file stored in the Alternate Data Stream (ADS) of the target file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_diantz_ads.yml | Windows: Suspicious Diantz Alternate Data Stream Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*diantz\.exe.*"" AND command REGEXP "".*\.cab.*"" |
| Windows: Suspicious Download From Direct IP Via Bitsadmin | Security | Detects usage of bitsadmin downloading a file using an URL that contains an IP. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bitsadmin_download_direct_ip.yml | Windows: Suspicious Download From Direct IP Via Bitsadmin | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\bitsadmin\.exe"" OR srcFileName=""bitsadmin.exe"") AND command REGEXP "".* /addfile .*|.* /create .*|.* /transfer .*"" AND command REGEXP "".*://1.*|.*://2.*|.*://3.*|.*://4.*|.*://5.*|.*://6.*|.*://7.*|.*://8.*|.*://9.*"") AND ((command NOT REGEXP "".*://7-.*"")) |
| Windows: Suspicious Download From File-Sharing Website Via Bitsadmin | Security | Detects usage of bitsadmin downloading a file from a suspicious domain. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bitsadmin_download_file_sharing_domains.yml | Windows: Suspicious Download From File-Sharing Website Via Bitsadmin | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\bitsadmin\.exe"" OR srcFileName=""bitsadmin.exe"") AND command REGEXP "".* /addfile .*|.* /create .*|.* /transfer .*"" AND command REGEXP "".*\.ghostbin\.co/.*|.*\.hastebin\.com.*|.*\.paste\.ee.*|.*anonfiles\.com.*|.*cdn\.discordapp\.com/attachments/.*|.*ddns\.net.*|.*gist\.githubusercontent\.com.*|.*mediafire\.com.*|.*mega\.nz.*|.*paste\.ee.*|.*pastebin\.com.*|.*pastebin\.pl.*|.*pastetext\.net.*|.*privatlab\.com.*|.*privatlab\.net.*|.*raw\.githubusercontent\.com.*|.*send\.exploit\.in.*|.*sendspace\.com.*|.*storage\.googleapis\.com.*|.*transfer\.sh.*|.*ufile\.io.*"" |
| Windows: Suspicious Eventlog Clear or Configuration Change | Security | Detects clearing or configuration of eventlogs using wevtutil, powershell and wmic. Might be used by ransomwares during the attack (seen by NotPetya and others). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_eventlog_clear.yml | Windows: Suspicious Eventlog Clear or Configuration Change | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\wevtutil\.exe"" AND command REGEXP "".* cl .*|.* sl .*|.*clear-log .*|.*lfn:.*|.*set-log .*"") OR (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND command REGEXP "".*Clear-EventLog .*|.*Clear-WinEvent .*|.*Limit-EventLog .*|.*Remove-EventLog .*"") OR (procName REGEXP "".*\\wmic\.exe"" AND command REGEXP "".* ClearEventLog .*"")) AND ((parentProcName NOT IN (""C:\\Windows\\SysWOW64\\msiexec.exe"",""C:\\Windows\\System32\\msiexec.exe"") OR command NOT REGEXP "".* sl .*"")) |
| Windows: Suspicious Explorer Child Of Regsvr32 | Security | Detects ""regsvr32.exe"" spawning ""explorer.exe"", which is very uncommon. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regsvr32_spawn_explorer.yml | Windows: Suspicious Explorer Child Of Regsvr32 | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\regsvr32\.exe"" AND procName REGEXP "".*\\explorer\.exe"" |
| Windows: Suspicious Extrac32 Alternate Data Stream Execution | Security | Extract data from cab file and hide it in an alternate data stream. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_extrac32_ads.yml | Windows: Suspicious Extrac32 Alternate Data Stream Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*extrac32\.exe.*"" AND command REGEXP "".*\.cab.*"" |
| Windows: Suspicious Files in Default GPO Folder | Security | Detects the creation of copy of suspicious files (EXE/DLL) to the default GPO storage folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_default_gpo_dir_write.yml | Windows: Suspicious Files in Default GPO Folder | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Policies\\\{31B2F340-016D-11D2-945F-00C04FB984F9\}\\.*"" AND fileName REGEXP "".*\.dll|.*\.exe"" |
| Windows: Suspicious GUP Usage | Security | Detects execution of the Notepad++ updater in a suspicious directory, which is often used in DLL side-loading attacks. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_gup_suspicious_execution.yml | Windows: Suspicious GUP Usage | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\GUP\.exe"" AND ((procName NOT REGEXP "".*\\Program Files \(x86\)\\Notepad\+\+\\updater\\GUP\.exe|.*\\Program Files\\Notepad\+\+\\updater\\GUP\.exe"") AND (procName NOT REGEXP "".*\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\Notepad\+\+\\updater\\GUP\.exe|.*\\AppData\\Roaming\\Notepad\+\+\\updater\\GUP\.exe"")) |
| Windows: Suspicious High IntegrityLevel Conhost Legacy Option | Security | ForceV1 asks for information directly from the kernel space. Conhost connects to the console application. High IntegrityLevel means the process is running with elevated privileges, such as an Administrator context. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_conhost_legacy_option.yml | Windows: Suspicious High IntegrityLevel Conhost Legacy Option | eventType=""Win-Sysmon-1-Create-Process"" AND integrityLevel=""High"" AND command REGEXP "".*conhost\.exe.*"" AND command REGEXP "".*0xffffffff.*"" AND command REGEXP "".*-ForceV1.*"" |
| Windows: Suspicious JavaScript Execution Via Mshta.EXE | Security | Detects execution of javascript code using ""mshta.exe"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mshta_javascript.yml | Windows: Suspicious JavaScript Execution Via Mshta.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\mshta\.exe"" OR srcFileName=""MSHTA.EXE"") AND command REGEXP "".*javascript.*"" |
| Windows: Suspicious Microsoft Office Child Process | Security | Detects a suspicious process spawning from one of the Microsoft Office suite products (Word, Excel, PowerPoint, Publisher, Visio, etc.). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_susp_child_processes.yml | Windows: Suspicious Microsoft Office Child Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\EQNEDT32\.EXE|.*\\EXCEL\.EXE|.*\\MSACCESS\.EXE|.*\\MSPUB\.exe|.*\\ONENOTE\.EXE|.*\\POWERPNT\.exe|.*\\VISIO\.exe|.*\\WINWORD\.EXE|.*\\wordpad\.exe|.*\\wordview\.exe"" AND (srcFileName IN (""CMSTP.EXE"",""CertOC.exe"",""CertUtil.exe"",""Cmd.Exe"",""HH.exe"",""IEExec.exe"",""InstallUtil.exe"",""MSHTA.EXE"",""Microsoft.Workflow.Compiler.exe"",""Msxsl.exe"",""PowerShell.EXE"",""REGSVR32.exe"",""RUNDLL32.exe"",""RegAsm.exe"",""RegSvcs.exe"",""ScriptRunner.exe"",""WorkFolders.exe"",""bitsadmin.exe"",""cscript.exe"",""curl.exe"",""javaw.exe"",""msdt.exe"",""msiexec.exe"",""odbcconf.exe"",""pcalua.exe"",""schtasks.exe"",""wmic.exe"",""wscript.exe"") OR procName REGEXP "".*\\AppVLP\.exe|.*\\Microsoft\.Workflow\.Compiler\.exe|.*\\bash\.exe|.*\\bitsadmin\.exe|.*\\certoc\.exe|.*\\certutil\.exe|.*\\cmd\.exe|.*\\cmstp\.exe|.*\\control\.exe|.*\\cscript\.exe|.*\\curl\.exe|.*\\forfiles\.exe|.*\\hh\.exe|.*\\ieexec\.exe|.*\\installutil\.exe|.*\\javaw\.exe|.*\\mftrace\.exe|.*\\msbuild\.exe|.*\\msdt\.exe|.*\\mshta\.exe|.*\\msidb\.exe|.*\\msiexec\.exe|.*\\msxsl\.exe|.*\\odbcconf\.exe|.*\\pcalua\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regasm\.exe|.*\\regsvcs\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\schtasks\.exe|.*\\scrcons\.exe|.*\\scriptrunner\.exe|.*\\sh\.exe|.*\\svchost\.exe|.*\\verclsid\.exe|.*\\wmic\.exe|.*\\workfolders\.exe|.*\\wscript\.exe"" OR procName REGEXP "".*\\AppData\\.*|.*\\ProgramData\\.*|.*\\Users\\Public\\.*|.*\\Windows\\System32\\Tasks\\.*|.*\\Windows\\Tasks\\.*|.*\\Windows\\Temp\\.*"") |
| Windows: Suspicious MSHTA Child Process | Security | Detects a suspicious process spawning from an ""mshta.exe"" process, which could be indicative of a malicious HTA script execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mshta_susp_child_processes.yml | Windows: Suspicious MSHTA Child Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\mshta\.exe"" AND (procName REGEXP "".*\\bash\.exe|.*\\bitsadmin\.exe|.*\\cmd\.exe|.*\\cscript\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\reg\.exe|.*\\regsvr32\.exe|.*\\sh\.exe|.*\\wscript\.exe"" OR srcFileName IN (""Bash.exe"",""Cmd.Exe"",""PowerShell.EXE"",""REGSVR32.EXE"",""bitsadmin.exe"",""cscript.exe"",""pwsh.dll"",""reg.exe"",""wscript.exe"")) |
| Windows: Suspicious MsiExec Embedding Parent | Security | Adversaries may abuse msiexec.exe to proxy the execution of malicious payloads. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msiexec_embedding.yml | Windows: Suspicious MsiExec Embedding Parent | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe|.*\\powershell\.exe|.*\\pwsh\.exe"" AND parentCommand REGEXP "".*MsiExec\.exe.*"" AND parentCommand REGEXP "".*-Embedding .*"") AND ((procName NOT REGEXP "".*:\\Windows\\System32\\cmd\.exe"" OR command NOT REGEXP "".*C:\\Program Files\\SplunkUniversalForwarder\\bin\\.*"") AND (command NOT REGEXP "".*\\DismFoDInstall\.cmd.*"" AND parentCommand NOT REGEXP "".*\\MsiExec\.exe -Embedding .*"" OR parentCommand NOT REGEXP "".*Global\\MSI0000.*"")) |
| Windows: Suspicious Msiexec Execute Arbitrary DLL | Security | Adversaries may abuse msiexec.exe to proxy execution of malicious payloads. Msiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msiexec_execute_dll.yml | Windows: Suspicious Msiexec Execute Arbitrary DLL | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\msiexec\.exe"" AND command REGEXP "".* -y.*|.* /y.*"") AND ((command NOT REGEXP "".*\\MsiExec\.exe\"" -Y C:\\Windows\\CCM\\.*|.*\\MsiExec\.exe\"" -Y \""C:\\Program Files \(x86\)\\Apple Software Update\\ScriptingObjectModel\.dll.*|.*\\MsiExec\.exe\"" -Y \""C:\\Program Files \(x86\)\\Apple Software Update\\SoftwareUpdateAdmin\.dll.*|.*\\MsiExec\.exe\"" -Y \""C:\\Program Files \(x86\)\\Bonjour\\mdnsNSP\.dll.*|.*\\MsiExec\.exe\"" -Y \""C:\\Program Files\\Bonjour\\mdnsNSP\.dll.*|.*\\MsiExec\.exe\"" -Y \""C:\\Windows\\CCM\\.*|.*\\MsiExec\.exe\"" /Y C:\\Windows\\CCM\\.*|.*\\MsiExec\.exe\"" /Y \""C:\\Program Files \(x86\)\\Apple Software Update\\ScriptingObjectModel\.dll.*|.*\\MsiExec\.exe\"" /Y \""C:\\Program Files \(x86\)\\Apple Software Update\\SoftwareUpdateAdmin\.dll.*|.*\\MsiExec\.exe\"" /Y \""C:\\Program Files \(x86\)\\Bonjour\\mdnsNSP\.dll.*|.*\\MsiExec\.exe\"" /Y \""C:\\Program Files\\Bonjour\\mdnsNSP\.dll.*|.*\\MsiExec\.exe\"" /Y \""C:\\Windows\\CCM\\.*"")) |
| Windows: Suspicious Msiexec Quiet Install From Remote Location | Security | Detects usage of Msiexec.exe to install packages hosted remotely quietly. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msiexec_install_remote.yml | Windows: Suspicious Msiexec Quiet Install From Remote Location | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\msiexec\.exe"" OR srcFileName=""msiexec.exe"") AND command REGEXP "".*-a.*|.*-i.*|.*-j.*|.*-package.*|.*/a.*|.*/i.*|.*/j.*|.*/package.*"" AND command REGEXP "".*-q.*|.*/q.*"" AND command REGEXP "".*\\\\\.*|.*http.*"" |
| Windows: Suspicious Outbound Kerberos Connection | Security | Detects suspicious outbound network activity via kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_susp_outbound_kerberos_connection.yml | Windows: Suspicious Outbound Kerberos Connection | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (destIpPort=88 AND initiated=""true"") AND ((procName NOT IN (""C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"",""C:\\Program Files\\Mozilla Firefox\\firefox.exe"",""C:\\Windows\\System32\\lsass.exe""))) |
| Windows: Suspicious Parent of Csc.exe | Security | Detects a suspicious parent of csc.exe, which could by a sign of payload delivery. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_csc_susp_parent.yml | Windows: Suspicious Parent of Csc.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\csc\.exe"" AND parentProcName REGEXP "".*\\cscript\.exe|.*\\mshta\.exe|.*\\wscript\.exe"" |
| Windows: Suspicious Ping/Del Command Combination | Security | Detects a method often used by ransomware. Which combines the ""ping"" to wait a couple of seconds and then ""del"" to delete the file in question. Its used to hide the file responsible for the initial infection for example. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_ping_del_combined_execution.yml | Windows: Suspicious Ping/Del Command Combination | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* -n .*|.* /n .*"" AND command REGEXP "".*Nul.*"" AND command REGEXP "".* -f .*|.* -q .*|.* /f .*|.* /q .*"" AND command REGEXP "".*ping.*"" AND command REGEXP "".*del .*"" |
| Windows: Suspicious PROCEXP152.sys File Created In TMP | Security | Detects the creation of the PROCEXP152.sys file in the application-data local temporary folder. This driver is used by Sysinternals Process Explorer but also by KDU (https://github.com/hfiref0x/KDU) or Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs), which uses KDU. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_procexplorer_driver_created_in_tmp_folder.yml | Windows: Suspicious PROCEXP152.sys File Created In TMP | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP "".*\\AppData\\Local\\Temp\\.*"" AND fileName REGEXP "".*PROCEXP152\.sys"") AND (procName NOT REGEXP "".*\\procexp64\.exe.*|.*\\procexp\.exe.*|.*\\procmon64\.exe.*|.*\\procmon\.exe.*"") |
| Windows: Suspicious Program Location Whitelisted In Firewall Via Netsh.EXE | Security | Detects Netsh command execution that whitelists a program located in a suspicious location in the Windows Firewall. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_fw_allow_program_in_susp_location.yml | Windows: Suspicious Program Location Whitelisted In Firewall Via Netsh.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\netsh\.exe"" OR srcFileName=""netsh.exe"") AND (command REGEXP "".*firewall.*"" AND command REGEXP "".*add.*"" AND (command REGEXP "".*allowedprogram.*"" OR (command REGEXP "".*advfirewall.*"" AND command REGEXP "".*rule.*"" AND command REGEXP "".*action=allow.*"" AND command REGEXP "".*program=.*""))) AND command REGEXP "".*%Public%\\.*|.*%TEMP%.*|.*%TMP%.*|.*:\\RECYCLER\\.*|.*:\\SystemVolumeInformation\\.*|.*:\\Temp\\.*|.*:\\Users\\Default\\.*|.*:\\Users\\Desktop\\.*|.*:\\Users\\Public\\.*|.*:\\Windows\\Tasks\\.*|.*:\\Windows\\Temp\\.*|.*:\\Windows\\addins\\.*|.*:\\Windows\\cursors\\.*|.*:\\Windows\\debug\\.*|.*:\\Windows\\drivers\\.*|.*:\\Windows\\fonts\\.*|.*:\\Windows\\help\\.*|.*:\\Windows\\system32\\tasks\\.*|.*:\\\$Recycle\.bin\\.*|.*\\Downloads\\.*|.*\\Local Settings\\Temporary Internet Files\\.*|.*\\Temporary Internet Files\\Content\.Outlook\\.*"" |
| Windows: Suspicious Recursif Takeown | Security | Adversaries can interact with the DACLs using built-in Windows commands takeown which can grant adversaries higher permissions on specific files and folders. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_takeown_recursive_own.yml | Windows: Suspicious Recursif Takeown | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\takeown\.exe"" AND command REGEXP "".*/f .*"" AND command REGEXP "".*/r.*"" |
| Windows: Suspicious Registry Modification From ADS Via Regini.EXE | Security | Detects the import of an alternate data stream with regini.exe, regini.exe can be used to modify registry keys. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regini_ads.yml | Windows: Suspicious Registry Modification From ADS Via Regini.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\regini\.exe"" OR srcFileName=""REGINI.EXE"") |
| Windows: Suspicious Regsvr32 Execution From Remote Share | Security | Detects REGSVR32.exe to execute DLL hosted on remote shares. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regsvr32_remote_share.yml | Windows: Suspicious Regsvr32 Execution From Remote Share | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\regsvr32\.exe"" OR srcFileName=""\\REGSVR32.EXE"") AND command REGEXP "".* \\\\\.*"" |
| Windows: Suspicious Regsvr32 Execution With Image Extension | Security | Detects the execution of REGSVR32.exe with DLL files masquerading as image files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regsvr32_image.yml | Windows: Suspicious Regsvr32 Execution With Image Extension | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\regsvr32\.exe"" OR srcFileName=""\\REGSVR32.EXE"") AND command REGEXP "".*\.bmp|.*\.cr2|.*\.eps|.*\.gif|.*\.ico|.*\.jpeg|.*\.jpg|.*\.nef|.*\.orf|.*\.png|.*\.raw|.*\.sr2|.*\.tif|.*\.tiff"" |
| Windows: Suspicious Regsvr32 HTTP IP Pattern | Security | Detects a certain command line flag combination used by regsvr32 when used to download and register a DLL from a remote address which uses HTTP (not HTTPS) and a IP address and not FQDN. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regsvr32_http_pattern.yml | Windows: Suspicious Regsvr32 HTTP IP Pattern | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* /s.*"" AND command REGEXP "".* /u.*"" AND command REGEXP "".* /i:http://1.*|.* /i:http://2.*|.* /i:http://3.*|.* /i:http://4.*|.* /i:http://5.*|.* /i:http://6.*|.* /i:http://7.*|.* /i:http://8.*|.* /i:http://9.*|.* /i:https://1.*|.* /i:https://2.*|.* /i:https://3.*|.* /i:https://4.*|.* /i:https://5.*|.* /i:https://6.*|.* /i:https://7.*|.* /i:https://8.*|.* /i:https://9.*"" |
| Windows: Suspicious Remote Child Process From Outlook | Security | Detects a suspicious child process spawning from Outlook where the image is located in a remote location (SMB/WebDav shares). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_outlook_susp_child_processes_remote.yml | Windows: Suspicious Remote Child Process From Outlook | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\outlook\.exe"" AND procName REGEXP ""\\\\\.*"" |
| Windows: Suspicious Rundll32 Activity | Security | Detects suspicious process related to rundll32 based on arguments. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_susp_activity.yml | Windows: Suspicious Rundll32 Activity | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*javascript:.*"" AND command REGEXP "".*\.RegisterXLL.*"") OR (command REGEXP "".*url\.dll.*"" AND command REGEXP "".*OpenURL.*"") OR (command REGEXP "".*url\.dll.*"" AND command REGEXP "".*OpenURLA.*"") OR (command REGEXP "".*url\.dll.*"" AND command REGEXP "".*FileProtocolHandler.*"") OR (command REGEXP "".*zipfldr\.dll.*"" AND command REGEXP "".*RouteTheCall.*"") OR (command REGEXP "".*shell32\.dll.*"" AND command REGEXP "".*Control_RunDLL.*"") OR (command REGEXP "".*shell32\.dll.*"" AND command REGEXP "".*ShellExec_RunDLL.*"") OR (command REGEXP "".*mshtml\.dll.*"" AND command REGEXP "".*PrintHTML.*"") OR (command REGEXP "".*advpack\.dll.*"" AND command REGEXP "".*LaunchINFSection.*"") OR (command REGEXP "".*advpack\.dll.*"" AND command REGEXP "".*RegisterOCX.*"") OR (command REGEXP "".*ieadvpack\.dll.*"" AND command REGEXP "".*LaunchINFSection.*"") OR (command REGEXP "".*ieadvpack\.dll.*"" AND command REGEXP "".*RegisterOCX.*"") OR (command REGEXP "".*ieframe\.dll.*"" AND command REGEXP "".*OpenURL.*"") OR (command REGEXP "".*shdocvw\.dll.*"" AND command REGEXP "".*OpenURL.*"") OR (command REGEXP "".*syssetup\.dll.*"" AND command REGEXP "".*SetupInfObjectInstallAction.*"") OR (command REGEXP "".*setupapi\.dll.*"" AND command REGEXP "".*InstallHinfSection.*"") OR (command REGEXP "".*pcwutl\.dll.*"" AND command REGEXP "".*LaunchApplication.*"") OR (command REGEXP "".*dfshim\.dll.*"" AND command REGEXP "".*ShOpenVerbApplication.*"") OR (command REGEXP "".*dfshim\.dll.*"" AND command REGEXP "".*ShOpenVerbShortcut.*"") OR (command REGEXP "".*scrobj\.dll.*"" AND command REGEXP "".*GenerateTypeLib.*"" AND command REGEXP "".*http.*"") OR (command REGEXP "".*shimgvw\.dll.*"" AND command REGEXP "".*ImageView_Fullscreen.*"" AND command REGEXP "".*http.*"")) AND ((command NOT REGEXP "".*shell32\.dll,Control_RunDLL desk\.cpl,screensaver,@screensaver.*"") AND (parentProcName!=""C:\\Windows\\System32\\control.exe"" OR parentCommand NOT REGEXP "".*\.cpl.*"") AND (parentProcName!=""C:\\Windows\\System32\\control.exe"" OR command NOT REGEXP ""\""C:\\Windows\\system32\\rundll32\.exe\"" Shell32\.dll,Control_RunDLL \""C:\\Windows\\System32\\.*"" OR command NOT REGEXP "".*\.cpl\"","")) |
| Windows: Suspicious Rundll32 Activity Invoking Sys File | Security | Detects suspicious process related to rundll32 based on command line that includes a *.sys file as seen being used by UNC2452. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_sys.yml | Windows: Suspicious Rundll32 Activity Invoking Sys File | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*rundll32\.exe.*"" AND command REGEXP "".*\.sys .*|.*\.sys,.*"" |
| Windows: Suspicious Rundll32 Execution With Image Extension | Security | Detects the execution of Rundll32.exe with DLL files masquerading as image files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_susp_execution_with_image_extension.yml | Windows: Suspicious Rundll32 Execution With Image Extension | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.exe"") AND command REGEXP "".*\.bmp.*|.*\.cr2.*|.*\.eps.*|.*\.gif.*|.*\.ico.*|.*\.jpeg.*|.*\.jpg.*|.*\.nef.*|.*\.orf.*|.*\.png.*|.*\.raw.*|.*\.sr2.*|.*\.tif.*|.*\.tiff.*"" |
| Windows: Suspicious Rundll32 Setupapi.dll Activity | Security | setupapi.dll library provide InstallHinfSection function for processing INF files. INF file may contain instructions allowing to create values in the registry, modify files and install drivers. This technique could be used to obtain persistence via modifying one of Run or RunOnce registry keys, run process or use other DLLs chain calls (see references) InstallHinfSection function in setupapi.dll calls runonce.exe executable regardless of actual content of INF file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_setupapi_installhinfsection.yml | Windows: Suspicious Rundll32 Setupapi.dll Activity | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\runonce\.exe"" AND parentProcName REGEXP "".*\\rundll32\.exe"" AND parentCommand REGEXP "".*setupapi\.dll.*"" AND parentCommand REGEXP "".*InstallHinfSection.*"" |
| Windows: Suspicious Rundll32 Without Any CommandLine Params | Security | Detects suspicious start of rundll32.exe without any parameters as found in CobaltStrike beacon activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_no_params.yml | Windows: Suspicious Rundll32 Without Any CommandLine Params | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\rundll32\.exe"" AND ((parentProcName NOT REGEXP "".*\\svchost\.exe"") AND (parentProcName NOT REGEXP "".*\\AppData\\Local\\.*|.*\\Microsoft\\Edge\\.*"")) |
| Windows: Suspicious Runscripthelper.exe | Security | Detects execution of powershell scripts via Runscripthelper.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_runscripthelper.yml | Windows: Suspicious Runscripthelper.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\Runscripthelper\.exe"" AND command REGEXP "".*surfacecheck.*"" |
| Windows: Suspicious Subsystem for Linux Bash Execution | Security | Performs execution of specified file, can be used for defensive evasion. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_bash.yml | Windows: Suspicious Subsystem for Linux Bash Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*bash\.exe.*"" AND command REGEXP "".*-c .*"") AND ((parentCommand NOT REGEXP "".*C:\\Program Files \(x86\)\\Git\\post-install\.bat.*|.*C:\\Program Files\\Git\\post-install\.bat.*|.*echo /etc/post-install/.*\.post.*"" AND command NOT REGEXP "".*echo /etc/post-install/.*\.post.*"")) |
| Windows: Suspicious Svchost Process | Security | Detects a suspicious svchost process start. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_svchost_susp_parent_process.yml | Windows: Suspicious Svchost Process | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\svchost\.exe"" AND ((parentProcName NOT REGEXP "".*\\Mrt\.exe|.*\\MsMpEng\.exe|.*\\TiWorker\.exe|.*\\ngen\.exe|.*\\rpcnet\.exe|.*\\services\.exe"") AND (parentProcName IS NOT NULL) AND (parentProcName IS NOT NULL) AND (parentProcName IS NOT NULL)) |
| Windows: Suspicious Task Added by Bitsadmin | Security | Detects the creation of a new bits job by Bitsadmin. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/bits_client/win_bits_client_new_job_via_bitsadmin.yml | Windows: Suspicious Task Added by Bitsadmin | eventType REGEXP ""Win-.*-3[^\d]*"" AND procName REGEXP "".*\\bitsadmin\.exe"" |
| Windows: Suspicious Task Added by Powershell | Security | Detects the creation of a new bits job by PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/bits_client/win_bits_client_new_job_via_powershell.yml | Windows: Suspicious Task Added by Powershell | eventType REGEXP ""Win-.*-3[^\d]*"" AND procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" |
| Windows: Suspicious VBoxDrvInst.exe Parameters | Security | Detect VBoxDrvInst.exe run with parameters allowing processing INF file. This allows to create values in the registry and install drivers. For example one could use this technique to obtain persistence via modifying one of Run or RunOnce registry keys . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_virtualbox_vboxdrvinst_execution.yml | Windows: Suspicious VBoxDrvInst.exe Parameters | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\VBoxDrvInst\.exe"" AND command REGEXP "".*driver.*"" AND command REGEXP "".*executeinf.*"" |
| Windows: Suspicious Windows Defender Folder Exclusion Added Via Reg.EXE | Security | Detects the usage of ""reg.exe"" to add Defender folder exclusions. Qbot has been seen using this technique to add exlcusions for folders within AppData and ProgramData. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_defender_exclusion.yml | Windows: Suspicious Windows Defender Folder Exclusion Added Via Reg.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\reg\.exe"" AND command REGEXP "".*SOFTWARE\\Microsoft\\Microsoft Antimalware\\Exclusions\\Paths.*|.*SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths.*"" AND command REGEXP "".*ADD .*"" AND command REGEXP "".*/t .*"" AND command REGEXP "".*REG_DWORD .*"" AND command REGEXP "".*/v .*"" AND command REGEXP "".*/d .*"" AND command REGEXP "".*0.*"" |
| Windows: Suspicious Windows Defender Registry Key Tampering Via Reg.EXE | Security | Detects the usage of ""reg.exe"" to tamper with different Windows defender registry keys in order to disable some important features related to protection and detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_defender_tampering.yml | Windows: Suspicious Windows Defender Registry Key Tampering Via Reg.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\reg\.exe"" OR srcFileName=""reg.exe"") AND command REGEXP "".*SOFTWARE\\Microsoft\\Windows Defender\\.*|.*SOFTWARE\\Policies\\Microsoft\\Windows Defender\\.*"" AND command REGEXP "".* add .*"" AND ((command REGEXP "".* /d 0.*"" AND command REGEXP "".*Real-Time Protection.*|.*TamperProtection.*"") OR (command REGEXP "".* /d 1.*"" AND command REGEXP "".*Notification_Suppress.*"")) |
| Windows: Suspicious Windows Trace ETW Session Tamper Via Logman.EXE | Security | Detects the execution of ""logman"" utility in order to disable or delete Windows trace sessions. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_logman_disable_eventlog.yml | Windows: Suspicious Windows Trace ETW Session Tamper Via Logman.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\logman\.exe"" OR srcFileName=""Logman.exe"") AND command REGEXP "".*delete .*|.*stop .*"" AND command REGEXP "".*Circular Kernel Context Logger.*|.*EventLog-.*|.*SYSMON TRACE.*|.*SysmonDnsEtwSession.*"" |
| Windows: Suspicious WMIC Execution Via Office Process | Security | Office application called wmic to proxye execution through a LOLBIN process. This is often used to break suspicious parent-child chain (Office app spawns LOLBin). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_susp_execution_via_office_process.yml | Windows: Suspicious WMIC Execution Via Office Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\EQNEDT32\.EXE|.*\\EXCEL\.EXE|.*\\MSACCESS\.EXE|.*\\MSPUB\.exe|.*\\ONENOTE\.EXE|.*\\POWERPNT\.exe|.*\\VISIO\.exe|.*\\WINWORD\.EXE|.*\\wordpad\.exe|.*\\wordview\.exe"" AND (procName REGEXP "".*\\wbem\\WMIC\.exe"" OR srcFileName=""wmic.exe"") AND (command REGEXP "".*process.*"" AND command REGEXP "".*create.*"" AND command REGEXP "".*call.*"" AND command REGEXP "".*cscript.*|.*mshta.*|.*msiexec.*|.*regsvr32.*|.*rundll32.*|.*verclsid.*|.*wscript.*"") |
| Windows: Suspicious WmiPrvSE Child Process | Security | Detects suspicious and uncommon child processes of WmiPrvSE. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmiprvse_susp_child_processes.yml | Windows: Suspicious WmiPrvSE Child Process | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\wbem\\WmiPrvSE\.exe"" AND (procName REGEXP "".*\\certutil\.exe|.*\\cscript\.exe|.*\\mshta\.exe|.*\\msiexec\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\verclsid\.exe|.*\\wscript\.exe"" OR (procName REGEXP "".*\\cmd\.exe"" AND command REGEXP "".*cscript.*|.*mshta.*|.*powershell.*|.*pwsh.*|.*regsvr32.*|.*rundll32.*|.*wscript.*""))) AND ((procName NOT REGEXP "".*\\WerFault\.exe"") AND (procName NOT REGEXP "".*\\WmiPrvSE\.exe"")) |
| Windows: Suspicious XOR Encoded PowerShell Command | Security | Detects presence of a potentially xor encoded powershell command. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_xor_commandline.yml | Windows: Suspicious XOR Encoded PowerShell Command | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"") OR description=""Windows PowerShell"" OR product=""PowerShell Core 6"") AND command REGEXP "".*bxor.*"" AND command REGEXP "".*-join .*|.*-join'.*|.*-join\"".*|.*-join`.*|.*::Join.*|.*ForEach.*|.*\[char\].*|.*for .*|.*for\(.*"" |
| Windows: Suspicious ZipExec Execution | Security | ZipExec is a Proof-of-Concept (POC) tool to wrap binary-based tools into a password-protected zip file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_zipexec.yml | Windows: Suspicious ZipExec Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\.zip.*"" AND ((command REGEXP "".*/generic:Microsoft_Windows_Shell_ZipFolder:filename=.*"" AND command REGEXP "".*/pass:.*"" AND command REGEXP "".*/user:.*"") OR (command REGEXP "".*/delete.*"" AND command REGEXP "".*Microsoft_Windows_Shell_ZipFolder:filename=.*"")) |
| Windows: Svchost DLL Search Order Hijack | Security | Detects DLL sideloading of DLLs that are loaded by the SCM for some services (IKE, IKEEXT, SessionEnv) which do not exists on a typical modern system IKEEXT and SessionEnv service, as they call LoadLibrary on files that do not exist within C:\Windows\System32\ by default. An attacker can place their malicious logic within the PROCESS_ATTACH block of their library and restart the aforementioned services ""svchost.exe -k netsvcs"" to gain code execution on a remote machine. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_svchost_dlls.yml | Windows: Svchost DLL Search Order Hijack | eventType=""Win-Sysmon-7-Image-Loaded"" AND (procName REGEXP "".*\\svchost\.exe"" AND loadedProcName REGEXP "".*\\tsmsisrv\.dll|.*\\tsvipsrv\.dll|.*\\wlbsctrl\.dll"") AND (loadedProcName NOT REGEXP ""C:\\Windows\\WinSxS\\.*"") |
| Windows: Sysinternals PsSuspend Suspicious Execution | Security | Detects suspicious execution of Sysinternals PsSuspend, where the utility is used to suspend critical processes such as AV or EDR to bypass defenses. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_pssuspend_susp_execution.yml | Windows: Sysinternals PsSuspend Suspicious Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""pssuspend.exe"" OR procName REGEXP "".*\\pssuspend64\.exe|.*\\pssuspend\.exe"") AND command REGEXP "".*msmpeng\.exe.*"" |
| Windows: Sysmon Channel Reference Deletion | Security | Potential threat actor tampering with Sysmon manifest and eventually disabling it. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_sysmon_channel_reference_deletion.yml | Windows: Sysmon Channel Reference Deletion | osObjName REGEXP "".*WINEVT\\Channels\\Microsoft-Windows-Sysmon/Operational.*|.*WINEVT\\Publishers\\\{5770385f-c22a-43e0-bf4c-06f5698ffbd9\}.*"" AND ((eventType=""Win-Security-4657"" AND osObjValue=""Enabled"" AND newObjValue IS NULL) OR (eventType=""Win-Security-4663"" AND fileAccess=""65536"")) |
| Windows: Sysmon Configuration Update | Security | Detects updates to Sysmon's configuration. Attackers might update or replace the Sysmon configuration with a bare bone one to avoid monitoring without shutting down the service completely. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_sysmon_config_update.yml | Windows: Sysmon Configuration Update | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\Sysmon64\.exe|.*\\Sysmon\.exe"" OR description=""System activity monitor"") AND command REGEXP "".*-c.*|.*/c.*"" |
| Windows: Sysmon Driver Unloaded Via Fltmc.EXE | Security | Detects possible Sysmon filter driver unloaded via fltmc.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_fltmc_unload_driver_sysmon.yml | Windows: Sysmon Driver Unloaded Via Fltmc.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\fltMC\.exe"" OR srcFileName=""fltMC.exe"") AND (command REGEXP "".*unload.*"" AND command REGEXP "".*sysmon.*"") |
| Windows: SysmonEnte Usage | Security | Detects the use of SysmonEnte, a tool to attack the integrity of Sysmon. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_hack_sysmonente.yml | Windows: SysmonEnte Usage | eventType=""Win-Sysmon-10-ProcessAccess"" AND (((targetProcName=""C:\\Windows\\Sysmon64.exe"" AND accessKeyId=""0x1400"") AND ((procName NOT REGEXP ""C:\\Program Files.*|C:\\Windows\\System32\\.*"") AND (procName NOT REGEXP ""C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\.*"" OR procName NOT REGEXP "".*\\MsMpEng\.exe""))) OR procPath=""Ente"") |
| Windows: System Eventlog Cleared | Security | Detects the clearing of one of the Windows Core Eventlogs. e.g. caused by ""wevtutil cl"" command execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/microsoft_windows_eventlog/win_system_susp_eventlog_cleared.yml | Windows: System Eventlog Cleared | eventType=""Win-System-Microsoft-Windows-Eventlog-104"" AND activityType IN (""Application"",""Security"",""System"") |
| Windows: Tamper Windows Defender Remove-MpPreference | Security | Detects attempts to remove windows defender configuration using the 'MpPreference' cmdlet. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_tamper_defender_remove_mppreference.yml | Windows: Tamper Windows Defender Remove-MpPreference | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Remove-MpPreference.*"" AND command REGEXP "".*-AttackSurfaceReductionRules_Actions .*|.*-AttackSurfaceReductionRules_Ids .*|.*-CheckForSignaturesBeforeRunningScan .*|.*-ControlledFolderAccessProtectedFolders .*"" |
| Windows: Taskkill Symantec Endpoint Protection | Security | Detects one of the possible scenarios for disabling Symantec Endpoint Protection. Symantec Endpoint Protection antivirus software services incorrectly implement the protected service mechanism. As a result, the NT AUTHORITY/SYSTEM user can execute the taskkill /im command several times ccSvcHst.exe /f, thereby killing the process belonging to the service, and thus shutting down the service. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_taskkill_sep.yml | Windows: Taskkill Symantec Endpoint Protection | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*taskkill.*"" AND command REGEXP "".* /F .*"" AND command REGEXP "".* /IM .*"" AND command REGEXP "".*ccSvcHst\.exe.*"" |
| Windows: Tasks Folder Evasion | Security | The Tasks folder in system32 and syswow64 are globally writable paths. Adversaries can take advantage of this and load or influence any script hosts or ANY .NET Application in Tasks to load and execute a custom assembly into cscript, wscript, regsvr32, mshta, eventvwr . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_task_folder_evasion.yml | Windows: Tasks Folder Evasion | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*copy .*|.*echo .*|.*file createnew.*|.*type .*"" AND command REGEXP "".* C:\\Windows\\SysWow64\\Tasks\\.*|.* C:\\Windows\\System32\\Tasks\\.*"" |
| Windows: Third Party Software DLL Sideloading | Security | Detects DLL sideloading of DLLs that are part of third party software (zoom, discord....etc). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_third_party.yml | Windows: Third Party Software DLL Sideloading | eventType=""Win-Sysmon-7-Image-Loaded"" AND ((loadedProcName REGEXP "".*\\commfunc\.dll"" AND (loadedProcName NOT REGEXP "".*\\AppData\\local\\Google\\Chrome\\Application\\.*"" AND loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Lenovo\\Communications Utility\\.*|C:\\Program Files\\Lenovo\\Communications Utility\\.*"")) OR (loadedProcName REGEXP "".*\\tosbtkbd\.dll"" AND (loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Toshiba\\Bluetooth Toshiba Stack\\.*|C:\\Program Files\\Toshiba\\Bluetooth Toshiba Stack\\.*""))) |
| Windows: TrustedPath UAC Bypass Pattern | Security | Detects indicators of a UAC bypass method by mocking directories. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_trustedpath.yml | Windows: TrustedPath UAC Bypass Pattern | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*C:\\Windows \\System32\\.*"" |
| Windows: UAC Bypass Abusing Winsat Path Parsing - File | Security | Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe (UACMe 52). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_uac_bypass_winsat.yml | Windows: UAC Bypass Abusing Winsat Path Parsing - File | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP ""C:\\Users\\.*"" AND fileName REGEXP "".*\\AppData\\Local\\Temp\\system32\\winmm\.dll|.*\\AppData\\Local\\Temp\\system32\\winsat\.exe"" |
| Windows: UAC Bypass Tool UACMe Akagi | Security | Detects the execution of UACMe, a tool used for UAC bypasses, via default PE metadata. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_uacme.yml | Windows: UAC Bypass Tool UACMe Akagi | eventType=""Win-Sysmon-1-Create-Process"" AND (product=""UACMe"" OR company IN (""APT 92"",""CD Project Rekt"",""Hazardous Environments"",""REvol Corp"",""UG North"") OR description IN (""Pentesting utility"",""UACMe main module"") OR srcFileName IN (""Akagi.exe"",""Akagi64.exe"") OR procName REGEXP "".*\\Akagi64\.exe|.*\\Akagi\.exe"" OR hashCode REGEXP "".*IMPHASH=14C4E4C72BA075E9069EE67F39188AD8.*|.*IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC.*|.*IMPHASH=3DE09703C8E79ED2CA3F01074719906B.*|.*IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74.*|.*IMPHASH=5834ED4291BDEB928270428EBBAF7604.*|.*IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38.*|.*IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F.*|.*IMPHASH=767637C23BB42CD5D7397CF58B0BE688.*|.*IMPHASH=7D010C6BB6A3726F327F7E239166D127.*|.*IMPHASH=89159BA4DD04E4CE5559F132A9964EB3.*|.*IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894.*"" OR hashIMP IN (""14c4e4c72ba075e9069ee67f39188ad8"",""3c782813d4afce07bbfc5a9772acdbdc"",""3de09703c8e79ed2ca3f01074719906b"",""41923ea1f824fe63ea5beb84db7a3e74"",""5834ed4291bdeb928270428ebbaf7604"",""5a8a8a43f25485e7ee1b201edcbc7a38"",""6f33f4a5fc42b8cec7314947bd13f30f"",""767637c23bb42cd5d7397cf58b0be688"",""7d010c6bb6a3726f327f7e239166d127"",""89159ba4dd04e4ce5559f132a9964eb3"",""dc7d30b90b2d8abf664fbed2b1b59894"")) |
| Windows: UAC Bypass Using .NET Code Profiler on MMC | Security | Detects the pattern of UAC Bypass using .NET Code Profiler and mmc.exe DLL hijacking (UACMe 39). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_uac_bypass_dotnet_profiler.yml | Windows: UAC Bypass Using .NET Code Profiler on MMC | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP ""C:\\Users\\.*"" AND fileName REGEXP "".*\\AppData\\Local\\Temp\\pe386\.dll"" |
| Windows: UAC Bypass Using ChangePK and SLUI | Security | Detects an UAC bypass that uses changepk.exe and slui.exe (UACMe 61). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_changepk_slui.yml | Windows: UAC Bypass Using ChangePK and SLUI | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\changepk\.exe"" AND parentProcName REGEXP "".*\\slui\.exe"" AND integrityLevel IN (""High"",""System"") |
| Windows: UAC Bypass Using ComputerDefaults | Security | Detects the pattern of UAC Bypass using computerdefaults.exe (UACMe 59). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_computerdefaults.yml | Windows: UAC Bypass Using ComputerDefaults | eventType=""Win-Sysmon-1-Create-Process"" AND (integrityLevel IN (""High"",""System"") AND procName=""C:\\Windows\\System32\\ComputerDefaults.exe"") AND (parentProcName NOT REGEXP "".*:\\Program Files.*|.*:\\Windows\\System32.*"") |
| Windows: UAC Bypass Using Consent and Comctl32 - File | Security | Detects the pattern of UAC Bypass using consent.exe and comctl32.dll (UACMe 22). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_uac_bypass_consent_comctl32.yml | Windows: UAC Bypass Using Consent and Comctl32 - File | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP ""C:\\Windows\\System32\\consent\.exe\.@.*"" AND fileName REGEXP "".*\\comctl32\.dll"" |
| Windows: UAC Bypass Using Consent and Comctl32 - Process | Security | Detects the pattern of UAC Bypass using consent.exe and comctl32.dll (UACMe 22). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_consent_comctl32.yml | Windows: UAC Bypass Using Consent and Comctl32 - Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\consent\.exe"" AND procName REGEXP "".*\\werfault\.exe"" AND integrityLevel IN (""High"",""System"") |
| Windows: UAC Bypass Using Disk Cleanup | Security | Detects the pattern of UAC Bypass using scheduled tasks and variable expansion of cleanmgr.exe (UACMe 34). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_cleanmgr.yml | Windows: UAC Bypass Using Disk Cleanup | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\""\\system32\\cleanmgr\.exe /autoclean /d C:"" AND parentCommand=""C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule"" AND integrityLevel IN (""High"",""System"") |
| Windows: UAC Bypass Using DismHost | Security | Detects the pattern of UAC Bypass using DismHost DLL hijacking (UACMe 63). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_dismhost.yml | Windows: UAC Bypass Using DismHost | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*C:\\Users\\.*"" AND parentProcName REGEXP "".*\\AppData\\Local\\Temp\\.*"" AND parentProcName REGEXP "".*\\DismHost\.exe.*"" AND integrityLevel IN (""High"",""System"") |
| Windows: UAC Bypass Using IDiagnostic Profile | Security | Detects the ""IDiagnosticProfileUAC"" UAC bypass technique. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_idiagnostic_profile.yml | Windows: UAC Bypass Using IDiagnostic Profile | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\DllHost\.exe"" AND parentCommand REGEXP "".* /Processid:\{12C21EA7-2EB8-4B55-9249-AC243DA8C666\}.*"" AND integrityLevel IN (""High"",""System"") |
| Windows: UAC Bypass Using IDiagnostic Profile - File | Security | Detects the creation of a file by ""dllhost.exe"" in System32 directory part of ""IDiagnosticProfileUAC"" UAC bypass technique. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_uac_bypass_idiagnostic_profile.yml | Windows: UAC Bypass Using IDiagnostic Profile - File | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\DllHost\.exe"" AND fileName REGEXP ""C:\\Windows\\System32\\.*"" AND fileName REGEXP "".*\.dll"" |
| Windows: UAC Bypass Using IEInstal - File | Security | Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_uac_bypass_ieinstal.yml | Windows: UAC Bypass Using IEInstal - File | eventType=""Win-Sysmon-11-FileCreate"" AND procName=""C:\\Program Files\\Internet Explorer\\IEInstal.exe"" AND fileName REGEXP ""C:\\Users\\.*"" AND fileName REGEXP "".*\\AppData\\Local\\Temp\\.*"" AND fileName REGEXP "".*consent\.exe"" |
| Windows: UAC Bypass Using IEInstal - Process | Security | Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_ieinstal.yml | Windows: UAC Bypass Using IEInstal - Process | eventType=""Win-Sysmon-1-Create-Process"" AND integrityLevel IN (""High"",""System"") AND parentProcName REGEXP "".*\\ieinstal\.exe"" AND procName REGEXP "".*\\AppData\\Local\\Temp\\.*"" AND procName REGEXP "".*consent\.exe"" |
| Windows: UAC Bypass Using Iscsicpl - ImageLoad | Security | Detects the ""iscsicpl.exe"" UAC bypass technique that leverages a DLL Search Order hijacking technique to load a custom DLL's from temp or a any user controlled location in the users %PATH%. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_uac_bypass_iscsicpl.yml | Windows: UAC Bypass Using Iscsicpl - ImageLoad | eventType=""Win-Sysmon-7-Image-Loaded"" AND (procName=""C:\\Windows\\SysWOW64\\iscsicpl.exe"" AND loadedProcName REGEXP "".*\\iscsiexe\.dll"") AND (loadedProcName NOT REGEXP "".*C:\\Windows\\.*"" OR loadedProcName NOT REGEXP "".*iscsiexe\.dll.*"") |
| Windows: UAC Bypass Using MSConfig Token Modification - File | Security | Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe 55). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_uac_bypass_msconfig_gui.yml | Windows: UAC Bypass Using MSConfig Token Modification - File | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP ""C:\\Users\\.*"" AND fileName REGEXP "".*\\AppData\\Local\\Temp\\pkgmgr\.exe"" |
| Windows: UAC Bypass Using MSConfig Token Modification - Process | Security | Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe 55). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_msconfig_gui.yml | Windows: UAC Bypass Using MSConfig Token Modification - Process | eventType=""Win-Sysmon-1-Create-Process"" AND integrityLevel IN (""High"",""System"") AND parentProcName REGEXP "".*\\AppData\\Local\\Temp\\pkgmgr\.exe"" AND command=""\""C:\\Windows\\system32\\msconfig.exe\"" -5"" |
| Windows: UAC Bypass Using NTFS Reparse Point - File | Security | Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe DLL hijacking (UACMe 36). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_uac_bypass_ntfs_reparse_point.yml | Windows: UAC Bypass Using NTFS Reparse Point - File | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP ""C:\\Users\\.*"" AND fileName REGEXP "".*\\AppData\\Local\\Temp\\api-ms-win-core-kernel32-legacy-l1\.DLL"" |
| Windows: UAC Bypass Using NTFS Reparse Point - Process | Security | Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe DLL hijacking (UACMe 36). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_ntfs_reparse_point.yml | Windows: UAC Bypass Using NTFS Reparse Point - Process | eventType=""Win-Sysmon-1-Create-Process"" AND integrityLevel IN (""High"",""System"") AND ((command REGEXP ""\""C:\\Windows\\system32\\wusa\.exe\"" /quiet C:\\Users\\.*"" AND command REGEXP "".*\\AppData\\Local\\Temp\\update\.msu"") OR (parentCommand=""\""C:\\Windows\\system32\\dism.exe\"" /online /quiet /norestart /add-package /packagepath:\""C:\\Windows\\system32\\pe386\"" /ignorecheck"" AND command REGEXP "".*C:\\Users\\.*"" AND command REGEXP "".*\\AppData\\Local\\Temp\\.*"" AND command REGEXP "".*\\dismhost\.exe \{.*"" AND procName REGEXP "".*\\DismHost\.exe"")) |
| Windows: UAC Bypass Using PkgMgr and DISM | Security | Detects the pattern of UAC Bypass using pkgmgr.exe and dism.exe (UACMe 23). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_pkgmgr_dism.yml | Windows: UAC Bypass Using PkgMgr and DISM | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\pkgmgr\.exe"" AND procName REGEXP "".*\\dism\.exe"" AND integrityLevel IN (""High"",""System"") |
| Windows: UAC Bypass Using Windows Media Player - File | Security | Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll (UACMe 32). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_uac_bypass_wmp.yml | Windows: UAC Bypass Using Windows Media Player - File | eventType=""Win-Sysmon-11-FileCreate"" AND ((fileName REGEXP ""C:\\Users\\.*"" AND fileName REGEXP "".*\\AppData\\Local\\Temp\\OskSupport\.dll"") OR (procName=""C:\\Windows\\system32\\DllHost.exe"" AND fileName=""C:\\Program Files\\Windows Media Player\\osk.exe"")) |
| Windows: UAC Bypass Using WOW64 Logger DLL Hijack | Security | Detects the pattern of UAC Bypass using a WoW64 logger DLL hijack (UACMe 30). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_uac_bypass_wow64_logger.yml | Windows: UAC Bypass Using WOW64 Logger DLL Hijack | eventType=""Win-Sysmon-10-ProcessAccess"" AND procName REGEXP "".*:\\Windows\\SysWOW64\\.*"" AND accessKeyId=""0x1fffff"" AND procPath REGEXP ""UNKNOWN\(0000000000000000\)\|UNKNOWN\(0000000000000000\)\|.*"" |
| Windows: UAC Bypass via Event Viewer | Security | Detects UAC bypass method using Windows event viewer. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_eventvwr.yml | Windows: UAC Bypass via Event Viewer | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\eventvwr\.exe"" AND (procName NOT REGEXP "".*:\\Windows\\SysWOW64\\WerFault\.exe|.*:\\Windows\\System32\\WerFault\.exe|.*\\mmc\.exe"") |
| Windows: UAC Bypass via ICMLuaUtil | Security | Detects the pattern of UAC Bypass using ICMLuaUtil Elevated COM interface. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_icmluautil.yml | Windows: UAC Bypass via ICMLuaUtil | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\dllhost\.exe"" AND parentCommand REGEXP "".*/Processid:\{3E5FC7F9-9A51-4367-9063-A120244FBEC7\}.*|.*/Processid:\{D2E7041B-2927-42FB-8E9F-7CE93B6DC937\}.*"") AND (procName NOT REGEXP "".*\\WerFault\.exe"" AND srcFileName!=""WerFault.exe"") |
| Windows: UAC Bypass Via Wsreset | Security | Unfixed method for UAC bypass from windows 10. WSReset.exe file associated with the Windows Store. It will run a binary file contained in a low-privilege registry. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_bypass_via_wsreset.yml | Windows: UAC Bypass Via Wsreset | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*\\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\\Shell\\open\\command"" |
| Windows: UAC Bypass With Fake DLL | Security | Attempts to load dismcore.dll after dropping it. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_uac_bypass_via_dism.yml | Windows: UAC Bypass With Fake DLL | eventType=""Win-Sysmon-7-Image-Loaded"" AND (procName REGEXP "".*\\dism\.exe"" AND loadedProcName REGEXP "".*\\dismcore\.dll"") AND (loadedProcName!=""C:\\Windows\\System32\\Dism\\dismcore.dll"") |
| Windows: UAC Bypass WSReset | Security | Detects the pattern of UAC Bypass via WSReset usable by default sysmon-config. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_wsreset_integrity_level.yml | Windows: UAC Bypass WSReset | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\wsreset\.exe"" AND integrityLevel IN (""High"",""System"") |
| Windows: UEFI Persistence Via Wpbbin - FileCreation | Security | Detects creation of a file named ""wpbbin"" in the ""%systemroot%\system32\"" directory. Which could be indicative of UEFI based persistence method. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_wpbbin_persistence.yml | Windows: UEFI Persistence Via Wpbbin - FileCreation | eventType=""Win-Sysmon-11-FileCreate"" AND fileName=""C:\\Windows\\System32\\wpbbin.exe"" |
| Windows: UEFI Persistence Via Wpbbin - ProcessCreation | Security | Detects execution of the binary ""wpbbin"" which is used as part of the UEFI based persistence method described in the reference section. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wpbbin_potential_persistence.yml | Windows: UEFI Persistence Via Wpbbin - ProcessCreation | eventType=""Win-Sysmon-1-Create-Process"" AND procName=""C:\\Windows\\System32\\wpbbin.exe"" |
| Windows: Unauthorized System Time Modification | Security | Detect scenarios where a potentially unauthorized application or user is modifying the system time. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_time_modification.yml | Windows: Unauthorized System Time Modification | eventType=""Win-Security-4616"" AND ((procName NOT IN (""C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe"",""C:\\Windows\\System32\\VBoxService.exe"",""C:\\Windows\\System32\\oobe\\msoobe.exe"")) AND (procName!=""C:\\Windows\\System32\\svchost.exe"" OR securityId!=""S-1-5-19"")) |
| Windows: Uninstall Crowdstrike Falcon | Security | Adversaries may disable security tools to avoid possible detection of their tools and activities by uninstalling Crowdstrike Falcon. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uninstall_crowdstrike_falcon.yml | Windows: Uninstall Crowdstrike Falcon | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\WindowsSensor\.exe.*"" AND command REGEXP "".* /uninstall.*"" AND command REGEXP "".* /quiet.*"" |
| Windows: Uninstall Sysinternals Sysmon | Security | Detects the removal of Sysmon, which could be a potential attempt at defense evasion. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_sysmon_uninstall.yml | Windows: Uninstall Sysinternals Sysmon | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\Sysmon64\.exe|.*\\Sysmon\.exe"" OR description=""System activity monitor"") AND command REGEXP "".*-u.*|.*/u.*"" |
| Windows: Unmount Share Via Net.EXE | Security | Detects when when a mounted share is removed. Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_share_unmount.yml | Windows: Unmount Share Via Net.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR srcFileName IN (""net.exe"",""net1.exe"")) AND (command REGEXP "".*share.*"" AND command REGEXP "".*/delete.*"") |
| Windows: Unsigned Binary Loaded From Suspicious Location | Security | Detects Code Integrity (CI) engine blocking processes from loading unsigned DLLs residing in suspicious locations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security_mitigations/win_security_mitigations_unsigned_dll_from_susp_location.yml | Windows: Unsigned Binary Loaded From Suspicious Location | eventType IN (""Win-Security-Mitigation-11"", ""Win-Security-Mitigation-12"") AND procName REGEXP "".*C:\\Windows\\TEMP\\.*|.*\\AppData\\Local\\Temp\\.*|.*\\Desktop\\.*|.*\\Downloads\\.*|.*\\PerfLogs\\.*|.*\\Users\\Public\\.*"" |
| Windows: Use Icacls to Hide File to Everyone | Security | Detect use of icacls to deny access for everyone in Users folder sometimes used to hide malicious files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_icacls_deny.yml | Windows: Use Icacls to Hide File to Everyone | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""iCACLS.EXE"" OR procName REGEXP "".*\\icacls\.exe"") AND (command REGEXP "".*C:\\Users\\.*"" AND command REGEXP "".*/deny.*"" AND command REGEXP "".*S-1-1-0:.*"") |
| Windows: Use NTFS Short Name in Command Line | Security | Detect use of the Windows 8.3 short name. Which could be used as a method to avoid command-line detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_use_cli.yml | Windows: Use NTFS Short Name in Command Line | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*~1\.bat.*|.*~1\.dll.*|.*~1\.exe.*|.*~1\.hta.*|.*~1\.js.*|.*~1\.msi.*|.*~1\.ps1.*|.*~1\.vbe.*|.*~1\.vbs.*|.*~2\.bat.*|.*~2\.dll.*|.*~2\.exe.*|.*~2\.hta.*|.*~2\.js.*|.*~2\.msi.*|.*~2\.ps1.*|.*~2\.vbe.*|.*~2\.vbs.*"" AND (parentProcName NOT REGEXP "".*\\WebEx\\WebexHost\.exe|.*\\thor\\thor64\.exe"" AND command NOT REGEXP "".*C:\\xampp\\vcredist\\VCREDI~1\.EXE.*"") |
| Windows: Use NTFS Short Name in Image | Security | Detect use of the Windows 8.3 short name. Which could be used as a method to avoid Image based detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_use_image.yml | Windows: Use NTFS Short Name in Image | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*~1\.bat.*|.*~1\.dll.*|.*~1\.exe.*|.*~1\.hta.*|.*~1\.js.*|.*~1\.msi.*|.*~1\.ps1.*|.*~1\.vbe.*|.*~1\.vbs.*|.*~2\.bat.*|.*~2\.dll.*|.*~2\.exe.*|.*~2\.hta.*|.*~2\.js.*|.*~2\.msi.*|.*~2\.ps1.*|.*~2\.vbe.*|.*~2\.vbs.*"" AND (parentProcName NOT REGEXP "".*-installer\.exe|.*\\WebEx\\WebexHost\.exe|.*\\thor\\thor64\.exe"" AND procName NOT REGEXP "".*\\vcredi.*"" AND parentProcName!=""C:\\Windows\\explorer.exe"") |
| Windows: Use of Setres.exe | Security | Detects the use of Setres.exe to set the screen resolution and then potentially launch a file named ""choice"" (with any executable extension such as "".cmd"" or "".exe"") from the current execution path. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_setres.yml | Windows: Use of Setres.exe | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\setres\.exe"" AND procName REGEXP "".*\\choice"" |
| Windows: Use Short Name Path in Command Line | Security | Detect use of the Windows 8.3 short name. Which could be used as a method to avoid command-line detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_path_use_cli.yml | Windows: Use Short Name Path in Command Line | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*~1\\.*|.*~2\\.*"" AND (parentProcName NOT IN (""C:\\Program Files\\GPSoftware\\Directory Opus\\dopus.exe"",""C:\\Windows\\System32\\Dism.exe"",""C:\\Windows\\System32\\cleanmgr.exe"") AND parentProcName NOT REGEXP "".*\\Everything\\Everything\.exe|.*\\WebEx\\WebexHost\.exe|.*\\thor\\thor64\.exe|.*\\veam\.backup\.shell\.exe|.*\\winget\.exe"" AND parentProcName NOT REGEXP "".*\\AppData\\Local\\Temp\\WinGet\\.*"" AND command NOT REGEXP "".*C:\\Program Files\\Git\\cmd\\scalar\.exe.*|.*C:\\Program Files\\Git\\post-install\.bat.*|.*\\appdata\\local\\webex\\webex64\\meetings\\wbxreport\.exe.*"") |
| Windows: Use Short Name Path in Image | Security | Detect use of the Windows 8.3 short name. Which could be used as a method to avoid Image detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_path_use_image.yml | Windows: Use Short Name Path in Image | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*~1\\.*|.*~2\\.*"" AND ((parentProcName NOT IN (""C:\\Windows\\System32\\Dism.exe"",""C:\\Windows\\System32\\cleanmgr.exe"") AND parentProcName NOT REGEXP "".*\\WebEx\\WebexHost\.exe|.*\\thor\\thor64\.exe"" AND product!=""InstallShield (R)"" AND description!=""InstallShield (R) Setup Engine"" AND company!=""InstallShield Software Corporation"") AND (procName NOT REGEXP "".*\\AppData\\.*"" OR procName NOT REGEXP "".*\\Temp\\.*"" AND procName NOT REGEXP "".*~1\\7zG\.exe|.*~1\\unzip\.exe"")) |
| Windows: Using SettingSyncHost.exe as LOLBin | Security | Detects using SettingSyncHost.exe to run hijacked binary. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_settingsynchost.yml | Windows: Using SettingSyncHost.exe as LOLBin | eventType=""Win-Sysmon-1-Create-Process"" AND (procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*"") AND (parentCommand REGEXP "".*cmd\.exe /c.*"" AND parentCommand REGEXP "".*RoamDiag\.cmd.*"" AND parentCommand REGEXP "".*-outputpath.*"") |
| Windows: Visual Basic Command Line Compiler Usage | Security | Detects successful code compilation via Visual Basic Command Line Compiler that utilizes Windows Resource to Object Converter. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_visual_basic_compiler.yml | Windows: Visual Basic Command Line Compiler Usage | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\vbc\.exe"" AND procName REGEXP "".*\\cvtres\.exe"" |
| Windows: VMGuestLib DLL Sideload | Security | Detects DLL sideloading of VMGuestLib.dll by the WmiApSrv service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_vmguestlib.yml | Windows: VMGuestLib DLL Sideload | eventType=""Win-Sysmon-7-Image-Loaded"" AND (loadedProcName REGEXP "".*\\VMware\\VMware Tools\\vmStatsProvider\\win32.*"" AND loadedProcName REGEXP "".*\\vmGuestLib\.dll.*"" AND procName REGEXP "".*\\Windows\\System32\\wbem\\WmiApSrv\.exe"") AND (authResult!=""true"") |
| Windows: VsCode Child Process Anomaly | Security | Detects uncommon or suspicious child processes spawning from a VsCode ""code.exe"" process. This could indicate an attempt of persistence via VsCode tasks or terminal profiles. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_vscode_child_processes_anomalies.yml | Windows: VsCode Child Process Anomaly | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\code\.exe"" AND (procName REGEXP "".*\\calc\.exe|.*\\cscript\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wscript\.exe"" OR (procName REGEXP "".*\\cmd\.exe|.*\\powershell\.exe|.*\\pwsh\.exe"" AND command REGEXP "".*DownloadString.*|.*ICM.*|.*IEX.*|.*Invoke-Command.*|.*Invoke-Expressions.*|.*cscript.*|.*regsvr32.*|.*rundll32.*|.*wscript.*"") OR procName REGEXP "".*C:\\Temp\\.*|.*C:\\Users\\Public\\.*|.*C:\\Windows\\Temp\\.*"") |
| Windows: Wdigest CredGuard Registry Modification | Security | Detects potential malicious modification of the property value of IsCredGuardEnabled from HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest to disable Cred Guard on a system. This is usually used with UseLogonCredential to manipulate the caching credentials. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_disable_wdigest_credential_guard.yml | Windows: Wdigest CredGuard Registry Modification | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*\\IsCredGuardEnabled"" |
| Windows: WinDivert Driver Load | Security | Detects the load of the Windiver driver, a powerful user-mode capture/sniffing/modification/blocking/re-injection package for Windows. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_windivert.yml | Windows: WinDivert Driver Load | eventType=""Win-Sysmon-6-Driver-Loaded"" AND (loadedProcName REGEXP "".*\\NordDivert\.sys.*|.*\\WinDivert64\.sys.*|.*\\WinDivert\.sys.*|.*\\eswfp\.sys.*|.*\\lingtiwfp\.sys.*"" OR hashCode REGEXP "".*IMPHASH=0604bb7cb4bb851e2168d5c7d9399087.*|.*IMPHASH=0ea54f8c9af4a2fe8367fa457f48ed38.*|.*IMPHASH=2a5f85fe4609461c6339637594fa9b0a.*|.*IMPHASH=2e5f0e649d97f32b03c09e4686d0574f.*|.*IMPHASH=45ee545ae77e8d43fc70ede9efcd4c96.*|.*IMPHASH=52f8aa269f69f0edad9e8fcdaedce276.*|.*IMPHASH=58623490691babe8330adc81cd04a663.*|.*IMPHASH=6b2c6f95233c2914d1d488ee27531acc.*|.*IMPHASH=8ee39b48656e4d6b8459d7ba7da7438b.*|.*IMPHASH=9d519ae0a0864d6d6ae3f8b6c9c70af6.*|.*IMPHASH=9f2fdd3f9ab922bbb0560a7df46f4342.*|.*IMPHASH=a1b2e245acd47e4a348e1a552a02859a.*|.*IMPHASH=a66b476c2d06c370f0a53b5537f2f11e.*|.*IMPHASH=a74929edfc3289895e3f2885278947ae.*|.*IMPHASH=bdcd836a46bc2415773f6b5ea77a46e4.*|.*IMPHASH=c0e5d314da39dbf65a2dbff409cc2c76.*|.*IMPHASH=c28cd6ccd83179e79dac132a553693d9.*|.*IMPHASH=d8a719865c448b1bd2ec241e46ac1c88.*"" OR hashIMP IN (""0604bb7cb4bb851e2168d5c7d9399087"",""0ea54f8c9af4a2fe8367fa457f48ed38"",""2a5f85fe4609461c6339637594fa9b0a"",""2e5f0e649d97f32b03c09e4686d0574f"",""45ee545ae77e8d43fc70ede9efcd4c96"",""52f8aa269f69f0edad9e8fcdaedce276"",""58623490691babe8330adc81cd04a663"",""6b2c6f95233c2914d1d488ee27531acc"",""8ee39b48656e4d6b8459d7ba7da7438b"",""9d519ae0a0864d6d6ae3f8b6c9c70af6"",""9f2fdd3f9ab922bbb0560a7df46f4342"",""a1b2e245acd47e4a348e1a552a02859a"",""a66b476c2d06c370f0a53b5537f2f11e"",""a74929edfc3289895e3f2885278947ae"",""bdcd836a46bc2415773f6b5ea77a46e4"",""c0e5d314da39dbf65a2dbff409cc2c76"",""c28cd6ccd83179e79dac132a553693d9"",""d8a719865c448b1bd2ec241e46ac1c88"")) |
| Windows: Windows Binary Executed From WSL | Security | Detects the execution of Windows binaries from within a WSL instance. This could be used to masquerade parent-child relationships. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wsl_windows_binaries_execution.yml | Windows: Windows Binary Executed From WSL | eventType=""Win-Sysmon-1-Create-Process"" AND dirName REGEXP "".*\\\\wsl\.localhost.*"" |
| Windows: Windows Defender Definition Files Removed | Security | Adversaries may disable security tools to avoid possible detection of their tools and activities by removing Windows Defender Definition Files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mpcmdrun_remove_windows_defender_definition.yml | Windows: Windows Defender Definition Files Removed | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\MpCmdRun\.exe"" OR srcFileName=""MpCmdRun.exe"") AND (command REGEXP "".* -RemoveDefinitions.*"" AND command REGEXP "".* -All.*"") |
| Windows: Windows Defender Download Activity | Security | Detect the use of Windows Defender to download payloads. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_susp_mpcmdrun_download.yml | Windows: Windows Defender Download Activity | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*MpCmdRun\.exe.*"" OR description=""Microsoft Malware Protection Command Line Utility"") AND (command REGEXP "".*DownloadFile.*"" AND command REGEXP "".*url.*"") |
| Windows: Windows Defender Exclusion Set | Security | Detects scenarios where an windows defender exclusion was added in registry where an entity would want to bypass antivirus scanning from windows defender. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_defender_bypass.yml | Windows: Windows Defender Exclusion Set | eventType IN (""Win-Security-4656"",""Win-Security-4657"",""Win-Security-4660"",""Win-Security-4663"") AND osObjName REGEXP "".*\\Microsoft\\Windows Defender\\Exclusions\\.*"" |
| Windows: Windows Defender Threat Detection Disabled - Service | Security | Detects the ""Windows Defender Threat Protection"" service has been disabled. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_defender_disabled.yml | Windows: Windows Defender Threat Detection Disabled - Service | eventType=""Win-System-Service-Control-Manager-7036"" AND paraName IN (""Service antivirus Microsoft Defender"",""Windows Defender Antivirus Service"") AND otherParaName=""stopped"" |
| Windows: Windows Processes Suspicious Parent Directory | Security | Detect suspicious parent processes of well-known Windows processes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_proc_wrong_parent.yml | Windows: Windows Processes Suspicious Parent Directory | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\csrss\.exe|.*\\lsaiso\.exe|.*\\lsass\.exe|.*\\lsm\.exe|.*\\services\.exe|.*\\svchost\.exe|.*\\taskhost\.exe|.*\\wininit\.exe|.*\\winlogon\.exe"" AND ((parentProcName NOT REGEXP "".*\\SavService\.exe|.*\\ngen\.exe"" AND parentProcName NOT REGEXP "".*\\SysWOW64\\.*|.*\\System32\\.*"") AND (parentProcName NOT REGEXP "".*\\Microsoft Security Client\\.*|.*\\Windows Defender\\.*"" OR parentProcName NOT REGEXP "".*\\MsMpEng\.exe"") AND (parentProcName IS NOT NULL AND parentProcName IS NOT NULL)) |
| Windows: WMIC Loading Scripting Libraries | Security | Detects threat actors proxy executing code and bypassing application controls by leveraging wmic and the `/FORMAT` argument switch to download and execute an XSL file (i.e js, vbs, etc). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_wmic_remote_xsl_scripting_dlls.yml | Windows: WMIC Loading Scripting Libraries | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\wmic\.exe"" AND loadedProcName REGEXP "".*\\jscript\.dll|.*\\vbscript\.dll"" |
| Windows: Writing Of Malicious Files To The Fonts Folder | Security | Monitors for the hiding possible malicious files in the C:\Windows\Fonts\ location. This folder doesn't require admin privillege to be written and executed from. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_hiding_malware_in_fonts_folder.yml | Windows: Writing Of Malicious Files To The Fonts Folder | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*cacls.*|.*copy.*|.*echo.*|.*file createnew.*|.*type.*"" AND command REGEXP "".*C:\\Windows\\Fonts\\.*"" AND command REGEXP "".*\.bat.*|.*\.bin.*|.*\.cmd.*|.*\.cpl.*|.*\.dll.*|.*\.exe.*|.*\.hta.*|.*\.inf.*|.*\.jar.*|.*\.js.*|.*\.msh.*|.*\.msi.*|.*\.pl.*|.*\.ps.*|.*\.reg.*|.*\.scr.*|.*\.sh.*|.*\.vb.*|.*\.vbs.*"" |
| Windows: WSL Child Process Anomaly | Security | Detects uncommon or suspicious child processes spawning from a WSL process. This could indicate an attempt to evade parent/child relationship detections or persistence attempts via cron using WSL. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wsl_child_processes_anomalies.yml | Windows: WSL Child Process Anomaly | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\wsl\.exe|.*\\wslhost\.exe"" AND (procName REGEXP "".*\\calc\.exe|.*\\cmd\.exe|.*\\powershell\.exe|.*\\pwsh\.exe"" OR procName REGEXP "".*C:\\Temp\\.*|.*C:\\Users\\Public\\.*|.*C:\\Windows\\Temp\\.*|.*\\AppData\\Local\\Temp\\.*|.*\\Desktop\\.*|.*\\Downloads\\.*"") |
| Windows: XSL Script Processing | Security | Extensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files. Rule detects when adversaries abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_xsl_script_processing.yml | Windows: XSL Script Processing | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\wmic\.exe"" AND command REGEXP "".*-format.*|.*/format.*"") AND (command NOT REGEXP "".*Format:List.*|.*Format:csv.*|.*Format:hform.*|.*Format:htable.*|.*Format:mof.*|.*Format:rawxml.*|.*Format:table.*|.*Format:value.*|.*Format:xml.*"")) OR procName REGEXP "".*\\msxsl\.exe"") |
| Windows: Xwizard DLL Sideloading | Security | Detects the execution of Xwizard tool from the non-default directory which can be used to sideload a custom xwizards.dll. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_dll_sideload_xwizard.yml | Windows: Xwizard DLL Sideloading | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\xwizard\.exe"" AND (procName NOT REGEXP ""C:\\Windows\\System32\\.*"") |
| Windows: ZOHO Dctask64 Process Injection | Security | Detects suspicious process injection using ZOHO's dctask64.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_dctask64_proc_inject.yml | Windows: ZOHO Dctask64 Process Injection | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\dctask64\.exe"" AND (command NOT REGEXP "".*DesktopCentral_Agent\\agent.*"") |
| AWS Instance or Snapshot Discovery | Security | Detects AWS Instance or Snapshot discovery | AWS Instance or Snapshot Discovery | eventType IN (""AWS-CloudTrail-EC2-DescribeInstances"",""AWS-CloudTrail-EC2-DescribeReservedInstancesListings"",""AWS-CloudTrail-EC2-DescribeSnapshots"") |
| AWS SecHub: Tactics: Discovery Detected | Security | AWS Security Hub detected Discovery tactics. Adversary is trying to figure out your environment. | AWS SecHub: Tactics: Discovery Detected | eventType = ""AWS-Hub-TTPs-Discovery"" |
| Azure Infrastructure Discovery | Security | Detects Azure infrastructure discovery | Azure Infrastructure Discovery | eventType IN (""Microsoft-Azure-ClassicNetwork-reservedIps-read"",""Microsoft-Azure-Network-publicIPAddresses-read"",""Microsoft-Azure-Network-virtualNetworks-read"",""Microsoft-Azure-Resources-subscriptions-resourceGroups-read"") |
| Azure Service Discovery | Security | Detects Azure Service discovery | Azure Service Discovery | eventType IN (""Microsoft-Azure-Sql-servers-databases-read"",""Microsoft-Azure-Sql-servers-read"",""Microsoft-Azure-Web-serverfarms-read"") |
| Enumeration of System Information | Security | Detects system information enumeration and discovery via built-in tools. | Enumeration of System Information | eventType = ""LINUX_PROCESS_EXEC"" AND (procName = ""uname"" OR (procName IN (""cat"",""less"",""more"") AND swParam REGEXP ("".* /etc/issue.*|.* /etc/profile.*|.* /etc/services.*|.* /proc/cpuinfo.*|.* /proc/version.*""))) |
| Heavy Half Open TCP Host Scan | Security | Detects excessive half-open TCP sessions from the same source to many distinct destinations in a short period of time. The threshold is 200 flows within 3 minutes. Scanning may be a precursor to exploits. However, network management and mapping tools often scan the network for discovery purposes and authorized scanners need to be blocklisted. P2P clients also exhibit this behavior when they attempt to establish connections to (non-existent) peers. | Heavy Half Open TCP Host Scan | srcDestTCPFlags = 2 AND ipProto = 6 AND eventType IN (Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Heavy Half Open TCP Host Scan On Fixed Port | Security | Detects excessive half-open TCP sessions from the same source to many distinct destinations and on the same destination port in a short period of time. The threshold is 200 flows within 3 minutes. A fixed destination port may indicate that the scanning host is attempting to find hosts on a well known port (with a vulnerability). Scanning may be a precursor to exploits. However, network management and mapping tools often scan the network for discovery purposes and authorized scanners need to be blocklisted. P2P clients also exhibit this behavior when they attempt to establish connections to (non-existent) peers. | Heavy Half Open TCP Host Scan On Fixed Port | srcDestTCPFlags = 2 AND ipProto = 6 AND eventType IN (Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Heavy Half Open TCP Port Scan: Multiple Destinations | Security | Detects that a source is doing port scans on multiple hosts. The thresholds are port scans on at least 5 hosts in 15 minute window | Heavy Half Open TCP Port Scan: Multiple Destinations | eventType IN (""PH_RULE_HEAVY_HO_TCP_PORT_SCAN"") |
| Heavy Half Open TCP Port Scan: Single Destination | Security | Detects a host performing a port scan - this involves excessive half open TCP connections from the same source to many distinct ports on a host in a short period of time. The thresholds are at least 20 distinct ports in a 2 minute window | Heavy Half Open TCP Port Scan: Single Destination | srcDestTCPFlags = 2 AND ipProto = 6 AND srcIpPort >= 1024 AND eventType IN (Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Heavy ICMP Ping sweep | Security | Detects excessive number of ICMP echo request packets from the same source to many distinct destinations in a short period of time. Nachi worm exploited pings to spread. The threshold is 50 pings within 3 minutes. Scanning may be a precursor to exploits. However, network management and mapping tools often scan the network for discovery purposes and authorized scanners need to be blocklisted. | Heavy ICMP Ping sweep | ipProto = 1 AND icmpType = 8 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Heavy TCP Host Scan | Security | Detects excessive permitted TCP connections from the same source to many distinct destinations in a short period of time. The threshold is 200 flows within 3 minutes. Scanning may be a precursor to exploits. However, network management and mapping tools often scan the network for discovery purposes and authorized scanners need to be blocklisted. P2P clients also exhibit this behavior when they attempt to establish connections to (non-existent) peers. | Heavy TCP Host Scan | ipProto = 6 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Heavy TCP Host Scan On Fixed Port | Security | Detects excessive permitted TCP sessions from the same source to many distinct destinations and on the same destination port in a short period of time. The threshold is 200 flows within 3 minutes. A fixed destination port may indicate that the scanning host is attempting to find hosts on a well known port (with a vulnerability). Scanning may be a precursor to exploits. However, network management and mapping tools often scan the network for discovery purposes and authorized scanners need to be blocklisted. P2P clients also exhibit this behavior when they attempt to establish connections to (non-existent) peers. | Heavy TCP Host Scan On Fixed Port | ipProto = 6 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic) AND eventType NOT IN (Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Heavy TCP Port Scan: Multiple Destinations | Security | Detects that a source is doing port scans on multiple hosts. The thresholds are port scans on at least 5 hosts in 15 minute window | Heavy TCP Port Scan: Multiple Destinations | eventType IN (""PH_RULE_HEAVY_TCP_PORT_SCAN"") |
| Heavy TCP Port Scan: Single Destination | Security | Detects a host performing a port scan - this involves excessive permitted TCP connections from the same source to many distinct ports on a host in a short period of time. The thresholds are at least 20 distinct ports in a 2 minute window | Heavy TCP Port Scan: Single Destination | ipProto = 6 AND srcIpPort >= 1024 AND eventType NOT IN (""Win-Security-5156"", ""ASA-302014"", ""PIX-302014"",""FWSM-302014"") AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Heavy UDP Host Scan | Security | Detects excessive number of UDP connections from the same source to many distinct destinations in a short period of time. The threshold is 200 flows within 3 minutes. Scanning may be a precursor to exploits. However, network management and mapping tools often scan the network for discovery purposes and authorized scanners need to be blocklisted. P2P clients also exhibit this behavior when they attempt to establish connections to (non-existent) peers. | Heavy UDP Host Scan | ipProto = 17 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Heavy UDP Host Scan On Fixed Port | Security | Detects excessive number of UDP connections from the same source to many distinct destinations and on the same destination port in a short period of time. The threshold is 200 flows within 3 minutes. | Heavy UDP Host Scan On Fixed Port | ipProto = 17 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND ((srcIpAddr NOT IN (Group@PH_SYS_APP_DNS_SERVER)) OR (destIpPort != 53)) |
| Heavy UDP Port Scan: Multiple Hosts | Security | Detects that a source is doing UDP port scans on multiple hosts. The thresholds are port scans on at least 5 hosts in 15 minute window | Heavy UDP Port Scan: Multiple Hosts | eventType IN (""PH_RULE_HEAVY_UDP_PORT_SCAN"") |
| Heavy UDP Port Scan: Single Host | Security | Detects excessive UDP connections from the same source to many distinct ports on the same destination in a short period of time | Heavy UDP Port Scan: Single Host | ipProto = 17 AND srcIpPort >= 1024 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Info Leak Exploits | Security | Detects information leak attacks - alerts on all attacks from internal networks and permitted attacks from external networks | Info Leak Exploits | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_InfoLeakExploit) AND ((srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventAction = 0) OR srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)) |
| Invalid TCP Flags: High Intensity | Security | Detects 500 or more flows in 5 minutes, with invalid TCP flag combinations (FIN, SYN-FIN, SYN-FIN-PUSH, SYN-FIN-RESET, SYN-FIN-RESET-PUSH,SYN-FIN-RESET-PUSH-ACK-URG) - may indcate scanning and probing activity from the sender | Invalid TCP Flags: High Intensity | ipProto = 6 AND srcDestTCPFlags IN (1,3,7,11,15,31,63) AND eventType IN (Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Invalid TCP Flags: Medium Intensity | Security | Detects 100 or more flows in 5 minutes, with invalid TCP flag combinations (NULL,FIN, SYN-FIN, SYN-FIN-PUSH, SYN-FIN-RESET, SYN-FIN-RESET-PUSH,SYN-FIN-RESET-PUSH-ACK-URG) - may indcate scanning and probing activity from the sender | Invalid TCP Flags: Medium Intensity | ipProto = 6 AND srcDestTCPFlags IN (1,3,7,11,15,31,63) AND eventType IN (Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Linux Account Discovery via Built-In Tools | Security | Detects use of built-in applications to get a listing of local system or domain accounts | Linux Account Discovery via Built-In Tools | eventType = ""LINUX_PROCESS_EXEC"" AND ((procName = ""net.exe"" AND swParam REGEXP "".* user.*|.*group .*|.*localgroup .*"") OR procName IN (""groups"",""id"") OR (procName = ""dscl"" AND swParam CONTAIN ""list /groups"") OR (procName = ""dscacheutil"" AND swParam CONTAIN ""group"") OR swParam REGEXP "".*/etc/master\.passwd.*|.*/etc/passwd.*"") |
| Linux: Discovery of Domain Groups | Security | Detects attempts to use known commands for discovery of local groups | Linux: Discovery of Domain Groups | eventType = ""LINUX_PROCESS_EXEC"" AND (procName IN (""dscacheutil"",""ldapsearch"") OR procName = ""dscl"" AND swParam CONTAIN ""-list"") |
| Linux: Discovery of Network Environment via Built-in Tools | Security | Detects the use of Build-in tools to enumerate and discover network environment on unix systems. | Linux: Discovery of Network Environment via Built-in Tools | eventType = ""LINUX_PROCESS_EXEC"" AND (procName IN (""arp"",""ifconfig"",""netstat"",""networkctl"",""ntop"",""route"") OR (procName IN (""cat"",""gedit"",""less"",""more"",""nano"",""vi"",""vim"") AND swParam CONTAIN "" /etc/hosts"")) |
| Linux: Hping Process Activity | Security | Hping ran on a Linux host. Hping is a open source command-line packet analyzer and has the ability to construct network packets for a wide variety of network security testing applications, including scanning and firewall auditing. Normal use of hping is uncommon apart from security testing and research. Use by non-security engineers is very uncommon. This requires process monitoring via FortiSIEM Linux agent. | Linux: Hping Process Activity | eventType = ""LINUX_PROCESS_EXEC"" AND procName IN (""hping"", ""hping2"", ""hping3"") |
| Linux: Kernel Module Enumeration | Security | Detects attempts to enumerate information about a kernel module. Loadable Kernel Modules (or LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. This requires process monitoring via FortiSIEM Linux agent. | Linux: Kernel Module Enumeration | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""sudo"" AND ((swParam CONTAIN ""kmod"" AND swParam CONTAIN ""list"") OR (swParam REGEXP ("".*depmod.*|.*lsmod.*|.*modinfo.*""))) |
| Linux: Process Discovery via Built-In Applications | Security | Detects the use of built-in tools to discover running processes on an endpoint | Linux: Process Discovery via Built-In Applications | eventType = ""LINUX_PROCESS_EXEC"" AND (procName IN (""htop"",""pgrep"",""ps"",""pstree"") OR swParam REGEXP "".* /proc/\d+"") |
| Linux: System Network Connections Discovery | Security | Detects attempts to get a listing of network connections to or from a compromised system. | Linux: System Network Connections Discovery | eventType = ""LINUX_PROCESS_EXEC"" AND procName IN (""lsof"",""netstat"",""w"",""who"") |
| Linux: User Discovery via Whoami | Security | Detects that the whoami application was executed on a Linux host. This is often used by tools and persistence mechanisms to test for privileged access. This requires process monitoring via FortiSIEM Linux agent. | Linux: User Discovery via Whoami | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""whoami"" |
| Linux: Virtual Machine Fingerprinting By non-root User | Security | Detects attempts to get detailed information about the operating system and hardware by a non-root user. This requires process monitoring via FortiSIEM Linux agent. | Linux: Virtual Machine Fingerprinting By non-root User | eventType = ""LINUX_PROCESS_EXEC"" AND swParam REGEXP ("".*/sys/class/dmi/id/bios_version.*|.*/sys/class/dmi/id/product_name.*|.*/sys/class/dmi/id/chassis_vendor.*|.*/proc/scsi/scsi.*|.*/proc/ide/hd0/model.*"") AND user != ""root"" |
| MS 365 Defender: Suspicious Process Discovery - Discovery Alert | Security | Suspicious Process Discovery - Discovery Alert from MS 365 Defender | MS 365 Defender: Suspicious Process Discovery - Discovery Alert | (eventType = ""MS-Defender-Endpoint-Alert-Discovery"" OR eventType CONTAIN ""M365Defender-Alert"") AND attackTechniqueId = ""T1057"" |
| MS 365 Defender: System Network Configuration Discovery - Discovery Alert | Security | System Network Configuration Discovery - Discovery Alert from MS 365 Defender | MS 365 Defender: System Network Configuration Discovery - Discovery Alert | (eventType = ""MS-Defender-Endpoint-Alert-Discovery"" OR eventType CONTAIN ""M365Defender-Alert"") AND attackTechniqueId = ""T1016"" |
| MS 365 Defender: System Service Discovery - Discovery Alert | Security | System Service Discovery - Discovery Alert from MS 365 Defender | MS 365 Defender: System Service Discovery - Discovery Alert | (eventType = ""MS-Defender-Endpoint-Alert-Discovery"" OR eventType CONTAIN ""M365Defender-Alert"") AND attackTechniqueId = ""T1007"" |
| Multiple IPS Detected Scans From Same Src | Security | Detects multiple IPS detected scans from the same source IP in a short period of time. | Multiple IPS Detected Scans From Same Src | eventType IN (Group@PH_SYS_EVENT_Reconn) |
| Password Policy Enumeration | Security | Detects enumeration of local or global password policies using built-in commands. | Password Policy Enumeration | eventType = ""LINUX_PROCESS_EXEC"" AND (procName = ""chage"" AND swParam CONTAIN "" -l "" OR procName = ""cat"" AND swParam REGEXP "".*/etc/pam\.d/common-password.*"") |
| SQL Server Excessive Full Scan | Performance | Detects excessive SQL Server full scan (greater than 1000 per second) | SQL Server Excessive Full Scan | eventType = ""PH_DEV_MON_PERF_MSSQL_SYS"" |
| Stealth Scan using a tool | Security | Detects scans using a tool like NMap, Satan, Saint, Nikto etc | Stealth Scan using a tool | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_ToolReconn) |
| Windows: AD Privileged Users or Groups Reconnaissance | Security | Detect priv users or groups recon based on 4661 eventid and known privileged users or groups SIDs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_account_discovery.yml | Windows: AD Privileged Users or Groups Reconnaissance | ((eventType=""Win-Security-4661"" AND osObjType IN (""SAM_GROUP"",""SAM_USER"")) AND (osObjName REGEXP "".*-500|.*-502|.*-505|.*-512|.*-519|.*-520|.*-544|.*-551|.*-555"" OR osObjName REGEXP "".*admin.*"")) AND (user NOT REGEXP "".*\$"") |
| Windows: AD User Enumeration | Security | Detects access to a domain user from a non-machine account. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_ad_user_enumeration.yml | Windows: AD User Enumeration | (eventType=""Win-Security-4662"" AND osObjType REGEXP "".*bf967aba-0de6-11d0-a285-00aa003049e2.*"") AND (user NOT REGEXP "".*\$"" AND user NOT REGEXP ""MSOL_.*"") |
| Windows: HackTool - Bloodhound/Sharphound Execution | Security | Detects command line parameters used by Bloodhound and Sharphound hack tools. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_bloodhound_sharphound.yml | Windows: HackTool - Bloodhound/Sharphound Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((product REGEXP "".*SharpHound.*"" OR description REGEXP "".*SharpHound.*"" OR company REGEXP "".*SpecterOps.*|.*evil corp.*"" OR procName REGEXP "".*\\Bloodhound\.exe.*|.*\\SharpHound\.exe.*"") OR command REGEXP "".* --CollectionMethods Session .*|.* --Loop --Loopduration .*|.* --PortScanTimeout .*|.* -CollectionMethod All .*|.*Get-BloodHoundData.*|.*Invoke-Bloodhound.*|.*\.exe -c All -d .*"" OR (command REGEXP "".* -JsonFolder .*"" AND command REGEXP "".* -ZipFileName .*"") OR (command REGEXP "".* DCOnly .*"" AND command REGEXP "".* --NoSaveCache .*"")) |
| Windows: DirLister Execution | Security | Detect the usage of ""DirLister.exe"" a utility for quickly listing folder or drive contents. It was seen used by BlackCat ransomware to create a list of accessible directories and files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dirlister_execution.yml | Windows: DirLister Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""DirLister.exe"" OR procName REGEXP "".*\\dirlister\.exe"") |
| Targeted System/Application Scan | Security | Detects targeted application or detailed system level scans - alerts on all attacks from internal networks and permitted attacks from external networks. | Targeted System/Application Scan | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_AppReconn,Group@PH_SYS_EVENT_HostReconn) AND ((srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventAction = 1) OR srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)) |
| Windows: BloodHound Collection Files | Security | Detects default file names outputted by the BloodHound collection tool SharpHound. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_bloodhound_collection.yml | Windows: BloodHound Collection Files | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*BloodHound\.zip|.*_computers\.json|.*_containers\.json|.*_domains\.json|.*_gpos\.json|.*_groups\.json|.*_ous\.json|.*_users\.json"" AND ((procName NOT REGEXP "".*\\svchost\.exe"" OR fileName NOT REGEXP ""C:\\Program Files\\WindowsApps\\Microsoft\..*"" OR fileName NOT REGEXP "".*\\pocket_containers\.json"")) |
| Windows: Discovery of a System Time | Security | Identifies use of various commands to query a systems time. This technique may be used before executing a scheduled task or to discover the time zone of a target system. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remote_time_discovery.yml | Windows: Discovery of a System Time | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" AND command REGEXP "".*time.*"") OR (procName REGEXP "".*\\w32tm\.exe"" AND command REGEXP "".*tz.*"")) |
| Windows: Computer Discovery And Export Via Get-ADComputer Cmdlet | Security | Detects usage of the Get-ADComputer cmdlet to collect computer information and output it to a file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_computer_discovery_get_adcomputer.yml | Windows: Computer Discovery And Export Via Get-ADComputer Cmdlet | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND (command REGEXP "".*Get-ADComputer .*"" AND command REGEXP "".* -Filter \.*"" AND command REGEXP "".* > .*|.* \| Select .*|.*Add-Content.*|.*Out-File.*|.*Set-Content.*"") |
| Windows: Azure AD Health Monitoring Agent Registry Keys Access | Security | This detection uses Windows security events to detect suspicious access attempts to the registry key of Azure AD Health monitoring agent. This detection requires an access control entry (ACE) on the system access control list (SACL) of the following securable object HKLM\SOFTWARE\Microsoft\Microsoft Online\Reporting\MonitoringAgent. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_aadhealth_mon_agent_regkey_access.yml | Windows: Azure AD Health Monitoring Agent Registry Keys Access | (eventType IN (""Win-Security-4656"",""Win-Security-4663"") AND osObjType=""Key"" AND osObjName=""\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Microsoft Online\\Reporting\\MonitoringAgent"") AND (procName NOT REGEXP "".*Microsoft\.Identity\.Health\.Adfs\.DiagnosticsAgent\.exe.*|.*Microsoft\.Identity\.Health\.Adfs\.InsightsService\.exe.*|.*Microsoft\.Identity\.Health\.Adfs\.MonitoringAgent\.Startup\.exe.*|.*Microsoft\.Identity\.Health\.Adfs\.PshSurrogate\.exe.*|.*Microsoft\.Identity\.Health\.Common\.Clients\.ResourceMonitor\.exe.*"") |
| Windows: HackTool - TruffleSnout Execution | Security | Detects the use of TruffleSnout.exe an iterative AD discovery toolkit for offensive operators, situational awareness and targeted low noise enumeration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_trufflesnout.yml | Windows: HackTool - TruffleSnout Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""TruffleSnout.exe"" OR procName REGEXP "".*\\TruffleSnout\.exe"") |
| Windows: Exports Registry Key To a File | Security | Detects the export of the target Registry key to a file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regedit_export_keys.yml | Windows: Exports Registry Key To a File | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\regedit\.exe"" OR srcFileName=""REGEDIT.EXE"") AND command REGEXP "".* -E .*|.* /E .*"") AND ((command NOT REGEXP "".*hkey_local_machine.*|.*hklm.*"") OR (command NOT REGEXP "".*\\sam|.*\\security|.*\\system"")) |
| Windows: Exports Critical Registry Keys To a File | Security | Detects the export of a crital Registry key to a file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regedit_export_critical_keys.yml | Windows: Exports Critical Registry Keys To a File | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\regedit\.exe"" OR srcFileName=""REGEDIT.EXE"") AND command REGEXP "".* -E .*|.* /E .*"" AND command REGEXP "".*hkey_local_machine.*|.*hklm.*"" AND command REGEXP "".*\\sam|.*\\security|.*\\system"" |
| Sudden Increase in Reported Events From A Host | Security | Detects that a reporting device is suddenly reporting more events. The current average over a 30 minute time window is more than 3 times the standard deviation and also 50% more than the statistical mean. | Sudden Increase in Reported Events From A Host | phEventCategory = 3 AND eventType = ""PH_SYSTEM_IP_EVENTS_PER_SEC"" |
| Windows: CMD Shell Output Redirect | Security | Detects the use of the redirection character "">"" to redirect information in commandline. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_redirect.yml | Windows: CMD Shell Output Redirect | eventType=""Win-Sysmon-1-Create-Process"" AND ((srcFileName=""Cmd.Exe"" OR procName REGEXP "".*\\cmd\.exe"") AND command REGEXP "".*>.*"") AND ((command NOT REGEXP "".*C:\\Program Files \(x86\)\\Internet Download Manager\\IDMMsgHost\.exe.*|.*\\\.\\pipe\\chrome\.nativeMessaging.*|.*chrome-extension://.*"")) |
| Windows: Group Membership Reconnaissance Via Whoami.EXE | Security | Detects the execution of whoami.exe with the /group command line flag to show group membership for the current user, account type, security identifiers (SID), and attributes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_whoami_groups_discovery.yml | Windows: Group Membership Reconnaissance Via Whoami.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\whoami\.exe"" OR srcFileName=""whoami.exe"") AND command REGEXP "".* -groups.*|.* /groups.*"" |
| Windows: Domain Trust Discovery Via Dsquery | Security | Detects execution of ""dsquery.exe"" for domain trust discovery. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dsquery_domain_trust_discovery.yml | Windows: Domain Trust Discovery Via Dsquery | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\dsquery\.exe"" OR srcFileName=""dsquery.exe"") AND command REGEXP "".*trustedDomain.*"" |
| Windows: HackTool - SharpLdapWhoami Execution | Security | Detects SharpLdapWhoami, a whoami alternative that queries the LDAP service on a domain controller. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_sharpldapwhoami.yml | Windows: HackTool - SharpLdapWhoami Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\SharpLdapWhoami\.exe"" OR srcFileName REGEXP "".*SharpLdapWhoami.*"" OR product=""SharpLdapWhoami"" OR command REGEXP "".* /m:kerb|.* /m:nego|.* /m:ntlm|.* /method:kerb|.* /method:nego|.* /method:ntlm"") |
| Windows: Fsutil Drive Enumeration | Security | Attackers may leverage fsutil to enumerated connected drives. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_fsutil_drive_enumeration.yml | Windows: Fsutil Drive Enumeration | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\fsutil\.exe"" OR srcFileName=""fsutil.exe"") AND command REGEXP "".*drives.*"" |
| Windows: Azure AD Health Service Agents Registry Keys Access | Security | This detection uses Windows security events to detect suspicious access attempts to the registry key values and sub-keys of Azure AD Health service agents (e.g AD FS). Information from AD Health service agents can be used to potentially abuse some of the features provided by those services in the cloud (e.g. Federation). This detection requires an access control entry (ACE) on the system access control list (SACL) of the following securable object: HKLM:\SOFTWARE\Microsoft\ADHealthAgent. Make sure you set the SACL to propagate to its sub-keys. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_aadhealth_svc_agent_regkey_access.yml | Windows: Azure AD Health Service Agents Registry Keys Access | (eventType IN (""Win-Security-4656"",""Win-Security-4663"") AND osObjType=""Key"" AND osObjName=""\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\ADHealthAgent"") AND (procName NOT REGEXP "".*Microsoft\.Identity\.Health\.Adfs\.DiagnosticsAgent\.exe.*|.*Microsoft\.Identity\.Health\.Adfs\.InsightsService\.exe.*|.*Microsoft\.Identity\.Health\.Adfs\.MonitoringAgent\.Startup\.exe.*|.*Microsoft\.Identity\.Health\.Adfs\.PshSurrogate\.exe.*|.*Microsoft\.Identity\.Health\.Common\.Clients\.ResourceMonitor\.exe.*"") |
| Windows: Files And Subdirectories Listing Using Dir | Security | Detects usage of the ""dir"" command that's part of windows batch/cmd to collect information about directories. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_dir_execution.yml | Windows: Files And Subdirectories Listing Using Dir | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*dir .*"" AND command REGEXP "".* /s.*"" AND command REGEXP "".* /b.*"" |
| Windows: PUA - AdFind Suspicious Execution | Security | Detects AdFind execution with common flags seen used during attacks. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_adfind_susp_usage.yml | Windows: PUA - AdFind Suspicious Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* dclist .*|.* oudmp .*|.*-sc u:.*|.*-subnets -f.*|.*adinfo.*|.*computer_pwdnotreqd.*|.*computers_active.*|.*computers_pwdnotreqd.*|.*dcmodes.*|.*domainlist.*|.*domainncs.*|.*dompol.*|.*fspdmp.*|.*gpodmp.*|.*name=\""Domain Admins\"".*|.*objectcategory=.*|.*subnetdmp.*|.*trustdmp.*|.*users_noexpire.*"" |
| Windows: SysKey Registry Keys Access | Security | Detects handle requests and access operations to specific registry keys to calculate the SysKey. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_syskey_registry_access.yml | Windows: SysKey Registry Keys Access | eventType IN (""Win-Security-4656"",""Win-Security-4663"") AND osObjType=""key"" AND osObjName REGEXP "".*lsa\\Data|.*lsa\\GBG|.*lsa\\JD|.*lsa\\Skew1"" |
| Windows: Suspicious Tasklist Discovery Command | Security | Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_tasklist_basic_execution.yml | Windows: Suspicious Tasklist Discovery Command | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*tasklist.*"" OR procName REGEXP "".*\\tasklist\.exe"" OR srcFileName=""tasklist.exe"") |
| Windows: Suspicious Execution of Systeminfo | Security | Detects usage of the ""systeminfo"" command to retrieve information. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_systeminfo_execution.yml | Windows: Suspicious Execution of Systeminfo | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\systeminfo\.exe"" OR srcFileName=""sysinfo.exe"") |
| Windows: PUA - Seatbelt Execution | Security | Detects the execution of the PUA/Recon tool Seatbelt via PE information of command line parameters. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_seatbelt.yml | Windows: PUA - Seatbelt Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\Seatbelt\.exe"" OR srcFileName=""Seatbelt.exe"" OR description=""Seatbelt"" OR command REGEXP "".* CertificateThumbprints.*|.* ChromiumBookmarks.*|.* ChromiumHistory.*|.* ChromiumPresence.*|.* CloudCredentials.*|.* CredEnum.*|.* CredGuard.*|.* DpapiMasterKeys.*|.* FirefoxHistory.*|.* InterestingFiles.*|.* InterestingProcesses.*|.* ProcessCreationEvents.*"") OR (command REGEXP "".* -group=all.*|.* -group=chromium.*|.* -group=misc.*|.* -group=remote.*|.* -group=slack.*|.* -group=system.*|.* -group=user.*"" AND command REGEXP "".* -outputfile=.*"")) |
| Windows: Potential Recon Activity Via Nltest.EXE | Security | Detects nltest commands that can be used for information discovery. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_nltest_recon.yml | Windows: Potential Recon Activity Via Nltest.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\nltest\.exe"" OR srcFileName=""nltestrk.exe"") AND ((command REGEXP "".*/server.*"" AND command REGEXP "".*/query.*"") OR command REGEXP "".*/all_trusts.*|.*/dclist:.*|.*/domain_trusts.*|.*/parentdomain.*|.*/trusted_domains.*|.*/user.*"") |
| Windows: SCM Database Handle Failure | Security | Detects non-system users failing to get a handle of the SCM database. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_scm_database_handle_failure.yml | Windows: SCM Database Handle Failure | (eventType=""Win-Security-4656"" AND osObjType=""SC_MANAGER OBJECT"" AND osObjName=""ServicesActive"" AND fileAccess=""0xf003f"") AND (winLogonId!=""0x3e4"") |
| Windows: Suspicious Scan Loop Network | Security | Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_network_scan_loop.yml | Windows: Suspicious Scan Loop Network | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*for .*|.*foreach .*"" AND command REGEXP "".*nslookup.*|.*ping.*"" |
| Windows: PUA - Advanced IP Scanner Execution | Security | Detects the use of Advanced IP Scanner. Seems to be a popular tool for ransomware groups. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_advanced_ip_scanner.yml | Windows: PUA - Advanced IP Scanner Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\advanced_ip_scanner.*"" OR srcFileName REGEXP "".*advanced_ip_scanner.*"" OR description REGEXP "".*Advanced IP Scanner.*"") OR (command REGEXP "".*/portable.*"" AND command REGEXP "".*/lng.*"")) |
| Windows: Potential Configuration And Service Reconnaissance Via Reg.EXE | Security | Detects the usage of ""reg.exe"" in order to query reconnaissance information from the registry. Adversaries may interact with the Windows registry to gather information about credentials, the system, configuration, and installed software. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_query_registry.yml | Windows: Potential Configuration And Service Reconnaissance Via Reg.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\reg\.exe"" OR srcFileName=""reg.exe"") AND command REGEXP "".*query.*"" AND command REGEXP "".*currentVersion\\policies\\explorer\\run.*|.*currentVersion\\run.*|.*currentVersion\\shellServiceObjectDelayLoad.*|.*currentVersion\\windows.*|.*currentcontrolset\\services.*|.*winlogon\\.*"" |
| Windows: Local Accounts Discovery | Security | Local accounts, System Owner/User discovery using operating systems utilities. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_local_system_owner_account_discovery.yml | Windows: Local Accounts Discovery | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\cmd\.exe"" AND command REGEXP "".* /c.*"" AND command REGEXP "".*dir .*"" AND command REGEXP "".*\\Users\\.*"") AND (command NOT REGEXP "".* rmdir .*"")) OR ((procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" AND command REGEXP "".*user.*"") AND (command NOT REGEXP "".*/active.*|.*/add.*|.*/delete.*|.*/domain.*|.*/expires.*|.*/passwordreq.*|.*/scriptpath.*|.*/times.*|.*/workstations.*"")) OR procName REGEXP "".*\\quser\.exe|.*\\qwinsta\.exe|.*\\whoami\.exe"" OR (procName REGEXP "".*\\wmic\.exe"" AND command REGEXP "".*useraccount.*"" AND command REGEXP "".*get.*"") OR (procName REGEXP "".*\\cmdkey\.exe"" AND command REGEXP "".* /l.*"")) |
| Windows: Suspicious Execution of Hostname | Security | Use of hostname to get information. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hostname_execution.yml | Windows: Suspicious Execution of Hostname | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\HOSTNAME\.EXE"" |
| Windows: Renamed AdFind Execution | Security | Detects the use of a renamed Adfind.exe. AdFind continues to be seen across majority of breaches. It is used to domain trust discovery to plan out subsequent steps in the attack chain. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_adfind.yml | Windows: Renamed AdFind Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".* dclist .*|.* oudmp .*|.*-sc u:.*|.*-subnets -f.*|.*adinfo.*|.*computer_pwdnotreqd.*|.*computers_active.*|.*computers_pwdnotreqd.*|.*dcmodes.*|.*domainlist.*|.*domainncs.*|.*dompol.*|.*fspdmp.*|.*gpodmp.*|.*name=\""Domain Admins\"".*|.*objectcategory=.*|.*subnetdmp.*|.*trustdmp.*|.*users_noexpire.*"" OR hashIMP IN (""53e117a96057eaf19c41380d0e87f1c2"",""bca5675746d13a1f246e2da3c2217492"") OR hashCode REGEXP "".*IMPHASH=53E117A96057EAF19C41380D0E87F1C2.*|.*IMPHASH=BCA5675746D13A1F246E2DA3C2217492.*"" OR srcFileName=""AdFind.exe"") AND (procName NOT REGEXP "".*\\AdFind\.exe"") |
| Windows: Network Reconnaissance Activity | Security | Detects a set of suspicious network related commands often used in recon stages. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_nslookup_domain_discovery.yml | Windows: Network Reconnaissance Activity | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*nslookup.*"" AND command REGEXP "".*_ldap\._tcp\.dc\._msdcs\..*"" |
| Windows: SC.EXE Query Execution | Security | Detects execution of ""sc.exe"" to query information about registered services on the system. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_query.yml | Windows: SC.EXE Query Execution | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\sc\.exe"" AND srcFileName REGEXP "".*sc\.exe"" AND command REGEXP "".* query.*"" |
| Windows: Suspicious Whoami.EXE Execution From Privileged Process | Security | Detects the execution of ""whoami.exe"" by privileged accounts that are often abused by threat actors. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_whoami_execution_from_high_priv_process.yml | Windows: Suspicious Whoami.EXE Execution From Privileged Process | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""whoami.exe"" OR procName REGEXP "".*\\whoami\.exe"") AND user REGEXP "".*AUTHORI.*|.*AUTORI.*|.*TrustedInstaller.*"" |
| Windows: PUA - Advanced Port Scanner Execution | Security | Detects the use of Advanced Port Scanner. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_advanced_port_scanner.yml | Windows: PUA - Advanced Port Scanner Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\advanced_port_scanner.*"" OR srcFileName REGEXP "".*advanced_port_scanner.*"" OR description REGEXP "".*Advanced Port Scanner.*"") OR (command REGEXP "".*/portable.*"" AND command REGEXP "".*/lng.*"")) |
| Windows: Potential Active Directory Reconnaissance/Enumeration Via LDAP | Security | Detects potential Active Directory enumeration via LDAP. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/ldap/win_ldap_recon.yml | Windows: Potential Active Directory Reconnaissance/Enumeration Via LDAP | ((eventType REGEXP ""Win-.*-30[^\d]*"" AND queryFilter REGEXP "".*Domain Admins.*|.*\(groupType:1\.2\.840\.113556\.1\.4\.803:=2147483648\).*|.*\(groupType:1\.2\.840\.113556\.1\.4\.803:=2147483650\).*|.*\(groupType:1\.2\.840\.113556\.1\.4\.803:=2147483652\).*|.*\(groupType:1\.2\.840\.113556\.1\.4\.803:=2147483656\).*|.*\(objectCategory=Computer\).*|.*\(objectCategory=domain\).*|.*\(objectCategory=groupPolicyContainer\).*|.*\(objectCategory=group\).*|.*\(objectCategory=nTDSDSA\).*|.*\(objectCategory=organizationalUnit\).*|.*\(objectCategory=person\).*|.*\(objectCategory=server\).*|.*\(objectCategory=user\).*|.*\(objectClass=computer\).*|.*\(objectClass=group\).*|.*\(objectClass=server\).*|.*\(objectClass=trustedDomain\).*|.*\(objectClass=user\).*|.*\(primaryGroupID=512\).*|.*\(primaryGroupID=515\).*|.*\(primaryGroupID=516\).*|.*\(primaryGroupID=521\).*|.*\(sAMAccountType=268435456\).*|.*\(sAMAccountType=268435457\).*|.*\(sAMAccountType=536870912\).*|.*\(sAMAccountType=536870913\).*|.*\(sAMAccountType=805306368\).*|.*\(sAMAccountType=805306369\).*|.*\(schemaIDGUID=\.*\).*|.*objectGUID=\.*"") AND (eventType NOT REGEXP ""Win-.*-30[^\d]*"" OR queryFilter NOT REGEXP "".*\(domainSid=.*\).*|.*\(objectSid=.*\).*"")) OR (eventType REGEXP ""Win-.*-30[^\d]*"" AND queryFilter REGEXP "".*\!\(UserAccountControl:1\.2\.840\.113556\.1\.4\.803:=2\).*|.*\!\(userAccountControl:1\.2\.840\.113556\.1\.4\.803:=1048574\).*|.*\(accountExpires=0\).*|.*\(accountExpires=9223372036854775807\).*|.*\(adminCount=1\).*|.*\(userAccountControl:1\.2\.840\.113556\.1\.4\.803:=2097152\).*|.*\(userAccountControl:1\.2\.840\.113556\.1\.4\.803:=4194304\).*|.*\(userAccountControl:1\.2\.840\.113556\.1\.4\.803:=524288\).*|.*\(userAccountControl:1\.2\.840\.113556\.1\.4\.803:=544\).*|.*\(userAccountControl:1\.2\.840\.113556\.1\.4\.803:=65536\).*|.*\(userAccountControl:1\.2\.840\.113556\.1\.4\.803:=8192\).*|.*ms-MCS-AdmPwd.*|.*msDS-AllowedToActOnBehalfOfOtherIdentity.*|.*msDS-AllowedToDelegateTo.*|.*msDS-GroupManagedServiceAccount.*"") |
| Windows: Permission Check Via Accesschk.EXE | Security | Detects the usage of the ""Accesschk"" utility, an access and privilege audit tool developed by SysInternal and often being abused by attacker to verify process privileges. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_accesschk_check_permissions.yml | Windows: Permission Check Via Accesschk.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (product REGEXP "".*AccessChk"" OR description REGEXP "".*Reports effective permissions.*"" OR procName REGEXP "".*\\accesschk64\.exe|.*\\accesschk\.exe"" OR srcFileName=""accesschk.exe"") AND command REGEXP "".*kwsu .*|.*qwsu .*|.*uwcqv .*|.*uwdqs .*"" |
| Windows: Suspicious Where Execution | Security | Adversaries may enumerate browser bookmarks to learn more about compromised hosts. Browser bookmarks may reveal personal information about users (ex: banking sites, interests, social media, etc.) as well as details about internal network resources such as servers, tools/dashboards, or other related infrastructure. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_where_browser_data_recon.yml | Windows: Suspicious Where Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\where\.exe"" OR srcFileName=""where.exe"") AND command REGEXP "".*Bookmarks.*|.*Cookies.*|.*History.*|.*Login Data.*|.*cookies\.sqlite.*|.*formhistory\.sqlite.*|.*key3\.db.*|.*key4\.db.*|.*logins\.json.*|.*places\.sqlite.*|.*sessionstore\.jsonlz4.*"" |
| Windows: Sysmon Discovery Via Default Driver Altitude Using Findstr.EXE | Security | Detects usage of ""findstr"" with the argument ""385201"". Which could indicate potential discovery of an installed Sysinternals Sysmon service using the default driver altitude (even if the name is changed). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_findstr_sysmon_discovery_via_default_altitude.yml | Windows: Sysmon Discovery Via Default Driver Altitude Using Findstr.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\findstr\.exe"" OR srcFileName=""FINDSTR.EXE"") AND command REGEXP "".* 385201.*"" |
| Windows: Potential System Information Discovery Via Wmic.EXE | Security | Detects the use of the WMI command-line (WMIC) utility to identify and display various system information, including OS, CPU, GPU, and disk drive names; memory capacity; display resolution; and baseboard, BIOS, and GPU driver products/versions. Some of these commands were used by Aurora Stealer in late 2022/early 2023. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_recon_system_info_discovery.yml | Windows: Potential System Information Discovery Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (description=""WMI Commandline Utility"" OR srcFileName=""wmic.exe"" OR procName REGEXP "".*\\WMIC\.exe"") AND command REGEXP "".*DISKDRIVE get Caption.*|.*LOGICALDISK get Name,Size,FreeSpace.*|.*MEMPHYSICAL get MaxCapacity.*|.*OS get Caption,OSArchitecture,Version.*|.*baseboard get product.*|.*baseboard get version.*|.*bios get SMBIOSBIOSVersion.*|.*cpu get name.*|.*path win32_VideoController get DriverVersion.*|.*path win32_VideoController get VideoModeDescription.*|.*path win32_VideoController get name.*"" |
| Windows: Suspicious LDAP Domain Access | Security | Detect suspicious LDAP request from non-Windows application. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_susp_ldap.yml | Windows: Suspicious LDAP Domain Access | eventType=""Win-Sysmon-22-DNS-Query"" AND queryId REGEXP ""_ldap\..*"" AND ((procName NOT REGEXP ""C:\\Windows\\.*"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Windows Defender\\MsMpEng\.exe.*|C:\\Program Files\\Windows Defender\\MsMpEng\.exe.*|C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\.*"" OR procName NOT REGEXP "".*\\MsMpEng\.exe"") AND (procName!=""<unknown process>"") AND (procName NOT REGEXP ""C:\\WindowsAzure\\GuestAgent.*"")) |
| Windows: User Discovery And Export Via Get-ADUser Cmdlet | Security | Detects usage of the Get-ADUser cmdlet to collect user information and output it to a file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_user_discovery_get_aduser.yml | Windows: User Discovery And Export Via Get-ADUser Cmdlet | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND (command REGEXP "".*Get-ADUser .*"" AND command REGEXP "".* -Filter \.*"" AND command REGEXP "".* > .*|.* \| Select .*|.*Add-Content.*|.*Out-File.*|.*Set-Content.*"") |
| Windows: Local Groups Reconnaissance Via Wmic.EXE | Security | Detects the execution of ""wmic"" with the ""group"" flag. Adversaries may attempt to find local system groups and permission settings. The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_recon_group.yml | Windows: Local Groups Reconnaissance Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\wmic\.exe"" OR srcFileName=""wmic.exe"") AND command REGEXP "".* group.*"" |
| Windows: HackTool - winPEAS Execution | Security | WinPEAS is a script that search for possible paths to escalate privileges on Windows hosts. The checks are explained on book.hacktricks.xyz. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_winpeas.yml | Windows: HackTool - winPEAS Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""winPEAS.exe"" OR procName REGEXP "".*\\winPEASany\.exe|.*\\winPEASany_ofs\.exe|.*\\winPEASx64\.exe|.*\\winPEASx64_ofs\.exe|.*\\winPEASx86\.exe|.*\\winPEASx86_ofs\.exe"" OR command REGEXP "".* applicationsinfo.*|.* browserinfo.*|.* eventsinfo.*|.* fileanalysis.*|.* filesinfo.*|.* processinfo.*|.* servicesinfo.*|.* windowscreds.*"" OR command REGEXP "".*https://github\.com/carlospolop/PEASS-ng/releases/latest/download/.*"" OR parentCommand REGEXP "".* -linpeas"" OR command REGEXP "".* -linpeas"") |
| Windows: Share And Session Enumeration Using Net.EXE | Security | Detects attempts to enumerate file shares, printer shares and sessions using ""net.exe"" with the ""view"" flag. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_share_and_sessions_enum.yml | Windows: Share And Session Enumeration Using Net.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR srcFileName IN (""net.exe"",""net1.exe"")) AND command REGEXP "".*view.*"") AND (command NOT REGEXP "".*\\\\\.*"") |
| Windows: Use of W32tm as Timer | Security | When configured with suitable command line arguments, w32tm can act as a delay mechanism. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_w32tm.yml | Windows: Use of W32tm as Timer | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\w32tm\.exe"" OR srcFileName=""w32time.dll"") AND (command REGEXP "".*/stripchart.*"" AND command REGEXP "".*/computer:.*"" AND command REGEXP "".*/period:.*"" AND command REGEXP "".*/dataonly.*"" AND command REGEXP "".*/samples:.*"") |
| Windows: PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE | Security | Detects active directory enumeration activity using known AdFind CLI flags. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_adfind_enumeration.yml | Windows: PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*lockoutduration.*|.*lockoutobservationwindow.*|.*lockoutthreshold.*|.*maxpwdage.*|.*minpwdage.*|.*minpwdlength.*|.*pwdhistorylength.*|.*pwdproperties.*"" OR command REGEXP "".*-sc admincountdmp.*"" OR command REGEXP "".*-sc exchaddresses.*"") |
| Windows: Suspicious Query of MachineGUID | Security | Use of reg to get MachineGuid information. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_machineguid.yml | Windows: Suspicious Query of MachineGUID | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\reg\.exe"" AND command REGEXP "".*SOFTWARE\\Microsoft\\Cryptography.*"" AND command REGEXP "".*/v .*"" AND command REGEXP "".*MachineGuid.*"" |
| Windows: Suspicious Reconnaissance Activity Using Get-LocalGroupMember Cmdlet | Security | Detects suspicious reconnaissance command line activity on Windows systems using the PowerShell Get-LocalGroupMember Cmdlet. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_get_localgroup_member_recon.yml | Windows: Suspicious Reconnaissance Activity Using Get-LocalGroupMember Cmdlet | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Get-LocalGroupMember .*"" AND command REGEXP "".* administrateur.*|.* administrator.*|.*Exchange Trusted Subsystem.*|.*Remote Desktop Users.*|.*Usuarios de escritorio remoto.*|.*Utilisateurs du Bureau . distance.*|.*domain admins.*|.*enterprise admins.*"" |
| Windows: Suspicious Use of PsLogList | Security | Detects usage of the PsLogList utility to dump event log in order to extract admin accounts and perform account discovery or delete events logs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_psloglist.yml | Windows: Suspicious Use of PsLogList | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""psloglist.exe"" OR procName REGEXP "".*\\psloglist64\.exe|.*\\psloglist\.exe"") AND command REGEXP "".* application.*|.* security.*|.* system.*"" AND command REGEXP "".* -c.*|.* -d.*|.* -g.*|.* -s.*|.* -x.*|.* /c.*|.* /d.*|.* /g.*|.* /s.*|.* /x.*"" |
| Windows: Python Initiated Connection | Security | Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_python.yml | Windows: Python Initiated Connection | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (initiated=""true"" AND procName REGEXP "".*python.*"") AND ((parentProcName!=""C:\\ProgramData\\Anaconda3\\Scripts\\conda.exe"" OR command NOT REGEXP "".*C:\\ProgramData\\Anaconda3\\Scripts\\conda-script\.py.*"" OR command NOT REGEXP "".*update.*"") AND (parentProcName!=""C:\\ProgramData\\Anaconda3\\python.exe"" OR command NOT REGEXP "".*C:\\ProgramData\\Anaconda3\\Scripts\\jupyter-notebook-script\.py.*"") AND (destIpAddr!=127.0.0.1 OR srcIpAddr!=127.0.0.1)) |
| Windows: System Network Connections Discovery Via Net.EXE | Security | Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_network_connections_discovery.yml | Windows: System Network Connections Discovery Via Net.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR srcFileName IN (""net.exe"",""net1.exe"")) AND (command REGEXP "".* sessions|.* use"" OR command REGEXP "".* sessions .*|.* use .*"") |
| Windows: Security Privileges Enumeration Via Whoami.EXE | Security | Detects a whoami.exe executed with the /priv command line flag instructing the tool to show all current user privileges. This is often used after a privilege escalation attempt. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_whoami_priv_discovery.yml | Windows: Security Privileges Enumeration Via Whoami.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\whoami\.exe"" OR srcFileName=""whoami.exe"") AND command REGEXP "".* -priv.*|.* /priv.*"" |
| Windows: Reconnaissance Activity | Security | Detects activity as ""net user administrator /domain"" and ""net group domain admins /domain"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_net_recon_activity.yml | Windows: Reconnaissance Activity | eventType=""Win-Security-4661"" AND fileAccess=""0x2d"" AND osObjType IN (""SAM_GROUP"",""SAM_USER"") AND osObjName REGEXP ""S-1-5-21-.*"" AND osObjName REGEXP "".*-500|.*-512"" |
| Windows: PUA - Nmap/Zenmap Execution | Security | Detects usage of namp/zenmap. Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_nmap_zenmap.yml | Windows: PUA - Nmap/Zenmap Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\nmap\.exe|.*\\zennmap\.exe"" OR srcFileName IN (""nmap.exe"",""zennmap.exe"")) |
| Windows: Suspicious Execution of Adidnsdump | Security | This tool enables enumeration and exporting of all DNS records in the zone for recon purposes of internal networks Python 3 and python.exe must be installed, Usee to Query/modify DNS records for Active Directory integrated DNS via LDAP . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_python_adidnsdump.yml | Windows: Suspicious Execution of Adidnsdump | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\python\.exe"" AND command REGEXP "".*adidnsdump.*"" |
| Windows: Suspicious Whoami.EXE Execution | Security | Detects the execution of ""whoami.exe"" with the ""/all"" flag or with redirection options to export the results to a file for later use. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_whoami_susp_flags.yml | Windows: Suspicious Whoami.EXE Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\whoami\.exe"" OR srcFileName=""whoami.exe"") AND command REGEXP "".* -FO CSV.*|.* -all.*|.* /FO CSV.*|.* /all.*"") OR (command REGEXP "".*whoami.*"" AND command REGEXP "".*>.*"")) |
| Windows: Net.exe Execution | Security | Detects execution of Net.exe, whether suspicious or benign. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_susp_execution.yml | Windows: Net.exe Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR srcFileName IN (""net.exe"",""net1.exe"")) AND command REGEXP "".* accounts.*|.* group.*|.* localgroup.*|.* share.*|.* start.*|.* stop .*|.* user.*|.* view.*"" |
| Windows: Renamed Whoami Execution | Security | Detects the execution of whoami that has been renamed to a different name to avoid detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_whoami.yml | Windows: Renamed Whoami Execution | eventType=""Win-Sysmon-1-Create-Process"" AND srcFileName=""whoami.exe"" AND (procName NOT REGEXP "".*\\whoami\.exe"") |
| Failed Windows DC Diagnostic Test | Disponibilidade | Detects that a specific Windows Domain Controller Diagnostic test failed | Failed Windows DC Diagnostic Test | eventType = ""PH_DEV_MON_DCDIAG"" AND testResult = ""failed"" |
| ICS Alert: Wireless Sniffing | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0887 - Wireless Sniffing. Adversaries may seek to capture radio frequency (RF) communication used for remote control and reporting in distributed environments. | ICS Alert: Wireless Sniffing | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0887(,T\d+)*$"" |
| Crowdstrike: Overwatch Detection | Security | Crowdstrike agent's Overwatch module detected malicious activity | Crowdstrike: Overwatch Detection | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Overwatch-Detection"" |
| Blocked File Execution | Security | Detects a file execution being blocked by end user protection software such as Carbon Black, PaloAlto Traps, BitDefender | Blocked File Execution | eventType IN (Group@PH_SYS_EVENT_BlockedFileExec) |
| Warning APC Trap | Disponibilidade | Detects a medium severity trap from APC devices (UPS, PDUs etc) | Warning APC Trap | eventType CONTAIN ""APC-"" AND eventSeverityCat = ""Medium"" AND errorNo IS NULL AND phEventCategory = 0 |
| Crowdstrike: File Blocked With Matching Hash | Security | Crowdstrike agent blocked exploit | Crowdstrike: File Blocked With Matching Hash | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Blocked-Hash"" |
| ICS Alert: Network Connection Enumeration | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0840 - Network Connection Enumeration. Adversaries may perform network connection enumeration to discover information about device communication patterns. | ICS Alert: Network Connection Enumeration | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0840(,T\d+)*$"" |
| ICS Alert: Remote System Information Discovery | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0888 - Remote System Information Discovery. An adversary may attempt to get detailed information about remote systems and their peripherals, such as make/model, role, and configuration. | ICS Alert: Remote System Information Discovery | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0888(,T\d+)*$"" |
| Azure Command Execution on Virtual Machine | Security | Identifies command execution on a virtual machine (VM) in Azure. A Virtual Machine Contributor role lets you manage virtual machines, but not access them, nor access the virtual network or storage account they're connected to. However, commands can be run via PowerShell on the VM, which execute as System. Other roles, such as certain Administrator roles may be able to execute commands on a VM as well. | Azure Command Execution on Virtual Machine | eventType = ""MS_EvtHub_compute_virtualmachines_runcommand_action"" |
| NetBotz camera motion detected | Disponibilidade | Detects camera motion from NetBotz camera motion | NetBotz camera motion detected | eventType = ""PH_DEV_MON_HW_CAMERA_MOTION"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_ENV_GEN) AND cameraMotionSensorVal = ""No Motion"" |
| ICS Alert: Remote System Discovery | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0846 - Remote System Discovery. Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for subsequent Lateral Movement or Discovery techniques. | ICS Alert: Remote System Discovery | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0846(,T\d+)*$"" |
| Crowdstrike: Blocked Exploit | Security | Crowdstrike agent blocked exploit | Crowdstrike: Blocked Exploit | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Blocked-Exploit"" |
| ICS Alert: Exploitation for Evasion | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0820 - Exploitation for Evasion. Adversaries may exploit a software vulnerability to take advantage of a programming error in a program, service, or within the operating system software or kernel itself to evade detection. | ICS Alert: Exploitation for Evasion | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0820(,T\d+)*$"" |
| Code Injection Attack detected by NIPS | Security | Detects a high severity Code Injection Attack. This rule alerts on all attacks from internal networks and permitted attacks from external networks. | Code Injection Attack detected by NIPS | eventType IN (Group@PH_SYS_EVENT_CodeInjectionExploit) AND eventSeverity >= 7 AND ((srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventAction = 0) OR srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)) |
| Crowdstrike: Drive By Download | Security | Crowdstrike agent detected drive by download likely indicating malware download on the host | Crowdstrike: Drive By Download | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Drive-By-Download"" |
| FPC ground current high | Disponibilidade | Detects that ground current is more than 0.12 amps | FPC ground current high | eventType = ""PH_DEV_MON_FPC_LIEBERT_METRIC"" |
| WLAN Scan | Security | Detects Wireless LAN scanning activity using tools such as NetStumbler, Wellenreiter etc | WLAN Scan | eventType IN (Group@PH_SYS_EVENT_WirelessReconn) |
| ICS Alert: Rootkit | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0851 - Rootkit. Adversaries may deploy rootkits to hide the presence of programs, files, network connections, services, drivers, and other system components. | ICS Alert: Rootkit | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0851(,T\d+)*$"" |
| Windows: Whoami Utility Execution | Security | Detects the execution of whoami, which is often used by attackers after exploitation / privilege escalation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_whoami_execution.yml | Windows: Whoami Utility Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\whoami\.exe"" OR srcFileName=""whoami.exe"") |
| AWS Execution via System Manager | Security | Identifies the execution of commands and scripts via System Manager. Execution methods such as RunShellScript, RunPowerShellScript, and alike can be abused by an authenticated attacker to install a backdoor or to interact with a compromised instance via reverse-shell using system only commands. | AWS Execution via System Manager | eventType CONTAIN ""AWS-CloudTrail-SSM-SendCommand"" |
| ICS Alert: Spoof Reporting Message | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0856 - Spoof Reporting Message. Adversaries may spoof reporting messages in control system environments for evasion and to impair process control. | ICS Alert: Spoof Reporting Message | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0856(,T\d+)*$"" |
| Windows: WhoAmI as Parameter | Security | Detects a suspicious process command line that uses whoami as first parameter (as e.g. used by EfsPotato). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_whoami_as_param.yml | Windows: WhoAmI as Parameter | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\.exe whoami.*"" |
| Critical APC Trap: can be auto cleared | Disponibilidade | Detects a high severity trap from APC devices (UPS, PDUs etc). This trap can be cleared by a corresponding event. | Critical APC Trap: can be auto cleared | eventType CONTAIN ""APC-"" AND eventSeverityCat = ""High"" AND errorNo IS NOT NULL AND phEventCategory = 0 |
| AWS SecHub: Tactics: Execution Detected | Security | AWS Security Hub detected execution tactics. Adversary is trying to run malicious code. | AWS SecHub: Tactics: Execution Detected | eventType = ""AWS-Hub-TTPs-Execution"" |
| Excessive Destination Windows DC Replication Failure | Disponibilidade | Detects that a specific Domain Controller is failing to replicate to a destination Windows Domain Controller | Excessive Destination Windows DC Replication Failure | eventType = ""PH_DEV_MON_DST_AD_REPL_STAT"" |
| Excessive Source Windows DC Replication Failure | Disponibilidade | Detects that a specific Domain Controller is failing to replicate to a destination Windows Domain Controller | Excessive Source Windows DC Replication Failure | eventType = ""PH_DEV_MON_SRC_AD_REPL_STAT"" |
| ICS Alert: Indicator Removal on Host | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0872 - Indicator Removal on Host. Adversaries may attempt to remove indicators of their presence on a system in an effort to cover their tracks. | ICS Alert: Indicator Removal on Host | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0872(,T\d+)*$"" |
| Windows: Whoami.EXE Execution Anomaly | Security | Detects the execution of whoami.exe with suspicious parent processes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_whoami_parent_anomaly.yml | Windows: Whoami.EXE Execution Anomaly | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\whoami\.exe"" OR srcFileName=""whoami.exe"") AND ((parentProcName NOT REGEXP "".*\\cmd\.exe|.*\\powershell\.exe|.*\\powershell_ise\.exe|.*\\pwsh\.exe"") AND (parentProcName!=""C:\\Program Files\\Microsoft Monitoring Agent\\Agent\\MonitoringHost.exe"") AND (parentProcName IS NOT NULL) AND (parentProcName IS NOT NULL)) |
| Cylance Found Active Script | Security | This rule detects Cylance found active scripts | Cylance Found Active Script | eventType = ""CylanceProtect-ScriptControl-Alert"" |
| Cylance Blocked Exploit | Security | This rule detects exploit attempts blocked by Cylance | Cylance Blocked Exploit | eventType = ""CylanceProtect-ExploitAttempt-blocked"" |
| NetBotz module door open | Disponibilidade | Detects that Netbotz door sensor values went from Close to Open | NetBotz module door open | eventType = ""PH_DEV_MON_HW_DOOR_SWITCH"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_ENV_GEN) AND doorSwitchSensorVal = ""Open"" |
| ICS Alert: Network Sniffing | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0842 - Network Sniffing. Network sniffing is the practice of using a network interface on a computer system to monitor or capture information regardless of whether it is the specified destination for the information. | ICS Alert: Network Sniffing | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0842(,T\d+)*$"" |
| FPC Current THD high | Disponibilidade | Detects that current total harmonic distortion is more than 0.15 pct | FPC Current THD high | eventType = ""PH_DEV_MON_FPC_LIEBERT_METRIC"" |
| Backdoor Found by Network IPS | Security | Detects connection to or response from a backdoor. A successful exploit often creates a backdoor to which a malicious host can connect. | Backdoor Found by Network IPS | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_Backdoor_Found) |
| NetBotz camera motion detected | Disponibilidade | Detects camera motion from NetBotz camera motion | NetBotz camera motion detected | eventType = ""PH_DEV_MON_HW_CAMERA_MOTION"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_ENV_GEN) AND cameraMotionSensorVal = ""Motion Detected"" |
| AlertLogic Incident | Security | AlertLogic triggered a security incident. Search for AlertLogic-InInboundId-Associated-Event to get triggered events | AlertLogic Incident | eventType CONTAIN ""AlertLogic-Incident"" |
| Warning APC Trap: can be auto cleared | Disponibilidade | Detects a medium severity trap from APC devices (UPS, PDUs etc).This trap can be cleared by a corresponding event. | Warning APC Trap: can be auto cleared | eventType CONTAIN ""APC-"" AND eventSeverityCat = ""Medium"" AND errorNo IS NOT NULL AND phEventCategory = 0 |
| ICS Alert: Masquerading | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0849 - Masquerading. Adversaries may use masquerading to disguise a malicious application or executable as another file, to avoid operator and engineer suspicion. | ICS Alert: Masquerading | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0849(,T\d+)*$"" |
| FPC Voltage THD high | Disponibilidade | Detects that Voltage total harmonic distortion is more than 0.15 pct | FPC Voltage THD high | eventType = ""PH_DEV_MON_FPC_LIEBERT_METRIC"" |
| NetBotz module door open | Disponibilidade | Detects that Netbotz door sensor values went from Close to Open | NetBotz module door open | eventType = ""PH_DEV_MON_HW_DOOR_SWITCH"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_ENV_GEN) AND doorSwitchSensorVal = ""Closed"" |
| Critical APC Trap | Disponibilidade | Detects a high severity trap from APC devices (UPS, PDUs etc) | Critical APC Trap | eventType CONTAIN ""APC-"" AND eventSeverityCat = ""High"" AND errorNo IS NULL AND phEventCategory = 0 |
| Linux: socat Process Activity | Security | Detects socat process running on a host. Socat is often used as a persistence mechanism by exporting a reverse shell, or by serving a shell on a listening port. Socat is also sometimes used for lateral movement. Some normal use of this program, at varying levels of frequency, may originate from scripts, automation tools, and frameworks. This requires process monitoring via FortiSIEM Linux agent. | Linux: socat Process Activity | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""socat"" AND swParam NOT CONTAIN ""-V"" |
| Shellshock Expression in Log Files | Security | Detects Shellshock expression in linux syslog | Shellshock Expression in Log Files | eventType CONTAIN ""Generic_Unix_"" AND rawEventMsg REGEXP ""\(\)\s*\t*\{.*;\s*\}\s*;"" |
| MS 365 Defender: Exploit Detected | Security | Windows Defender Advanced Threat Protection detected exploit | MS 365 Defender: Exploit Detected | eventType = ""Microsoft-WinDefATP-Alert-Exploit"" |
| System Exploit Detected by Network IPS: Likely Success | Security | Detects a likely succesful IPS detected exploit (e.g. Buffer overflow, Privilege escalation) optionally preceded by a Reconnaissance and followed by outbound connections and/or excessive scanning | System Exploit Detected by Network IPS: Likely Success | eventType = ""PH_RULE_SYSTEM_EXPLOIT_IPS"" |
| Spyware found but not remediated | Security | Detects that host anti-virus or content inspection devices found a spyware but could not remediate it | Spyware found but not remediated | eventType IN (Group@PH_SYS_EVENT_Spyware_Remedy_Failed) AND reptDevIpAddr IN (Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_SEC_GW) |
| Cylance Quarantined Host | Security | This rule detects Cylance agent quarantined a host | Cylance Quarantined Host | threatScore >= 70 AND eventType = ""CylanceProtect-Threat-threat_quarantined"" |
| Executable file posting from external source | Security | Detects an external IP posting an executable file to a web server via HTTP POST or PUT | Executable file posting from external source | httpMethod IN (""POST"",""PUT"") AND eventType IN (Group@PH_SYS_EVENT_PermitWebTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND (uriStem CONTAIN "".cgi"" OR uriStem CONTAIN "".asp"" OR uriStem CONTAIN "".aspx"" OR uriStem CONTAIN "".jar"" OR uriStem CONTAIN "".php"" OR uriStem CONTAIN "".exe"" OR uriStem CONTAIN "".com"" OR uriStem CONTAIN "".cmd"" OR uriStem CONTAIN "".sh"" OR uriStem CONTAIN "".bat"") |
| High Severity Inbound Permitted IPS Exploit | Security | Detects a permitted high severity IPS security exploit from outside. This rule makes sense only from an IPS positioned inside the firewall. Since this attack went through the firewall, its consequence must be monitored. | High Severity Inbound Permitted IPS Exploit | (eventType CONTAIN ""Checkpoint-ips"" OR eventType CONTAIN ""Cisco_IPS"" OR eventType CONTAIN ""Corero-SmartWall"" OR eventType CONTAIN ""FortiGate-ips"" OR eventType CONTAIN ""Juniper_IDP"" OR eventType CONTAIN ""McAfee-Intrushield"" OR eventType CONTAIN ""Forcepoint-NGFW-"" OR eventType CONTAIN ""Snort-"") AND (eventSeverity >= 8 OR ipsEvRR >= 85) AND eventAction = 0 AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| High Severity Inbound Denied Security Exploit | Security | Detects a denied high severity IPS security exploit from outside. This rule makes sense only from an IPS positioned inside the firewall. | High Severity Inbound Denied Security Exploit | (eventType CONTAIN ""Checkpoint-ips"" OR eventType CONTAIN ""Cisco_IPS"" OR eventType CONTAIN ""Corero-SmartWall"" OR eventType CONTAIN ""FortiGate-ips"" OR eventType CONTAIN ""Juniper_IDP"" OR eventType CONTAIN ""McAfee-Intrushield"" OR eventType CONTAIN ""Forcepoint-NGFW-"" OR eventType CONTAIN ""Snort-"") AND (eventSeverity >= 8 OR ipsEvRR >= 85) AND eventAction = 1 AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| FortiSandbox detects Network Attack | Security | FortiSandbox detecting a network attack | FortiSandbox detects Network Attack | eventType = ""FortiSandbox-NetAlert-Attack"" |
| High Severity WLAN Attack | Security | Detects a high severity WLAN attack | High Severity WLAN Attack | eventType IN (Group@PH_SYS_EVENT_WirelessSig) AND eventSeverity >= 5 |
| Malicious PowerShell Tool: PSAttack Detected | Security | A malicious powershell tool known as PSAttack has been detected being running on a Windows Host. This rule requires collection of the Windows PowerShell Event Log: Microsoft-Windows-PowerShell/Operational via the FortiSIEM Agent. | Malicious PowerShell Tool: PSAttack Detected | eventType = ""Win-PowerShell-4103"" AND msg REGEXP ("".*PS ATTACK!!!"") |
| High Severity Symantec Host IPS Exploit | Security | Detects a high severity host IPS security exploit detected by Symantec. This should be carefully looked at. | High Severity Symantec Host IPS Exploit | eventType CONTAIN ""Symantec-CIDS-"" AND eventSeverity >= 9 |
| Spyware Found by Network IPS | Security | Detects spyware installed on hosts and it is not clear whether the spyware was cleaned or not. Spyware are malicious applications that can be installed on hosts without the knowledge of the user. Once installed, a spyware automatically run each time the host is started, records URLs visited, user name, password and credit card information and send this information to spyware authors | Spyware Found by Network IPS | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_Spyware_Found) |
| High Severity Outbound Permitted IPS Exploit | Security | Detects a high severity IPS exploit detected by IPS - - from internal networks permitted to external network | High Severity Outbound Permitted IPS Exploit | (eventType CONTAIN ""Checkpoint-ips"" OR eventType CONTAIN ""Cisco_IPS"" OR eventType CONTAIN ""Corero-SmartWall"" OR eventType CONTAIN ""FortiGate-ips"" OR eventType CONTAIN ""Juniper_IDP"" OR eventType CONTAIN ""McAfee-Intrushield"" OR eventType CONTAIN ""Sophos-UTM-Intrusion"" OR eventType CONTAIN ""Forcepoint-NGFW-"" OR eventType CONTAIN ""Snort-"") AND eventSeverity >= 8 AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventAction = 0 |
| High Risk Rating Cisco IPS Exploit | Security | Detects a high risk rating IPS exploit event. This is applicable for Cisco IPS. | High Risk Rating Cisco IPS Exploit | eventType CONTAIN ""Cisco_IPS"" AND eventType NOT IN (Group@PH_SYS_EVENT_Logon,Group@PH_SYS_EVENT_Reconn) AND ipsEvRR >= 85 |
| System Exploit Detected by Network IPS: Likely Success | Security | Detects a likely succesful IPS detected exploit (e.g. Buffer overflow, Privilege escalation) optionally preceded by a Reconnaissance and followed by outbound connections and/or excessive scanning | System Exploit Detected by Network IPS: Likely Success | destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND destIpPort IN (21,23,80,443) |
| Multiple Distinct IPS Events From Same Src | Security | Detects multiple distinct IPS events from the same source IP in a short period of time - the source IP may have been infected | Multiple Distinct IPS Events From Same Src | (eventType CONTAIN ""Checkpoint-ips"" OR eventType CONTAIN ""Cisco_IPS"" OR eventType CONTAIN ""Corero-SmartWall"" OR eventType CONTAIN ""FortiGate-ips-"" OR eventType CONTAIN ""Juniper_IDP"" OR eventType CONTAIN ""McAfee-Intrushield"" OR eventType CONTAIN ""Forcepoint-NGFW-"" OR eventType CONTAIN ""Snort-"") AND eventSeverity >= 7 |
| Cylance Waived Threat | Security | This rule detects files that are allowed by Cylance agent | Cylance Waived Threat | eventType = ""CylanceProtect-Threat-threat_waived"" |
| Execution via local SxS Shared Module | Security | Identifies the creation, change, or deletion of a DLL module within a Windows SxS local folder. Adversaries may abuse shared modules to execute malicious payloads by instructing the Windows module loader to load DLLs from arbitrary local paths. | Execution via local SxS Shared Module | eventType = ""Win-Sysmon-11-FileCreate"" AND fileName CONTAIN ""dll"" AND filePath REGEXP ""C:\\.*\\.*\.exe\.local\\.*\.dll"" |
| Linux: Interactive Terminal Spawned via Python | Security | Detects a terminal (tty) is spawned via Python. Attackers may upgrade a simple reverse shell to a fully interactive tty after obtaining initial access to a host. This requires process monitoring via FortiSIEM Linux agent. | Linux: Interactive Terminal Spawned via Python | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""python"" AND swParam REGEXP "".*import\s+pty;\s*pty.spawn\(\""/bin/(sh|bash|dash)\"".*"" |
| Linux: Interactive Terminal Spawned via Perl | Security | Detects a terminal (tty) is spawned via Perl. Attackers may upgrade a simple reverse shell to a fully interactive tty after obtaining initial access to a host. This requires process monitoring via FortiSIEM Linux agent. | Linux: Interactive Terminal Spawned via Perl | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""perl"" AND swParam REGEXP "".*exec\s+\""/bin/sh\"";.*|.*exec\s+\""/bin/dash\"";.*|.*exec \""/bin/bash\"";.*"" |
| Suspicious Linux VSFTPD Errors | Security | Detects suspicious VSFTPD error messages that indicate a fatal or suspicious error that could be caused by exploit attempts | Suspicious Linux VSFTPD Errors | eventType CONTAIN ""Generic_Unix_"" AND (rawEventMsg CONTAIN ""Connection refused: too many sessions for this address"" OR rawEventMsg CONTAIN ""Connection refused: tcp_wrappers denial"" OR rawEventMsg CONTAIN ""Bad HTTP verb"" OR rawEventMsg CONTAIN ""port and pasv both active"" OR rawEventMsg CONTAIN ""pasv and port both active"" OR rawEventMsg CONTAIN ""Transfer done (but failed to open directory)"" OR rawEventMsg CONTAIN ""Could not set file modification time"" OR rawEventMsg CONTAIN ""bug: pid active in ptrace_sandbox_free"" OR rawEventMsg CONTAIN ""PTRACE_SETOPTIONS failure"" OR rawEventMsg CONTAIN ""weird status:"" OR rawEventMsg CONTAIN ""couldn't handle sandbox event"" OR rawEventMsg CONTAIN ""syscall not permitted"" OR rawEventMsg CONTAIN ""syscall validate failed"" OR rawEventMsg CONTAIN ""Input line too long"" OR rawEventMsg CONTAIN ""poor buffer accounting in str_netfd_alloc"" OR rawEventMsg CONTAIN ""vsf_sysutil_read_loop"" OR rawEventMsg REGEXP "".*syscall .* out of bounds.*"") AND phEventCategory = 0 |
| PowerShell Script Detected Calling a Credential Prompt | Security | A PowerShell Script has been detected calling a credential prompt, which may suspicious behaviour. This rule requires collection of the Windows PowerShell Event Log: Microsoft-Windows-PowerShell/Operational via the FortiSIEM Agent, and PowerShell Script block logging must be enabled. | PowerShell Script Detected Calling a Credential Prompt | eventType = ""Win-PowerShell-4104"" AND msg REGEXP ("".*PromptForCredential"") |
| Suspicious Linux log entries | Security | Detects suspicious entries in linux syslog | Suspicious Linux log entries | eventType CONTAIN ""Generic_Unix_"" AND (rawEventMsg CONTAIN ""entered promiscuous mode"" OR rawEventMsg CONTAIN ""Deactivating service"" OR rawEventMsg CONTAIN ""Oversized packet received from"" OR rawEventMsg CONTAIN ""imuxsock begins to drop messages"" ) AND phEventCategory = 0 |
| Excessive WLAN Exploits: Same Source | Security | Detects an excessive number of WLAN attacks from the same source | Excessive WLAN Exploits: Same Source | eventType IN (Group@PH_SYS_EVENT_WirelessSig) |
| System Exploit Detected by Network IPS | Security | Detects an IPS detected exploit (e.g. Buffer overflow, Privilege escalation) optionally preceded by a Reconnaissance | System Exploit Detected by Network IPS | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_BufferOverflowExploit, Group@PH_SYS_EVENT_CommandExecExploit) |
| MS 365 Defender: Suspicious PowerShell command line Execution Alert | Security | Suspicious PowerShell command line - Execution Alert from MS 365 Defender | MS 365 Defender: Suspicious PowerShell command line Execution Alert | (eventType = ""MS-Defender-Endpoint-Alert-Execution"" OR eventType CONTAIN ""M365Defender-Alert"") AND attackTechniqueId = ""T1059.001"" |
| System Exploit Detected by Network IPS: Likely Success | Security | Detects a likely succesful IPS detected exploit (e.g. Buffer overflow, Privilege escalation) optionally preceded by a Reconnaissance and followed by outbound connections and/or excessive scanning | System Exploit Detected by Network IPS: Likely Success | eventType = ""PH_RULE_EXCESS_DENY_SRC"" |
| Suspicious Linux SSHD Errors | Security | Detects suspicious SSH / SSHD error messages that indicate a fatal or suspicious error that could be caused by exploit attempts | Suspicious Linux SSHD Errors | eventType CONTAIN ""Generic_Unix_"" AND (rawEventMsg CONTAIN ""unexpected internal error"" OR rawEventMsg CONTAIN ""unknown or unsupported key type"" OR rawEventMsg CONTAIN ""invalid certificate signing key"" OR rawEventMsg CONTAIN ""invalid elliptic curve value"" OR rawEventMsg CONTAIN ""incorrect signature"" OR rawEventMsg CONTAIN ""error in libcrypto"" OR rawEventMsg CONTAIN ""unexpected bytes remain after decoding"" ) AND phEventCategory = 0 |
| Windows: Active Directory Kerberos DLL Loaded Via Office Application | Security | Detects Kerberos DLL being loaded by an Office Product. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_office_kerberos_dll_load.yml | Windows: Active Directory Kerberos DLL Loaded Via Office Application | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\excel\.exe|.*\\mspub\.exe|.*\\onenote\.exe|.*\\onenoteim\.exe|.*\\outlook\.exe|.*\\powerpnt\.exe|.*\\winword\.exe"" AND loadedProcName REGEXP "".*\\kerberos\.dll"" |
| Windows process communicating outbound to unusual ports | Security | Detects a Windows process communicating to outside public addresses on ports other than common web, dns and mail ports. | Windows process communicating outbound to unusual ports | eventType = ""PH_OSQUERY_WIN_OUTBOUND_NOT_WEB_DNS_MAIL"" AND totalNum >= 1 |
| High Severity Outbound Denied IPS Exploit | Security | Detects a high severity IPS security exploit from inside that is denied. This most likely implies that the source is infected with malware. | High Severity Outbound Denied IPS Exploit | (eventType CONTAIN ""Checkpoint-ips"" OR eventType CONTAIN ""Cisco_IPS"" OR eventType CONTAIN ""Corero-SmartWall"" OR eventType CONTAIN ""FortiGate-ips"" OR eventType CONTAIN ""Juniper_IDP"" OR eventType CONTAIN ""McAfee-Intrushield"" OR eventType CONTAIN ""Forcepoint-NGFW-"" OR eventType CONTAIN ""Snort-"") AND (eventSeverity >= 8 OR ipsEvRR >= 85) AND eventAction = 1 AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Unapproved File Execution | Security | Detects a unapproved file execution by end user protection software such as Carbon Black, PaloAlto Traps, BitDefender | Unapproved File Execution | eventType IN (Group@PH_SYS_EVENT_UnapprovedFileExec) |
| PowerShell Commandlet of Well Known Exploitation Framework Detected | Security | Detects Commandlet names from well-known PowerShell exploitation frameworks, https://adsecurity.org/?p=2921 This rule requires collection of the Windows PowerShell Event Log: Microsoft-Windows-PowerShell/Operational via the FortiSIEM Agent. | PowerShell Commandlet of Well Known Exploitation Framework Detected | eventType CONTAIN ""Win-PowerShell-"" AND ( msg REGEXP ("".*Invoke-DllInjection"") OR msg REGEXP ("".*Invoke-Shellcode"") OR msg REGEXP ("".*Invoke-WmiCommand"") OR msg REGEXP ("".*Get-GPPPassword"") OR msg REGEXP ("".*Get-Keystrokes"") OR msg REGEXP ("".*Get-TimedScreenshot"") OR msg REGEXP ("".*Get-VaultCredential"") OR msg REGEXP ("".*Invoke-CredentialInjection"") OR msg REGEXP ("".*Invoke-Mimikatz"") OR msg REGEXP ("".*Invoke-NinjaCopy"") OR msg REGEXP ("".*Invoke-TokenManipulation"") OR msg REGEXP ("".*Out-Minidump"") OR msg REGEXP ("".*VolumeShadowCopyTools"") OR msg REGEXP ("".*Invoke-ReflectivePEInjection"") OR msg REGEXP ("".*Invoke-UserHunter"") OR msg REGEXP ("".*Find-GPOLocation"") OR msg REGEXP ("".*Invoke-ACLScanner"") OR msg REGEXP ("".*Invoke-DowngradeAccount"") OR msg REGEXP ("".*Get-ServiceUnquoted"") OR msg REGEXP ("".*Get-ServiceFilePermission"") OR msg REGEXP ("".*Get-ServicePermission"") OR msg REGEXP ("".*Invoke-ServiceAbuse"") OR msg REGEXP ("".*Install-ServiceBinary"") OR msg REGEXP ("".*Get-RegAutoLogon"") OR msg REGEXP ("".*Get-VulnAutoRun"") OR msg REGEXP ("".*Get-VulnSchTask"") OR msg REGEXP ("".*Get-UnattendedInstallFile"") OR msg REGEXP ("".*Get-ApplicationHost"") OR msg REGEXP ("".*Get-RegAlwaysInstallElevated"") OR msg REGEXP ("".*Get-Unconstrained"") OR msg REGEXP ("".*Add-RegBackdoor"") OR msg REGEXP ("".*Add-ScrnSaveBackdoor"") OR msg REGEXP ("".*Gupt-Backdoor"") OR msg REGEXP ("".*Invoke-ADSBackdoor"") OR msg REGEXP ("".*Enabled-DuplicateToken"") OR msg REGEXP ("".*Invoke-PsUaCme"") OR msg REGEXP ("".*Remove-Update"") OR msg REGEXP ("".*Check-VM"") OR msg REGEXP ("".*Get-LSASecret"") OR msg REGEXP ("".*Get-PassHashes"") OR msg REGEXP ("".*Show-TargetScreen"") OR msg REGEXP ("".*Port-Scan"") OR msg REGEXP ("".*Invoke-PoshRatHttp"") OR msg REGEXP ("".*Invoke-PowerShellTCP"") OR msg REGEXP ("".*Invoke-PowerShellWMI"") OR msg REGEXP ("".*Add-Exfiltration"") OR msg REGEXP ("".*Add-Persistence"") OR msg REGEXP ("".*Do-Exfiltration"") OR msg REGEXP ("".*Start-CaptureServer"") OR msg REGEXP ("".*Get-ChromeDump"") OR msg REGEXP ("".*Get-ClipboardContents"") OR msg REGEXP ("".*Get-FoxDump"") OR msg REGEXP ("".*Get-IndexedItem"") OR msg REGEXP ("".*Get-Screenshot"") OR msg REGEXP ("".*Invoke-Inveigh"") OR msg REGEXP ("".*Invoke-NetRipper"") OR msg REGEXP ("".*Invoke-EgressCheck"") OR msg REGEXP ("".*Invoke-PostExfil"") OR msg REGEXP ("".*Invoke-PSInject"") OR msg REGEXP ("".*Invoke-RunAs"") OR msg REGEXP ("".*MailRaider"") OR msg REGEXP ("".*New-HoneyHash"") OR msg REGEXP ("".*Set-MacAttribute"") OR msg REGEXP ("".*Invoke-DCSync"") OR msg REGEXP ("".*Invoke-PowerDump"") OR msg REGEXP ("".*Exploit-Jboss"") OR msg REGEXP ("".*Invoke-ThunderStruck"") OR msg REGEXP ("".*Invoke-VoiceTroll"") OR msg REGEXP ("".*Set-Wallpaper"") OR msg REGEXP ("".*Invoke-InveighRelay"") OR msg REGEXP ("".*Invoke-PsExec"") OR msg REGEXP ("".*Invoke-SSHCommand"") OR msg REGEXP ("".*Get-SecurityPackages"") OR msg REGEXP ("".*Install-SSP"") OR msg REGEXP ("".*Invoke-BackdoorLNK"") OR msg REGEXP ("".*PowerBreach"") OR msg REGEXP ("".*Get-SiteListPassword"") OR msg REGEXP ("".*Get-System"") OR msg REGEXP ("".*Invoke-BypassUAC"") OR msg REGEXP ("".*Invoke-Tater"") OR msg REGEXP ("".*Invoke-WScriptBypassUAC"") OR msg REGEXP ("".*PowerUp"") OR msg REGEXP ("".*PowerView"") OR msg REGEXP ("".*Get-RickAstley"") OR msg REGEXP ("".*Find-Fruit"") OR msg REGEXP ("".*HTTP-Login"") OR msg REGEXP ("".*Find-TrustedDocuments"") OR msg REGEXP ("".*Invoke-Paranoia"") OR msg REGEXP ("".*Invoke-WinEnum"") OR msg REGEXP ("".*Invoke-ARPScan"") OR msg REGEXP ("".*Invoke-PortScan"") OR msg REGEXP ("".*Invoke-ReverseDNSLookup"") OR msg REGEXP ("".*Invoke-SMBScanner"") OR msg REGEXP ("".*Invoke-Mimikittenz"") ) AND msg NOT REGEXP ("".*Get-SystemDriveInfo"") |
| System Exploit Detected by Network IPS | Security | Detects an IPS detected exploit (e.g. Buffer overflow, Privilege escalation) optionally preceded by a Reconnaissance | System Exploit Detected by Network IPS | eventType IN (Group@PH_SYS_EVENT_Reconn) |
| Linux: Netcat Process Activity | Security | Netcat Process Activity detected. Netcat is often used as a persistence mechanism by exporting a reverse shell or by serving a shell on a listening port. Netcat is also sometimes used for data exfiltration. Some normal use of this program, while uncommon, may originate from scripts, automation tools, and frameworks. This requires process monitoring via FortiSIEM Linux agent. | Linux: Netcat Process Activity | eventType = ""LINUX_PROCESS_EXEC"" AND procName IN (""nc"", ""ncat"", ""netcat"", ""netcat.openbsd"", ""netcat.traditional"") |
| Spyware Found And Cleaned | Security | Detects that host or gateway IPS found and cleaned spyware installed on hosts. Spyware are malicious applications that can be installed on hosts without the knowledge of the user. Once installed, a spyware automatically run each time the host is started, records URLs visited, user name, password and credit card information and send this information to spyware authors | Spyware Found And Cleaned | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_Spyware_Remedy_Success) |
| Windows: Computer System Reconnaissance Via Wmic.EXE | Security | Detects execution of wmic utility with the ""computersystem"" flag in order to obtain information about the machine such as the domain, username, model, etc. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_recon_computersystem.yml | Windows: Computer System Reconnaissance Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\wmic\.exe"" OR srcFileName=""wmic.exe"") AND command REGEXP "".*computersystem.*"" |
| Windows: Excel Network Connections | Security | Detects an Excel process that opens suspicious network connections to non-private IP addresses, and attempts to cover CVE-2021-42292. You will likely have to tune this rule for your organization, but it is certainly something you should look for and could have applications for malicious activity beyond CVE-2021-42292. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_excel_outbound_network_connection.yml | Windows: Excel Network Connections | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (procName REGEXP "".*\\excel\.exe"" AND initiated=""true"" AND isIpv6=""false"") AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Windows: Cmd.EXE Missing Space Characters Execution Anomaly | Security | Detects Windows command lines that miss a space before or after the /c flag when running a command using the cmd.exe. This could be a sign of obfuscation of a fat finger problem (typo by the developer). . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_no_space_execution.yml | Windows: Cmd.EXE Missing Space Characters Execution Anomaly | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*\""cmd/c.*|.*\""cmd/k.*|.*\""cmd/r.*|.*\\cmd/c.*|.*\\cmd/k.*|.*\\cmd/r.*|.*cmd\.exe/c.*|.*cmd\.exe/k.*|.*cmd\.exe/r.*"" OR command REGEXP "".*/cbitsadmin.*|.*/ccertutil.*|.*/cpowershell.*|.*/cschtasks.*|.*/cwhoami.*|.*/kbitsadmin.*|.*/kcertutil.*|.*/kpowershell.*|.*/kschtasks.*|.*/kwhoami.*"" OR command REGEXP "".*cmd /c.*|.*cmd /k.*|.*cmd /r.*|.*cmd\.exe /c.*|.*cmd\.exe /k.*|.*cmd\.exe /r.*"") AND ((command NOT REGEXP "".*cmd /c .*|.*cmd /k .*|.*cmd /r .*|.*cmd\.exe /c .*|.*cmd\.exe /k .*|.*cmd\.exe /r .*"") AND (command NOT REGEXP "".*AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\node_modules.*"" AND command NOT REGEXP "".*cmd\.exe/c \."" AND command!=""cmd.exe /c"")) |
| Windows: Hidden Powershell in Link File Pattern | Security | Detects events that appear when a user click on a link file with a powershell command in it. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_embed_exe_lnk.yml | Windows: Hidden Powershell in Link File Pattern | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName=""C:\\Windows\\explorer.exe"" AND procName=""C:\\Windows\\System32\\cmd.exe"" AND command REGEXP "".*powershell.*"" AND command REGEXP "".*\.lnk.*"" |
| Windows: Invoke-Obfuscation COMPRESS OBFUSCATION: Sysmon | Security | Detects Obfuscated Powershell via COMPRESS OBFUSCATION. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_compress.yml | Windows: Invoke-Obfuscation COMPRESS OBFUSCATION: Sysmon | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*new-object.*"" AND command REGEXP "".*text\.encoding\]::ascii.*"" AND command REGEXP "".*readtoend\(.*|.*system\.io\.compression\.deflatestream.*|.*system\.io\.streamreader.*"" |
| Windows: Equation Editor Network Connection | Security | Detects network connections from Equation Editor. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_eqnedt.yml | Windows: Equation Editor Network Connection | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND procName REGEXP "".*\\eqnedt32\.exe"" |
| Windows: HackTool - Koadic Execution | Security | Detects command line parameters used by Koadic hack tool. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_koadic.yml | Windows: HackTool - Koadic Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe"" OR srcFileName=""Cmd.Exe"") AND (command REGEXP "".*/q.*"" AND command REGEXP "".*/c.*"" AND command REGEXP "".*chcp.*"") |
| Windows: HackTool - Potential Impacket Lateral Movement Activity | Security | Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_impacket_lateral_movement.yml | Windows: HackTool - Potential Impacket Lateral Movement Activity | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*cmd\.exe.*"" AND command REGEXP "".*&1.*"" AND ((parentProcName REGEXP "".*\\explorer\.exe|.*\\mmc\.exe|.*\\services\.exe|.*\\wmiprvse\.exe"" AND command REGEXP "".*/Q.*"" AND command REGEXP "".*/c.*"" AND command REGEXP "".*\\\\127\.0\.0\.1\\\.*"") OR (parentCommand REGEXP "".*svchost\.exe -k netsvcs.*|.*taskeng\.exe.*"" AND command REGEXP "".*/C.*"" AND command REGEXP "".*Windows\\Temp\\.*"")) |
| Windows: HackTool - CrackMapExec PowerShell Obfuscation | Security | The CrachMapExec pentesting framework implements a PowerShell obfuscation with some static strings detected by this rule. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_powershell_obfuscation.yml | Windows: HackTool - CrackMapExec PowerShell Obfuscation | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".*\( \$PSHome\[.*\]\+\$PSHOME\[.*\]\+.*|.*\( \$ShellId\[1\]\+\$ShellId\[13\]\+'x'\).*|.*\( \$env:ComSpec\[4,.*,25\]-Join''\).*|.*\( \$env:Public\[13\]\+\$env:Public\[5\]\+'x'\).*|.*\[1,3\]\+'x'-Join''\).*|.*join.*split.*"" |
| Windows: DotNET Assembly DLL Loaded Via Office Application | Security | Detects any assembly DLL being loaded by an Office Product. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_office_dotnet_assembly_dll_load.yml | Windows: DotNET Assembly DLL Loaded Via Office Application | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\excel\.exe|.*\\mspub\.exe|.*\\onenote\.exe|.*\\onenoteim\.exe|.*\\outlook\.exe|.*\\powerpnt\.exe|.*\\winword\.exe"" AND loadedProcName REGEXP ""C:\\Windows\\assembly\\.*"" |
| Windows: ConvertTo-SecureString Cmdlet Usage Via CommandLine | Security | Detects usage of the ""ConvertTo-SecureString"" cmdlet via the commandline. Which is fairly uncommon and could indicate potential suspicious activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_cmdline_convertto_securestring.yml | Windows: ConvertTo-SecureString Cmdlet Usage Via CommandLine | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".*ConvertTo-SecureString.*"" |
| Windows: CVE-2022-24527 Microsoft Connected Cache LPE | Security | Detects files created during the local privilege exploitation of CVE-2022-24527 Microsoft Connected Cache. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_cve_2022_24527_lpe.yml | Windows: CVE-2022-24527 Microsoft Connected Cache LPE | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*WindowsPowerShell\\Modules\\webAdministration\\webAdministration\.psm1"" AND (user NOT REGEXP "".*AUTHORI.*|.*AUTORI.*"") |
| Windows: CobaltStrike Service Installations: System Log | Security | Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement. Cobalt Strike (https://www.cobaltstrike.com/) is an adversary simulation tool with a post-exploitation agent and covert channels to emulate a quiet long-term embedded actor in your network. It uses Process injection, a defense evasion technique that runs custom code within the address space of another process, thereby avoiding detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_cobaltstrike_service_installs.yml | Windows: CobaltStrike Service Installations: System Log | (eventType=""Win-System-Service-Control-Manager-7045"") AND ((serviceFileName REGEXP "".*ADMIN\$.*"" AND serviceFileName REGEXP "".*\.exe.*"") OR (serviceFileName REGEXP "".*%COMSPEC%.*"" AND serviceFileName REGEXP "".*start.*"" AND serviceFileName REGEXP "".*powershell.*"") OR serviceFileName REGEXP "".*powershell -nop -w hidden -encodedcommand.*"" OR serviceFileName REGEXP "".*JRVggKE5ldy1PYmplY3QgTmV0LldlYmNsaWVudCkuRG93bmxvYWRTdHJpbmcoJ2h0dHA6Ly8xMjcuMC4wLjE6.*|.*SUVYIChOZXctT2JqZWN0IE5ldC5XZWJjbGllbnQpLkRvd25sb2FkU3RyaW5nKCdodHRwOi8vMTI3LjAuMC4xO.*|.*lFWCAoTmV3LU9iamVjdCBOZXQuV2ViY2xpZW50KS5Eb3dubG9hZFN0cmluZygnaHR0cDovLzEyNy4wLjAuMT.*"") |
| Windows: Detection of PowerShell Execution via Sqlps.exe | Security | This rule detects execution of a PowerShell code through the sqlps.exe utility, which is included in the standard set of utilities supplied with the MSSQL Server. Script blocks are not logged in this case, so this utility helps to bypass protection mechanisms based on the analysis of these logs. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mssql_sqlps_susp_execution.yml | Windows: Detection of PowerShell Execution via Sqlps.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\sqlps\.exe"" OR ((procName REGEXP "".*\\sqlps\.exe"" OR srcFileName=""sqlps.exe"") AND (parentProcName NOT REGEXP "".*\\sqlagent\.exe""))) |
| Windows: Important Scheduled Task Deleted/Disabled | Security | Detects when adversaries stop services or processes by deleting or disabling their respective scheduled tasks in order to conduct data destructive activities. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_scheduled_task_delete_or_disable.yml | Windows: Important Scheduled Task Deleted/Disabled | (eventType IN (""Win-Security-4699"",""Win-Security-4701"") AND task REGEXP "".*\\Windows\\BitLocker.*|.*\\Windows\\ExploitGuard.*|.*\\Windows\\SystemRestore\\SR.*|.*\\Windows\\UpdateOrchestrator\\Schedule.*|.*\\Windows\\Windows Defender\\.*|.*\\Windows\\WindowsBackup\\.*|.*\\Windows\\WindowsUpdate\\.*"") AND ((eventType!=""Win-Security-4699"" OR user NOT REGEXP "".*\$"" OR task NOT REGEXP "".*\\Windows\\Windows Defender\\.*"")) |
| Windows: CLR DLL Loaded Via Office Applications | Security | Detects CLR DLL being loaded by an Office Product. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_office_dotnet_clr_dll_load.yml | Windows: CLR DLL Loaded Via Office Applications | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\excel\.exe|.*\\mspub\.exe|.*\\onenote\.exe|.*\\onenoteim\.exe|.*\\outlook\.exe|.*\\powerpnt\.exe|.*\\winword\.exe"" AND loadedProcName REGEXP "".*\\clr\.dll.*"" |
| Windows: Application Removed Via Wmic.EXE | Security | Uninstall an application with wmic. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_uninstall_application.yml | Windows: Application Removed Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\WMIC\.exe"" OR srcFileName=""wmic.exe"") AND command REGEXP "".*call.*|.*uninstall.*"" |
| Windows: Credential Dumping Tools Service Execution | Security | Detects well-known credential dumping tools execution via service execution events. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_mal_creddumper.yml | Windows: Credential Dumping Tools Service Execution | eventType=""Win-Sysmon-6-Driver-Loaded"" AND loadedProcName REGEXP "".*cachedump.*|.*dumpsvc.*|.*fgexec.*|.*gsecdump.*|.*mimidrv.*|.*pwdump.*|.*servpw.*"" |
| Windows: Active Directory Parsing DLL Loaded Via Office Application | Security | Detects DSParse DLL being loaded by an Office Product. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_office_dsparse_dll_load.yml | Windows: Active Directory Parsing DLL Loaded Via Office Application | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\excel\.exe|.*\\mspub\.exe|.*\\onenote\.exe|.*\\onenoteim\.exe|.*\\outlook\.exe|.*\\powerpnt\.exe|.*\\winword\.exe"" AND loadedProcName REGEXP "".*\\dsparse\.dll.*"" |
| Windows: Import PowerShell Modules From Suspicious Directories - ProcCreation | Security | Detects powershell scripts that import modules from suspicious directories. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_import_module_susp_dirs.yml | Windows: Import PowerShell Modules From Suspicious Directories - ProcCreation | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Import-Module '\$Env:Appdata\\.*|.*Import-Module '\$Env:Temp\\.*|.*Import-Module C:\\Users\\Public\\.*|.*Import-Module \""\$Env:Appdata\\.*|.*Import-Module \""\$Env:Temp\\.*|.*Import-Module \$Env:Appdata\\.*|.*Import-Module \$Env:Temp\\.*|.*ipmo '\$Env:Appdata\\.*|.*ipmo '\$Env:Temp\\.*|.*ipmo C:\\Users\\Public\\.*|.*ipmo \""\$Env:Appdata\\.*|.*ipmo \""\$Env:Temp\\.*|.*ipmo \$Env:Appdata\\.*|.*ipmo \$Env:Temp\\.*"" |
| Windows: Direct Syscall of NtOpenProcess | Security | Detects the usage of the direct syscall of NtOpenProcess which might be done from a CobaltStrike BOF. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_direct_syscall_ntopenprocess.yml | Windows: Direct Syscall of NtOpenProcess | eventType=""Win-Sysmon-10-ProcessAccess"" AND procPath REGEXP ""UNKNOWN.*"" AND ((targetProcName!=""C:\\Program Files\\Cylance\\Desktop\\CylanceUI.exe"" OR procName!=""C:\\Windows\\Explorer.EXE"") AND (targetProcName!=""C:\\Program Files (x86)\\Microsoft\\EdgeUpdate\\MicrosoftEdgeUpdate.exe"" OR procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\Temp\\.*"" OR procName NOT REGEXP "".*\\MicrosoftEdgeUpdate\.exe"") AND (targetProcName NOT REGEXP "".*vcredist_x64\.exe"" OR procName NOT REGEXP "".*vcredist_x64\.exe"") AND (targetProcName!=""C:\\Windows\\system32\\systeminfo.exe"" OR procName NOT REGEXP "".*setup64\.exe"") AND (targetProcName NOT REGEXP "".*AmazonSSMAgentSetup\.exe"" OR procName NOT REGEXP "".*AmazonSSMAgentSetup\.exe"") AND (targetProcName NOT REGEXP "".*C:\\Program Files\\Mozilla Firefox\\firefox\.exe"" OR procName NOT REGEXP "".*C:\\Program Files\\Mozilla Firefox\\firefox\.exe"") AND (targetProcName NOT REGEXP "".*\\AppData\\Local\\Programs\\Microsoft VS Code\\Code\.exe"" OR procName NOT REGEXP "".*\\AppData\\Local\\Programs\\Microsoft VS Code\\Code\.exe"") AND (targetProcName NOT REGEXP "".*C:\\Program Files\\Google\\Chrome\\Application\\chrome\.exe"" OR procName NOT REGEXP "".*C:\\Program Files\\Google\\Chrome\\Application\\chrome\.exe"") AND (targetProcName NOT REGEXP "".*C:\\Program Files \(x86\)\\Google\\Update\\GoogleUpdate\.exe"" OR procName NOT REGEXP "".*C:\\Program Files \(x86\)\\Google\\Update\\GoogleUpdate\.exe"") AND (targetProcName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams\\current\\Teams\.exe"" OR procName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams\\current\\Teams\.exe"") AND (targetProcName!=""C:\\Windows\\System32\\backgroundTaskHost.exe"" OR procName!=""C:\\Windows\\System32\\backgroundTaskHost.exe"") AND (targetProcName!=""C:\\Program Files (x86)\\CCleaner Browser\\Application\\CCleanerBrowser.exe"" OR procName!=""C:\\Program Files (x86)\\CCleaner Browser\\Application\\CCleanerBrowser.exe"") AND (targetProcName NOT REGEXP ""C:\\Users\\.*"" OR targetProcName NOT REGEXP "".*\\AppData\\Local\\Discord\\.*"" OR targetProcName NOT REGEXP "".*\\Discord\.exe"") AND (targetProcName!=""C:\\WINDOWS\\system32\\AUDIODG.EXE"") AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\yammerdesktop\\app-.*"" OR procName NOT REGEXP "".*\\Yammer\.exe"" OR targetProcName NOT REGEXP ""C:\\Users\\.*"" OR targetProcName NOT REGEXP "".*\\AppData\\Local\\yammerdesktop\\app-.*"" OR targetProcName NOT REGEXP "".*\\Yammer\.exe"" OR accessKeyId!=""0x1000"") AND (targetProcName NOT REGEXP "".*\\Evernote\\Evernote\.exe"")) |
| Windows: Cobalt Strike Service Installations: Security Log | Security | Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement. Cobalt Strike (https://www.cobaltstrike.com/) is an adversary simulation tool with a post-exploitation agent and covert channels to emulate a quiet long-term embedded actor in your network. It uses Process injection, a defense evasion technique that runs custom code within the address space of another process, thereby avoiding detection This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_cobaltstrike_service_installs.yml | Windows: Cobalt Strike Service Installations: Security Log | eventType=""Win-Security-4697"" AND ((serviceFileName REGEXP "".*ADMIN\$.*"" AND serviceFileName REGEXP "".*\.exe.*"") OR (serviceFileName REGEXP "".*%COMSPEC%.*"" AND serviceFileName REGEXP "".*start.*"" AND serviceFileName REGEXP "".*powershell.*"") OR serviceFileName REGEXP "".*powershell -nop -w hidden -encodedcommand.*"" OR serviceFileName REGEXP "".*JRVggKE5ldy1PYmplY3QgTmV0LldlYmNsaWVudCkuRG93bmxvYWRTdHJpbmcoJ2h0dHA6Ly8xMjcuMC4wLjE6.*|.*SUVYIChOZXctT2JqZWN0IE5ldC5XZWJjbGllbnQpLkRvd25sb2FkU3RyaW5nKCdodHRwOi8vMTI3LjAuMC4xO.*|.*lFWCAoTmV3LU9iamVjdCBOZXQuV2ViY2xpZW50KS5Eb3dubG9hZFN0cmluZygnaHR0cDovLzEyNy4wLjAuMT.*"") |
| Windows: Invoke-Obfuscation COMPRESS OBFUSCATION: Security Log | Security | Detects Obfuscated Powershell via COMPRESS OBFUSCATION. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_invoke_obfuscation_via_compress_services_security.yml | Windows: Invoke-Obfuscation COMPRESS OBFUSCATION: Security Log | eventType=""Win-Security-4697"" AND serviceFileName REGEXP "".*new-object.*"" AND serviceFileName REGEXP "".*text\.encoding\]::ascii.*"" AND serviceFileName REGEXP "".*readtoend.*"" AND serviceFileName REGEXP "".*system\.io\.compression\.deflatestream.*|.*system\.io\.streamreader.*"" |
| Windows: Dllhost Internet Connection | Security | Detects Dllhost that communicates with public IP addresses. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_dllhost_net_connections.yml | Windows: Dllhost Internet Connection | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND procName REGEXP "".*\\dllhost\.exe"" AND initiated=""true"" AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Windows: HackTool - Empire PowerShell Launch Parameters | Security | Detects suspicious powershell command line parameters used in Empire. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_empire_powershell_launch.yml | Windows: HackTool - Empire PowerShell Launch Parameters | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* -NoP -NonI -W Hidden -enc .*|.* -NoP -sta -NonI -W Hidden -Enc .*|.* -enc SQB.*|.* -noP -sta -w 1 -enc .*|.* -noP -sta -w 1 -enc.*|.* -nop -exec bypass -EncodedCommand .*"" |
| Windows: Credential Dumping Tools Service Execution - System | Security | Detects well-known credential dumping tools execution via service execution events. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_mal_creddumper.yml | Windows: Credential Dumping Tools Service Execution - System | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".*cachedump.*|.*dumpsvc.*|.*fgexec.*|.*gsecdump.*|.*mimidrv.*|.*pwdump.*|.*servpw.*"" |
| Windows: Created Files by Office Applications | Security | This rule will monitor executable and script file creation by office applications. Please add more file extensions or magic bytes to the logic of your choice. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_script_creation_by_office_using_file_ext.yml | Windows: Created Files by Office Applications | eventType=""Win-Sysmon-11-FileCreate"" AND (procName REGEXP "".*\\excel\.exe|.*\\powerpnt\.exe|.*\\winword\.exe"" AND fileName REGEXP "".*\.bat|.*\.com|.*\.dll|.*\.exe|.*\.ocx|.*\.proj|.*\.ps1|.*\.scr|.*\.sys|.*\.vbs"") AND ((fileName NOT REGEXP "".*C:\\Users\\.*"" OR fileName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Office\\.*"" OR fileName NOT REGEXP "".*\\WebServiceCache\\AllUsers.*"" OR fileName NOT REGEXP "".*\.com"") AND (procName NOT REGEXP "".*\\winword\.exe"" OR fileName NOT REGEXP "".*\\AppData\\Local\\Temp\\webexdelta\\.*"" OR fileName NOT REGEXP "".*\.dll|.*\.exe"") AND (fileName NOT REGEXP "".*\\AppData\\Local\\assembly\\tmp\\.*"" OR fileName NOT REGEXP "".*\.dll"")) |
| Windows: Change PowerShell Policies to an Insecure Level | Security | Detects use of executionpolicy option to set insecure policies. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_set_policies_to_unsecure_level.yml | Windows: Change PowerShell Policies to an Insecure Level | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".* -ep .*|.* -exec .*|.* -executionpolicy .*"" AND command REGEXP "".*RemoteSigned.*|.*Unrestricted.*|.*bypass.*"") AND (command NOT REGEXP "".*C:\\Program Files.*|.*C:\\ProgramData.*|.*\\AppData\\Roaming\\Code\\.*"") |
| Windows: Credential Dumping Tools Service Execution - Security | Security | Detects well-known credential dumping tools execution via service execution events. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_mal_creddumper.yml | Windows: Credential Dumping Tools Service Execution - Security | eventType=""Win-Security-4697"" AND serviceFileName REGEXP "".*cachedump.*|.*dumpsvc.*|.*fgexec.*|.*gsecdump.*|.*mimidrv.*|.*pwdump.*|.*servpw.*"" |
| Windows: HackTool - Default PowerSploit/Empire Scheduled Task Creation | Security | Detects the creation of a schtask via PowerSploit or Empire Default Configuration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_powersploit_empire_default_schtasks.yml | Windows: HackTool - Default PowerSploit/Empire Scheduled Task Creation | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".*/Create.*"" AND command REGEXP "".*powershell\.exe -NonI.*"" AND command REGEXP "".*/TN Updater /TR.*"" AND command REGEXP "".*/SC DAILY /ST.*|.*/SC HOURLY.*|.*/SC ONIDLE.*|.*/SC ONLOGON.*"" |
| Windows: Interactive AT Job | Security | Detects an interactive AT job, which may be used as a form of privilege escalation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_at_interactive_execution.yml | Windows: Interactive AT Job | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\at\.exe"" AND command REGEXP "".*interactive.*"" |
| Windows: Hardware Model Reconnaissance Via Wmic.EXE | Security | Detects the execution of WMIC with the ""csproduct"" which is used to obtain information such as hardware models and vendor information. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_recon_csproduct.yml | Windows: Hardware Model Reconnaissance Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\wmic\.exe"" OR srcFileName=""wmic.exe"") AND command REGEXP "".*csproduct.*"" |
| Windows: Invoke-Obfuscation CLIP Launcher: Sysmon | Security | Detects Obfuscated use of Clip.exe to execute PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_clip.yml | Windows: Invoke-Obfuscation CLIP Launcher: Sysmon | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*cmd.*"" AND command REGEXP "".*&&.*"" AND command REGEXP "".*clipboard\]::.*"" AND command REGEXP "".*-f.*"" AND command REGEXP "".*/c.*|.*/r.*"" |
| Windows: Exchange PowerShell Snap-Ins Usage | Security | Detects adding and using Exchange PowerShell snap-ins to export mailbox data. As seen used by HAFNIUM and APT27. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_snapins_hafnium.yml | Windows: Exchange PowerShell Snap-Ins Usage | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".*Add-PSSnapin.*"" AND command REGEXP "".*Microsoft\.Exchange\.Management\.PowerShell\.SnapIn.*|.*Microsoft\.Exchange\.Powershell\.Snapin.*"") AND ((parentProcName!=""C:\\Windows\\System32\\msiexec.exe"" OR command NOT REGEXP "".*\$exserver=Get-ExchangeServer \(\[Environment\]::MachineName\) -ErrorVariable exerr 2> \$null.*"")) |
| Windows: CVE-2021-26858 Exchange Exploitation | Security | Detects possible successful exploitation for vulnerability described in CVE-2021-26858 by looking for creation of non-standard files on disk by Exchange Serverâ€šÃ„Ã¶âˆšÃ‘âˆšÂ¥s Unified Messaging service which could indicate dropping web shells or other malicious content . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_cve_2021_26858_msexchange.yml | Windows: CVE-2021-26858 Exchange Exploitation | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*UMWorkerProcess\.exe"" AND (fileName NOT REGEXP "".*CacheCleanup\.bin|.*\.LOG|.*\.cfg|.*\.txt|.*cleanup\.bin"") |
| Windows: HandleKatz Duplicating LSASS Handle | Security | Detects HandleKatz opening LSASS to duplicate its handle to later dump the memory without opening any new handles. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_handlekatz_lsass_access.yml | Windows: HandleKatz Duplicating LSASS Handle | eventType=""Win-Sysmon-10-ProcessAccess"" AND targetProcName REGEXP "".*\\lsass\.exe"" AND accessKeyId=""0x1440"" AND procPath REGEXP ""C:\\Windows\\System32\\ntdll\.dll\+.*"" AND procPath REGEXP "".*\|UNKNOWN\(.*"" AND procPath REGEXP "".*\)"" |
| Windows: HackTool - CrackMapExec Execution Patterns | Security | Detects various execution patterns of the CrackMapExec pentesting framework. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_execution_patterns.yml | Windows: HackTool - CrackMapExec Execution Patterns | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*cmd\.exe /C .* > .*\\Temp\\.* 2>&1|.*cmd\.exe /C .* > \\\\.*\\.*\\.* 2>&1|.*cmd\.exe /Q /c .* 1> \\\\.*\\.*\\.* 2>&1"" AND command REGEXP "".*powershell\.exe -exec bypass -noni -nop -w 1 -C \"".*|.*powershell\.exe -noni -nop -w 1 -enc .*"" |
| Windows: CVE-2021-31979 CVE-2021-33771 Exploits by Sourgum | Security | Detects patterns as noticed in exploitation of Windows CVE-2021-31979 CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_cve_2021_31979_cve_2021_33771_exploits.yml | Windows: CVE-2021-31979 CVE-2021-33771 Exploits by Sourgum | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*C:\\Windows\\System32\\IME\\IMEJP\\imjpueact\.dll.*|.*C:\\Windows\\system32\\config\\config\\startwus\.dat.*|.*C:\\Windows\\system32\\config\\cy-GB\\Setup\\SKB\\InputMethod\\TupTask\.dat.*|.*C:\\Windows\\system32\\config\\spp\\ServiceState\\Recovery\\pac\.dat.*|.*C:\\Windows\\system32\\ime\\IMEJP\\WimBootConfigurations\.ini.*|.*C:\\Windows\\system32\\ime\\IMETC\\IMTCPROT\.DLL.*|.*C:\\Windows\\system32\\ime\\IMETC\\WimBootConfigurations\.ini.*|.*C:\\Windows\\system32\\ime\\SHARED\\WimBootConfigurations\.ini.*|.*C:\\Windows\\system32\\ime\\SHARED\\imecpmeid\.dll.*|.*C:\\Windows\\system32\\physmem\.sys.*"" |
| Windows: Conhost.exe CommandLine Path Traversal | Security | detects the usage of path traversal in conhost.exe indicating possible command/argument confusion/hijacking. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_conhost_path_traversal.yml | Windows: Conhost.exe CommandLine Path Traversal | eventType=""Win-Sysmon-1-Create-Process"" AND parentCommand REGEXP "".*conhost.*"" AND command REGEXP "".*/\.\./\.\./.*"" |
| Windows: Execute Code with Pester.bat | Security | Detects code execution via Pester.bat (Pester - Powershell Modulte for testing). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_pester_1.yml | Windows: Execute Code with Pester.bat | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND command REGEXP "".*Pester.*"" AND command REGEXP "".*Get-Help.*"") OR (procName REGEXP "".*\\cmd\.exe"" AND command REGEXP "".*pester.*"" AND command REGEXP "".*;.*"" AND command REGEXP "".*\?.*|.*help.*"")) |
| Windows: CMSTP Execution Process Access | Security | Detects various indicators of Microsoft Connection Manager Profile Installer execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_cmstp_execution_by_access.yml | Windows: CMSTP Execution Process Access | eventType=""Win-Sysmon-10-ProcessAccess"" AND procPath REGEXP "".*cmlua\.dll.*"" |
| Windows: GAC DLL Loaded Via Office Applications | Security | Detects any GAC DLL being loaded by an Office Product. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_office_dotnet_gac_dll_load.yml | Windows: GAC DLL Loaded Via Office Applications | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\excel\.exe|.*\\mspub\.exe|.*\\onenote\.exe|.*\\onenoteim\.exe|.*\\outlook\.exe|.*\\powerpnt\.exe|.*\\winword\.exe"" AND loadedProcName REGEXP ""C:\\Windows\\Microsoft\.NET\\assembly\\GAC_MSIL.*"" |
| Windows: Potential Persistence Via Microsoft Compatibility Appraiser | Security | Detects manual execution of the ""Microsoft Compatibility Appraiser"" task via schtasks. In order to trigger persistence stored in the ""\AppCompatFlags\TelemetryController"" registry key. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_persistence_windows_telemetry.yml | Windows: Potential Persistence Via Microsoft Compatibility Appraiser | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\schtasks\.exe"" OR srcFileName=""schtasks.exe"") AND (command REGEXP "".*run .*"" AND command REGEXP "".*\\Application Experience\\Microsoft Compatibility Appraiser.*"") |
| Windows: Mimikatz through Windows Remote Management | Security | Detects usage of mimikatz through WinRM protocol by monitoring access to lsass process by wsmprovhost.exe. Mimikatz is a open source malware program that is commonly used by hackers and security professionals to extract sensitive information, such as passwords and credentials, from a system's memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_mimikatz_trough_winrm.yml | Windows: Mimikatz through Windows Remote Management | eventType=""Win-Sysmon-10-ProcessAccess"" AND (targetProcName REGEXP "".*\\lsass\.exe"" AND procName=""C:\\Windows\\system32\\wsmprovhost.exe"") AND (accessKeyId!=""0x80000000"") |
| Windows: Microsoft Excel Add-In Loaded | Security | Detects Microsoft Excel loading an Add-In (.xll) file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_office_excel_xll_load.yml | Windows: Microsoft Excel Add-In Loaded | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\excel\.exe"" AND loadedProcName REGEXP "".*\.xll"" |
| Windows: Invoke-Obfuscation Obfuscated IEX Invocation: Sysmon | Security | Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_obfuscated_iex_commandline.yml | Windows: Invoke-Obfuscation Obfuscated IEX Invocation: Security Log | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP ""\\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\[|\\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\[|\\$VerbosePreference\\.ToString\\(|\\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}|\\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\[|\\*mdr\\*\\W\\s*\\)\\.Name|\\[String\\]\\s*\\$VerbosePreference"") |
| Windows: Potential CommandLine Path Traversal Via Cmd.EXE | Security | Detects potential path traversal attempt via cmd.exe. Could indicate possible command/argument confusion/hijacking. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_path_traversal.yml | Windows: Potential CommandLine Path Traversal Via Cmd.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((parentProcName REGEXP "".*\\cmd\.exe"" OR procName REGEXP "".*\\cmd\.exe"" OR srcFileName=""cmd.exe"") AND (parentCommand REGEXP "".*/c.*|.*/k.*|.*/r.*"" OR command REGEXP "".*/c.*|.*/k.*|.*/r.*"") AND (parentCommand=""/../../"" OR command REGEXP "".*/\.\./\.\./.*"")) AND ((command NOT REGEXP "".*\\Tasktop\\keycloak\\bin\\/\.\./\.\./jre\\bin\\java.*"")) |
| Windows: Potential Data Exfiltration Activity Via CommandLine Tools | Security | Detects the use of various CLI utilities exfiltrating data via web requests. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_data_exfiltration_via_cli.yml | Windows: Potential Data Exfiltration Activity Via CommandLine Tools | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\cmd\.exe|.*\\powershell\.exe|.*\\pwsh\.exe"" AND command REGEXP "".*Invoke-WebRequest.*|.*curl .*|.*iwr .*|.*wget .*"" AND command REGEXP "".* -ur.*"" AND command REGEXP "".* -me.*"" AND command REGEXP "".* -b.*"" AND command REGEXP "".* POST .*"") OR (procName REGEXP "".*\\curl\.exe"" AND command REGEXP "".*--ur.*"" AND command REGEXP "".* --data .*|.* -d .*"")) AND (command REGEXP "".*ToBase64String.*|.*hostname.*|.*ifconfig.*|.*net view.*|.*netstat.*|.*nltest.*|.*qprocess.*|.*sc query.*|.*systeminfo.*|.*tasklist.*|.*whoami.*"" OR (command REGEXP "".*type .*"" AND command REGEXP "".* > .*"" AND command REGEXP "".* C:\\.*"")) |
| Windows: Invoke-Obfuscation STDIN Launcher: System Log | Security | Detects Obfuscated use of stdin to execute PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_stdin_services.yml | Windows: Invoke-Obfuscation STDIN Launcher: Sysmon | (eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".*cmd.*"" AND serviceFileName REGEXP "".*powershell.*"" AND serviceFileName REGEXP "".*/c.*|.*/r.*"") AND (serviceFileName REGEXP "".*noexit.*"" OR (serviceFileName REGEXP "".*input.*"" AND serviceFileName REGEXP "".*\$.*"")) |
| Windows: Non Interactive PowerShell Process Spawned | Security | Detects non-interactive PowerShell activity by looking at the ""powershell"" process with a non-user GUI process such as ""explorer.exe"" as a parent. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_non_interactive_execution.yml | Windows: Non Interactive PowerShell Process Spawned | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND ((parentProcName NOT REGEXP "".*C:\\Windows\\SysWOW64\\explorer\.exe|.*C:\\Windows\\System32\\CompatTelRunner\.exe|.*C:\\Windows\\explorer\.exe"") AND (parentProcName!=""C:\\$WINDOWS.~BT\\Sources\\SetupHost.exe""))) AND ((parentProcName NOT REGEXP ""C:\\Users\\.*"" OR parentProcName NOT REGEXP "".*\\AppData\\Local\\Programs\\Microsoft VS Code\\Code\.exe"" OR parentCommand NOT REGEXP "".* --ms-enable-electron-run-as-node .*"")) |
| Windows: Invoke-Obfuscation STDIN Launcher: Security Log | Security | Detects Obfuscated use of stdin to execute PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_invoke_obfuscation_stdin_services_security.yml | Windows: Invoke-Obfuscation STDIN Launcher: Sysmon | eventType=""Win-Security-4697"" AND serviceFileName REGEXP "".*cmd.*"" AND serviceFileName REGEXP "".*powershell.*"" AND serviceFileName REGEXP "".*\$\{input\}.*|.*noexit.*"" AND serviceFileName REGEXP "".* /c .*|.* /r .*"" |
| Windows: Malicious Base64 Encoded PowerShell Keywords in Command Lines | Security | Detects base64 encoded strings used in hidden malicious PowerShell command lines. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_hidden_b64_cmd.yml | Windows: Malicious Base64 Encoded PowerShell Keywords in Command Lines | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".* hidden .*"" AND command REGEXP "".*0AZQBtAG0AbwB2AGUA.*|.*1lbW1vdm.*|.*4ARwBlAHQAQwBoAHUAbgBrA.*|.*5HZXRDaHVua.*|.*AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A.*|.*AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ.*|.*AEcAZQB0AEMAaAB1AG4Aaw.*|.*AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A.*|.*AGMAaAB1AG4AawBfAHMAaQB6AGUA.*|.*AGUAbQBtAG8AdgBlA.*|.*AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA.*|.*AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA.*|.*IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA.*|.*JABjAGgAdQBuAGsAXwBzAGkAegBlA.*|.*JGNodW5rX3Npem.*|.*JpdHNhZG1pbiAvdHJhbnNmZX.*|.*LgBHAGUAdABDAGgAdQBuAGsA.*|.*LkdldENodW5r.*|.*MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA.*|.*NyZWF0ZVJlbW90ZVRocmVhZ.*|.*Q3JlYXRlUmVtb3RlVGhyZWFk.*|.*QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA.*|.*QAYwBoAHUAbgBrAF8AcwBpAHoAZQ.*|.*QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA.*|.*R2V0Q2h1bm.*|.*RIUkVBRF9JTkZPNj.*|.*RjaHVua19zaXpl.*|.*SFJFQURfSU5GTzY0.*|.*SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA.*|.*SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A.*|.*SU8uQ29tcHJlc3Npb2.*|.*SU8uTWVtb3J5U3RyZWFt.*|.*Ty5Db21wcmVzc2lvb.*|.*Ty5NZW1vcnlTdHJlYW.*|.*VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA.*|.*VEhSRUFEX0lORk82N.*|.*Y2h1bmtfc2l6Z.*|.*YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg.*|.*Yml0c2FkbWluIC90cmFuc2Zlc.*|.*ZW1tb3Zl.*|.*aXRzYWRtaW4gL3RyYW5zZmVy.*|.*bQBlAG0AbQBvAHYAZQ.*|.*bWVtbW92Z.*|.*cmVhdGVSZW1vdGVUaHJlYW.*|.*kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA.*|.*kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg.*|.*lPLk1lbW9yeVN0cmVhb.*|.*lPLkNvbXByZXNzaW9u.*"" |
| Windows: Invoke-Obfuscation VAR Launcher: Sysmon | Security | Detects Obfuscated use of Environment Variables to execute PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_var.yml | Windows: Invoke-Obfuscation VAR Launcher: Sysmon | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*cmd.*"" AND command REGEXP "".*\""set.*"" AND command REGEXP "".*-f.*"" AND command REGEXP "".*/c.*|.*/r.*"" |
| Windows: Node Process Executions | Security | Detects the execution of other scripts using the Node executable packaged with Adobe Creative Cloud. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_node_adobe_creative_cloud_abuse.yml | Windows: Node Process Executions | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\Adobe Creative Cloud Experience\\libs\\node\.exe"" AND (command NOT REGEXP "".*Adobe Creative Cloud Experience\\js.*"") |
| Windows: Operator Bloopers Cobalt Strike Modules | Security | Detects Cobalt Strike module/commands accidentally entered in CMD shell. Cobalt Strike (https://www.cobaltstrike.com/) is an adversary simulation tool with a post-exploitation agent and covert channels to emulate a quiet long-term embedded actor in your network. It uses Process injection, a defense evasion technique that runs custom code within the address space of another process, thereby avoiding detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_bloopers_modules.yml | Windows: Operator Bloopers Cobalt Strike Modules | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""Cmd.Exe"" OR procName REGEXP "".*\\cmd\.exe"") AND command REGEXP "".*Invoke-Kerberoast.*|.*Invoke-Nightmare.*|.*Invoke-SMBAutoBrute.*|.*Invoke-ShareFinder.*|.*Invoke-UserHunter.*|.*av_query.*|.*zerologon.*"" |
| Windows: Invoke-Obfuscation Via Use Clip: System Log | Security | Detects Obfuscated Powershell via use Clip.exe in Scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_use_clip_services.yml | Windows: Invoke-Obfuscation Via Use Clip: System Log | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".*\(Clipboard\|i.*"" |
| Windows: Invoke-Obfuscation RUNDLL LAUNCHER: System Log | Security | Detects Obfuscated Powershell via RUNDLL LAUNCHER. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_rundll_services.yml | Windows: Invoke-Obfuscation RUNDLL LAUNCHER: System Log | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".*rundll32\.exe.*"" AND serviceFileName REGEXP "".*shell32\.dll.*"" AND serviceFileName REGEXP "".*shellexec_rundll.*"" AND serviceFileName REGEXP "".*powershell.*"" |
| Windows: Invoke-Obfuscation Via Use Clip: Sysmon | Security | Detects Obfuscated Powershell via use Clip.exe in Scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_use_clip.yml | Windows: Invoke-Obfuscation Via Use Clip: Sysmon | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*echo.*"" AND command REGEXP "".*clip.*"" AND command REGEXP "".*&&.*"" AND command REGEXP "".*clipboard.*|.*e`.*|.*i`.*|.*invoke.*|.*k`.*|.*n`.*|.*o`.*|.*v`.*"" |
| Windows: Invoke-Obfuscation VAR Launcher: Security Log | Security | Detects Obfuscated use of Environment Variables to execute PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_invoke_obfuscation_var_services_security.yml | Windows: Invoke-Obfuscation VAR Launcher: Sysmon | eventType=""Win-Security-4697"" AND serviceFileName REGEXP "".*cmd.*"" AND serviceFileName REGEXP "".*\""set.*"" AND serviceFileName REGEXP "".*-f.*"" AND serviceFileName REGEXP "".*/c.*|.*/r.*"" |
| Windows: Malicious Service Installations | Security | Detects known malicious service installs that only appear in cases of lateral movement, credential dumping, and other suspicious activities. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_mal_service_installs.yml | Windows: Malicious Service Installations | eventType=""Win-Security-4697"" AND serviceName=""javamtsup"" |
| Windows: Operator Bloopers Cobalt Strike Commands | Security | Detects use of Cobalt Strike commands accidentally entered in the CMD shell. Cobalt Strike (https://www.cobaltstrike.com/) is an adversary simulation tool with a post-exploitation agent and covert channels to emulate a quiet long-term embedded actor in your network. It uses Process injection, a defense evasion technique that runs custom code within the address space of another process, thereby avoiding detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_bloopers_cmd.yml | Windows: Operator Bloopers Cobalt Strike Commands | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""Cmd.Exe"" OR procName REGEXP "".*\\cmd\.exe"") AND (command REGEXP ""c:\\windows\\system32\\cmd\.exe.*|cmd .*|cmd\.exe.*"" AND command REGEXP "".*dcsync.*|.*execute-assembly.*|.*getsystem.*|.*logonpasswords.*|.*make_token.*|.*psinject.*|.*remote-exec.*|.*rev2self.*|.*spawnas.*"") |
| Windows: Invoke-Obfuscation COMPRESS OBFUSCATION: System Log | Security | Detects Obfuscated Powershell via COMPRESS OBFUSCATION. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_compress_services.yml | Windows: Invoke-Obfuscation COMPRESS OBFUSCATION: System Log | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".*new-object.*"" AND serviceFileName REGEXP "".*text\.encoding\]::ascii.*"" AND serviceFileName REGEXP "".*readtoend.*"" AND serviceFileName REGEXP "".*:system\.io\.compression\.deflatestream.*|.*system\.io\.streamreader.*"" |
| Windows: Persistence and Execution at Scale via GPO Scheduled Task | Security | Detect lateral movement using GPO scheduled task, usually used to deploy ransomware at scale. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_gpo_scheduledtasks.yml | Windows: Persistence and Execution at Scale via GPO Scheduled Task | eventType=""Win-Security-5145"" AND fileName REGEXP ""\\\\\*\\SYSVOL"" AND targetName REGEXP "".*ScheduledTasks\.xml"" AND osObjAccessType REGEXP "".*%%4417.*|.*WriteData.*"" |
| Windows: Login with WMI | Security | Detection of logins performed with WMI. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_susp_wmi_login.yml | Windows: Login with WMI | eventType=""Win-Security-4624"" AND procName REGEXP "".*\\WmiPrvSE\.exe"" |
| Windows: Invoke-Obfuscation STDIN Launcher: Sysmon | Security | Detects Obfuscated use of stdin to execute PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_stdin.yml | Windows: Invoke-Obfuscation STDIN Launcher: Sysmon | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*cmd.*"" AND command REGEXP "".*powershell.*"" AND command REGEXP "".*/c.*|.*/r.*"") AND (command REGEXP "".*noexit.*"" OR (command REGEXP "".*input.*"" AND command REGEXP "".*\$.*"")) |
| Windows: New Process Created Via Wmic.EXE | Security | Detects new process creation using WMIC via the ""process call create"" flag. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_process_creation.yml | Windows: New Process Created Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\wmic\.exe"" OR srcFileName=""wmic.exe"") AND (command REGEXP "".*process.*"" AND command REGEXP "".*call.*"" AND command REGEXP "".*create.*"") |
| Windows: LittleCorporal Generated Maldoc Injection | Security | Detects the process injection of a LittleCorporal generated Maldoc. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_littlecorporal_generated_maldoc.yml | Windows: LittleCorporal Generated Maldoc Injection | eventType=""Win-Sysmon-10-ProcessAccess"" AND procName REGEXP "".*\\winword\.exe"" AND procPath REGEXP "".*:\\Windows\\Microsoft\.NET\\Framework64\\v2\..*"" AND procPath REGEXP "".*UNKNOWN.*"" |
| Windows: Microsoft VBA For Outlook Addin Loaded Via Outlook | Security | Detects outlvba (Microsoft VBA for Outlook Addin) DLL being loaded by the outlook process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_office_outlook_outlvba_load.yml | Windows: Microsoft VBA For Outlook Addin Loaded Via Outlook | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\outlook\.exe"" AND loadedProcName REGEXP ""\\outlvba\.dll.*"" |
| Windows: Microsoft Excel Add-In Loaded From Uncommon Location | Security | Detects Microsoft Excel loading an Add-In (.xll) file from an uncommon location. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_office_excel_xll_susp_load.yml | Windows: Microsoft Excel Add-In Loaded From Uncommon Location | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\excel\.exe"" AND loadedProcName REGEXP "".*\\Desktop\\.*|.*\\Downloads\\.*|.*\\Perflogs\\.*|.*\\Temp\\.*|.*\\Users\\Public\\.*|.*\\Windows\\Tasks\\.*"" AND loadedProcName REGEXP "".*\.xll"" |
| Windows: Potential Encoded PowerShell Patterns In CommandLine | Security | Detects specific combinations of encoding methods in PowerShell via the commandline. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_encoding_patterns.yml | Windows: Potential Encoded PowerShell Patterns In CommandLine | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND ((command REGEXP "".*ToByte.*|.*ToDecimal.*|.*ToInt.*|.*ToSByte.*|.*ToSingle.*|.*ToUint.*"" AND command REGEXP "".*String.*|.*ToChar.*|.*ToString.*"") OR (command REGEXP "".*join.*"" AND (command REGEXP "".*char.*"" OR command REGEXP "".*split.*""))) |
| Windows: Invoke-Obfuscation Via Use Rundll32: Security Log | Security | Detects Obfuscated Powershell via use Rundll32 in Scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_invoke_obfuscation_via_use_rundll32_services_security.yml | Windows: Invoke-Obfuscation Via Use Rundll32: Security Log | eventType=""Win-Security-4697"" AND serviceFileName REGEXP "".*&&.*"" AND serviceFileName REGEXP "".*rundll32.*"" AND serviceFileName REGEXP "".*shell32\.dll.*"" AND serviceFileName REGEXP "".*shellexec_rundll.*"" AND serviceFileName REGEXP "".*comspec.*|.*iex.*|.*invoke.*|.*value.*"" |
| Windows: Invoke-Obfuscation Via Stdin: System Log | Security | Detects Obfuscated Powershell via Stdin in Scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_stdin_services.yml | Windows: Invoke-Obfuscation Via Stdin: System Log | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".*set.*"" AND serviceFileName REGEXP "".*&&.*"" AND serviceFileName REGEXP "".*environment.*|.*input.*|.*invoke.*"" |
| Windows: Invoke-Obfuscation Via Stdin: Security Log | Security | Detects Obfuscated Powershell via Stdin in Scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_invoke_obfuscation_via_stdin_services_security.yml | Windows: Invoke-Obfuscation Via Stdin: Security Log | eventType=""Win-Security-4697"" AND serviceFileName REGEXP "".*set.*"" AND serviceFileName REGEXP "".*&&.*"" AND serviceFileName REGEXP "".*\$\{input\).*|.*environment.*|.*invoke.*"" |
| Windows: Invoke-Obfuscation Via Use Rundll32: System Log | Security | Detects Obfuscated Powershell via use Rundll32 in Scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_use_rundll32_services.yml | Windows: Invoke-Obfuscation Via Use Rundll32: System Log | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".*&&.*"" AND serviceFileName REGEXP "".*rundll32.*"" AND serviceFileName REGEXP "".*shell32\.dll.*"" AND serviceFileName REGEXP "".*shellexec_rundll.*"" AND serviceFileName REGEXP "".*comspec.*|.*iex.*|.*invoke.*|.*value.*"" |
| Windows: Jlaive Usage For Assembly Execution In-Memory | Security | Detects the use of Jlaive to execute assemblies in a copied PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_jlaive_batch_execution.yml | Windows: Jlaive Usage For Assembly Execution In-Memory | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\cmd\.exe"" AND parentCommand REGEXP "".*\.bat"" AND command REGEXP "".*\.bat\.exe.*"" AND ((procName REGEXP "".*\\xcopy\.exe"" AND command REGEXP "".*powershell\.exe.*"") OR (procName REGEXP "".*\\xcopy\.exe"" AND command REGEXP "".*pwsh\.exe.*"") OR (procName REGEXP "".*\\attrib\.exe"" AND command REGEXP "".*\+s.*"" AND command REGEXP "".*\+h.*"")) |
| Windows: Invoke-Obfuscation Via Use MSHTA: Sysmon | Security | Detects Obfuscated Powershell via use MSHTA in Scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_use_mhsta.yml | Windows: Invoke-Obfuscation Via Use MSHTA: Sysmon | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*set.*"" AND command REGEXP "".*&&.*"" AND command REGEXP "".*mshta.*"" AND command REGEXP "".*vbscript:createobject.*"" AND command REGEXP "".*\.run.*"" AND command REGEXP "".*\(window\.close\).*"" |
| Windows: Local User Creation Via Powershell | Security | Detects creation of a local user via PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_create_local_user.yml | Windows: Local User Creation Via Powershell | eventType=""Win-PowerShell-4104"" AND msg CONTAIN ""New-LocalUser"" |
| Windows: Invoke-Obfuscation Via Stdin: Sysmon | Security | Detects Obfuscated Powershell via Stdin in Scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_stdin.yml | Windows: Invoke-Obfuscation Via Stdin: Sysmon | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*set.*"" AND command REGEXP "".*&&.*"" AND command REGEXP "".*environment.*|.*input.*|.*invoke.*"" |
| Windows: Invoke-Obfuscation Via Use MSHTA: System Log | Security | Detects Obfuscated Powershell via use MSHTA in Scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_use_mshta_services.yml | Windows: Invoke-Obfuscation Via Use MSHTA: System Log | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".*mshta.*"" AND serviceFileName REGEXP "".*vbscript:createobject.*"" |
| Windows: Invoke-Obfuscation Via Use Clip: Security Log | Security | Detects Obfuscated Powershell via use Clip.exe in Scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_invoke_obfuscation_via_use_clip_services_security.yml | Windows: Invoke-Obfuscation Via Use Clip: Security Log | eventType=""Win-Security-4697"" AND serviceFileName REGEXP "".*\(Clipboard\|i.*"" |
| Windows: PAExec Service Installation | Security | Detects PAExec service installation. PAExec is a remote administration tool designed as an alternative to Microsoft's PsExec. The tool is a small remote shell that includes functionality for copying files, remote execution, and fully interactive shell sessions with remote Windows machines without the need to install client software. It relies on the SMB protocol. The tool copies an executable to the hidden Admin$ share and then uses the Windows Service Control Manager API to start it as a service. The service uses named pipes, which connect back to the PAExec tool. PAExec is self-contained and doesn't use an installer. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_install_paexec.yml | Windows: PAExec Service Installation | (eventType=""Win-System-Service-Control-Manager-7045"") AND (serviceName REGEXP ""PAExec-.*"" OR serviceFileName REGEXP ""C:\\WINDOWS\\PAExec-.*"") |
| Windows: Java Running with Remote Debugging | Security | Detects a JAVA process running with remote debugging allowing more than just localhost to connect. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_java_remote_debugging.yml | Windows: Java Running with Remote Debugging | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*transport=dt_socket,address=.*"" AND command REGEXP "".*jdk1\..*|.*jre1\..*"") AND (command NOT REGEXP "".*address=127\.0\.0\.1.*|.*address=localhost.*"") |
| Windows: Invoke-Obfuscation Via Use MSHTA: Security Log | Security | Detects Obfuscated Powershell via use MSHTA in Scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_invoke_obfuscation_via_use_mshta_services_security.yml | Windows: Invoke-Obfuscation Via Use MSHTA: Security Log | eventType=""Win-Security-4697"" AND serviceFileName REGEXP "".*mshta.*"" AND serviceFileName REGEXP "".*vbscript:createobject.*"" AND serviceFileName REGEXP "".*\.run.*"" AND serviceFileName REGEXP "".*window\.close.*"" |
| Windows: PDQ Deploy Remote Adminstartion Tool Execution | Security | Detect use of PDQ Deploy remote admin tool. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pdqdeploy_execution.yml | Windows: PDQ Deploy Remote Adminstartion Tool Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (description=""PDQ Deploy Console"" OR product=""PDQ Deploy"" OR company=""PDQ.com"" OR srcFileName=""PDQDeployConsole.exe"") |
| Windows: Invoke-Obfuscation VAR LAUNCHER OBFUSCATION: Sysmon | Security | Detects Obfuscated Powershell via VAR++ LAUNCHER. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_var.yml | Windows: Invoke-Obfuscation VAR LAUNCHER OBFUSCATION: Sysmon | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*&&set.*"" AND command REGEXP "".*cmd.*"" AND command REGEXP "".*/c.*"" AND command REGEXP "".*-f.*"" AND command REGEXP "".*\{0\}.*|.*\{1\}.*|.*\{2\}.*|.*\{3\}.*|.*\{4\}.*|.*\{5\}.*"" |
| Windows: PowerShell Core DLL Loaded By Non PowerShell Process | Security | Detects loading of essential DLLs used by PowerShell, but not by the process powershell.exe. Detects behaviour similar to meterpreter's ""load powershell"" extension. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_dll_system_management_automation_susp_load.yml | Windows: PowerShell Core DLL Loaded By Non PowerShell Process | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\System\.Management\.Automation\.Dll|.*\\System\.Management\.Automation\.ni\.Dll"" AND ((procName NOT IN (""C:\\Program Files\\PowerShell\\7\\pwsh.exe"",""C:\\Windows\\System32\\dsac.exe"") AND procName NOT REGEXP "".*\\Citrix\\ConfigSync\\ConfigSyncRun\.exe|.*\\IDE\\devenv\.exe|.*\\Microsoft SQL Server Management Studio .*\\Common.*\\IDE\\Ssms\.exe|.*\\ServerManager\.exe|.*\\ServiceHub\.Host\.CLR\.x86\.exe|.*\\ServiceHub\.SettingsHost\.exe|.*\\ServiceHub\.VSDetouredHost\.exe|.*\\WINDOWS\\System32\\RemoteFXvGPUDisablement\.exe|.*\\WINDOWS\\System32\\sdiagnhost\.exe|.*\\mscorsvw\.exe|.*\\powershell\.exe|.*\\powershell_ise\.exe|.*\\runscripthelper\.exe|.*\\sqlps\.exe|.*\\syncappvpublishingserver\.exe|.*\\winrshost\.exe|.*\\wsmprovhost\.exe"" AND procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft Visual Studio\\.*|C:\\Program Files\\Microsoft Visual Studio\\.*"") AND (procName NOT REGEXP ""C:\\Windows\\Temp\\asgard2-agent\\.*"" OR procName NOT REGEXP "".*\\thor64\.exe|.*\\thor\.exe"") AND (procName IS NOT NULL)) |
| Windows: PowerShell Base64 Encoded IEX Cmdlet | Security | Detects usage of a base64 encoded ""IEX"" cmdlet in a process command line. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_base64_iex.yml | Windows: PowerShell Base64 Encoded IEX Cmdlet | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*JRVggKE5ld.*|.*JRVggKF.*|.*JRVgoKC.*|.*JRVgoTmV3.*|.*JRVgoW.*|.*SUVYIChOZX.*|.*SUVYIChb.*|.*SUVYKCgn.*|.*SUVYKE5ld.*|.*SUVYKF.*|.*aWV4IChOZX.*|.*aWV4IChb.*|.*aWV4KCgn.*|.*aWV4KE5ld.*|.*aWV4KF.*|.*lFWCAoTmV3.*|.*lFWCAoW.*|.*lFWCgoJ.*|.*lFWChOZX.*|.*lFWChb.*|.*lleCAoTmV3.*|.*lleCAoW.*|.*lleCgoJ.*|.*lleChOZX.*|.*lleChb.*|.*pZXggKE5ld.*|.*pZXggKF.*|.*pZXgoKC.*|.*pZXgoTmV3.*|.*pZXgoW.*"" OR command REGEXP "".*JAEUAWAAgACgATgBlAHcA.*|.*JAEUAWAAgACgAWw.*|.*SQBFAFgAIAAoAE4AZQB3A.*|.*SQBFAFgAIAAoAFsA.*|.*aQBlAHgAIAAoAE4AZQB3A.*|.*aQBlAHgAIAAoAFsA.*|.*kARQBYACAAKABOAGUAdw.*|.*kARQBYACAAKABbA.*|.*kAZQB4ACAAKABOAGUAdw.*|.*kAZQB4ACAAKABbA.*|.*pAGUAeAAgACgATgBlAHcA.*|.*pAGUAeAAgACgAWw.*"") |
| Windows: Potential Unquoted Service Path Reconnaissance Via Wmic.EXE | Security | Detects known WMI recon method to look for unquoted service paths using wmic. Often used by pentester and attacker enumeration scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_recon_unquoted_service_search.yml | Windows: Potential Unquoted Service Path Reconnaissance Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""wmic.exe"" OR procName REGEXP "".*\\WMIC\.exe"") AND (command REGEXP "".* service get .*"" AND command REGEXP "".*name,displayname,pathname,startmode.*"") |
| Windows: PsExec Service File Creation | Security | Detects default PsExec service filename which indicates PsExec service installation and execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_tool_psexec.yml | Windows: PsExec Service File Creation | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\PSEXESVC\.exe"" |
| Windows: PsExec Tool Execution | Security | Detects PsExec service installation and execution events (service and Sysmon). PsExec is a light-weight telnet-replacement that lets you execute processes on other systems, complete with full interactivity for console applications, without having to manually install client software. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/other/win_tool_psexec.yml | Windows: PsExec Tool Execution | (eventType = ""Win-System-Service-Control-Manager-7045"" AND serviceName = ""PSEXESVC"" AND serviceFileName REGEXP "".*\\PSEXESVC\.exe"") OR ( eventType CONTAIN ""Win-System-Service-Control-Manager-7036-"" AND serviceName = ""PSEXESVC"") OR (eventType = ""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\PSEXESVC\.exe"" AND (user = ""SYSTEM"" OR user REGEXP "".*AUTHORI.*"")) OR (eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\PSEXESVC\.exe"") |
| Windows: PowerShell Script Run in AppData | Security | Detects a suspicious command line execution that invokes PowerShell with reference to an AppData folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_susp_ps_appdata.yml | Windows: PowerShell Script Run in AppData | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\powershell.*|.*\\pwsh.*|.*powershell\.exe.*|.*pwsh\.exe.*"" AND command REGEXP "".*/c .*"" AND command REGEXP "".*\\AppData\\.*"" AND command REGEXP "".*Local\\.*|.*Roaming\\.*"" |
| Windows: PUA - RunXCmd Execution | Security | Detects the use of the RunXCmd tool to execute commands with System or TrustedInstaller accounts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_runxcmd.yml | Windows: PUA - RunXCmd Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* /account=system .*|.* /account=ti .*"" AND command REGEXP "".*/exec=.*"" |
| Windows: Read Contents From Stdin Via Cmd.EXE | Security | Detect the use of ""<"" to read and potentially execute a file via cmd.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_stdin_redirect.yml | Windows: Read Contents From Stdin Via Cmd.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""Cmd.Exe"" OR procName REGEXP "".*\\cmd\.exe"") AND command REGEXP "".*<.*"" |
| Windows: PUA - NSudo Execution | Security | Detects the use of NSudo tool for command execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_nsudo.yml | Windows: PUA - NSudo Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\NSudoLC\.exe|.*\\NSudoLG\.exe|.*\\NSudo\.exe"" OR srcFileName IN (""NSudo.exe"",""NSudoLC.exe"",""NSudoLG.exe"")) AND command REGEXP "".*-M:H .*|.*-M:S .*|.*-M=H .*|.*-M=S .*|.*-P:E .*|.*-P=E .*|.*-ShowWindowMode:Hide.*|.*-U:E .*|.*-U:S .*|.*-U:T .*|.*-U=E .*|.*-U=S .*|.*-U=T .*"" |
| Windows: PowerShell Base64 Encoded Invoke Keyword | Security | Detects UTF-8 and UTF-16 Base64 encoded powershell 'Invoke-' calls. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_base64_invoke.yml | Windows: PowerShell Base64 Encoded Invoke Keyword | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".* -e.*"" AND command REGEXP "".*JAG4AdgBvAGsAZQAtA.*|.*JbnZva2Ut.*|.*SQBuAHYAbwBrAGUALQ.*|.*SW52b2tlL.*|.*kAbgB2AG8AawBlAC0A.*|.*ludm9rZS.*"" |
| Windows: Process Reconnaissance Via Wmic.EXE | Security | Detects the execution of ""wmic"" with the ""process"" flag, which adversary might use to list processes running on the compromised host or list installed software hotfixes and patches. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_recon_process.yml | Windows: Process Reconnaissance Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\WMIC\.exe"" OR srcFileName=""wmic.exe"") AND command REGEXP "".*process.*"") AND (command NOT REGEXP "".*call.*"" OR command NOT REGEXP "".*create.*"") |
| Windows: PowerShell Credential Prompt | Security | Detects PowerShell calling a credential prompt. This requires PowerShell script block logging turned on. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_prompt_credentials.yml | Windows: PowerShell Credential Prompt | eventType=""Win-PowerShell-4104"" AND msg REGEXP ( "".*PromptForCredential.*"" ) |
| Windows: Remote PowerShell Sessions | Security | Detects basic PowerShell Remoting (WinRM) by monitoring for network inbound connections to ports 5985 OR 5986. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_remote_powershell_session.yml | Windows: Remote PowerShell Sessions | eventType=""Win-Security-5156"" AND destIpPort IN (5985,5986) AND permissionLevelID=""44"" |
| Windows: PUA - NirCmd Execution | Security | Detects the use of NirCmd tool for command execution, which could be the result of legitimate administrative activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_nircmd.yml | Windows: PUA - NirCmd Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\NirCmd\.exe"" OR srcFileName=""NirCmd.exe"" OR command REGEXP "".* execmd .*|.* runinteractive .*|.*\.exe script .*|.*\.exe shexec .*"") OR (command REGEXP "".* exec .*|.* exec2 .*"" AND command REGEXP "".* hide .*|.* show .*"")) |
| Windows: Potential Persistence Via Powershell Search Order Hijacking - Task | Security | Detects suspicious powershell execution via a schedule task where the command ends with an suspicious flags to hide the powershell instance instead of executeing scripts or commands. This could be a sign of persistence via PowerShell ""Get-Variable"" technique as seen being used in Colibri Loader. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_powershell_persistence.yml | Windows: Potential Persistence Via Powershell Search Order Hijacking - Task | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName=""C:\\WINDOWS\\System32\\svchost.exe"" AND parentCommand REGEXP "".*-k netsvcs.*"" AND parentCommand REGEXP "".*-s Schedule.*"" AND command REGEXP "".* -ep bypass|.* -noni|.* -w hidden|.* -windowstyle hidden"" |
| Windows: ProcessHacker Privilege Elevation | Security | Detects a ProcessHacker tool that elevated privileges to a very high level. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_susp_proceshacker.yml | Windows: ProcessHacker Privilege Elevation | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceName REGEXP ""ProcessHacker.*"" AND user=""LocalSystem"" |
| Windows: PowerShell Base64 Encoded Reflective Assembly Load | Security | Detects base64 encoded .NET reflective loading of Assembly. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_base64_reflection_assembly_load.yml | Windows: PowerShell Base64 Encoded Reflective Assembly Load | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*AFsAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiAC.*|.*AWwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAK.*|.*BbAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgAp.*|.*WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAKQ.*|.*WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA.*|.*WwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA.*|.*bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgApA.*|.*bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA.*|.*bAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA.*|.*sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiACkA.*|.*sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA.*|.*sAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA.*"" |
| Windows: Remote PowerShell Session Host Process WinRM | Security | Detects remote PowerShell sections by monitoring for wsmprovhost (WinRM host process) as a parent or child process (sign of an active PowerShell remote session). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_winrm_remote_powershell_session_process.yml | Windows: Remote PowerShell Session Host Process WinRM | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\wsmprovhost\.exe"" OR parentProcName REGEXP "".*\\wsmprovhost\.exe"") |
| Windows: Scheduled Task Executing Powershell Encoded Payload from Registry | Security | Detects the creation of a schtask that executes a base64 encoded payload stored in the Windows Registry using PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml | Windows: Scheduled Task Executing Powershell Encoded Payload from Registry | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\schtasks\.exe"" OR srcFileName=""schtasks.exe"") AND (command REGEXP "".*/Create.*"" AND command REGEXP "".*FromBase64String.*"" AND command REGEXP "".*Get-ItemProperty.*"" AND command REGEXP "".*HKCU:.*|.*HKEY_.*|.*HKLM:.*|.*registry::.*"") |
| Windows: Potential Product Reconnaissance Via Wmic.EXE | Security | Detects the execution of WMIC in order to get a list of firewall and antivirus products. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_recon_product.yml | Windows: Potential Product Reconnaissance Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\wmic\.exe"" OR srcFileName=""wmic.exe"") AND command REGEXP "".*Product.*"" |
| Windows: Regsvr32 Network Activity | Security | Detects network connections and DNS queries initiated by Regsvr32.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_regsvr32_network_activity.yml | Windows: Regsvr32 Network Activity | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND procName REGEXP "".*\\regsvr32\.exe"" |
| Windows: Scheduled Task Deletion | Security | Detects scheduled task deletion events. Scheduled tasks are likely to be deleted if not used for persistence. Malicious Software often creates tasks directly under the root node e.g. \TASKNAME. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_scheduled_task_deletion.yml | Windows: Scheduled Task Deletion | eventType=""Win-Security-4699"" AND ((task!=""\\Microsoft\\Windows\\RemovalTools\\MRT_ERROR_HB"") AND (task NOT REGEXP "".*\\Mozilla\\Firefox Default Browser Agent .*"")) |
| Windows: Restricted Software Access By SRP | Security | Detects restricted access to applications by the Software Restriction Policies (SRP) policy. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/microsoft_windows_software_restriction_policies/win_software_restriction_policies_block.yml | Windows: Restricted Software Access By SRP | eventType IN (""Win-App-Microsoft-Windows-SoftwareRestrictionPolicies-865"",""Win-App-Microsoft-Windows-SoftwareRestrictionPolicies-866"",""Win-App-Microsoft-Windows-SoftwareRestrictionPolicies-867"",""Win-App-Microsoft-Windows-SoftwareRestrictionPolicies-868"",""Win-App-Microsoft-Windows-SoftwareRestrictionPolicies-882"") |
| Windows: PowerShell Base64 Encoded WMI Classes | Security | Detects calls to base64 encoded WMI class such as ""Win32_Shadowcopy"", ""Win32_ScheduledJob"", etc. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_base64_wmi_classes.yml | Windows: PowerShell Base64 Encoded WMI Classes | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND (command REGEXP "".*V2luMzJfU2hhZG93Y29we.*|.*VwBpAG4AMwAyAF8AUwBoAGEAZABvAHcAYwBvAHAAeQ.*|.*XAGkAbgAzADIAXwBTAGgAYQBkAG8AdwBjAG8AcAB5A.*|.*XaW4zMl9TaGFkb3djb3B5.*|.*cAaQBuADMAMgBfAFMAaABhAGQAbwB3AGMAbwBwAHkA.*|.*dpbjMyX1NoYWRvd2NvcH.*"" OR command REGEXP "".*V2luMzJfU2NoZWR1bGVkSm9i.*|.*VwBpAG4AMwAyAF8AUwBjAGgAZQBkAHUAbABlAGQASgBvAGIA.*|.*XAGkAbgAzADIAXwBTAGMAaABlAGQAdQBsAGUAZABKAG8AYg.*|.*XaW4zMl9TY2hlZHVsZWRKb2.*|.*cAaQBuADMAMgBfAFMAYwBoAGUAZAB1AGwAZQBkAEoAbwBiA.*|.*dpbjMyX1NjaGVkdWxlZEpvY.*"" OR command REGEXP "".*V2luMzJfUHJvY2Vzc.*|.*VwBpAG4AMwAyAF8AUAByAG8AYwBlAHMAcw.*|.*XAGkAbgAzADIAXwBQAHIAbwBjAGUAcwBzA.*|.*XaW4zMl9Qcm9jZXNz.*|.*cAaQBuADMAMgBfAFAAcgBvAGMAZQBzAHMA.*|.*dpbjMyX1Byb2Nlc3.*"" OR command REGEXP "".*V2luMzJfVXNlckFjY291bn.*|.*VwBpAG4AMwAyAF8AVQBzAGUAcgBBAGMAYwBvAHUAbgB0A.*|.*XAGkAbgAzADIAXwBVAHMAZQByAEEAYwBjAG8AdQBuAHQA.*|.*XaW4zMl9Vc2VyQWNjb3Vud.*|.*cAaQBuADMAMgBfAFUAcwBlAHIAQQBjAGMAbwB1AG4AdA.*|.*dpbjMyX1VzZXJBY2NvdW50.*"" OR command REGEXP "".*V2luMzJfTG9nZ2VkT25Vc2Vy.*|.*VwBpAG4AMwAyAF8ATABvAGcAZwBlAGQATwBuAFUAcwBlAHIA.*|.*XAGkAbgAzADIAXwBMAG8AZwBnAGUAZABPAG4AVQBzAGUAcg.*|.*XaW4zMl9Mb2dnZWRPblVzZX.*|.*cAaQBuADMAMgBfAEwAbwBnAGcAZQBkAE8AbgBVAHMAZQByA.*|.*dpbjMyX0xvZ2dlZE9uVXNlc.*"") |
| Windows: Potential Reconnaissance Activity Via GatherNetworkInfo.VBS | Security | Detects execution of the built-in script located in ""C:\Windows\System32\gatherNetworkInfo.vbs"". Which can be used to gather information about the target machine. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_gather_network_info.yml | Windows: Potential Reconnaissance Activity Via GatherNetworkInfo.VBS | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cscript\.exe|.*\\wscript\.exe"" OR srcFileName IN (""cscript.exe"",""wscript.exe"")) AND command REGEXP "".*gatherNetworkInfo\.vbs.*"" |
| Windows: PowerShell Scripts Installed as Services | Security | Detects powershell script installed as a Service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_powershell_script_installed_as_service.yml | Windows: PowerShell Scripts Installed as Services | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".*powershell.*|.*pwsh.*"" |
| Windows: Potential Product Class Reconnaissance Via Wmic.EXE | Security | Detects the execution of WMIC in order to get a list of firewall and antivirus products. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_recon_product_class.yml | Windows: Potential Product Class Reconnaissance Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\wmic\.exe"" OR srcFileName=""wmic.exe"") AND command REGEXP "".*AntiVirusProduct.*|.*FirewallProduct.*"" |
| Windows: Potential PowerShell Command Line Obfuscation | Security | Detects the PowerShell command lines with special characters. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_cmdline_special_characters.yml | Windows: Potential PowerShell Command Line Obfuscation | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND (command REGEXP "".*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*|.*\\^.*\\^.*\\^.*\\^.*\\^.*|.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*|.*`.*`.*`.*`.*`.*"")) AND ((parentProcName!=""C:\\Program Files\\Amazon\\SSM\\ssm-document-worker.exe"") AND (command NOT REGEXP "".*new EventSource\(\""Microsoft\.Windows\.Sense\.Client\.Management\"".*|.*public static extern bool InstallELAMCertificateInfo\(SafeFileHandle handle\);.*"")) |
| Windows: Remote Task Creation via ATSVC Named Pipe | Security | Detects remote task creation via at.exe or API interacting with ATSVC namedpipe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_atsvc_task.yml | Windows: Remote Task Creation via ATSVC Named Pipe | eventType=""Win-Security-5145"" AND fileName REGEXP ""\\\\\*\\IPC\$"" AND targetName=""atsvc"" AND osObjAccessType REGEXP "".*WriteData.*"" |
| Windows: Remote Access Tool Services Have Been Installed - System | Security | Detects service installation of different remote access tools software. These software are often abused by threat actors to perform. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_install_remote_access_software.yml | Windows: Remote Access Tool Services Have Been Installed - System | eventType IN (""Win-System-Service-Control-Manager-7036"",""Win-System-Service-Control-Manager-7045"") AND serviceName REGEXP "".*AmmyyAdmin.*|.*Atera.*|.*BASupportExpressSrvcUpdater.*|.*BASupportExpressStandaloneService.*|.*GoToAssist.*|.*GoToMyPC.*|.*LMIGuardianSvc.*|.*LogMeIn.*|.*Parsec.*|.*RManService.*|.*RPCPerformanceService.*|.*RPCService.*|.*SSUService.*|.*SplashtopRemoteService.*|.*TeamViewer.*|.*Zoho.*|.*chromoting.*|.*jumpcloud.*|.*monblanking.*|.*vncserver.*"" |
| Windows: Remote Access Tool Services Have Been Installed - Security | Security | Detects service installation of different remote access tools software. These software are often abused by threat actors to perform. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_service_install_remote_access_software.yml | Windows: Remote Access Tool Services Have Been Installed - Security | eventType=""Win-Security-4697"" AND serviceFileName REGEXP "".*AmmyyAdmin.*|.*Atera.*|.*BASupportExpressSrvcUpdater.*|.*BASupportExpressStandaloneService.*|.*GoToAssist.*|.*GoToMyPC.*|.*LMIGuardianSvc.*|.*LogMeIn.*|.*Parsec.*|.*RManService.*|.*RPCPerformanceService.*|.*RPCService.*|.*SSUService.*|.*SplashtopRemoteService.*|.*TeamViewer.*|.*Zoho.*|.*chromoting.*|.*jumpcloud.*|.*monblanking.*|.*vncserver.*"" |
| Windows: PowerShell Network Connections | Security | Detects a Powershell process that opens network connections - check for suspicious target ports and target systems - adjust to your environment (e.g. extend filters with company's ip range'). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_powershell_network_connection.yml | Windows: PowerShell Network Connections | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND initiated=""true"" AND isIpv6=""false"") AND destIpAddr != 127.0.0.1 AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Windows: PowerShell Scripts Run by a Services | Security | Detects powershell script installed as a Service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_powershell_script_installed_as_service.yml | Windows: PowerShell Scripts Run by a Services | eventType=""Win-Sysmon-6-Driver-Loaded"" AND loadedProcName REGEXP "".*powershell.*|.*pwsh.*"" |
| Windows: Regsvr32 DNS Activity | Security | Detects DNS queries initiated by Regsvr32.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_regsvr32_network_activity.yml | Windows: Regsvr32 DNS Activity | eventType=""Win-Sysmon-22-DNS-Query"" AND procName REGEXP "".*\\regsvr32\.exe"" |
| Windows: Scheduled Task Creation | Security | Detects the creation of scheduled tasks in user session. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_creation.yml | Windows: Scheduled Task Creation | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".* /create .*"") AND (user NOT REGEXP "".*AUTHORI.*|.*AUTORI.*"") |
| Windows: Potential PowerShell Obfuscation Via Reversed Commands | Security | Detects the presence of reversed PowerShell commands in the CommandLine. This is often used as a method of obfuscation by attackers. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_cmdline_reversed_strings.yml | Windows: Potential PowerShell Obfuscation Via Reversed Commands | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".*46esab.*|.*daolnwod.*|.*dnammoc.*|.*eddih.*|.*ekovn.*|.*eliFd.*|.*elifotevas.*|.*esnopser.*|.*etirw.*|.*golon.*|.*hcaerof.*|.*hctac.*|.*htaPpmeTteG.*|.*kaerb.*|.*llehsrewop.*|.*maerts.*|.*ptth.*|.*rahc.*|.*retupmoc.*|.*ssecorp.*|.*tcejbO.*|.*tneilCbeW.*|.*tneilc.*|.*tninon.*|.*tpircS.*"") AND ((parentProcName!=""C:\\Windows\\System32\\cmd.exe"" OR command NOT REGEXP "".*-EncodedCommand.*"" OR command NOT REGEXP "".*rahc.*"")) |
| Windows: Potential Powershell ReverseShell Connection | Security | Detects usage of the ""TcpClient"" class. Which can be abused to establish remote connections and reverse-shells. As seen used by the Nishang ""Invoke-PowerShellTcpOneLine"" reverse shell and other. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_reverse_shell_connection.yml | Windows: Potential Powershell ReverseShell Connection | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName IN (""PowerShell.EXE"",""pwsh.dll"") OR procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"") AND (command REGEXP "".* Net\.Sockets\.TCPClient.*"" AND command REGEXP "".*\.GetStream\(.*"" AND command REGEXP "".*\.Write\(.*"") |
| Windows: Remote PowerShell Session Network | Security | Detects remote PowerShell connections by monitoring network outbound connections to ports 5985 or 5986 from a non-network service account. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_remote_powershell_session_network.yml | Windows: Remote PowerShell Session Network | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (destIpPort IN (5985,5986) AND initiated=""true"") AND ((user NOT REGEXP "".*NETWORK SERVICE.*|.*NETZWERKDIENST.*|.*SERVICIO DE RED.*|.*SERVIZIO DI RETE.*"" AND user NOT REGEXP "".*SERVICE R.*"" OR user NOT REGEXP "".*SEAU.*"" AND srcIpAddr NOT IN (127.0.0.1,::1) AND procName NOT IN (""C:\\Program Files (x86)\\Avast Software\\Avast\\AvastSvc.exe"",""C:\\Program Files\\Avast Software\\Avast\\AvastSvc.exe"")) AND (srcIpAddr NOT IN (127.0.0.1,::1) OR destIpAddr NOT IN (127.0.0.1,::1))) |
| Windows: Potential PowerShell Downgrade Attack | Security | Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_downgrade_attack.yml | Windows: Potential PowerShell Downgrade Attack | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\powershell\.exe"" AND command REGEXP "".* -v 2 .*|.* -ve 2 .*|.* -ver 2 .*|.* -vers 2 .*|.* -versi 2 .*|.* -versio 2 .*|.* -version 2 .*"" |
| Windows: Potential WMI Lateral Movement WmiPrvSE Spawned PowerShell | Security | Detects Powershell as a child of the WmiPrvSE process. Which could be a sign of lateral movement via WMI. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmiprvse_spawns_powershell.yml | Windows: Potential WMI Lateral Movement WmiPrvSE Spawned PowerShell | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\WmiPrvSE\.exe"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) |
| Windows: PUA - NirCmd Execution As LOCAL SYSTEM | Security | Detects the use of NirCmd tool for command execution as SYSTEM user. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_nircmd_as_system.yml | Windows: PUA - NirCmd Execution As LOCAL SYSTEM | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* runassystem .*"" |
| Windows: Potential WinAPI Calls Via CommandLine | Security | Detects the use of WinAPI Functions via the commandline. As seen used by threat actors via the tool winapiexec. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_inline_win_api_access.yml | Windows: Potential WinAPI Calls Via CommandLine | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*AddSecurityPackage.*|.*AdjustTokenPrivileges.*|.*Advapi32.*|.*CloseHandle.*|.*CreateProcessWithToken.*|.*CreatePseudoConsole.*|.*CreateRemoteThread.*|.*CreateThread.*|.*CreateUserThread.*|.*DangerousGetHandle.*|.*DuplicateTokenEx.*|.*EnumerateSecurityPackages.*|.*FreeHGlobal.*|.*FreeLibrary.*|.*GetDelegateForFunctionPointer.*|.*GetLogonSessionData.*|.*GetModuleHandle.*|.*GetProcAddress.*|.*GetProcessHandle.*|.*GetTokenInformation.*|.*ImpersonateLoggedOnUser.*|.*LoadLibrary.*|.*MiniDumpWriteDump.*|.*OpenDesktop.*|.*OpenProcess.*|.*OpenProcessToken.*|.*OpenThreadToken.*|.*OpenWindowStation.*|.*PtrToString.*|.*QueueUserApc.*|.*ReadProcessMemory.*|.*RevertToSelf.*|.*RtlCreateUserThread.*|.*SetThreadToken.*|.*VirtualAlloc.*|.*VirtualFree.*|.*VirtualProtect.*|.*WaitForSingleObject.*|.*WriteInt32.*|.*WriteProcessMemory.*|.*ZeroFreeGlobalAllocUnicode.*|.*kernel32.*|.*memcpy.*|.*ntdll.*|.*secur32.*"" AND ((procName NOT REGEXP "".*\\MpCmdRun\.exe"" OR command NOT REGEXP "".*GetLoadLibraryWAddress32.*"")) |
| Windows: Usage Of Web Request Commands And Cmdlets | Security | Detects the use of various web request commands with commandline tools and Windows PowerShell cmdlets (including aliases) via CommandLine. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_web_request_cmd_and_cmdlets.yml | Windows: Usage Of Web Request Commands And Cmdlets | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Invoke-RestMethod.*|.*Invoke-WebRequest.*|.*Net\.WebClient.*|.*Resume-BitsTransfer.*|.*Start-BitsTransfer.*|.*WinHttp\.WinHttpRequest.*|.*\[System\.Net\.WebRequest\]::create.*|.*curl .*|.*iwr .*|.*wget .*"" |
| Windows: Suspicious Schtasks From Env Var Folder | Security | Detects Schtask creations that point to a suspicious folder or an environment variable often used by malware. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_env_folder.yml | Windows: Suspicious Schtasks From Env Var Folder | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".* /create .*"" AND command REGEXP "".*%AppData%.*|.*%Public%.*|.*C:\\Perflogs.*|.*C:\\Windows\\Temp.*|.*\\AppData\\Local\\.*|.*\\AppData\\Roaming\\.*|.*\\Users\\Public.*"") OR (parentCommand REGEXP "".*\\svchost\.exe -k netsvcs -p -s Schedule"" AND command REGEXP "".*%Public%.*|.*C:\\Perflogs.*|.*C:\\Windows\\Temp.*|.*\\Users\\Public.*"")) AND ((command NOT REGEXP "".*/Create /TN TVInstallRestore /TR.*|.*update_task\.xml.*"" AND parentCommand NOT REGEXP "".*unattended\.ini.*"") AND (command NOT REGEXP "".*/Create /Xml \""C:\\Users\\.*"" OR command NOT REGEXP "".*\\AppData\\Local\\Temp\\\.CR\..*"" OR command NOT REGEXP "".*Avira_Security_Installation\.xml.*"") AND (command NOT REGEXP "".*/Create /F /TN.*"" OR command NOT REGEXP "".*/Xml .*"" OR command NOT REGEXP "".*\\AppData\\Local\\Temp\\is-.*"" OR command NOT REGEXP "".*Avira_.*"" OR command NOT REGEXP "".*\.tmp\\MaintenanceTask\.xml.*|.*\.tmp\\SystrayAutostart\.xml.*|.*\.tmp\\UpdateFallbackTask\.xml.*|.*\.tmp\\WatchdogServiceControlManagerTimeout\.xml.*"") AND (command NOT REGEXP "".*\\AppData\\Local\\Temp\\.*"" OR command NOT REGEXP "".*/Create /TN \""klcp_update\"" /XML .*"" OR command NOT REGEXP "".*\\klcp_update_task\.xml.*"")) |
| Windows: VBA DLL Loaded Via Office Application | Security | Detects VB DLL's loaded by an office application. Which could indicate the presence of VBA Macros. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_office_vbadll_load.yml | Windows: VBA DLL Loaded Via Office Application | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\excel\.exe|.*\\mspub\.exe|.*\\onenote\.exe|.*\\onenoteim\.exe|.*\\outlook\.exe|.*\\powerpnt\.exe|.*\\winword\.exe"" AND loadedProcName REGEXP "".*\\VBE7INTL\.DLL|.*\\VBE7\.DLL|.*\\VBEUI\.DLL"" |
| Windows: Suspicious Reconnaissance Activity Via GatherNetworkInfo.VBS | Security | Detects execution of the built-in script located in ""C:\Windows\System32\gatherNetworkInfo.vbs"". Which can be used to gather information about the target machine. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_gather_network_info_execution.yml | Windows: Suspicious Reconnaissance Activity Via GatherNetworkInfo.VBS | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*gatherNetworkInfo\.vbs.*"" AND (procName NOT REGEXP "".*\\cscript\.exe|.*\\wscript\.exe"") |
| Windows: Suspicious Binary In User Directory Spawned From Office Application | Security | Detects an executable in the users directory started from one of the Microsoft Office suite applications (Word, Excel, PowerPoint, Publisher, Visio). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_spawn_exe_from_users_directory.yml | Windows: Suspicious Binary In User Directory Spawned From Office Application | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\EQNEDT32\.exe|.*\\EXCEL\.EXE|.*\\MSACCESS\.exe|.*\\MSPUB\.exe|.*\\POWERPNT\.exe|.*\\VISIO\.exe|.*\\WINWORD\.EXE"" AND procName REGEXP ""C:\\users\\.*"" AND procName REGEXP "".*\.exe"") AND (procName NOT REGEXP "".*\\Teams\.exe"") |
| Windows: Suspicious PowerShell Encoded Command Patterns | Security | Detects PowerShell command line patterns in combincation with encoded commands that often appear in malware infection chains. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_encoded_cmd_patterns.yml | Windows: Suspicious PowerShell Encoded Command Patterns | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.Exe"",""pwsh.dll"")) AND command REGEXP "".* -e .*|.* -en .*|.* -enc .*|.* -enco.*"" AND command REGEXP "".* IAB.*|.* JAB.*|.* PAA.*|.* SQBFAFgA.*|.* SUVYI.*|.* aQBlAHgA.*|.* aWV4I.*"") AND ((parentProcName NOT REGEXP "".*C:\\Packages\\Plugins\\Microsoft\.GuestConfiguration\.ConfigurationforWindows\\.*|.*\\gc_worker\.exe.*"")) |
| Windows: Service Started/Stopped Via Wmic.EXE | Security | Detects usage of wmic to start or stop a service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_service_manipulation.yml | Windows: Service Started/Stopped Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""wmic.exe"" OR procName REGEXP "".*\\WMIC\.exe"") AND (command REGEXP "".* service .*"" AND command REGEXP "".* call .*"" AND command REGEXP "".*startservice.*|.*stopservice.*"") |
| Windows: Suspicious Scheduled Task Update | Security | Detects update to a scheduled task event that contain suspicious keywords. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_scheduled_task_update.yml | Windows: Suspicious Scheduled Task Update | eventType=""Win-Security-4702"" AND task REGEXP "".*C:\\Perflogs\\.*|.*C:\\ProgramData\\.*|.*C:\\Temp\\.*|.*\\AppData\\Local\\Temp\\.*|.*\\AppData\\Roaming\\.*|.*\\Desktop\\.*|.*\\Downloads\\.*|.*\\Temporary Internet.*|.*\\Users\\Public\\.*|.*\\WINDOWS\\Temp\\.*"" AND task REGEXP "".*<Arguments>/c .*|.*<Arguments>/k .*|.*<Arguments>/r .*|.*bash .*|.*bash\.exe.*|.*bitsadmin.*|.*certutil.*|.*cmd</Command>.*|.*cmd\.exe</Command>.*|.*cscript.*|.*forfiles.*|.*hh\.exe.*|.*mshta.*|.*powershell.*|.*pwsh.*|.*regsvr32.*|.*rundll32.*|.*scrcons.*|.*scriptrunner.*|.*wmic .*|.*wmic\.exe.*|.*wscript.*"" |
| Windows: Suspicious Execution of Powershell with Base64 | Security | Commandline to launch powershell with a base64 payload. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_encode.yml | Windows: Suspicious Execution of Powershell with Base64 | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND command REGEXP "".* -e .*|.* -ec .*|.* -en .*|.* -enc .*|.* -enco.*"") AND ((command NOT REGEXP "".* -Encoding .*"") AND (parentProcName NOT REGEXP "".*C:\\Packages\\Plugins\\Microsoft\.GuestConfiguration\.ConfigurationforWindows\\.*|.*\\gc_worker\.exe.*"")) |
| Windows: Start Windows Service Via Net.EXE | Security | Detects the usage of the ""net.exe"" command to start a service using the ""start"" flag. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_start_service.yml | Windows: Start Windows Service Via Net.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR srcFileName IN (""net.exe"",""net1.exe"")) AND command REGEXP "".* start .*"" |
| Windows: Suspicious Mshta.EXE Execution Patterns | Security | Detects suspicious mshta process execution patterns. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mshta_susp_pattern.yml | Windows: Suspicious Mshta.EXE Execution Patterns | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\mshta\.exe"" OR srcFileName=""MSHTA.EXE"") AND (parentProcName REGEXP "".*\\cmd\.exe|.*\\cscript\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wscript\.exe"" AND command REGEXP "".*C:\\ProgramData\\.*|.*C:\\Users\\Public\\.*|.*C:\\Windows\\Temp\\.*|.*\\AppData\\Local\\.*"")) OR ((procName REGEXP "".*\\mshta\.exe"" OR srcFileName=""MSHTA.EXE"") AND (procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*"" AND command NOT REGEXP "".*\.hta.*|.*\.htm.*"" AND command NOT REGEXP "".*mshta|.*mshta\.exe""))) |
| Windows: Suspicious Outlook Child Process | Security | Detects a suspicious process spawning from an Outlook process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_outlook_susp_child_processes.yml | Windows: Suspicious Outlook Child Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\OUTLOOK\.EXE"" AND procName REGEXP "".*\\AppVLP\.exe|.*\\bash\.exe|.*\\cmd\.exe|.*\\cscript\.exe|.*\\forfiles\.exe|.*\\hh\.exe|.*\\mftrace\.exe|.*\\msbuild\.exe|.*\\msdt\.exe|.*\\mshta\.exe|.*\\msiexec\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\schtasks\.exe|.*\\scrcons\.exe|.*\\scriptrunner\.exe|.*\\sh\.exe|.*\\svchost\.exe|.*\\wmic\.exe|.*\\wscript\.exe"" |
| Windows: T1047 Wmiprvse Wbemcomn DLL Hijack | Security | Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\Windows\System32\wbem\` directory over the network for a WMI DLL Hijack scenario. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_wmiprvse_wbemcomn_dll_hijack.yml | Windows: T1047 Wmiprvse Wbemcomn DLL Hijack | (eventType=""Win-Security-5145"" AND targetName REGEXP "".*\\wbem\\wbemcomn\.dll"") AND (user NOT REGEXP "".*\$"") |
| Windows: Suspicious Add Scheduled Task Parent | Security | Detects suspicious scheduled task creations from a parent stored in a temporary folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_parent.yml | Windows: Suspicious Add Scheduled Task Parent | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".*/Create .*"" AND parentProcName REGEXP "".*\\AppData\\Local\\.*|.*\\AppData\\Roaming\\.*|.*\\Temporary Internet.*|.*\\Users\\Public\\.*"") AND ((command NOT REGEXP "".*unattended\.ini.*|.*update_task\.xml.*"")) |
| Windows: Schtasks From Suspicious Folders | Security | Detects scheduled task creations that have suspicious action command and folder combinations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_folder_combos.yml | Windows: Schtasks From Suspicious Folders | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\schtasks\.exe"" OR srcFileName=""schtasks.exe"") AND command REGEXP "".* /create .*"" AND command REGEXP "".*cmd /c .*|.*cmd /k .*|.*cmd /r .*|.*cmd\.exe /c .*|.*cmd\.exe /k .*|.*cmd\.exe /r .*|.*powershell.*|.*pwsh.*"" AND command REGEXP "".*%ProgramData%.*|.*C:\\ProgramData\\.*"" |
| Windows: Suspicious Schtasks Schedule Type With High Privileges | Security | Detects scheduled task creations or modification to be run with high privileges on a suspicious schedule type. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_schedule_type_system.yml | Windows: Suspicious Schtasks Schedule Type With High Privileges | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\schtasks\.exe"" OR srcFileName=""schtasks.exe"") AND command REGEXP "".* ONCE .*|.* ONIDLE .*|.* ONLOGON .*|.* ONSTART .*"" AND command REGEXP "".* SYSTEM.*|.*HIGHEST.*|.*NT AUT.*"" |
| Windows: Suspicious Encoded And Obfuscated Reflection Assembly Load Function Call | Security | Detects suspicious base64 encoded and obfuscated ""LOAD"" keyword used in .NET ""reflection.assembly"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_base64_reflection_assembly_load_obfusc.yml | Windows: Suspicious Encoded And Obfuscated Reflection Assembly Load Function Call | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*6ADoAKAAiAEwAIgArACIAbwBhAGQAIgApA.*|.*6ADoAKAAiAEwAbwAiACsAIgBhAGQAIgApA.*|.*6ADoAKAAiAEwAbwBhACIAKwAiAGQAIgApA.*|.*6ADoAKAAnAEwAJwArACcAbwBhAGQAJwApA.*|.*6ADoAKAAnAEwAbwAnACsAJwBhAGQAJwApA.*|.*6ADoAKAAnAEwAbwBhACcAKwAnAGQAJwApA.*|.*OgA6ACgAIgBMACIAKwAiAG8AYQBkACIAKQ.*|.*OgA6ACgAIgBMAG8AIgArACIAYQBkACIAKQ.*|.*OgA6ACgAIgBMAG8AYQAiACsAIgBkACIAKQ.*|.*OgA6ACgAJwBMACcAKwAnAG8AYQBkACcAKQ.*|.*OgA6ACgAJwBMAG8AJwArACcAYQBkACcAKQ.*|.*OgA6ACgAJwBMAG8AYQAnACsAJwBkACcAKQ.*|.*oAOgAoACIATAAiACsAIgBvAGEAZAAiACkA.*|.*oAOgAoACIATABvACIAKwAiAGEAZAAiACkA.*|.*oAOgAoACIATABvAGEAIgArACIAZAAiACkA.*|.*oAOgAoACcATAAnACsAJwBvAGEAZAAnACkA.*|.*oAOgAoACcATABvACcAKwAnAGEAZAAnACkA.*|.*oAOgAoACcATABvAGEAJwArACcAZAAnACkA.*"" |
| Windows: Suspicious Scheduled Task Creation | Security | Detects suspicious scheduled task creation events. Based on attributes such as paths, commands line flags, etc. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_scheduled_task_creation.yml | Windows: Suspicious Scheduled Task Creation | eventType=""Win-Security-4698"" AND task REGEXP "".*C:\\Perflogs\\.*|.*C:\\ProgramData\\.*|.*C:\\Temp\\.*|.*\\AppData\\Local\\Temp\\.*|.*\\AppData\\Roaming\\.*|.*\\Desktop\\.*|.*\\Downloads\\.*|.*\\Temporary Internet.*|.*\\Users\\Public\\.*|.*\\WINDOWS\\Temp\\.*"" AND task REGEXP "".*<Arguments>/c .*|.*<Arguments>/k .*|.*<Arguments>/r .*|.*bash .*|.*bash\.exe.*|.*bitsadmin.*|.*certutil.*|.*cmd</Command>.*|.*cmd\.exe</Command>.*|.*cscript.*|.*forfiles.*|.*hh\.exe.*|.*mshta.*|.*powershell.*|.*pwsh.*|.*regsvr32.*|.*rundll32.*|.*scrcons.*|.*scriptrunner.*|.*wmic .*|.*wmic\.exe.*|.*wscript.*"" |
| Windows: Suspicious WSMAN Provider Image Loads | Security | Detects signs of potential use of the WSMAN provider from uncommon processes locally and remote execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_wsman_provider_image_load.yml | Windows: Suspicious WSMAN Provider Image Loads | eventType=""Win-Sysmon-7-Image-Loaded"" AND (((loadedProcName REGEXP "".*\\Microsoft\.WSMan\.Management\.ni\.dll|.*\\WsmAuto\.dll|.*\\WsmSvc\.dll"" OR srcFileName IN (""Microsoft.WSMan.Management.dll"",""WSMANAUTOMATION.DLL"",""WsmSvc.dll"")) OR (procName REGEXP "".*\\svchost\.exe"" AND srcFileName=""WsmWmiPl.dll"")) AND ((procName NOT REGEXP "".*C:\\Windows\\System32\\sdiagnhost\.exe|.*C:\\Windows\\System32\\services\.exe|.*\\powershell\.exe"") AND (command NOT REGEXP "".*svchost\.exe -k GraphicsPerfSvcGroup -s GraphicsPerfSvc.*|.*svchost\.exe -k NetworkService -p -s Wecsvc.*|.*svchost\.exe -k netsvcs -p -s BITS.*|.*svchost\.exe -k netsvcs.*"") AND (procName NOT REGEXP ""C:\\Windows\\Microsoft\.NET\\Framework64\\v.*|C:\\Windows\\Microsoft\.NET\\Framework\\v.*"" OR procName NOT REGEXP "".*\\mscorsvw\.exe"") AND (procName NOT IN (""C:\\Windows\\System32\\Configure-SMRemoting.exe"",""C:\\Windows\\System32\\ServerManager.exe"")) AND (procName NOT REGEXP ""C:\\Windows\\Temp\\asgard2-agent\\.*"") AND (procName NOT REGEXP ""C:\\Program Files\\Citrix\\.*"") AND (procName NOT REGEXP "".*\\powershell_ise\.exe"") AND (procName NOT REGEXP ""C:\\\$WINDOWS\.~BT\\Sources\\.*""))) AND ((procName NOT REGEXP "".*\\svchost\.exe"" OR command IS NOT NULL)) |
| Windows: Suspicious PowerShell Download and Execute Pattern | Security | Detects suspicious PowerShell download patterns that are often used in malicious scripts, stagers or downloaders (make sure that your backend applies the strings case-insensitive). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_susp_download_patterns.yml | Windows: Suspicious PowerShell Download and Execute Pattern | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* -c \(New-Object System\.Net\.WebClient\)\.DownloadFile\(.*|.* -command \(New-Object System\.Net\.WebClient\)\.DownloadFile\(.*|.*IEX \(New-Object Net\.WebClient\)\.DownloadString.*|.*IEX \(\(New-Object Net\.WebClient\)\.DownloadString.*|.*IEX\(New-Object Net\.WebClient\)\.DownloadString.*|.*IEX\(\(New-Object Net\.WebClient\)\.DownloadString.*"" |
| Windows: Suspicious Encoded PowerShell Command Line | Security | Detects suspicious powershell process starts with base64 encoded commands (e.g. Emotet). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_base64_encoded_cmd.yml | Windows: Suspicious Encoded PowerShell Command Line | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND ((command REGEXP "".* -e.*"" AND command REGEXP "".* IAA.*|.* IAB.*|.* JAB.*|.* SQBFAFgA.*|.* SUVYI.*|.* UwB.*|.* aQBlAHgA.*|.* aWV4I.*|.* cwB.*"") OR command REGEXP "".* BA\^J e-.*|.*\.exe -ENCOD .*"")) AND ((command NOT REGEXP "".* -ExecutionPolicy remotesigned .*"")) |
| Windows: Suspicious Scheduled Task Name As GUID | Security | Detects creation of a scheduled task with a GUID like name. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_guid_task_name.yml | Windows: Suspicious Scheduled Task Name As GUID | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".*/Create .*"" AND command REGEXP "".*/TN '\{.*|.*/TN \""\{.*|.*/TN \{.*"" AND command REGEXP "".*\} .*|.*\}'.*|.*\}\"".*"" |
| Windows: Suspicious Schtasks Schedule Types | Security | Detects scheduled task creations or modification on a suspicious schedule type. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_schedule_type.yml | Windows: Suspicious Schtasks Schedule Types | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\schtasks\.exe"" OR srcFileName=""schtasks.exe"") AND command REGEXP "".* ONCE .*|.* ONIDLE .*|.* ONLOGON .*|.* ONSTART .*"") AND ((command NOT REGEXP "".* SYSTEM.*|.*HIGHEST.*|.*NT AUT.*"")) |
| Windows: Sliver C2 Default Service Installation | Security | Detects known malicious service installation that appear in cases in which a Sliver implants execute the PsExec commands. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_install_sliver.yml | Windows: Sliver C2 Default Service Installation | (eventType=""Win-System-Service-Control-Manager-7045"") AND (serviceName IN (""Sliver implant"",""Sliver"") OR serviceFileName REGEXP ""^[a-zA-Z]:\\\\windows\\\\temp\\\\[a-zA-Z0-9]{10}\\.exe"") |
| Windows: Suspicious Modification Of Scheduled Tasks | Security | Detects when an attacker tries to modify an already existing scheduled tasks to run from a suspicious location Attackers can create a simple looking task in order to avoid detection on creation as it's often the most focused on Instead they modify the task after creation to include their malicious payload . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_change.yml | Windows: Suspicious Modification Of Scheduled Tasks | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".* /Change .*"" AND command REGEXP "".* /TN .*"" AND command REGEXP "".*%ProgramData%.*|.*%appdata%.*|.*%comspec%.*|.*%localappdata%.*|.*C:\\Perflogs\\.*|.*C:\\ProgramData\\.*|.*\\AppData\\Local\\Temp.*|.*\\AppData\\Roaming\\.*|.*\\Desktop\\.*|.*\\Downloads\\.*|.*\\Temporary Internet.*|.*\\Users\\Public\\.*|.*\\WINDOWS\\Temp\\.*"" AND command REGEXP "".*bash .*|.*bash\.exe.*|.*bitsadmin.*|.*certutil.*|.*cmd /c .*|.*cmd /k .*|.*cmd /r .*|.*cmd\.exe /c .*|.*cmd\.exe /k .*|.*cmd\.exe /r .*|.*cscript.*|.*forfiles.*|.*hh .*|.*hh\.exe.*|.*mshta.*|.*powershell.*|.*regsvr32.*|.*rundll32.*|.*scrcons.*|.*scriptrunner.*|.*wmic .*|.*wmic\.exe.*|.*wscript.*"" |
| Windows: SQL Client Tools PowerShell Session Detection | Security | This rule detects execution of a PowerShell code through the sqltoolsps.exe utility, which is included in the standard set of utilities supplied with the Microsoft SQL Server Management studio. Script blocks are not logged in this case, so this utility helps to bypass protection mechanisms based on the analysis of these logs. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mssql_sqltoolsps_susp_execution.yml | Windows: SQL Client Tools PowerShell Session Detection | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\sqltoolsps\.exe"" OR parentProcName REGEXP "".*\\sqltoolsps\.exe"" OR srcFileName=""\\sqltoolsps.exe"") AND (parentProcName NOT REGEXP "".*\\smss\.exe"") |
| Windows: Suspicious PowerShell Parent Process | Security | Detects a suspicious or uncommon parent processes of PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_susp_parent_process.yml | Windows: Suspicious PowerShell Parent Process | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*tomcat.*"" OR parentProcName REGEXP "".*\\MicrosoftEdgeSH\.exe|.*\\amigo\.exe|.*\\browser\.exe|.*\\chrome\.exe|.*\\firefox\.exe|.*\\httpd\.exe|.*\\iexplore\.exe|.*\\jbosssvc\.exe|.*\\microsoftedge\.exe|.*\\microsoftedgecp\.exe|.*\\mshta\.exe|.*\\nginx\.exe|.*\\outlook\.exe|.*\\php-cgi\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\safari\.exe|.*\\services\.exe|.*\\sqlagent\.exe|.*\\sqlserver\.exe|.*\\sqlservr\.exe|.*\\vivaldi\.exe|.*\\w3wp\.exe"") AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR command REGEXP "".*/c powershell.*|.*/c pwsh.*"" OR description=""Windows PowerShell"" OR product=""PowerShell Core 6"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) |
| Windows: Script Event Consumer Spawning Process | Security | Detects a suspicious child process of Script Event Consumer (scrcons.exe). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_scrcons_susp_child_process.yml | Windows: Script Event Consumer Spawning Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\scrcons\.exe"" AND procName REGEXP "".*\\cscript\.exe|.*\\dllhost\.exe|.*\\msbuild\.exe|.*\\mshta\.exe|.*\\msiexec\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\schtasks\.exe|.*\\svchost\.exe|.*\\wscript\.exe"" |
| Windows: Suspicious Add Scheduled Command Pattern | Security | Detects suspicious scheduled task creations with commands that are uncommon. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_susp_pattern.yml | Windows: Suspicious Add Scheduled Command Pattern | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".*/Create .*"") AND ((command REGEXP "".*/ru system .*|.*/sc minute .*"" AND command REGEXP "".*cmd /c.*|.*cmd /k.*|.*cmd /r.*|.*cmd\.exe /c .*|.*cmd\.exe /k .*|.*cmd\.exe /r .*"") OR command REGEXP "".* -decode .*|.* -enc .*|.* -w hidden .*|.* IEX.*|.* bypass .*|.* curl .*|.*/c start /min .*|.*FromBase64String.*|.*\.DownloadFile.*|.*\.DownloadString.*"" OR (command REGEXP "".*/xml C:\\Users\\.*"" AND command REGEXP "".*\\AppData\\Local\\.*"") OR (command REGEXP "".*wscript\.exe.*"" AND command REGEXP "".*\\AppData\\.*"")) |
| Windows: Schtasks Creation Or Modification With SYSTEM Privileges | Security | Detects the creation or update of a scheduled task to run with ""NT AUTHORITY\SYSTEM"" privileges. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_system.yml | Windows: Schtasks Creation Or Modification With SYSTEM Privileges | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".* /change .*|.* /create .*"" AND command REGEXP "".*/ru .*"" AND command REGEXP "".* SYSTEM .*|.*NT AUT.*"") AND ((parentProcName NOT REGEXP "".*\\AppData\\Local\\Temp\\.*"" OR parentProcName NOT REGEXP "".*TeamViewer_\.exe.*"" OR procName NOT REGEXP "".*\\schtasks\.exe"" OR command NOT REGEXP "".*/TN TVInstallRestore.*"") AND (command NOT REGEXP "".*/Create /F /RU System /SC WEEKLY /TN AviraSystemSpeedupVerify /TR .*|.*/VERIFY /VERYSILENT /NOSTART /NODOTNET /NORESTART\"" /RL HIGHEST.*|.*C:\\Program Files \(x86\)\\Avira\\System Speedup\\setup\\avira_speedup_setup\.exe.*"")) |
| Windows: Suspicious PowerShell Parameter Substring | Security | Detects suspicious PowerShell invocation with a parameter substring. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_susp_parameter_variation.yml | Windows: Suspicious PowerShell Parameter Substring | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND command REGEXP "".* -NoPr .*|.* -NoPro .*|.* -NoProf .*|.* -NoProfi .*|.* -NoProfil .*|.* -ec .*|.* -en .*|.* -enco .*|.* -encod .*|.* -encode .*|.* -encoded .*|.* -encodedC .*|.* -encodedCo .*|.* -encodedCom .*|.* -encodedComm .*|.* -encodedComma .*|.* -encodedComman .*|.* -ep bypass.*|.* -ex bypass.*|.* -exe bypass.*|.* -exec bypass.*|.* -execu bypass.*|.* -execut bypass.*|.* -executi bypass.*|.* -executio bypass.*|.* -execution bypass.*|.* -executionp .*|.* -executionpo .*|.* -executionpol .*|.* -executionpoli .*|.* -executionpolic .*|.* -nonin .*|.* -nonint .*|.* -noninte .*|.* -noninter .*|.* -nonintera .*|.* -noninterac .*|.* -noninteract .*|.* -noninteracti .*|.* -noninteractiv .*|.* -wi h.*|.* -win h .*|.* -win h.*|.* -win hi .*|.* -win hid .*|.* -win hidd .*|.* -win hidde .*|.* -wind h.*|.* -windo h.*|.* -windows h.*|.* -windowst h.*|.* -windowsty h.*|.* -windowstyl h.*|.* -windowstyle h .*|.* /NoPr .*|.* /NoPro .*|.* /NoProf .*|.* /NoProfi .*|.* /NoProfil .*|.* /ec .*|.* /en .*|.* /enco .*|.* /encod .*|.* /encode .*|.* /encoded .*|.* /encodedC .*|.* /encodedCo .*|.* /encodedCom .*|.* /encodedComm .*|.* /encodedComma .*|.* /encodedComman .*|.* /ep bypass.*|.* /ex bypass.*|.* /exe bypass.*|.* /exec bypass.*|.* /execu bypass.*|.* /execut bypass.*|.* /executi bypass.*|.* /executio bypass.*|.* /execution bypass.*|.* /executionp .*|.* /executionpo .*|.* /executionpol .*|.* /executionpoli .*|.* /executionpolic .*|.* /nonin .*|.* /nonint .*|.* /noninte .*|.* /noninter .*|.* /nonintera .*|.* /noninterac .*|.* /noninteract .*|.* /noninteracti .*|.* /noninteractiv .*|.* /wi h.*|.* /win h .*|.* /win h.*|.* /win hi .*|.* /win hid .*|.* /win hidd .*|.* /win hidde .*|.* /wind h.*|.* /windo h.*|.* /windows h.*|.* /windowst h.*|.* /windowsty h.*|.* /windowstyl h.*|.* /windowstyle h .*"" |
| Windows: Suspicious Scheduled Task Creation Involving Temp Folder | Security | Detects the creation of scheduled tasks that involves a temporary folder and runs only once. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_creation_temp_folder.yml | Windows: Suspicious Scheduled Task Creation Involving Temp Folder | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".* /create .*"" AND command REGEXP "".* /sc once .*"" AND command REGEXP "".*\\Temp\\.*"" |
| Windows: Suspicious Scheduled Task Creation via Masqueraded XML File | Security | Detects the creation of a scheduled task using the ""-XML"" flag with a file without the '.xml' extension. This behavior could be indicative of potential defense evasion attempt during persistence. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_schedule_via_masqueraded_xml_file.yml | Windows: Suspicious Scheduled Task Creation via Masqueraded XML File | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\schtasks\.exe"" OR srcFileName=""schtasks.exe"") AND command REGEXP "".*-create.*|.*/create.*"" AND command REGEXP "".*-xml.*|.*/xml.*"") AND ((command NOT REGEXP "".*\.xml.*"") AND (integrityLevel!=""System"") AND (parentProcName NOT REGEXP "".*\\rundll32\.exe"" OR parentCommand NOT REGEXP "".*:\\WINDOWS\\Installer\\MSI.*"" OR parentCommand NOT REGEXP "".*\.tmp,zzzzInvokeManagedCustomActionOutOfProc.*""))) AND ((parentProcName NOT REGEXP "".*:\\Program Files \(x86\)\\Zemana\\AntiMalware\\AntiMalware\.exe|.*:\\Program Files\\Axis Communications\\AXIS Camera Station\\SetupActions\.exe|.*:\\Program Files\\Axis Communications\\AXIS Device Manager\\AdmSetupActions\.exe|.*:\\Program Files\\Dell\\SupportAssist\\pcdrcui\.exe|.*:\\ProgramData\\OEM\\UpgradeTool\\CareCenter_.*\\BUnzip\\Setup_msi\.exe"")) |
| Windows: Suspicious Schtasks Execution AppData Folder | Security | Detects the creation of a schtask that executes a file from C:\Users\<USER>\AppData\Local. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_appdata_local_system.yml | Windows: Suspicious Schtasks Execution AppData Folder | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".*/Create.*"" AND command REGEXP "".*/RU.*"" AND command REGEXP "".*/TR.*"" AND command REGEXP "".*C:\\Users\\.*"" AND command REGEXP "".*\\AppData\\Local\\.*"" AND command REGEXP "".* SYSTEM .*|.*NT AUT.*"") AND (parentProcName NOT REGEXP "".*\\AppData\\Local\\Temp\\.*"" OR parentProcName NOT REGEXP "".*TeamViewer_\.exe.*"" OR procName NOT REGEXP "".*\\schtasks\.exe"" OR command NOT REGEXP "".*/TN TVInstallRestore.*"") |
| Windows: Suspicious Process Created Via Wmic.EXE | Security | Detects WMIC executing ""process call create"" with suspicious calls to processes such as ""rundll32"", ""regsrv32"", etc. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_susp_process_creation.yml | Windows: Suspicious Process Created Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*process .*"" AND command REGEXP "".*call .*"" AND command REGEXP "".*create .*"" AND command REGEXP "".*%ProgramData%.*|.*%appdata%.*|.*%comspec%.*|.*%localappdata%.*|.*%temp%.*|.*%tmp%.*|.*\\AppData\\Local\\.*|.*\\Users\\Public\\.*|.*\\Windows\\Temp\\.*|.*bitsadmin.*|.*certutil.*|.*cmd /c .*|.*cmd /k .*|.*cmd /r .*|.*cmd\.exe /c .*|.*cmd\.exe /k .*|.*cmd\.exe /r .*|.*cscript.*|.*mshta.*|.*powershell.*|.*pwsh.*|.*regsvr32.*|.*rundll32.*|.*wscript.*"" |
| Windows: Suspicious File Characteristics Due to Missing Fields | Security | Detects Executables in the Downloads folder without FileVersion,Description,Product,Company likely created with py2exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_file_characteristics.yml | Windows: Suspicious File Characteristics Due to Missing Fields | eventType=""Win-Sysmon-1-Create-Process"" AND description=""\?"" AND (fileVersion=""\?"" OR product=""\?"" OR company=""\?"") AND procName REGEXP "".*\\Downloads\\.*"" |
| Windows: Suspicious File Execution From Internet Hosted WebDav Share | Security | Detects the execution of the ""net use"" command to mount a WebDAV server and then immediately execute some content in it. As seen being used in malicious LNK files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_net_use_and_exec_combo.yml | Windows: Suspicious File Execution From Internet Hosted WebDav Share | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe.*"" OR srcFileName=""Cmd.EXE"") AND (command REGEXP "".* net use http.*"" AND command REGEXP "".*& start /b .*"" AND command REGEXP "".*\\DavWWWRoot\\.*"") AND command REGEXP "".*\.bat .*|.*\.dll .*|.*\.exe .*|.*\.ps1 .*|.*\.vbs .*"" |
| Windows: Suspicious Csi.exe Usage | Security | Csi.exe is a signed binary from Microsoft that comes with Visual Studio and provides C# interactive capabilities. It can be used to run C# code from a file passed as a parameter in command line. Early version of this utility provided with Microsoft â€šÃ„Ã¶âˆšÃ‘âˆšâˆ«Roslynâ€šÃ„Ã¶âˆšÃ‘âˆšÏ€ Community Technology Preview was named 'rcsi.exe'. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_csi_execution.yml | Windows: Suspicious Csi.exe Usage | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\csi\.exe|.*\\rcsi\.exe"" OR srcFileName IN (""csi.exe"",""rcsi.exe"")) AND company=""Microsoft Corporation"" |
| Windows: Suspicious PowerShell Invocation From Script Engines | Security | Detects suspicious powershell invocations from interpreters or unusual programs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_script_engine_parent.yml | Windows: Suspicious PowerShell Invocation From Script Engines | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\cscript\.exe|.*\\wscript\.exe"" AND procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"") AND ((dirName NOT REGEXP "".*\\Health Service State\\.*"")) |
| Windows: Use Radmin Viewer Utility | Security | Detects the execution of Radmin which can be abused by an adversary to remotely control Windows machines. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_radmin.yml | Windows: Use Radmin Viewer Utility | eventType=""Win-Sysmon-1-Create-Process"" AND (description=""Radmin Viewer"" OR product=""Radmin Viewer"" OR srcFileName=""Radmin.exe"") |
| Windows: Service Reconnaissance Via Wmic.EXE | Security | An adversary might use WMI to check if a certain remote service is running on a remote device. When the test completes, a service information will be displayed on the screen if it exists. A common feedback message is that ""No instance(s) Available"" if the service queried is not running. A common error message is ""Node - (provided IP or default) ERROR Description =The RPC server is unavailable"" if the provided remote host is unreachable . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_recon_service.yml | Windows: Service Reconnaissance Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\WMIC\.exe"" OR srcFileName=""wmic.exe"") AND command REGEXP "".*service.*"" |
| Excessive End User Mail To Unauthorized Mail Gateways | Security | Detects a scenario where a host, that is itself not an authorized mail gateway, is unsuccessfully trying to send excessive emails to unauthorized mail gateways. Authorized mail gateways are represented by the ""Mail Gateway"" group. Such requests would be typically denied because, either the firewall would block SMTP from end hosts and/or mail gateways only receive mail from other authorized mail gateways. This behavior may indicate malware running on an end host that is trying to send spam or privileged information to its own set of mail servers (which may be compromised). | Excessive End User Mail To Unauthorized Mail Gateways | srcDestTCPFlags = 2 AND ipProto = 6 AND destIpPort = 25 AND eventType IN (Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_DEVICE_SEC_GW,Group@PH_SYS_APP_MAIL_SERVER) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| FortiSandbox detects multiple hosts with infected files | Security | FortiSandbox detects multiple attacks from the same source | FortiSandbox detects multiple hosts with infected files | eventType = ""FortiSandbox-Malware-Detected"" |
| Large Outbound Transfer To Outside My Country | Security | Detects a large outbound transfer (larger than 2GB in 10 minutes) from an internal host to an external destination that is outside my country. The rule is written for United States and may need to be tuned for other countries. | Large Outbound Transfer To Outside My Country | srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND destGeoCountry NOT IN (Group@PH_COUNTRY_GROUP_MYHOME) |
| Crowdstrike: Known Malware | Security | Crowdstrike agent detected known malware at a host | Crowdstrike: Known Malware | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Known-Malware"" |
| ICS Alert: Execution through API | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0871 - Execution through API. Adversaries may attempt to leverage Application Program Interfaces (APIs) used for communication between control software and the hardware. | ICS Alert: Execution through API | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0871(,T\d+)*$"" |
| DNS Traffic to Anomali ThreatStream Malware Domains | Security | Detects DNS traffic to Anomali ThreatStream malware domains | DNS Traffic to Anomali ThreatStream Malware Domains | destName IN (Group@PH_SYS_MAL_DOMAIN_THREATSTREAM) AND eventType IN (Group@PH_SYS_EVENT_CommonDNSTraffic) |
| DNS Traffic to FortiGuard Malware Domains | Security | Detects DNS traffic to FortiGuard malware domains | DNS Traffic to FortiGuard Malware Domains | destName IN (Group@PH_SYS_FORTIGUARD_MAL_DOMAIN) AND eventType IN (Group@PH_SYS_EVENT_CommonDNSTraffic) |
| FortiSandbox detects malicious file malware from file upload | Security | FortiSandbox claims that a file has malware | FortiSandbox detects malicious file malware from file upload | eventType = ""FortiSandbox-Malware-Detected"" AND riskName = ""Malicious"" AND type = ""On-Demand"" |
| Windows: WMI Modules Loaded | Security | Detects non wmiprvse loading WMI modules. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_wmi_module_load.yml | Windows: WMI Modules Loaded | eventType=""Win-Sysmon-7-Image-Loaded"" AND (loadedProcName REGEXP "".*\\WMINet_Utils\.dll|.*\\WmiApRpl\.dll|.*\\fastprox\.dll|.*\\wbemcomn\.dll|.*\\wbemprox\.dll|.*\\wbemsvc\.dll|.*\\wmiclnt\.dll|.*\\wmiprov\.dll|.*\\wmiutils\.dll"" AND (procName NOT REGEXP "".*C:\\Windows\\Sysmon64\.exe|.*C:\\Windows\\Sysmon\.exe|.*C:\\Windows\\System32\\wbem\\WMIC\.exe|.*C:\\Windows\\System32\\wbem\\unsecapp\.exe|.*\\CompatTelRunner\.exe|.*\\DeviceCensus\.exe|.*\\MsMpEng\.exe|.*\\SIHClient\.exe|.*\\WmiApSrv\.exe|.*\\WmiPrvSE\.exe|.*\\explorer\.exe|.*\\logman\.exe|.*\\ngentask\.exe|.*\\nvcontainer\.exe|.*\\opera_autoupdate\.exe|.*\\sdiagnhost\.exe|.*\\svchost\.exe|.*\\systeminfo\.exe|.*\\thor64\.exe|.*\\thor\.exe|.*\\windows\\system32\\MoUsoCoreWorker\.exe|.*\\windows\\system32\\taskhostw\.exe|.*\\windows\\system32\\wbem\\WMIADAP\.exe"")) AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"") |
| ICS Alert: Change Operating Mode | Security | An ICS monitoring system has detected an event containing Mitre ICS Technique ID T0858 - Change Operating Mode. Adversaries may change the operating mode of a Programmable controller to gain additional access to engineering functions such as Program Download. | ICS Alert: Change Operating Mode | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0858(,T\d+)*$"" |
| Excessive End User Mail To Unauthorized Mail Gateways | Security | Detects a scenario where a host, that is itself not an authorized mail gateway, is unsuccessfully trying to send excessive emails to unauthorized mail gateways. Authorized mail gateways are represented by the ""Mail Gateway"" group. Such requests would be typically denied because, either the firewall would block SMTP from end hosts and/or mail gateways only receive mail from other authorized mail gateways. This behavior may indicate malware running on an end host that is trying to send spam or privileged information to its own set of mail servers (which may be compromised). | Excessive End User Mail To Unauthorized Mail Gateways | ipProto = 6 AND destIpPort = 25 AND eventType IN (Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_DEVICE_SEC_GW,Group@PH_SYS_APP_MAIL_SERVER) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Windows: WSF/JSE/JS/VBA/VBE File Execution | Security | Detects suspicious file execution by wscript and cscript. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_script_execution.yml | Windows: WSF/JSE/JS/VBA/VBE File Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName IN (""cscript.exe"",""wscript.exe"") OR procName REGEXP "".*\\cscript\.exe|.*\\wscript\.exe"") AND command REGEXP "".*\.js.*|.*\.jse.*|.*\.vba.*|.*\.vbe.*|.*\.vbs.*"" |
| FortiSandbox detects unknown risk file malware | Security | FortiSandbox claims that a file has malware but the risk is unknown and so needs to be investigated further | FortiSandbox detects unknown risk file malware | eventType = ""FortiSandbox-Malware-Detected"" AND riskName = ""Unknown"" |
| Blocklist User Agent Match | Security | Detects a match with the list of blocklisted http user agents. Malware, Adware, Spyware etc use uncommon user agents. | Blocklist User Agent Match | eventType IN (Group@PH_SYS_EVENT_PermitWebTraffic) AND httpUserAgent REGEXP (Group@PH_SYS_HTTP_UA_BLACKLIST) |
| Windows: Wmiexec Default Output File | Security | Detects the creation of the default output filename used by the wmiexec tool. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_wmiexec_default_filename.yml | Windows: Wmiexec Default Output File | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP ""C:\\\\__1\\d{9}\\.\\d{1,7}$|D:\\\\__1\\d{9}\\.\\d{1,7}$|\\\\Windows\\\\__1\\d{9}\\.\\d{1,7}$"") |
| Windows: Wmiprvse Wbemcomn DLL Hijack: Sysmon V2 | Security | Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\Windows\System32\wbem\` directory over the network and loading it for a WMI DLL Hijack scenario. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_wmiprvse_wbemcomn_dll_hijack.yml | Windows: Wmiprvse Wbemcomn DLL Hijack: Sysmon V2 | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\wmiprvse\.exe"" AND loadedProcName REGEXP "".*\\wbem\\wbemcomn\.dll"" |
| ICS Alert: Hooking | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0874 - Hooking. Adversaries may hook into application programming interface (API) functions used by processes to redirect calls for execution and privilege escalation means. | ICS Alert: Hooking | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0874(,T\d+)*$"" |
| ICS Alert: Native API | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0834 - Native API. Adversaries may directly interact with the native OS application programming interface (API) to access system functions. | ICS Alert: Native API | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0834(,T\d+)*$"" |
| ICS Alert: User Execution | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0863 - User Execution. Adversaries may rely on a targeted organizations user interaction for the execution of malicious code. | ICS Alert: User Execution | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0863(,T\d+)*$"" |
| Windows: Windows Hotfix Updates Reconnaissance Via Wmic.EXE | Security | Detects the execution of wmic with the ""qfe"" flag in order to obtain information about installed hotfix updates on the system. This is often used by pentester and attacker enumeration scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_recon_hotfix.yml | Windows: Windows Hotfix Updates Reconnaissance Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""wmic.exe"" OR procName REGEXP "".*\\WMIC\.exe"") AND command REGEXP "".* qfe.*"" |
| Malware found but not remediated | Security | Detects that host anti-virus or content inspection devices found a virus but could not remediate it | Malware found but not remediated | eventType IN (Group@PH_SYS_EVENT_Worm_Remedy_Failed, Group@PH_SYS_EVENT_GenMalware_Remedy_Failed) AND reptDevIpAddr IN (Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_SEC_GW) |
| Outbreak: DARKSIDE Domain Traffic Detected | Security | Traffic detected to domains known to be associated with DarkSide Ransomware activity | Outbreak: DARKSIDE Domain Traffic Detected | reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL,Group@PH_SYS_DEVICE_NETWORK_IPS,Group@PH_SYS_DEVICE_SEC_GW,Group@PH_SYS_APP_NETWORK_IPS,Group@PH_SYS_APP_SEC_GW,Group@PH_SYS_APP_SEC_MGMT) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic,Group@PH_SYS_EVENT_DenyNetTraffic,Group@PH_SYS_EVENT_CommonDNSTraffic) AND destDomain IS NOT NULL AND ( destDomain CONTAIN ""catsdegree"" OR destDomain CONTAIN ""fotoeuropa"" OR destDomain CONTAIN ""securebestapp20"" OR destDomain CONTAIN ""gosleepaddict"" OR destDomain CONTAIN ""kgtwiakkdoop"" OR destDomain CONTAIN ""yeeterracing"" OR destDomain CONTAIN ""ironnetworks"" OR destDomain CONTAIN ""lagrom"" OR destDomain CONTAIN ""openmsdn"" OR destDomain CONTAIN ""ctxinit.azureedge"" ) |
| FortiSandbox detects URL Malware | Security | FortiSandbox detects Malware in submitted URL for inspection | FortiSandbox detects URL Malware | eventType = ""FortiSandbox-NetAlert-URL"" |
| ICS Alert: Scripting | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0853 - Scripting. Adversaries may use scripting languages to execute arbitrary code in the form of a pre-written script or in the form of user-supplied code to an interpreter. | ICS Alert: Scripting | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0853(,T\d+)*$"" |
| ICS Alert: Graphical User Interface | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0823 - Graphical User Interface. Adversaries may attempt to gain access to a machine via a Graphical User Interface (GUI) to enhance execution capabilities. | ICS Alert: Graphical User Interface | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0823(,T\d+)*$"" |
| FireEye Malware Callback | Security | FireEye MPS found a host attempting to connect back to botnet controllers | FireEye Malware Callback | eventType = ""FireEye-malware-callback"" |
| Windows: Windows Shell/Scripting Processes Spawning Suspicious Programs | Security | Detects suspicious child processes of a Windows shell and scripting processes such as wscript, rundll32, powershell, mshta...etc. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_shell_spawn_susp_program.yml | Windows: Windows Shell/Scripting Processes Spawning Suspicious Programs | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\cscript\.exe|.*\\mshta\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wmiprvse\.exe|.*\\wscript\.exe"" AND procName REGEXP "".*\\bitsadmin\.exe|.*\\certutil\.exe|.*\\mshta\.exe|.*\\nslookup\.exe|.*\\schtasks\.exe"") AND ((dirName NOT REGEXP "".*\\ccmcache\\.*"") AND (parentCommand NOT REGEXP "".*\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\check-workspacehealth\.ps1.*|.*\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\set-selfhealing\.ps1.*|.*\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\setup-scheduledtask\.ps1.*|.*\\nessus_.*"") AND (command NOT REGEXP "".*\\nessus_.*"")) |
| Excessive Uncommon DNS Queries | Security | Detects the same host that is not a DNS server, doing an excessive amount of uncommon domain name queries - this indicates the host is likely infected with malware. An end host typically needs to perform only A and PTR queries; any other query inidicates the likely presence of malware. | Excessive Uncommon DNS Queries | srcIpAddr NOT IN (Group@PH_SYS_APP_DNS_SERVER) AND eventType NOT IN (Group@PH_SYS_EVENT_CommonDNSTraffic) AND (eventType CONTAIN ""BIND_DNS"" OR eventType CONTAIN ""MS_DNS"") |
| Large Outbound Transfer | Security | Detects a large outbound transfer (larger than 2GB in 10 minutes) from an internal host to an external destination | Large Outbound Transfer | srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Windows: WinDbg/CDB LOLBIN Usage | Security | Detects usage of ""cdb.exe"" to launch 64-bit shellcode or arbitrary processes or commands from a debugger script file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_cdb.yml | Windows: WinDbg/CDB LOLBIN Usage | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cdb\.exe"" OR srcFileName=""CDB.Exe"") AND command REGEXP "".* -c .*|.* -cf .*"" |
| Windows: Wmiprvse Wbemcomn DLL Hijack: Sysmon | Security | Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\Windows\System32\wbem\` directory over the network and loading it for a WMI DLL Hijack scenario. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_wmiprvse_wbemcomn_dll_hijack.yml | Windows: Wmiprvse Wbemcomn DLL Hijack: Sysmon | eventType=""Win-Sysmon-11-FileCreate"" AND procName=""System"" AND fileName REGEXP "".*\\wbem\\wbemcomn\.dll"" |
| Windows: WmiPrvSE Spawned A Process | Security | Detects WmiPrvSE spawning a process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmiprvse_spawning_process.yml | Windows: WmiPrvSE Spawned A Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\WmiPrvSe\.exe"" AND ((winLogonId NOT IN (""0x3e7"",""null"")) AND (user NOT REGEXP "".*AUTHORI.*|.*AUTORI.*"") AND (procName NOT REGEXP "".*\\WmiPrvSE\.exe"") AND (procName NOT REGEXP "".*\\WerFault\.exe"") AND (winLogonId IS NOT NULL)) |
| ICS Alert: Modify Controller Tasking | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0821 - Modify Controller Tasking. Adversaries may modify the tasking of a controller to allow for the execution of their own programs. | ICS Alert: Modify Controller Tasking | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0821(,T\d+)*$"" |
| FortiSandbox detects file malware with high or medium risk | Security | FortiSandbox detects file malware with high or medium risk | FortiSandbox detects file malware with high or medium risk | eventType = ""FortiSandbox-Malware-Detected"" AND riskName IN (""High Risk"",""Medium Risk"") |
| ICS Alert: Command-Line Interface | Security | An ICS monitoring system has detected an event containing Mitre ICS Technique ID T0807 - Command-Line Interface. Adversaries may utilize command-line interfaces (CLIs) to interact with systems and execute commands. | ICS Alert: Command-Line Interface | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0807(,T\d+)*$"" |
| Excessive End User Mail To Unauthorized Mail Gateways | Security | Detects a scenario where a host, that is itself not an authorized mail gateway, is unsuccessfully trying to send excessive emails to unauthorized mail gateways. Authorized mail gateways are represented by the ""Mail Gateway"" group. Such requests would be typically denied because, either the firewall would block SMTP from end hosts and/or mail gateways only receive mail from other authorized mail gateways. This behavior may indicate malware running on an end host that is trying to send spam or privileged information to its own set of mail servers (which may be compromised). | Excessive End User Mail To Unauthorized Mail Gateways | ipProto = 6 AND destIpPort = 25 AND destIpAddr NOT IN (Group@PH_SYS_DEVICE_SEC_GW, Group@PH_SYS_APP_MAIL_SERVER) AND srcIpAddr NOT IN (Group@PH_SYS_DEVICE_SEC_GW,Group@PH_SYS_APP_MAIL_SERVER) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic,Group@PH_SYS_EVENT_DenyNetTraffic) |
| Windows: WScript or CScript Dropper | Security | Detects wscript/cscript executions of scripts located in user directories. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_malware_script_dropper.yml | Windows: WScript or CScript Dropper | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cscript\.exe|.*\\wscript\.exe"" AND command REGEXP "".*C:\\ProgramData\\.*|.*C:\\Users\\.*"" AND command REGEXP "".*\.js.*|.*\.jse.*|.*\.vba.*|.*\.vbe.*|.*\.vbs.*"") AND (parentProcName NOT REGEXP "".*\\winzip.*"") |
| Malware hash match | Security | Detects a blocklist malware hash match from FortiSIEM file monitoring. Malware hash blocklist is populated by external threat intelligence sources such as ThreatStream Anomali, FortiSandbox, etc. | Malware hash match | eventType IN (""PH_DEV_MON_CUST_FILE_CREATE"",""PH_DEV_MON_CUST_FILE_SCAN"", ""PH_DEV_MON_CUST_FILE_CHANGE_CONTENT"", ""AO-WUA-FileMon-Added"", ""AO-WUA-FileMon-Modified"",""AO-WUA-InstSw-Added"", ""FSM_LINUX_FILE_MODIFY"",""FSM_LINUX_FILE_CREATE"") AND hashCode IN (Group@PH_SYS_MALWARE_HASH) |
| MS 365 Defender: Malware Detected | Security | Windows Defender Advanced Threat Protection detected malware | MS 365 Defender: Malware Detected | eventType = ""Microsoft-WinDefATP-Alert-Malware"" |
| Windows: WMIC Remote Command Execution | Security | Detects the execution of WMIC to query information on a remote system. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_remote_execution.yml | Windows: WMIC Remote Command Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\WMIC\.exe"" OR srcFileName=""wmic.exe"") AND command REGEXP "".*/node:.*"") AND ((command NOT REGEXP "".*/node:127\.0\.0\.1 .*|.*/node:localhost .*"")) |
| Windows: Suspicious Outbound SMTP Connections | Security | Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_susp_outbound_smtp_connections.yml | Windows: Suspicious Outbound SMTP Connections | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (destIpPort IN (25,2525,465,587) AND initiated=""true"") AND ((procName NOT REGEXP "".*\\outlook\.exe|.*\\thunderbird\.exe"") AND (procName NOT REGEXP ""C:\\Program Files\\Microsoft\\Exchange Server\\.*"") AND (procName NOT REGEXP ""C:\\Program Files\\WindowsApps\\microsoft\.windowscommunicationsapps_.*"" OR procName NOT REGEXP "".*\\HxTsr\.exe"")) |
| ClickHouse Log Integrity Violation Detected | Disponibilidade | Detects a ClickHouse data checksum has changed since it was finalized. This may indicate attempt to modify events in ClickHouse. | ClickHouse Log Integrity Violation Detected | eventType IN (""PH_CLICKHOUSE_LOG_INTEGRITY_SHA256_MISMATCH"", ""PH_CLICKHOUSE_LOG_INTEGRITY_PARTITION_UPDATED_AFTER_CHECKSUM"") |
| Windows Server USB File Write | Change | Detects Windows Server USB file writes | Windows Server USB File Write | eventType IN (""AO-WUA-RemovableMedia-AddFile"",""AO-WUA-RemovableMedia-ModifyFile"",""AO-WUA-RemovableMedia-RemoveFile"",""AO-WUA-RemovableMedia-RenameFile"") |
| Traffic to Emerging Threat IP List | Security | Detects network traffic to emerging threat IP List | Traffic to Emerging Threat IP List | destIpAddr IN (Group@PH_SYS_EMER_THREAT) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic, Group@PH_SYS_EVENT_DenyNetTraffic) |
| Outbreak: Emotet Suspicious File Hash Found on Host | Security | Emotet malware hash detected by Fortinet Products on host. | Outbreak: Emotet Suspicious File Hash Found on Host | (eventType CONTAIN ""FortiGate-antivirus"" OR eventType CONTAIN ""FortiClient-av"") AND ( hashMD5 IN (""c17a1a08f40029c5134c7dfee8855c62"",""ea24cb1a4b92c92199eb73a1bd6d0dbc"",""7cf0ae7e45e7f92e668e41b104187cce"") OR hashCode IN (""c17a1a08f40029c5134c7dfee8855c62"",""ea24cb1a4b92c92199eb73a1bd6d0dbc"",""7cf0ae7e45e7f92e668e41b104187cce"") ) |
| Windows: Suspicious WebDav Client Execution: Sysmon V2 | Security | Detects ""svchost.exe"" spawning ""rundll32.exe"" with command arguments like C:\windows\system32\davclnt.dll,DavSetCookie. This could be an indicator of exfiltration or use of WebDav to launch code (hosted on WebDav Server). . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_webdav_client_execution.yml | Windows: Suspicious WebDav Client Execution: Sysmon V2 | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"") AND command REGEXP "".*C:\\windows\\system32\\davclnt\.dll,DavSetCookie.*"" |
| Windows: DNS Query for Anonfiles.com Domain - Sysmon | Security | Detects DNS queries for ""anonfiles.com"", which is an anonymous file upload platform often used for malicious purposes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_anonymfiles_com.yml | Windows: DNS Query for Anonfiles.com Domain - Sysmon | eventType=""Win-Sysmon-22-DNS-Query"" AND queryId REGEXP "".*\.anonfiles\.com.*"" |
| ClickHouse Log Integrity System Errors Detected | Disponibilidade | Detects ClickHouse Log Integrity system errors. This means that Log Integrity failed to complete. | ClickHouse Log Integrity System Errors Detected | eventType IN (""PH_CLICKHOUSE_LOG_INTEGRITY_OPTIMIZE_COMMAND_FAILED"", ""PH_CLICKHOUSE_LOG_INTEGRITY_MIN_MAX_QUERY_FAILED"", ""PH_CLICKHOUSE_LOG_INTEGRITY_EXEC_FAILED"") |
| Traffic to FortiGuard Malware IP List | Security | Detects network traffic to FortiGuard Blocked IP List | Traffic to FortiGuard Malware IP List | destIpAddr IN (Group@PH_SYS_FORTIGUARD_BLOCKED_IP) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic,Group@PH_SYS_EVENT_DenyNetTraffic) |
| Outbreak: Emotet Malware Activity Detected on Host | Security | A Fortinet product has detected a host with Emotet malware. | Outbreak: Emotet Malware Activity Detected on Host | hostIpAddr IS NOT NULL AND (eventType CONTAIN ""FortiGate-antivirus"" OR eventType CONTAIN ""FortiClient-av"") AND virusName IN (""W32/Agent.5C62!tr"",""W32/GenKryptik.FKJF!tr"",""MSIL/Agent.BEU!tr"",""VBA/Dloader.BLG!tr"") |
| Outbreak: Emotet Malware Activity Detected on Network | Security | Emotet Malware was detected by Fortinet Products on Network. | Outbreak: Emotet Malware Activity Detected on Network | hostIpAddr IS NULL AND (eventType CONTAIN ""FortiGate-antivirus"" OR eventType CONTAIN ""FortiClient-av"") AND virusName IN (""W32/Agent.5C62!tr"",""W32/GenKryptik.FKJF!tr"",""MSIL/Agent.BEU!tr"",""VBA/Dloader.BLG!tr"") |
| Windows: DNS Query for Ufile.io Upload Domain - Sysmon | Security | Detects DNS queries to ""ufile.io"". Which is often abused by malware for upload and exfiltration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_ufile_io.yml | Windows: DNS Query for Ufile.io Upload Domain - Sysmon | eventType=""Win-Sysmon-22-DNS-Query"" AND queryId REGEXP "".*ufile\.io.*"" |
| Elasticsearch Disaster Recovery: Restore Failed | Disponibilidade | Detects that FortiSIEM Elasticsearch Disaster Recovery restore failed | Elasticsearch Disaster Recovery: Restore Failed | eventType = ""PH_DATAPURGER_DR_ES_RESTORE_FAILED"" AND phEventCategory = 3 |
| Windows: PUA - Rclone Execution | Security | Detects execution of RClone utility for exfiltration as used by various ransomwares strains like REvil, Conti, FiveHands, etc. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_rclone_execution.yml | Windows: PUA - Rclone Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*--config .*"" AND command REGEXP "".*--no-check-certificate .*"" AND command REGEXP "".* copy .*"") OR ((procName REGEXP "".*\\rclone\.exe"" OR description=""Rsync for cloud storage"") AND command REGEXP "".*auto-confirm.*|.*config.*|.*copy.*|.*ftp.*|.*ignore-existing.*|.*ls.*|.*lsd.*|.*mega.*|.*multi-thread-streams.*|.*no-check-certificate .*|.*pass.*|.*pcloud.*|.*remote.*|.*sync.*|.*transfers.*|.*user.*"")) |
| Outbreak: Print Nightmare Activity Detected on Network | Security | Print Nightmare Exploit Activity was detected on Network | Outbreak: Print Nightmare Activity Detected on Network | reptVendor = ""Fortinet"" AND eventType NOT CONTAIN ""FortiClient"" AND ( virusName = ""MS.Windows.Print.Spooler.AddPrinterDriver.Privilege.Escalation"" OR vulnName = ""MS.Windows.Print.Spooler.AddPrinterDriver.Privilege.Escalation"" OR attackName = ""MS.Windows.Print.Spooler.AddPrinterDriver.Privilege.Escalation"" OR virusId IN (""68103"",""68104"",""68105"") OR vulnIdStr IN (""68103"",""68104"",""68105"") OR ipsSignatureId = 50553 ) |
| Outbreak: DARKSIDE Suspicious File Hash Found on Network | Security | File Hash Relating to DarkSide Ransomware Detected on Network | Outbreak: DARKSIDE Suspicious File Hash Found on Network | eventType CONTAIN ""FortiGate-"" AND ( hashMD5 IN (""262bc500b93b5238c6715543bdf6638e"",""02EA21DB281A790AA7DFECB6355D2572"",""0842f6de2f20e102a276030e0ad216d5"",""08646478a2ba16fa350a650e03bd115f"",""0B87CB91225E487710C6023C40E4A759"",""112669455CE35A4CCEFB4B8D7B961468"",""1210DCBFBB8532F25BAFDDA862FF2177"",""131EFF5622870F73F00C7F16C0646991"",""15e656071a642f9e91605d74367f7ec7"",""1716C6A315CE64EDC532F05906C3D704"",""18ea49336cade89c161c5975fda7cd6f"",""216C9ECED26BC6C7B1AF175C585DF26B"",""224E5C3A7521C2A98D03F1E5086ED50C"",""2491CE6F5FCC8BB20EA4C60E094390B0"",""27304b246c7d5b4e149124d5f93c5b01"",""29372529B316373D55EAE430ED710815"",""2F4159DDA4F5192D8CFD2DC3432C981F"",""394b17f84fc6c0ce40fccb800130153b"",""463dc22be6298fdbb0181be362615edd"",""464305094D4CBF567E2B8B64471D5F8E"",""46B157174C970DFE9D4FA71BA3AD9DBA"",""4812449F7FAD62162BA8C4179D5D45D7"",""4812449F7FAD62162BA8C4179D5D45D7"",""4d3d3919dda002511e03310c49b7b47f"",""577A1311362AB64DD86F14C7E6FDB319"",""653B8FC4F8E937DAC82291A46FC0981F"",""65E801948737814B76DFB4FA3975F311"",""6AF99FD0C053CA096D3FC61E41F1D07A"",""73F2BEF2D5BAD58106825E0FBE18AECD"",""8079676DD62582DA4D2E9D2448C1142D"",""8750C7ABA06A7188C227254E0515A954"",""897FD2E61928417881089E492639F58F"",""8A4E27CD31A3795E17E84E25DA524E80"",""954f9876d93fa5d3dde3c1fd89872f2a"",""979692CD7FC638BEEA6E9D68C752F360"",""987B65CD9B9F4E9A1AFD8F8B48CF64A7"",""9E1FD4F7F9C8FC94AFC2B2024ADE44F5"",""9e779da82d86bcd4cc43ab29f929f73f"",""A82B44581F7C7B70D7EC32411BA44D46"",""a8920685634d5793b2937510b2881e40"",""b20234935da806218ae8e4f435cee48"",""b278d7ec3681df16a541cf9e34d3b70a"",""B4A9C9EB091A81A65162C1F7957BDED4"",""C1174225533B6DB2D1E078B2EAA19028"",""c81dae5c67fb72a2c2f24b178aea50b7"",""e1ccabd83ec346cd9794c94801c6e6ab"",""E2ED793DED71E097436F5829A42F96D9"",""EA3999AF92A594402471748374A468FC"",""EBFD9B1F421FAC88DB43E1EA8D67AD52"") OR hashSHA1 IN (""121e68bfb9262c445f3b6ab7aba4b52fc1e22177"",""539c228b6b332f5aa523e5ce358c16647d8bbe57"",""9d2c297e9c185d30da1920e995eb13fe16562493"",""e50d9e3bd91908e13a26b3e23edeaf577fb3a095"",""bde75329827e15b8ba1cef76ffb15f775716f7f3"",""08d1da979f8d568b62701d7cedf1d0e81b7bab4d"",""0d35e1eab210859d746032b6200db0d74e45a6bc"",""13e2024d8b31b96f4617b62bf4eb8e9c9bf8f2f5"",""1b7172ec213997ed02ce1bf6dacb722f44a00576"",""1e0aa7aaeb8bddd03254f0c4cd0193268b132e4d"",""1f028ea7ae00bac06fe190482f9171f38b45d0d6"",""33a6b39fbe8ec45afab14af88fd6fa8e96885bf1"",""3d202aa6ad8cdccde1d59b5e3dab162f5fcbeda3"",""4bd6437cd1dc77097a7951466531674f80c866c6"",""7165647de8e84715299f177e7c840cabbd149763"",""7769cea037ebf692f1d94bab37aaa9d01c5db0dd"",""9d39c0d21b96ebb210fe467ad50604f05543db8e"",""9e1ee72ca493d9658d01910b2aea5a3728dee9e3"",""a14afbb27e7a9bd2740547427b7cdfc7d6548a92"",""c511ae4d80aaa281c610190aa13630de61ca714c"",""d1dfe82775c1d698dd7861d6dfa1352a74551d35"",""d6b7ebde993a9c4bc6adfa83dcc7fc4528bd2db3"",""d78fd52d7693b137f0cc3d56a77f5ec83c949575"",""DD4FCEC6BA1B763AAE50A7363409F591FE985D87"",""EB7918113E9E003EE811B5A16CBFFD251842D459"",""f16cad2eda3d0b5d07dde002fade6ff8102e4c8"") OR hashSHA256 IN (""5467a0aa064d7340031e9087cdbdacc2c656c80a458a913889f308056533d9eb"",""0a0c225f0e5ee941a79f2b7701f1285e4975a2859eb4d025d96d9e366e81abb9"",""48a848bc9e0f126b41e5ca196707412c7c40087404c0c8ed70e5cee4a418203a"",""7375adedb82fd62cefc6b6fd20a704a164e056022f3b8c2e1b94f3a9b8361478"",""9cee5522a7ca2bfca7cd3d9daba23e9a30deb6205f56c12045839075f7627297"",""B9D60D450664C1E8FBFD6B2EC58FDEB2FD81797E183906A4536B59BC4F79846F"",""eda7e4a81c2d689c3897ed3765a29e40c7708443d7281fcf08f143d8edf460cc"",""ab630fb08478f42b6cee4c7b397294964c24349e4aa58cbbe9180fe2c5c5051c"",""7d57e0ba8b36ec221b16807ce4e13a1125d53922fa50c3827a5ebd6811736ffd"",""0a0c225f0e5ee941a79f2b7701f1285e4975a2859eb4d025d96d9e366e81abb9"",""36bc32becf287402bf0e9c918de22d886a74c501a33aa08dcb9be2f222fa6e24"",""68872cc22fbdf0c2f69c32ac878ba9a7b7cf61fe5dd0e3da200131b8b23438e7"",""bafa2efff234303166d663f967037dae43701e7d63d914efc8c894b3e5be9408"",""f7eda7111ac0f95dfbd817bd0962defe35412de12964f178421122e96c72495b"",""b43bde75780244aeee719ae926c1f901291574c9400b5e6d0c2fdc135d0c6fe5"",""5467a0aa064d7340031e9087cdbdacc2c656c80a458a913889f308056533d9eb"",""ca77f63a08f4e01e7e7294695eb300610e65f22333256d547d0125075bed2cc8"",""b9d60d450664c1e8fbfd6b2ec58fdeb2fd81797e183906a4536b59bc4f79846f"",""48a848bc9e0f126b41e5ca196707412c7c40087404c0c8ed70e5cee4a418203a"",""9cee5522a7ca2bfca7cd3d9daba23e9a30deb6205f56c12045839075f7627297"",""2aa1bbbe47f04627a8ea4e8718ad21f0d50adf6a32ba4e6133ee46ce2cd13780"",""7375adedb82fd62cefc6b6fd20a704a164e056022f3b8c2e1b94f3a9b8361478"",""3337e3875b05e0bfba69ab926532e3f179e8cfbf162ebb60ce58a0281437a7ef"") ) |
| Outbreak: Emotet Malware Activity Detected by FortiClient | Security | Forticlient has detected a host with Emotet malware. | Outbreak: Emotet Malware Activity Detected by FortiClient | hostName IS NOT NULL AND ( eventType CONTAIN ""FortiClient-av"" OR eventType CONTAIN ""FortiClient-traffic"" ) AND virusName IN (""W32/Agent.5C62!tr"",""W32/GenKryptik.FKJF!tr"",""MSIL/Agent.BEU!tr"",""VBA/Dloader.BLG!tr"") |
| Discovered Device Incorrectly Merged: Overlapping IP | Disponibilidade | Detects that a discovered device is merged (incorrectly) to an existing CMDB device with different host name because of one or more overlapping IP addresses. To avoid such merging, include the overlapping IP addresses in the list of Virtual IP addresses and rediscover | Discovered Device Incorrectly Merged: Overlapping IP | eventType = ""PH_AUDIT_DEVICE_MERGED_BY_IP_WITH_DIFF_NAME"" AND phEventCategory = 2 |
| Windows: DNS Query for MEGA.io Upload Domain | Security | Detects DNS queries for subdomains used for upload to MEGA.io. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_mega_nz.yml | Windows: DNS Query for MEGA.io Upload Domain | eventType=""Win-Sysmon-22-DNS-Query"" AND queryId REGEXP "".*userstorage\.mega\.co\.nz.*"" |
| Windows: Communication To Ngrok.Io | Security | Detects an executable accessing ngrok.io, which could be a sign of forbidden exfiltration of data exfiltration by malicious actors. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_ngrok_io.yml | Windows: Communication To Ngrok.Io | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND initiated=""true"" AND destName REGEXP "".*\.ngrok\.io"" |
| Outbreak: DARKSIDE Ransomware Outbound Network Traffic Detected | Security | Detects if outbound traffic to known malicious IPs associated with DarkSide occurred. | Outbreak: DARKSIDE Ransomware Outbound Network Traffic Detected | destIpAddr IN (176.123.2.216,51.210.138.71,185.105.109.19,192.3.141.157,213.252.247.18,23.95.85.176,159.65.225.72,80.209.241.4,46.166.128.144,108.62.118.232,185.203.116.7,185.203.117.159,104.21.69.79,172.67.206.76,185.203.116.28,198.54.117.197,198.54.117.199,185.243.214.107,45.61.138.171,45.84.0.127,88.85.66.195,139.45.195.28,139.45.195.93,139.45.196.12,139.45.196.74,146.185.16.146,173.192.200.70,173.237.15.140,173.237.15.156,185.225.208.133,193.124.201.171,88.85.66.196,88.85.66.201,88.85.82.153,88.85.82.189,89.19.36.48,139.45.195.149) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic,Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Outbreak: DARKSIDE Ransomware File Activity Detected on Host | Security | An IPS, EDR, or XDR product has detected malware known to be associated with DarkSide Ransomware activity | Outbreak: DARKSIDE Ransomware File Activity Detected on Host | (eventType CONTAIN ""FortiClient"" OR eventType CONTAIN ""FortiSandbox"") AND virusName IN (""PossibleThreat"",""Riskware/Agent"",""Riskware/PCH"",""Riskware/PowerTool"",""Riskware/RemoteUtilities"",""Riskware/TorTool"",""W32/DarkSide.B!tr.ransom"",""W32/Filecoder.ODE!tr.ransom"",""W32/Filecoder_DarkSide.A!tr"",""W32/Filecoder_DarkSide.B!tr"",""W32/GenKryptik.FBOV!tr"",""W32/Packed.OBSIDIUM.BV!tr"",""W64/Kryptik.BVR!tr"") |
| Outbreak: DEARCRY Infected File Detected on Host | Security | DEARCRY Infected File was Detected on a Host | Outbreak: DEARCRY Infected File Detected on Host | (eventType CONTAIN ""FortiClient"" OR eventType CONTAIN ""FortiSandbox"") AND virusName IN (""W32/DearCry.OGE!tr"",""W32/DearCry.OGE!tr.ransom"",""W32/Filecoder.OGE!tr"",""PossibleThreat.ARN.H"",""W32/Encoder!tr"",""W32/Encoder.OGE!tr.ransom"") |
| Windows: DNS Query for Anonfiles.com Domain - DNS Client | Security | Detects DNS queries for anonfiles.com, which is an anonymous file upload platform often used for malicious purposes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/dns_client/win_dns_client_anonymfiles_com.yml | Windows: DNS Query for Anonfiles.com Domain - DNS Client | eventType = ""Win-DNS-Client-3008"" AND queryId REGEXP "".*\.anonfiles\.com.*"" |
| Outbreak: DARKSIDE Ransomware Inbound Network Traffic Detected | Security | Detects if Inbound traffic to known malicious IPs associated with DarkSide occurred. | Outbreak: DARKSIDE Ransomware Inbound Network Traffic Detected | srcIpAddr IN (176.123.2.216,51.210.138.71,185.105.109.19,192.3.141.157,213.252.247.18,23.95.85.176,159.65.225.72,80.209.241.4,46.166.128.144,108.62.118.232,185.203.116.7,185.203.117.159,104.21.69.79,172.67.206.76,185.203.116.28,198.54.117.197,198.54.117.199,185.243.214.107,45.61.138.171,45.84.0.127,88.85.66.195,139.45.195.28,139.45.195.93,139.45.196.12,139.45.196.74,146.185.16.146,173.192.200.70,173.237.15.140,173.237.15.156,185.225.208.133,193.124.201.171,88.85.66.196,88.85.66.201,88.85.82.153,88.85.82.189,89.19.36.48,139.45.195.149) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic,Group@PH_SYS_EVENT_DenyNetTraffic) |
| Outbreak: Emotet Suspicious File Hash Found by Forticlient | Security | Emotet malware hash detected by Forticlient. | Outbreak: Emotet Suspicious File Hash Found by Forticlient | hostName IS NOT NULL AND ( eventType CONTAIN ""FortiClient-av"" OR eventType CONTAIN ""FortiClient-traffic"" ) AND ( hashMD5 IN (""c17a1a08f40029c5134c7dfee8855c62"",""ea24cb1a4b92c92199eb73a1bd6d0dbc"",""7cf0ae7e45e7f92e668e41b104187cce"") OR hashCode IN (""c17a1a08f40029c5134c7dfee8855c62"",""ea24cb1a4b92c92199eb73a1bd6d0dbc"",""7cf0ae7e45e7f92e668e41b104187cce"") ) |
| EventDB: Event Retention Policy Error | Disponibilidade | Detects Policy Based Event Retention Errors | EventDB: Event Retention Policy Error | phEventCategory = 3 AND eventType = ""PH_SYSTEM_RETENTION_POLICY_FAILED"" |
| Windows: Suspicious WebDav Client Execution | Security | Detects ""svchost.exe"" spawning ""rundll32.exe"" with command arguments like C:\windows\system32\davclnt.dll,DavSetCookie. This could be an indicator of exfiltration or use of WebDav to launch code (hosted on WebDav Server) or potentially a sign of exploitation of CVE-2023-23397 . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_webdav_client_susp_execution.yml | Windows: Suspicious WebDav Client Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\svchost\.exe"" AND parentCommand REGEXP "".*-s WebClient.*"" AND procName REGEXP "".*\\rundll32\.exe"" AND command REGEXP "".*C:\\windows\\system32\\davclnt\.dll,DavSetCookie.*"") AND ((command NOT REGEXP "".*://10\..*|.*://127\..*|.*://169\.254\..*|.*://172\.16\..*|.*://172\.17\..*|.*://172\.18\..*|.*://172\.19\..*|.*://172\.20\..*|.*://172\.21\..*|.*://172\.22\..*|.*://172\.23\..*|.*://172\.24\..*|.*://172\.25\..*|.*://172\.26\..*|.*://172\.27\..*|.*://172\.28\..*|.*://172\.29\..*|.*://172\.30\..*|.*://172\.31\..*|.*://192\.168\..*"")) |
| Web Traffic to FortiGuard Malicious URLs | Security | Detects HTTP traffic where the URL matches the external FortiGuard Malicious URL list | Web Traffic to FortiGuard Malicious URLs | infoURL IN (Group@PH_SYS_FORTIGUARD_BLOCKED_URL) AND eventType IN (Group@PH_SYS_EVENT_PermitWebTraffic) |
| Outbreak: DARKSIDE Suspicious File Hash Found on Host | Security | File Hash Relating to DarkSide Ransomware Detected on Host | Outbreak: DARKSIDE Suspicious File Hash Found on Host | eventType CONTAIN ""FortiGate-"" AND ( hashMD5 IN (""262bc500b93b5238c6715543bdf6638e"",""02EA21DB281A790AA7DFECB6355D2572"",""0842f6de2f20e102a276030e0ad216d5"",""08646478a2ba16fa350a650e03bd115f"",""0B87CB91225E487710C6023C40E4A759"",""112669455CE35A4CCEFB4B8D7B961468"",""1210DCBFBB8532F25BAFDDA862FF2177"",""131EFF5622870F73F00C7F16C0646991"",""15e656071a642f9e91605d74367f7ec7"",""1716C6A315CE64EDC532F05906C3D704"",""18ea49336cade89c161c5975fda7cd6f"",""216C9ECED26BC6C7B1AF175C585DF26B"",""224E5C3A7521C2A98D03F1E5086ED50C"",""2491CE6F5FCC8BB20EA4C60E094390B0"",""27304b246c7d5b4e149124d5f93c5b01"",""29372529B316373D55EAE430ED710815"",""2F4159DDA4F5192D8CFD2DC3432C981F"",""394b17f84fc6c0ce40fccb800130153b"",""463dc22be6298fdbb0181be362615edd"",""464305094D4CBF567E2B8B64471D5F8E"",""46B157174C970DFE9D4FA71BA3AD9DBA"",""4812449F7FAD62162BA8C4179D5D45D7"",""4812449F7FAD62162BA8C4179D5D45D7"",""4d3d3919dda002511e03310c49b7b47f"",""577A1311362AB64DD86F14C7E6FDB319"",""653B8FC4F8E937DAC82291A46FC0981F"",""65E801948737814B76DFB4FA3975F311"",""6AF99FD0C053CA096D3FC61E41F1D07A"",""73F2BEF2D5BAD58106825E0FBE18AECD"",""8079676DD62582DA4D2E9D2448C1142D"",""8750C7ABA06A7188C227254E0515A954"",""897FD2E61928417881089E492639F58F"",""8A4E27CD31A3795E17E84E25DA524E80"",""954f9876d93fa5d3dde3c1fd89872f2a"",""979692CD7FC638BEEA6E9D68C752F360"",""987B65CD9B9F4E9A1AFD8F8B48CF64A7"",""9E1FD4F7F9C8FC94AFC2B2024ADE44F5"",""9e779da82d86bcd4cc43ab29f929f73f"",""A82B44581F7C7B70D7EC32411BA44D46"",""a8920685634d5793b2937510b2881e40"",""b20234935da806218ae8e4f435cee48"",""b278d7ec3681df16a541cf9e34d3b70a"",""B4A9C9EB091A81A65162C1F7957BDED4"",""C1174225533B6DB2D1E078B2EAA19028"",""c81dae5c67fb72a2c2f24b178aea50b7"",""e1ccabd83ec346cd9794c94801c6e6ab"",""E2ED793DED71E097436F5829A42F96D9"",""EA3999AF92A594402471748374A468FC"",""EBFD9B1F421FAC88DB43E1EA8D67AD52"") OR hashSHA1 IN (""121e68bfb9262c445f3b6ab7aba4b52fc1e22177"",""539c228b6b332f5aa523e5ce358c16647d8bbe57"",""9d2c297e9c185d30da1920e995eb13fe16562493"",""e50d9e3bd91908e13a26b3e23edeaf577fb3a095"",""bde75329827e15b8ba1cef76ffb15f775716f7f3"",""08d1da979f8d568b62701d7cedf1d0e81b7bab4d"",""0d35e1eab210859d746032b6200db0d74e45a6bc"",""13e2024d8b31b96f4617b62bf4eb8e9c9bf8f2f5"",""1b7172ec213997ed02ce1bf6dacb722f44a00576"",""1e0aa7aaeb8bddd03254f0c4cd0193268b132e4d"",""1f028ea7ae00bac06fe190482f9171f38b45d0d6"",""33a6b39fbe8ec45afab14af88fd6fa8e96885bf1"",""3d202aa6ad8cdccde1d59b5e3dab162f5fcbeda3"",""4bd6437cd1dc77097a7951466531674f80c866c6"",""7165647de8e84715299f177e7c840cabbd149763"",""7769cea037ebf692f1d94bab37aaa9d01c5db0dd"",""9d39c0d21b96ebb210fe467ad50604f05543db8e"",""9e1ee72ca493d9658d01910b2aea5a3728dee9e3"",""a14afbb27e7a9bd2740547427b7cdfc7d6548a92"",""c511ae4d80aaa281c610190aa13630de61ca714c"",""d1dfe82775c1d698dd7861d6dfa1352a74551d35"",""d6b7ebde993a9c4bc6adfa83dcc7fc4528bd2db3"",""d78fd52d7693b137f0cc3d56a77f5ec83c949575"",""DD4FCEC6BA1B763AAE50A7363409F591FE985D87"",""EB7918113E9E003EE811B5A16CBFFD251842D459"",""f16cad2eda3d0b5d07dde002fade6ff8102e4c8"") OR hashSHA256 IN (""5467a0aa064d7340031e9087cdbdacc2c656c80a458a913889f308056533d9eb"",""0a0c225f0e5ee941a79f2b7701f1285e4975a2859eb4d025d96d9e366e81abb9"",""48a848bc9e0f126b41e5ca196707412c7c40087404c0c8ed70e5cee4a418203a"",""7375adedb82fd62cefc6b6fd20a704a164e056022f3b8c2e1b94f3a9b8361478"",""9cee5522a7ca2bfca7cd3d9daba23e9a30deb6205f56c12045839075f7627297"",""B9D60D450664C1E8FBFD6B2EC58FDEB2FD81797E183906A4536B59BC4F79846F"",""eda7e4a81c2d689c3897ed3765a29e40c7708443d7281fcf08f143d8edf460cc"",""ab630fb08478f42b6cee4c7b397294964c24349e4aa58cbbe9180fe2c5c5051c"",""7d57e0ba8b36ec221b16807ce4e13a1125d53922fa50c3827a5ebd6811736ffd"",""0a0c225f0e5ee941a79f2b7701f1285e4975a2859eb4d025d96d9e366e81abb9"",""36bc32becf287402bf0e9c918de22d886a74c501a33aa08dcb9be2f222fa6e24"",""68872cc22fbdf0c2f69c32ac878ba9a7b7cf61fe5dd0e3da200131b8b23438e7"",""bafa2efff234303166d663f967037dae43701e7d63d914efc8c894b3e5be9408"",""f7eda7111ac0f95dfbd817bd0962defe35412de12964f178421122e96c72495b"",""b43bde75780244aeee719ae926c1f901291574c9400b5e6d0c2fdc135d0c6fe5"",""5467a0aa064d7340031e9087cdbdacc2c656c80a458a913889f308056533d9eb"",""ca77f63a08f4e01e7e7294695eb300610e65f22333256d547d0125075bed2cc8"",""b9d60d450664c1e8fbfd6b2ec58fdeb2fd81797e183906a4536b59bc4f79846f"",""48a848bc9e0f126b41e5ca196707412c7c40087404c0c8ed70e5cee4a418203a"",""9cee5522a7ca2bfca7cd3d9daba23e9a30deb6205f56c12045839075f7627297"",""2aa1bbbe47f04627a8ea4e8718ad21f0d50adf6a32ba4e6133ee46ce2cd13780"",""7375adedb82fd62cefc6b6fd20a704a164e056022f3b8c2e1b94f3a9b8361478"",""3337e3875b05e0bfba69ab926532e3f179e8cfbf162ebb60ce58a0281437a7ef"") ) |
| Outbreak: DARKSIDE Ransomware File Activity Detected on Network | Security | An IPS, EDR, or XDR product has detected malware known to be associated with DarkSide Ransomware activity from FortiGate Firewalls, FortiWeb, FortiNDR, or FortiMail | Outbreak: DARKSIDE Ransomware File Activity Detected on Network | (eventType CONTAIN ""FortiGate"" OR eventType CONTAIN ""FortiWeb"" OR eventType CONTAIN ""FortiNDR"" OR eventType CONTAIN ""FortiMail"") AND virusName IN (""PossibleThreat"",""Riskware/Agent"",""Riskware/PCH"",""Riskware/PowerTool"",""Riskware/RemoteUtilities"",""Riskware/TorTool"",""W32/DarkSide.B!tr.ransom"",""W32/Filecoder.ODE!tr.ransom"",""W32/Filecoder_DarkSide.A!tr"",""W32/Filecoder_DarkSide.B!tr"",""W32/GenKryptik.FBOV!tr"",""W32/Packed.OBSIDIUM.BV!tr"",""W64/Kryptik.BVR!tr"") |
| Outbreak: Print Nightmare Activity Detected on Host | Security | Print Nightmare Exploit Activity was detected on Host | Outbreak: Print Nightmare Activity Detected on Host | eventType CONTAIN ""FortiClient"" AND ( virusName = ""MS.Windows.Print.Spooler.AddPrinterDriver.Privilege.Escalation"" OR vulnName = ""MS.Windows.Print.Spooler.AddPrinterDriver.Privilege.Escalation"" OR attackName = ""MS.Windows.Print.Spooler.AddPrinterDriver.Privilege.Escalation"" OR virusId IN (""68103"",""68104"",""68105"") OR vulnIdStr IN (""68103"",""68104"",""68105"") OR ipsSignatureId = 50553 ) |
| Outbreak: DEARCRY Infected File Detected on Network | Security | DEARCRY Infected File was Detected on Network by FortiGate Firewall, FortiWeb, FortiMail or FortiNDR | Outbreak: DEARCRY Infected File Detected on Network | (eventType CONTAIN ""FortiGate"" OR eventType CONTAIN ""FortiWeb"" OR eventType CONTAIN ""FortiNDR"" OR eventType CONTAIN ""FortiMail"") AND virusName IN (""W32/DearCry.OGE!tr"",""W32/DearCry.OGE!tr.ransom"",""W32/Filecoder.OGE!tr"",""PossibleThreat.ARN.H"",""W32/Encoder!tr"",""W32/Encoder.OGE!tr.ransom"") |
| Outbreak: Emotet Suspicious File Hash Found on Network | Security | Emotet malware hash detected by Fortinet Products on network. | Outbreak: Emotet Suspicious File Hash Found on Network | hostIpAddr IS NULL AND (eventType CONTAIN ""FortiGate-antivirus"" OR eventType CONTAIN ""FortiClient-av"") AND ( hashMD5 IN (""c17a1a08f40029c5134c7dfee8855c62"",""ea24cb1a4b92c92199eb73a1bd6d0dbc"",""7cf0ae7e45e7f92e668e41b104187cce"") OR hashCode IN (""c17a1a08f40029c5134c7dfee8855c62"",""ea24cb1a4b92c92199eb73a1bd6d0dbc"",""7cf0ae7e45e7f92e668e41b104187cce"") ) |
| Windows: DNS Query for Ufile.io Upload Domain - DNS Client | Security | Detects DNS queries to ""ufile.io"". Which is often abused by malware for upload and exfiltration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/dns_client/win_dns_client_ufile_io.yml | Windows: DNS Query for Ufile.io Upload Domain - DNS Client | eventType = ""Win-DNS-Client-3008"" AND queryId REGEXP "".*ufile\.io.*"" |
| Traffic to Anomali ThreatStream Malware IP List | Security | Detects network traffic to Anomali ThreatStream Blocked IP List | Traffic to Anomali ThreatStream Malware IP List | destIpAddr IN (Group@PH_SYS_THREATSTREAM_BLOCKED_IP) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic, Group@PH_SYS_EVENT_DenyNetTraffic) |
| Elasticsearch Disaster Recovery: Snapshot Failed | Disponibilidade | Detects that FortiSIEM Elasticsearch Disaster Recovery snapshots failed | Elasticsearch Disaster Recovery: Snapshot Failed | eventType = ""PH_DATAPURGER_DR_ES_SNAPSHOT_FAILED"" AND phEventCategory = 3 |
| Web Traffic to FortiSandbox Malicious URLs | Security | Detects HTTP traffic where the URL matches the external FortiSandbox Malicious URL list | Web Traffic to FortiSandbox Malicious URLs | infoURL IN (Group@PH_SYS_FORTISANDBOX_BLOCKED_URL) AND eventType IN (Group@PH_SYS_EVENT_PermitWebTraffic) |
| Permitted Traffic from Anomali ThreatStream Malware IP List | Security | Detects network traffic from Anomali ThreatStream Malware IP List | Permitted Traffic from Anomali ThreatStream Malware IP List | srcIpAddr IN (Group@PH_SYS_THREATSTREAM_BLOCKED_IP) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Permitted Traffic from FortiGuard Malware IP List | Security | Detects network traffic from FortiGuard Malware IP List | Permitted Traffic from FortiGuard Malware IP List | srcIpAddr IN (Group@PH_SYS_FORTIGUARD_BLOCKED_IP) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Web Traffic to Anomali ThreatStream Malicious URLs | Security | Detects HTTP traffic where the URL matches the external Anomali ThreatStream Malicious URL list | Web Traffic to Anomali ThreatStream Malicious URLs | infoURL IN (Group@PH_SYS_THREATSTREAM_BLOCKED_URL) AND eventType IN (Group@PH_SYS_EVENT_PermitWebTraffic) |
| Windows: Communication To Mega.nz | Security | Detects an executable accessing mega.co.nz, which could be a sign of forbidden file sharing use of data exfiltration by malicious actors. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_mega_nz.yml | Windows: Communication To Mega.nz | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND initiated=""true"" AND destName REGEXP "".*api\.mega\.co\.nz"" |
| Outbreak: F5 BIG-IP TMM Attack - FortiGate IPS Exploit Permitted | Security | This indicates an attack attempt to exploit a Buffer Overflow Vulnerability in F5 BIG-IP Traffic Management Microkernel (TMM). The vulnerability is due to an input validation error when normalizing invalid IPv6 hostnames. A remote attacker may be able to exploit this to execute arbitrary code or lead to a denial of service condition within the context of the application, via a crafted HTTP request. | Outbreak: F5 BIG-IP TMM Attack - FortiGate IPS Exploit Permitted | eventType CONTAIN ""FortiGate-ips-signature-"" AND ipsSignatureId IN (49979,50002,49976) AND eventAction = 0 |
| EventDB: Excessive Data Retention Policy Execution Time | Disponibilidade | Detects that policy based event retention took more than 6 hours to execute. This may be caused by too many complex policies or not enough resources on Supervisor node. | EventDB: Excessive Data Retention Policy Execution Time | phEventCategory = 3 AND eventType = ""PH_SYSTEM_RETENTION_POLICY_EXEC_TIME"" |
| FortiSIEM Event Archiving Completed | Disponibilidade | Detects that system archived event database files to offline storage | FortiSIEM Event Archiving Completed | phEventCategory = 3 AND eventType IN (""PH_SYSTEM_DISK_ARCHIVING_FINISHED"",""PH_ES_HOT_STORAGE_ARCHIVING_FINISHED"",""PH_ES_WARM_STORAGE_ARCHIVING_FINISHED"",""PH_ES_COLD_STORAGE_ARCHIVING_FINISHED"") AND totBytes64 > 0 |
| Large Worker Input SVN Queue | Performance | Detects that Worker input SVN queue is very large (greater than 100MB). This indicates that the workers are falling behind in handling SVN files from collectors or from the parser modules. Check the SVN installation. | Large Worker Input SVN Queue | eventType = ""PH_EVT_HANDLER_SVN_QUEUE_WARNING"" |
| Large Supervisor JMS System Queue | Performance | Detects that Supervisor JMS System queue is very large | Large Supervisor JMS System Queue | eventType = ""PH_JMS_QUEUE_SIZE_WARNING"" AND jmsQueueType = ""system"" |
| Performance Monitoring Error | Disponibilidade | Detects that the system failed to monitor a performance monitoring metric | Performance Monitoring Error | eventType = ""PH_JOB_STAT"" AND (jobStatus = 1 OR jobStatus = 2) AND phEventCategory = 3 |
| No Events Reported From External Apps In Last Hour | Disponibilidade | Detects that a reporting application that previously reported events, did not report any events this hour. | No Events Reported From External Apps In Last Hour | phEventCategory = 3 AND eventType = ""PH_SYSTEM_DEVAPP_NO_EVENTS"" |
| Sudden Decrease in Reported Events From A Host | Disponibilidade | Detects that a reporting device is suddenly reporting less events. The current average over the one hour time window is less than 3 times the standard deviation and also 50% less than the statistical mean | Sudden Decrease in Reported Events From A Host | phEventCategory = 3 AND eventType = ""PH_SYSTEM_IP_EVENTS_PER_SEC"" |
| EventDB: Event Retention Policy Violation | Disponibilidade | Detects Event Retention Policy Violations | EventDB: Event Retention Policy Violation | phEventCategory = 3 AND eventType IN (""PH_SYSTEM_ONLINE_RETENTION_POLICY_VIOLATED"", ""PH_SYSTEM_ARCHIVE_RETENTION_POLICY_VIOLATED"") |
| FortiSIEM Online Event Successfully Purged | Disponibilidade | Detects that FortiSIEM successfully purged online event. This is normal operation when online database gets full and new events need to be accommodated | FortiSIEM Online Event Successfully Purged | phEventCategory = 3 AND eventType IN (""PH_SYSTEM_DISK_PURGING_FINISHED"",""PH_ES_HOT_STORAGE_PURGING_FINISHED"",""PH_ES_WARM_STORAGE_PURGING_FINISHED"",""PH_ES_COLD_STORAGE_PURGING_FINISHED"", ""PH_ES_ARCHIVE_STORAGE_PURGING_FINISHED"") AND totBytes64 > 0 |
| Scheduled Report Send Error | Disponibilidade | Detects that system has failed to deliver a scheduled report | Scheduled Report Send Error | eventType = ""PH_REPORT_ACTION_STATUS"" AND actionResult = ""Failed"" |
| No Events Reported From External Devices In Last Hour | Disponibilidade | Detects that a reporting device that reported events (logs etc) in the last hour did not report any events this hour. This does not include monitoring events (like CPU, Memory etc). This indicates that there is a problem in the network or at the reporting device. | No Events Reported From External Devices In Last Hour | phEventCategory = 3 AND eventType = ""PH_SYSTEM_DEVICE_NO_EVENTS"" |
| Outbound Incident Integration Error | Disponibilidade | Detects that an FortiSIEM incident failed to be pushed to a ticketing system | Outbound Incident Integration Error | phEventCategory = 3 AND eventType = ""PH_APPSERVER_OUT_INTEGRATION_ERROR"" AND objType = ""Incident"" |
| Inbound Incident Integration Error | Disponibilidade | Detects that an FortiSIEM incident external status failed to be updated | Inbound Incident Integration Error | phEventCategory = 3 AND eventType = ""PH_APPSERVER_IN_INTEGRATION_ERROR"" AND objType = ""Incident"" |
| Large Supervisor JMS Request Queue | Performance | Detects that Supervisor JMS Request queue is very large | Large Supervisor JMS Request Queue | eventType = ""PH_JMS_QUEUE_SIZE_WARNING"" AND jmsQueueType = ""request"" |
| FortiSIEM Archive Purging Failed | Disponibilidade | Detects that system failed to purge archive files because of internal errors | FortiSIEM Archive Purging Failed | phEventCategory = 3 AND eventType IN (""PH_SYSTEM_ARCHIVE_PURGING_POLICY_FAILED"",""PH_SYSTEM_ARCHIVE_PURGING_LOW_SPACE_FAILED"",""PH_HDFS_PURGING_FAILED"") |
| FortiSIEM EPS License Exceeded | Disponibilidade | Detects that global EPS license is exceeded even with elastic EPS redistribution. Events will be dropped unless the license is upgraded. | FortiSIEM EPS License Exceeded | phEventCategory = 3 AND eventType = ""PH_PARSER_GLOBAL_LICENSE_EXCEED"" |
| Large Worker Input Event Queue | Performance | Detects that Worker input event queue is very large (greater than 100MB). This indicates that the workers are falling behind in handling events and cannot keep pace with the rate at which workers are sending events. | Large Worker Input Event Queue | eventType = ""PH_EVT_HANDLER_EVT_QUEUE_WARNING"" |
| FortiSIEM CMDB Disk space low - prune successful | Disponibilidade | Detects that FortiSIEM CMDB Disk space is below low threshold (cmdb_disk_space_low_threshold_MB). Incidents and Identity Location data older than month_retain_limit months were deleted to bring the free disk above high threshold (cmdb_disk_space_high_threshold_MB) | FortiSIEM CMDB Disk space low - prune successful | eventType = ""PH_AUDIT_CMDB_DISK_PRUNE_SUCCESS"" |
| No performance metrics from a device | Disponibilidade | Detects that a FortiSIEM has not received any performance metric from a device for a configured period of time. This indicates that (a)the FortiSIEM system has a perf monitoring metric collection/delivery problem in a specific module or (b) there is a connectivity issue between the device and FortiSIEM or (c) there is a connectivity problem within the FortiSIEM cloud. | No performance metrics from a device | eventType = ""PH_DEV_MON_PERFMON_DEVICE_DELAY_HIGH"" |
| FortiSIEM CMDB Disk space low - prune failed to keep free disk space above high threshold | Disponibilidade | Detects that FortiSIEM CMDB Disk space is below low threshold (cmdb_disk_space_low_threshold_MB). Even after pruning Incidents and Identity Location data older than month_retain_limit months, free disk remains below high threshold (cmdb_disk_space_high_threshold_MB). Consider increasing the CMDB disk space or reducing retention period: month_retain_limit. | FortiSIEM CMDB Disk space low - prune failed to keep free disk space above high threshold | eventType = ""PH_AUDIT_CMDB_DISK_PRUNE_FAILED"" |
| Performance monitoring jobs not picked up for execution | Disponibilidade | Performance monitoring jobs not picked up for execution | Performance monitoring jobs not picked up for execution | eventType = ""PH_AUDIT_DEV_MON_JOB_NOT_STARTED"" |
| Performance monitoring jobs deleted by discovery | Disponibilidade | FortiSIEM discovery procedure removed performance monitoring jobs because credentials became invalid or job execution failed during discovery. Discovery tests whether the jobs can still run using the credentials provided. PING jobs are never removed but all other jobs are removed. Incorrect credentials lead to protocol timeouts which in turn lead to bad performance affecting all other devices. | Performance monitoring jobs deleted by discovery | eventType = ""PH_AUDIT_DEV_MON_JOB_STATUS_CHANGE"" AND jobStatusType IN (""DiscoveryRemoved"", ""DiscoveryNotScheduled"") |
| FortiSIEM Event Archiving Failed | Disponibilidade | Detects that FortiSIEM failed to archive online event database files to offline storage. Works for both FortiSIEM EventDB and Elasticsearch. | FortiSIEM Event Archiving Failed | phEventCategory = 3 AND eventType IN (""PH_SYSTEM_DISK_ARCHIVING_FAILED"",""PH_SYSTEM_ARCHIVE_PURGING_POLICY_FAILED"",""PH_ES_HOT_STORAGE_ARCHIVING_FAILED"",""PH_ES_WARM_STORAGE_ARCHIVING_FAILED"", ""PH_ES_COLD_STORAGE_ARCHIVING_FAILED"",""PH_UNABLE_ACCESS_DIR"") |
| No logs from any device via Collector/Worker | Disponibilidade | Detects that a FortiSIEM system (e.g. Collector, Worker) is not relaying logs for any device. This indicates that the FortiSIEM system has a problem in a specific module or there is a connectivity issue with the FortiSIEM cloud. | No logs from any device via Collector/Worker | eventType = ""PH_DEV_MON_LOG_ALL_DEVICE_DELAY_HIGH"" |
| Incident Notification Error | Disponibilidade | Detects that system has failed to take notification action on an incident | Incident Notification Error | eventType = ""PH_INCIDENT_ACTION_STATUS"" AND actionResult = ""Failed"" AND phEventCategory = 3 |
| FortiSIEM Report Server Removed After License Expiry | Disponibilidade | FortiSIEM Report Server removed from CMDB after license grace period expired | FortiSIEM Report Server Removed After License Expiry | eventType = ""PH_AUDIT_REPORT_SERVER_LICENSE_EXPIRED"" |
| FortiSIEM: Low Available Archive Space | Disponibilidade | Detects that low (less than 20GB by default) available archive space - purging is going to start soon | FortiSIEM: Low Available Archive Space | phEventCategory = 3 AND eventType IN (""PH_SYSTEM_ARCHIVE_LOW"",""PH_HDFS_ARCHIVE_STORAGE_LOW"") |
| FortiSIEM EventDB event store failed | Disponibilidade | Detects the datamanager module is unable to create directory in NFS for writing event files even after a few retries. Data will be lost. | FortiSIEM EventDB event store failed | eventType = ""PH_UNABLE_CREATE_DIR"" |
| FortiSIEM: Too Many Unknown Events | Performance | FortiSIEM is receiving too many unknown events, this may cause high CPU or delay. | FortiSIEM: Too Many Unknown Events | phEventCategory = 3 AND eventType = ""PH_PARSER_TOO_MANY_UNKNOWN_EVENTS"" |
| No logs from a device | Disponibilidade | Detects that a FortiSIEM has not received a log from a device for a configured period of time. This indicates that (a) the FortiSIEM system has a log collection/delivery problem in a specific module or (b) there is a connectivity issue between the device and FortiSIEM or (c) there is a connectivity problem within the FortiSIEM cloud. | No logs from a device | eventType = ""PH_DEV_MON_LOG_DEVICE_DELAY_HIGH"" AND jobName IN (""NetFlow"",""Syslog"",""MS_WMI"",""CKP_SSLCA"",""CKP_CLEAR"",""Windows Agent"") AND hostIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) |
| Missing specific performance metric from a device | Disponibilidade | Detects that a FortiSIEM has not received a specific performance metric from a device for a configured period of time. This indicates that (a)the FortiSIEM system has a perf monitoring metric collection/delivery problem in a specific module or (b) there is a connectivity issue between the device and FortiSIEM or (c) there is a connectivity problem within the FortiSIEM cloud. | Missing specific performance metric from a device | eventType = ""PH_DEV_MON_PERFMON_JOB_DELAY_HIGH"" |
| FortiSIEM Archive Purging Completed | Disponibilidade | Detects that system purged archive files based on archive policy | FortiSIEM Archive Purging Completed | phEventCategory = 3 AND eventType IN (""PH_SYSTEM_ARCHIVE_PURGING_POLICY_FINISHED"", ""PH_SYSTEM_ARCHIVE_PURGING_LOW_SPACE_FINISHED"",""PH_HDFS_PURGING_FINISHED"") AND totBytes64 > 0 |
| FortiSIEM Agent Operational Error | Disponibilidade | Detects FortiSIEM Linux/Windows Agent Operational errors - uninstalls, stopped and non-responsive | FortiSIEM Agent Operational Error | eventType IN (""PH_AUDIT_AGENT_NOTRESPONDING"", ""PH_AUDIT_AGENT_STOPPED"", ""PH_AUDIT_AGENT_UNINSTALLED"") |
| FortiSIEM: Low Available EventDB Storage | Disponibilidade | Detects the free space of the file system containing the folder /data/eventdb used for storing events is lower than a warning threshold - default 20GB. Once the free space is lower than critical threshold (default 10GB), the system will automatically purge old events until the free space is more than 20GB. | FortiSIEM: Low Available EventDB Storage | phEventCategory = 3 AND eventType = ""PH_SYSTEM_STORAGE_LOW"" |
| External Event Dropped By License | Disponibilidade | Detects that events are dropped because of inadequate license | External Event Dropped By License | phEventCategory = 3 AND eventType = ""PH_SYSTEM_EPS_GLOBAL"" |
| FortiSIEM Performance Monitoring Relay Not Working: All Devices delayed | Disponibilidade | Detects that a FortiSIEM system (e.g. Collector, Worker) is not collecting/relaying performance metrics for any device. This indicates that the FortiSIEM system has a problem in a specific module or there is a connectivity issue with the FortiSIEM cloud. | FortiSIEM Performance Monitoring Relay Not Working: All Devices delayed | eventType = ""PH_DEV_MON_PERFMON_ALL_DEVICE_DELAY_HIGH"" |
| FortiSIEM Archive Purging Started | Disponibilidade | Detects that system is starting to purge archived event files because of low space or retention policy | FortiSIEM Archive Purging Started | phEventCategory = 3 AND eventType IN (""PH_SYSTEM_ARCHIVE_PURGING_LOW_SPACE_STARTED"",""PH_SYSTEM_ARCHIVE_PURGING_POLICY_STARTED"",""PH_HDFS_PURGING_STARTED"") |
| ArubaOS-CX: Multiple Users Deleted | Change | Aruba OS CX Switch Platform Reported that an Admin deleted more than two users from the switch in a 15 minute interval. | ArubaOS-CX: Multiple Users Deleted | eventType = ""ArubaCx-UserDeleted"" |
| Auto Service Stopped | Disponibilidade | Detects that an automatically running service stopped. Currently this works for windows servers and is detected via WMI. | Auto Service Stopped | eventType = ""PH_DEV_MON_AUTO_SVC_START_TO_STOP"" |
| AWS RDS Instance/Cluster Stopped | Security | Identifies that an Amazon Relational Database Service (RDS) cluster or instance has been stopped. | AWS RDS Instance/Cluster Stopped | eventType IN (""AWS-CloudTrail-RDS-StopDBCluster"",""AWS-CloudTrail-RDS-StopDBInstance"") |
| AWS IAM Group Deleted | Security | Identifies the deletion of a specified AWS Identity and Access Management (IAM) resource group. Deleting a resource group does not delete resources that are members of the group; it only deletes the group structure. | AWS IAM Group Deleted | eventType CONTAIN ""AWS-CloudTrail-IAM-DeleteGroup"" |
| AWS RDS Cluster Deleted | Security | Identifies the deletion of an Amazon Relational Database Service (RDS) Aurora database cluster or global database cluster. | AWS RDS Cluster Deleted | eventType IN (""AWS-CloudTrail-RDS-DeleteDBCluster"",""AWS-CloudTrail-RDS-DeleteGlobalCluster"") |
| AWS SecHub: Unusal Serverless Behavior Detected | Security | AWS Security Hub detected unusual serverless behavior | AWS SecHub: Unusal Serverless Behavior Detected | eventType = ""AWS-Hub-Unusual_Behaviors-Serverless"" |
| AWS EC2 Instance Down | Disponibilidade | Detects a EC2 instance is down | AWS EC2 Instance Down | eventType = ""PH_DEV_MON_EC2_INSTANCE_DOWN"" |
| AWS SecHub: Software and Configuration Violation | Security | AWS Security and Configuration Violation Detected | AWS SecHub: Software and Configuration Violation | eventType CONTAIN ""AWS-Hub-Software_and_Configuration_Checks"" |
| AWS SecHub: Unusual Application Behavior Detected | Security | AWS Security Hub detected unusal application behavior. | AWS SecHub: Unusual Application Behavior Detected | eventType = ""AWS-Hub-Unusual_Behaviors-Application"" |
| Storage Hardware Warning | Disponibilidade | Detects a storage hardware issue that is of warning criticality. | Storage Hardware Warning | eventType IN (Group@PH_SYS_EVENT_HwProblem) AND eventSeverityCat = ""MEDIUM"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Storage) |
| ArubaOS-CX: User Deleted | Change | Aruba OS CX Switch Platform User Deleted | ArubaOS-CX: User Deleted | eventType = ""ArubaCx-UserDeleted"" |
| AWS SecHub: Host Vulnerability Detected | Security | AWS Security Hub detected host vulnerability | AWS SecHub: Host Vulnerability Detected | eventType = ""AWS-Hub-Software_and_Configuration_Checks-Vulnerabilities-CVE"" |
| HVAC humidity low | Disponibilidade | Detects that HVAC relative humidity is less than 5 units from lower threshold | HVAC humidity low | eventType = ""PH_DEV_MON_HVAC_LIEBERT_METRIC"" |
| Network Device Hardware Critical | Disponibilidade | Detects a critical network device hardware alert. | Network Device Hardware Critical | eventType IN (Group@PH_SYS_EVENT_HwProblem) AND eventSeverityCat = ""HIGH"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Server Hardware Warning | Disponibilidade | Detects a server hardware issue that is of warning criticality. | Server Hardware Warning | eventType IN (Group@PH_SYS_EVENT_HwProblem) AND eventSeverityCat = ""MEDIUM"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Server Hardware Critical | Disponibilidade | Detects a critical server hardware alert. | Server Hardware Critical | eventType IN (Group@PH_SYS_EVENT_HwProblem) AND eventSeverityCat = ""HIGH"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| AWS SecHub: Tactics: Impact: Data Exposure Detected | Security | AWS Security Hub detected Data Exposure tactics. Adversary is trying to manipulate, interrupt, destroy your systems and data. | AWS SecHub: Tactics: Impact: Data Exposure Detected | eventType = ""AWS-Hub-Effects-Data_Exposure"" |
| AWS SecHub: Unusal Database Behavior Detected | Security | AWS Security Hub detected unusual database behavior | AWS SecHub: Unusal Database Behavior Detected | eventType = ""AWS-Hub-Unusual_Behaviors-Database"" |
| AWS SecHub: Tactics: Impact: Data Destruction Detected | Security | AWS Security Hub detected Data Destruction tactics. Adversary is trying to manipulate, interrupt, destroy your systems and data. | AWS SecHub: Tactics: Impact: Data Destruction Detected | eventType = ""AWS-Hub-Effects-Data_Destruction"" |
| AWS SecHub: Tactics: Impact: Data Exfiltration Detected | Security | AWS Security Hub detected Data Exfiltration tactics. Adversary is trying to send sensitive data to outside. | AWS SecHub: Tactics: Impact: Data Exfiltration Detected | eventType = ""AWS-Hub-Effects-Data_Exfiltration"" |
| AWS SecHub: Unusal Data Behavior Detected | Security | AWS Security Hub detected unusual data behavior | AWS SecHub: Unusal Data Behavior Detected | eventType = ""AWS-Hub-Unusual_Behaviors-Data"" |
| AWS SecHub: Unusal Process Behavior Detected | Security | AWS Security Hub detected unusual process behavior | AWS SecHub: Unusal Process Behavior Detected | eventType = ""AWS-Hub-Unusual_Behaviors-Process"" |
| Storage Hardware Critical | Disponibilidade | Detects a critical storage hardware alert. | Storage Hardware Critical | eventType IN (Group@PH_SYS_EVENT_HwProblem) AND eventSeverityCat = ""HIGH"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Storage) |
| HVAC humidity high | Disponibilidade | Detects that HVAC relative humidity is less than 5 units from upper threshold | HVAC humidity high | eventType = ""PH_DEV_MON_HVAC_LIEBERT_METRIC"" |
| HVAC temp high | Disponibilidade | Detects that HVAC temperature is less than 5 degree Fahrenheit from upper threshold | HVAC temp high | eventType = ""PH_DEV_MON_HVAC_LIEBERT_METRIC"" |
| AWS SecHub: Tactics: Impact: Denial of Service Detected | Security | AWS Security Hub detected Data Denial of Service tactics. Adversary is trying to manipulate, interrupt, destroy your systems and data. | AWS SecHub: Tactics: Impact: Denial of Service Detected | eventType = ""AWS-Hub-Effects-Denial_of_Service"" |
| Network Device Hardware Warning | Disponibilidade | Detects a network device hardware issue that is of warning criticality. | Network Device Hardware Warning | eventType IN (Group@PH_SYS_EVENT_HwProblem) AND eventSeverityCat = ""MEDIUM"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| AWS IAM MFA Device Deactivated | Security | Identifies the deactivation of a specified multi-factor authentication (MFA) device and removes it from association with the user name for which it was originally enabled. In AWS Identity and Access Management (IAM), a device must be deactivated before it can be deleted. | AWS IAM MFA Device Deactivated | eventType CONTAIN ""AWS-CloudTrail-IAM-DeactivateMFADevice"" |
| AWS SecHub: Unusal Network Flow Behavior Detected | Security | AWS Security Hub detected unusual network flow behavior | AWS SecHub: Unusal Network Flow Behavior Detected | eventType = ""AWS-Hub-Unusual_Behaviors-Network_Flow"" |
| HVAC temp low | Disponibilidade | Detects that HVAC temperature is less than 5 degree Fahrenheit from the lower threshold | HVAC temp low | eventType = ""PH_DEV_MON_HVAC_LIEBERT_METRIC"" |
| System Collector Event Delayed | Disponibilidade | Detects that collector has not sent an event to FortiSIEM cloud for more than 10 minutes | System Collector Event Delayed | eventType = ""PH_COLLECTOR_EVENT_ARRIVAL_DELAYED"" |
| Degraded IPSLA DNS Test | Performance | Detects average IPSLA DNS response times more than 30msec | Degraded IPSLA DNS Test | eventType = ""PH_DEV_MON_IPSLA_HTTP_MET"" |
| Distributed DoS Attack detected by NIPS | Security | Detects high severity distributed Denial of Service Attacks on servers or network devices. These attacks can be launched from geographically dispersed servers making them hard to defend against. This rule alerts on all attacks from internal networks and permitted attacks from external networks. | Distributed DoS Attack detected by NIPS | eventType IN (Group@PH_SYS_EVENT_DDoSExploit) AND eventSeverity >= 7 AND ((srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventAction = 0) OR srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)) |
| EqualLogic Connection Read/Write Latency Warning | Performance | Detects that the EqualLogic connection Read or Write latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval | EqualLogic Connection Read/Write Latency Warning | eventType IN (""PH_DEV_MON_EQL_CONN_MET"") |
| Cisco CallManager Cluster Member Down | Disponibilidade | In cluster setup, the primary cannot reach another server in a cluster | Cisco CallManager Cluster Member Down | eventType = ""Cisco_UC_RTMT_ServerDown"" |
| EqualLogic Connection Read/Write Latency Critical | Performance | Detects that EqualLogic Connection Read/Write latency has reached a critical level (greater than 50 msec) based on 2 successive readings in a 10 minute interval | EqualLogic Connection Read/Write Latency Critical | eventType IN (""PH_DEV_MON_EQL_CONN_MET"") |
| Cylance Found Corrupt File | Security | This rule detects Cylance found file corruption | Cylance Found Corrupt File | eventType CONTAIN ""CylanceProtect-Threat-corrupt_found"" |
| ESX Memory Warning | Performance | Detects that ESX memory utilization has reached a warning level (greater than 85% and swap rate between 1MBps and 1.5 MBps) based on 2 successive readings in a 10 minute interval | ESX Memory Warning | eventType = ""PH_DEV_MON_SYS_MEM_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_VM_SERVER) |
| ESX Disk I/O Critical | Performance | Detects that ESX disk I/O utilization has reached a critical level - average Disk IO Latency greater than 50ms based on 2 successive readings in a 10 minute interval | ESX Disk I/O Critical | eventType = ""PH_DEV_MON_ESX_DISK_IO"" |
| ESX Network I/O Warning | Performance | Detects that ESX network I/O utilization has reached a warning level - average network interface utilization between 35% and 50% based on 2 successive readings in a 10 minute interval | ESX Network I/O Warning | eventType = ""PH_DEV_MON_NET_INTF_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_VM_SERVER) |
| Degraded VoIP Call Quality | Performance | Detects degraded VoIP call quality (mos score between 2.2 and 3.5) from CDR records. Calls originating from VPN Pools are excluded. | Degraded VoIP Call Quality | eventType = ""Cisco-CM-CDR"" AND mosScore > 2.2 AND mosScore <= 3.5 AND srcIpAddr NOT IN (Group@PH_SYS_VPN_ADDRESS_POOL) |
| Degraded IPSLA UDP Echo Test | Performance | Detects IPSLA UDP failures or response time more than 30msec or more than 3 failures in 10 minutes | Degraded IPSLA UDP Echo Test | eventType = ""PH_DEV_MON_IPSLA_UDP_MET"" AND ipslaUdpStatus != 1 |
| BGP Neighbor Down | Disponibilidade | Detects that a BGP neighbor is down | BGP Neighbor Down | eventType = ""IOS-BGP-ADJCHANGE-TO-DOWN"" |
| Datastore Space Warning | Performance | Detects that datastore usage has reached a warning level (utilization between 75% and 85% and free disk still greater than 10GB) based on 2 successive readings in a 10 minute interval | Datastore Space Warning | eventType = ""PH_DEV_MON_DATASTORE_UTIL"" |
| ESX CPU Critical | Performance | Detects that ESX CPU utilization has reached a critical level (greater than 95% based on 2 successive readings in a 10 minute interval | ESX CPU Critical | eventType = ""PH_DEV_MON_SYS_CPU_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_VM_SERVER) |
| ESX Memory Critical | Performance | Detects that ESX memory utilization has reached a critical level (greater than 95% based on 2 successive readings in a 10 minute interval | ESX Memory Critical | eventType = ""PH_DEV_MON_SYS_MEM_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_VM_SERVER) |
| Degraded IPSLA UDP Echo Test | Performance | Detects IPSLA UDP failures or response time more than 30msec or more than 3 failures in 10 minutes | Degraded IPSLA UDP Echo Test | eventType = ""PH_DEV_MON_IPSLA_UDP_MET"" |
| Degraded IPSLA ICMP Test | Performance | Detects average IPSLA ICMP response times more than 30msec | Degraded IPSLA ICMP Test | eventType = ""PH_DEV_MON_IPSLA_ICMP_MET"" |
| DoS Attack detected by NIPS | Security | Detects high severity Denial of Service Attacks on a server that typically exploits a code vulnerability and causes excessive resource (CPU or memory) utilization on the server. This rule alerts on all attacks from internal networks and permitted attacks from external networks. | DoS Attack detected by NIPS | eventType IN (Group@PH_SYS_EVENT_DoSExploit) AND eventSeverity >= 7 AND ((srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventAction = 0) OR srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)) |
| Cisco CallManager Critical Service Down | Disponibilidade | Cisco CallManager Critical Service Down | Cisco CallManager Critical Service Down | eventType = ""Cisco_UC_RTMT_CriticalServiceDown"" |
| Cisco Call Manager DDR Down | Disponibilidade | IDSReplicationFailure alarm with alarm number 32 occurs. An auto recover procedure runs in the background | Cisco Call Manager DDR Down | eventType = ""Cisco_UC_RTMT_DDRDown"" |
| ESX Disk I/O Warning | Performance | Detects that ESX disk I/O utilization has reached a warning level - average Disk IO Latency between 20ms and 50ms based on 2 successive readings in a 10 minute interval | ESX Disk I/O Warning | eventType = ""PH_DEV_MON_ESX_DISK_IO"" |
| ESX Network I/O Critical | Performance | Detects that ESX network I/O utilization has reached a critical level - average network interface utilization greater than 50% based on 2 successive readings in a 10 minute interval | ESX Network I/O Critical | eventType = ""PH_DEV_MON_NET_INTF_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_VM_SERVER) |
| ESX CPU Warning | Performance | Detects that ESX CPU utilization has reached a warning level (between 75% and 95% based on 2 successive readings in a 10 minute interval | ESX CPU Warning | eventType = ""PH_DEV_MON_SYS_CPU_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_VM_SERVER) |
| DoS Attack on Network Devices by Network IPS | Security | Detects high severity Denial of Service Attacks on network devices that typically exploits a code vulnerability and causes excessive resource (CPU or memory) utilization or crashes the device - alerts on all attacks from internal networks and permitted attacks from external networks | DoS Attack on Network Devices by Network IPS | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND destIpAddr IN (Group@PH_SYS_DEVICE_Network) AND eventType IN (Group@PH_SYS_EVENT_DoSExploit) AND eventSeverity >= 7 AND ((srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventAction = 1) OR srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)) |
| EIGRP Neighbor Down | Disponibilidade | Detects that a EIGRP neighbor is down | EIGRP Neighbor Down | eventType IN (""IOS-EIGRP-NBRCHANGE_DUAL-TO-DOWN"",""IOS-DUAL-NBRCHANGE-TO-DOWN"") |
| Crowdstrike: Data Deletion | Security | Crowdstrike agent detected data deletion at a host | Crowdstrike: Data Deletion | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Data-Deletion"" |
| Degraded VoIP IPSLA Call Quality | Performance | Detects degraded VoIP call quality (mos score between 2.2 and 3.5) from IPSLA entries | Degraded VoIP IPSLA Call Quality | eventType = ""PH_DEV_MON_IPSLA_VOIP_MET"" |
| Azure Resource Group Deleted | Security | Identifies the deletion of a resource group in Azure, which includes all resources within the group. Deletion is permanent and irreversible. An adversary may delete a resource group in an attempt to evade defenses or intentionally destroy data. | Azure Resource Group Deleted | eventType = ""MS_EvtHub_resources_subscriptions_resourcegroups_delete"" |
| DoS Attack on WLAN Infrastructure by Network IPS | Security | Detects high severity Denial of Service Attacks on WLAN infrastructure | DoS Attack on WLAN Infrastructure by Network IPS | eventType IN (Group@PH_SYS_EVENT_WirelessDoS) AND eventSeverity >= 7 |
| Crowdstrike: Data Theft | Security | Crowdstrike agent detected data theft at a host | Crowdstrike: Data Theft | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Data-Theft"" |
| GCP: IAM Custom Role Deleted | Change | Google Cloud Platform: A Custom IAM Role was deleted | GCP: IAM Custom Role Deleted | eventType = ""GCP_Audit_activity_DeleteRole"" |
| HyperV Guest Hypervisor Run Time Percent Warning | Performance | Detects that Hyper-V Guest hypervisor run time pct has reached a warning level (greater than 25% based on 2 successive readings in a 10 minute interval). Hypervisor run time percent represents the percent of time Guest virtual processor is running in hypervisor code on an logical processor | HyperV Guest Hypervisor Run Time Percent Warning | eventType = ""PH_DEV_MON_HYPERV_CPU_GUEST_VIRTUAL_PROC"" |
| Exchange Server RPC request high | Performance | Detects a spike in MS Exchange server RPC requests | Exchange Server RPC request high | eventType = ""PH_DEV_MON_APP_MSEXCH_MET"" |
| HyperV Guest Critical | Performance | Detects that an HyperV Guest is in critical state | HyperV Guest Critical | eventType = ""PH_DEV_MON_HYPERV_OVERALL_HEALTH"" AND vmHealthCritCount >= 1 |
| FortiGate: Admin User Deleted | Change | FortiOS Admin has deleted an admin user account. This triggers due to account deletions under System Administrators tab. | FortiGate: Admin User Deleted | eventType = ""FortiGate-event-admin-delete"" |
| Exchange Server SMTP Queue high | Performance | Detects that one or more of MS Exchange SMTP Server queues have crossed critical threshold | Exchange Server SMTP Queue high | eventType = ""PH_DEV_MON_APP_MSEXCH_SMTP_MET"" |
| HyperV Disk I/O Warning | Performance | Detects that HyperV disk I/O utilization has reached a warning level - average Disk IO Latency between 20ms and 50ms based on 2 successive readings in a 10 minute interval | HyperV Disk I/O Warning | eventType = ""PH_DEV_MON_HYPERV_STORAGE_LOGICAL_DISK"" |
| Exchange Server Mailbox Queue high | Performance | Detects that one or more of MS Exchange mailbox store queues have crossed critical threshold | Exchange Server Mailbox Queue high | eventType = ""PH_DEV_MON_APP_MSEXCH_MBOX_MET"" |
| GCP: Service Account Deleted | Change | Google Cloud Platform: A Service Account was Deleted | GCP: Service Account Deleted | eventType = ""GCP_Audit_activity_DeleteServiceAccount"" |
| HyperV Logical Processor Total Run Time Percent Critical | Performance | Detects that Hyper-V logical processor total run time pct has reached a critical level (greater than 90% based on 2 successive readings in a 10 minute interval). The total run time combines the time guest code and the hypervisor is running on a logical processor. | HyperV Logical Processor Total Run Time Percent Critical | eventType = ""PH_DEV_MON_HYPERV_CPU_LOGICAL_PROC"" |
| Excessive Denied Connections From Same Src | Security | Detects excessive denies from the same source to many distinct destinations on the same port in a short period of time. The intent could be malicious or some sort of misconfiguration. | Excessive Denied Connections From Same Src | eventType IN (Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| GCP: Service Account Disabled | Change | Google Cloud Platform: A Service Account was Disabled | GCP: Service Account Disabled | eventType = ""GCP_Audit_activity_DisableServiceAccount"" |
| Excessive Denied Connections To A Port | Security | Detects excessive denies from many distinct external source IP addresses to the same port. The intent could be beginning of some sort of day zero attack | Excessive Denied Connections To A Port | eventType IN (Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| HyperV Disk Latency Critical | Performance | Detects that HyperV disk I/O utilization has reached a critical level - average Disk IO Latency greater than 50ms based on 2 successive readings in a 10 minute interval | HyperV Disk Latency Critical | eventType = ""PH_DEV_MON_HYPERV_STORAGE_LOGICAL_DISK"" |
| High Process Memory: Network Device | Performance | Detects high memory usage by an application on the basis of 3 consecutive measurements in a 15 minute period | High Process Memory: Network Device | eventType = ""PH_DEV_MON_PROC_RESOURCE_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Exchange Server RPC latency high | Performance | Detects excessive MS Exchange server RPC request latency | Exchange Server RPC latency high | eventType = ""PH_DEV_MON_APP_MSEXCH_MET"" |
| Excessive Postfix gateway connection failures | Performance | Detects excessive connection failures from an Postfix SMTP gateway | Excessive Postfix gateway connection failures | eventType IN (""Postfix-Connect-From-failure"",""Postfix-Connect-To-refused"",""Postfix-Connect-To-timeout"",""Postfix-Connect-To-failure"",""Postfix-Disconnect-From"") |
| ESX Server Health: Critical | Performance | Detects that the health of an ESX server is critical since either the performance of one of the component VMs is in critical state or the ESX server itself is showing critical resource utilization at the aggregate level. | ESX Server Health: Critical | eventType IN (""PH_RULE_ESX_CPU_CRIT"",""PH_RULE_ESX_MEM_CRIT"",""PH_RULE_ESX_DISKIO_CRIT"", ""PH_RULE_ESX_INTF_CRIT"") |
| FortiWeb Connection Limit Reached | Performance | Detects concurrent connections through a FortiWeb appliance has reached max limit | FortiWeb Connection Limit Reached | eventType = ""FortiWeb-19999498"" |
| Excessive Denied Connections From An External Country | Security | Detects excessive denies from the an external country in a short period of time. The intent could be beginning of some sort of day zero attack | Excessive Denied Connections From An External Country | srcGeoCountry IS NOT NULL AND eventType IN (Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| GCP: Service Account Access Key Deleted | Change | Google Cloud Platform: A Service Account Access Key was Deleted. These are used to programmatically authenticate using this service accounts permissions. | GCP: Service Account Access Key Deleted | eventType = ""GCP_Audit_activity_DeleteServiceAccountKey"" |
| High Process Memory: Server | Performance | Detects high memory usage by a server application on the basis of 3 consecutive measurements in a 15 minute period | High Process Memory: Server | eventType = ""PH_DEV_MON_PROC_RESOURCE_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| ESX Server Health: Warning | Performance | Detects that the health of an ESX server is to be watched carefully since either the performance of one of the component VMs has entered a watched state or the ESX server itself is showing high resource utilization at the aggregate level. | ESX Server Health: Warning | eventType IN (""PH_RULE_ESX_CPU_WARN"",""PH_RULE_ESX_MEM_WARN"",""PH_RULE_ESX_DISKIO_WARN"", ""PH_RULE_ESX_INTF_WARN"") |
| Excessive Postfix mail send error | Performance | Detects excessive Postfix mail send errors | Excessive Postfix mail send error | eventType = ""Postfix-Mail-Send-Error"" |
| Half Open TCP DDOS Attack | Security | Detects excessive number of half-open TCP connections from many distinct sources to the same destination host and on the same port in a short period of time. This may indicate that the destination server is under some sort of attack. | Half Open TCP DDOS Attack | srcDestTCPFlags = 2 AND ipProto = 6 AND eventType IN (Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Excessive Denied Connections To Same Destination | Security | Detects excessive denies from many distinct sources to the same destination on the same destination port | Excessive Denied Connections To Same Destination | eventType IN (Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Excessive HTTP Client Side Errors | Security | Detects multiple HTTP client side errors from the same IP - might indicate an attack . Thresholds are 5 errors from the same src IP within a 10 minute interval | Excessive HTTP Client Side Errors | eventType IN (""IIS-Web-Forbidden-Access-Denied"",""IIS-Web-Bad-Request"",""IIS-Web-Length-Reqd-Access-Denied"",""Apache-Web-Forbidden-Access-Denied"",""Apache-Web-Bad-Request"",""Apache-Web-Length-Reqd-Access-Denied"",""Squid-Web-Forbidden-Access-Denied"",""Squid-Web-Bad-Request"",""Squid-Web-Length-Reqd-Access-Denied"") |
| High Process CPU: Network Device | Performance | Detects high CPU usage by an application on the basis of 3 consecutive measurements in a 15 minute period | High Process CPU: Network Device | eventType = ""PH_DEV_MON_PROC_RESOURCE_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| High Process CPU: Server | Performance | Detects high CPU usage by a server application on the basis of 3 consecutive measurements in a 15 minute period | High Process CPU: Server | eventType = ""PH_DEV_MON_PROC_RESOURCE_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Excessive FTP Client Side Errors | Security | Detects multiple FTP client side errors from the same IP - might indicate an attack from the source IP | Excessive FTP Client Side Errors | eventType IN (""IIS-FTP-Command-Not-Implemented"",""IIS-FTP-File-Not-Found"",""IIS-FTP-Illegal-File"") |
| NetApp Volume Read/Write Latency Warning | Performance | Detects that the Volume Read or Write latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval | NetApp Volume Read/Write Latency Warning | eventType IN (""PH_DEV_MON_NETAPP_VOL_MET"") |
| NetApp NFS Read/Write Latency Critical | Performance | Detects that NetApp NFS Read/Write latency has reached a critical level (greater than 50 msec) based on 2 successive readings in a 10 minute interval | NetApp NFS Read/Write Latency Critical | eventType IN (""PH_DEV_MON_NETAPP_NFS3_MET"", ""PH_DEV_MON_NETAPP_NFS4_MET"") |
| MS 365 Defender: Delivery Detected | Security | Windows Defender Advanced Threat Protection detected delivery | MS 365 Defender: Delivery Detected | eventType = ""Microsoft-WinDefATP-Alert-Delivery"" |
| Important process down | Disponibilidade | Detects that an important server process stopped | Important process down | eventType = ""PH_DEV_MON_PROC_STOP"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| NetApp CIFS Read/Write Latency Warning | Performance | Detects that the CIFS Read or Write latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval | NetApp CIFS Read/Write Latency Warning | eventType IN (""PH_DEV_MON_NETAPP_CIFS_MET"") |
| ICMP Flood From Same Source | Security | Detects excessive (> 5000 in 5 minutes) ICMP traffic from the same source | ICMP Flood From Same Source | ipProto = 1 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) |
| MySQL Database Instance Down | Disponibilidade | Detects that a MySQL database server instance is down | MySQL Database Instance Down | eventType = ""PH_DEV_MON_PERF_MYSQLDB"" AND instanceStatus = ""UNCONNECTED"" |
| Isilon Protocol Latency Critical | Performance | Detects that Isilon protocol latency has reached a critical level (greater than 2 sec) based on at least 3 readings in a 15 minute interval | Isilon Protocol Latency Critical | eventType = ""PH_DEV_MON_ISILON_NODE_PROTO_PERF"" |
| NetApp FCP Read/Write Latency Warning | Performance | Detects that the FCP Read or Write latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval | NetApp FCP Read/Write Latency Warning | eventType IN (""PH_DEV_MON_NETAPP_FCP_MET"") |
| NetApp NFS Read/Write Latency Warning | Performance | Detects that the NFS Read or Write latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval | NetApp NFS Read/Write Latency Warning | eventType IN (""PH_DEV_MON_NETAPP_NFS3_MET"", ""PH_DEV_MON_NETAPP_NFS4_MET"") |
| NetApp FCP Read/Write Latency Critical | Performance | Detects that NetApp FCP Read/Write latency has reached a critical level (greater than 50 msec) based on 2 successive readings in a 10 minute interval | NetApp FCP Read/Write Latency Critical | eventType IN (""PH_DEV_MON_NETAPP_FCP_MET"") |
| HyperV Page fault Critical | Performance | Detects that Hyper-V page fault rate has reached a critical level. Page fault rate is the pace at which pages are read in and out of disk to resolve hard page faults | HyperV Page fault Critical | eventType = ""PH_DEV_MON_HYPERV_MEM_OVERALL"" |
| Microsoft SQL Server Instance Down | Disponibilidade | Detects that a Microsoft SQL Server instance is down | Microsoft SQL Server Instance Down | eventType = ""PH_DEV_MON_PERF_MSSQL_SYS"" AND instanceStatus = ""STOPPED"" |
| HyperV Page fault Warning | Performance | Detects that Hyper-V page fault rate has reached a warning level. Page fault rate is the pace at which pages are read in and out of disk to resolve hard page faults | HyperV Page fault Warning | eventType = ""PH_DEV_MON_HYPERV_MEM_OVERALL"" |
| Important process staying Down | Disponibilidade | Detects that an important server process staying down - that is didn't come up within 5 minutes of going down | Important process staying Down | eventType = ""PH_DEV_MON_PROC_START"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| IIS Virtual Memory Critical | Performance | Detects that IIS is using at least 1.9 GB of virtual memory and is fast approaching the 2 GB limit. | IIS Virtual Memory Critical | eventType = ""PH_DEV_MON_PROC_RESOURCE_UTIL"" AND appName = ""Microsoft IIS"" |
| NetApp CIFS Latency Critical | Performance | Detects that NetApp CIFS latency has reached a critical level (greater than 50 msec) based on 2 successive readings in a 10 minute interval | NetApp CIFS Latency Critical | eventType IN (""PH_DEV_MON_NETAPP_CIFS_MET"") |
| Network CPU Critical | Performance | Detects that a network device CPU has reached a critical level (greater than 90% based on 2 successive readings in a 10 minute interval | Network CPU Critical | eventType IN (""PH_DEV_MON_SYS_CPU_UTIL"",""PH_DEV_MON_FORTIGATE_PERF"",""PH_DEV_MON_FORTISWITCH_PERF"",""PH_DEV_MON_FORTIAP_PERF"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Multi-Factor Authentication Disabled for an Azure User | Security | Identifies when multi-factor authentication (MFA) is disabled for an Azure user account. An adversary may disable MFA for a user account in order to weaken the authentication requirements for the account. | Multi-Factor Authentication Disabled for an Azure User | eventType = ""MS_EvtHub_disable_strong_authentication"" |
| NetApp ISCSI Read/Write Latency Warning | Performance | Detects that the ISCSI Read or Write latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval | NetApp ISCSI Read/Write Latency Warning | eventType IN (""PH_DEV_MON_NETAPP_ISCSI_MET"") |
| HyperV Logical Processor Total Run Time Percent Warning | Performance | Detects that Hyper-V logical processor total run time pct has reached a warning level (between 70% and 90% based on 2 successive readings in a 10 minute interval). The total run time combines the time guest code and the hypervisor is running on a logical processor. | HyperV Logical Processor Total Run Time Percent Warning | eventType = ""PH_DEV_MON_HYPERV_CPU_LOGICAL_PROC"" |
| IPSLA HTTP Test Failure | Performance | Detects IPSLA HTTP failures or response time more than 50msec or more than 3 failures in 10 minutes | IPSLA HTTP Test Failure | eventType = ""PH_DEV_MON_IPSLA_HTTP_MET"" |
| Network CPU Warning | Performance | Detects that a network device CPU has reached a warning level (between 75% and 90% based on 2 successive readings in a 10 minute interval | Network CPU Warning | eventType IN (""PH_DEV_MON_SYS_CPU_UTIL"",""PH_DEV_MON_FORTIGATE_PERF"",""PH_DEV_MON_FORTISWITCH_PERF"",""PH_DEV_MON_FORTIAP_PERF"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Meraki Device Down | Disponibilidade | Detects a Cisco Meraki device is down | Meraki Device Down | eventType = ""Cisco-Meraki-deviceGoesDownTrap"" |
| NetApp Volume Read/Write Latency Critical | Performance | Detects that NetApp Volume Read/Write latency has reached a critical level (greater than 50 msec) based on 2 successive readings in a 10 minute interval | NetApp Volume Read/Write Latency Critical | eventType IN (""PH_DEV_MON_NETAPP_VOL_MET"") |
| HyperV Remaining Guest Memory Warning | Performance | Detects that Hyper-V free memory remaining for guest is below 2MB | HyperV Remaining Guest Memory Warning | eventType = ""PH_DEV_MON_HYPERV_MEM_OVERALL"" |
| Important process staying Down | Disponibilidade | Detects that an important server process staying down - that is didn't come up within 5 minutes of going down | Important process staying Down | eventType = ""PH_DEV_MON_PROC_STOP"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| NetApp ISCSI Read/Write Latency Critical | Performance | Detects that NetApp ISCSI Read/Write latency has reached a critical level (greater than 50 msec) based on 2 successive readings in a 10 minute interval | NetApp ISCSI Read/Write Latency Critical | eventType IN (""PH_DEV_MON_NETAPP_ISCSI_MET"") |
| IPSLA HTTP Test Failure | Performance | Detects IPSLA HTTP failures or response time more than 50msec or more than 3 failures in 10 minutes | IPSLA HTTP Test Failure | eventType = ""PH_DEV_MON_IPSLA_HTTP_MET"" AND httpStatusCode != 1 |
| NetApp Back to Back Consistency Point | Performance | Detects back to back consistency points on NetApp filers. This simply means that writes are coming to the filer faster than can be written to NVRAM in one bank. Typically happens during RAID reconstruction or when the filer is overloaded. | NetApp Back to Back Consistency Point | eventType = ""PH_DEV_MON_NETAPP_CP_MET"" |
| Radvision ISDN Loss | Disponibilidade | Detects that loss of Radvision gateway ISDN link. | Radvision ISDN Loss | eventType = ""RV-lossIsdn"" AND eventAction = 0 |
| Poor VoIP Call Quality | Performance | Detects poor VoIP call quality (MOS score less than 2.2) from CDR records. Calls originating from VPN Pools are excluded. | Poor VoIP Call Quality | eventType = ""Cisco-CM-CDR"" AND mosScore > 0 AND srcIpAddr NOT IN (Group@PH_SYS_VPN_ADDRESS_POOL) |
| OSPF Neighbor Down | Disponibilidade | Detects that a OSPF neighbor is down | OSPF Neighbor Down | eventType = ""IOS-OSPF-ADJCHG-TO-DOWN"" |
| Network Memory Warning | Performance | Detects that a network device memory usage has reached a warning level (between 50% and 85% based on 2 successive readings in a 10 minute interval | Network Memory Warning | eventType IN (""PH_DEV_MON_SYS_MEM_UTIL"",""PH_DEV_MON_FORTIGATE_PERF"",""PH_DEV_MON_FORTISWITCH_PERF"",""PH_DEV_MON_FORTIAP_PERF"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND memName = ""Physical Memory"" |
| Network Device Degraded: Lossy Ping Response | Disponibilidade | Detects a host with degraded ping response - more than 75% packet loss | Network Device Degraded: Lossy Ping Response | eventType = ""PH_DEV_MON_PING_STAT"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Radvision Ethernet Loss | Disponibilidade | Detects that loss of Radvision gateway Ethernet link. | Radvision Ethernet Loss | eventType = ""RV-lossEthernet"" AND eventAction = 0 |
| Poor VoIP IPSLA Call Quality | Performance | Detects poor VoIP call quality (MOS score less than 2.2) from IPSLA entries | Poor VoIP IPSLA Call Quality | eventType = ""PH_DEV_MON_IPSLA_VOIP_MET"" |
| Oracle Database Listener Down | Disponibilidade | Detects that an Oracle database server listener is down | Oracle Database Listener Down | eventType = ""PH_DEV_MON_PERF_ORADB"" AND listenerStatus != ""OPEN"" |
| Radvision Gateway Down | Disponibilidade | Detects that the Radvision gateway is down. Cleared by the up event | Radvision Gateway Down | eventType = ""RV-powerDown"" |
| Network Memory Critical | Performance | Detects that a network device memory has reached a critical level (greater than 85% based on 2 successive readings in a 10 minute interval | Network Memory Critical | eventType IN (""PH_DEV_MON_SYS_MEM_UTIL"",""PH_DEV_MON_FORTIGATE_PERF"",""PH_DEV_MON_FORTISWITCH_PERF"",""PH_DEV_MON_FORTIAP_PERF"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND memName = ""Physical Memory"" |
| Network Device Down: no ping response | Disponibilidade | Detects a device does not respond to ping - 10 out of 10 ping packets are lost - either the host is down or there is a routing problem | Network Device Down: no ping response | eventType IN (Group@PH_SYS_EVENT_SystemShutdown) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Network Device Failover | Disponibilidade | Detects that a network device is failing over | Network Device Failover | eventType IN (Group@PH_SYS_EVENT_FailoverOccur) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Network Device Health: Warning | Performance | Detects that the health of a network device need to be watched carefully based average CPU, memory and interface utilization and interface errors- at least one of the measured attributes has crossed the specified LOW threshold but has not yet crossed the specified HIGH threshold | Network Device Health: Warning | eventType IN (""PH_RULE_NET_CPU_WARN"",""PH_RULE_NET_MEM_WARN"", ""PH_RULE_NET_INTF_UTIL_WARN"",""PH_RULE_NET_INTF_ERR_WARN"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Network Device Health: Critical | Performance | Detects that the health of a network device is critical and needs immediate attention based average CPU, memory and interface utilization and interface errors - at least one of the measured attributes has crossed the specified HIGH threshold | Network Device Health: Critical | eventType IN (""PH_RULE_NET_CPU_CRIT"",""PH_RULE_NET_MEM_CRIT"", ""PH_RULE_NET_INTF_UTIL_CRIT"",""PH_RULE_NET_INTF_ERR_CRIT"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Outbreak: HermeticWiper-Foxblade Malware Detected on Host | Security | A Fortinet product has detected HermeticWiper-Foxblade malware activity on a host | Outbreak: HermeticWiper-Foxblade Malware Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND (ipsSignatureId IN (10080460,778149) OR virusName = ""W32/KillDisk\\.NCV!tr"") |
| Network Device Interface Flapping | Disponibilidade | Detects that a network interface of a network device is flapping - that is, coming up and down more than 3 times in 15 minutes. This may indicate hardware issues. | Network Device Interface Flapping | eventType IN (Group@PH_SYS_EVENT_NetIntfShutdown) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Network Device Down: no ping response | Disponibilidade | Detects a device does not respond to ping - 10 out of 10 ping packets are lost - either the host is down or there is a routing problem | Network Device Down: no ping response | eventType = ""PH_DEV_MON_PING_STAT"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| NFS Disk space Warning | Performance | Detects that NFS disk space usage has reached a warning level (utilization between 80% and 95% and free disk still greater than 100 MB) based on 2 successive readings in a 10 minute interval | NFS Disk space Warning | eventType = ""PH_DEV_MON_SYS_DISK_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Storage) |
| Outbreak: Spring4Shell Malware Detected on Network | Security | A Fortinet product has detected Spring4Shell malware (CVE-2022-22965) activity on network | Outbreak: Spring4Shell Malware Detected on Network | eventType IN (""FortiGate-ips-signature-51352"",""FortiProxy-ips-signature-51352"") |
| Network Device Interface Flapping | Disponibilidade | Detects that a network interface of a network device is flapping - that is, coming up and down more than 3 times in 15 minutes. This may indicate hardware issues. | Network Device Interface Flapping | eventType IN (Group@PH_SYS_EVENT_NetIntfRestart) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Oracle Database Instance Down | Disponibilidade | Detects that an Oracle database server instance is down | Oracle Database Instance Down | eventType = ""PH_DEV_MON_PERF_ORADB"" AND instanceStatus != ""OPEN"" |
| Oracle OCI: User Deleted | Security | Oracle OCI user was deleted | Oracle OCI: User Deleted | eventType IN (""Oracle-OCI-identitycontrolplane-deleteuser"",""Oracle-OCI-identitycontrolplane-deleteidpuser"") |
| Network IPS Intf Util Warning | Performance | Detects that interface utilization of a network IPS device has reached a warning level (utilization between 60% and 80% based on 2 successive readings in a 10 minute interval. | Network IPS Intf Util Warning | eventType = ""PH_DEV_MON_NET_INTF_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND hostIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND intfName NOT IN (""lo"",""Null0"") |
| Network Intf Util Critical | Performance | Detects that interface utilization of a network device has reached a critical level (utilization greater than 50% based on 2 successive readings in a 10 minute interval. IPS devices are excluded since being a sniffing interface, they have high utilization under normal circumstances. | Network Intf Util Critical | eventType IN (""PH_DEV_MON_NET_INTF_UTIL"",""PH_DEV_MON_FORTIGATE_INTF_UTIL"",""PH_DEV_MON_FORTIAP_INTF_UTIL"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND hostIpAddr NOT IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND intfName NOT IN (""lo"",""Null0"") |
| Network Intf Util Warning | Performance | Detects that interface utilization of a network device has reached a warning level (utilization between 30% and 50% based on 2 successive readings in a 10 minute interval. IPS devices are excluded since being a sniffing interface, they have high utilization under normal circumstances. | Network Intf Util Warning | eventType IN (""PH_DEV_MON_NET_INTF_UTIL"",""PH_DEV_MON_FORTIGATE_INTF_UTIL"",""PH_DEV_MON_FORTIAP_INTF_UTIL"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND hostIpAddr NOT IN (Group@PH_SYS_DEVICE_NETWORK_IPS) |
| Ransomware detected on a host | Security | Identifies excessive non-executable file changes by the same process on a Windows host. Requires Windows Security logs or FortiSIEM Agent to be running on the host. | Ransomware detected on a host | (eventType IN (""FINS-Windows-file-written"",""FINS-Windows-file-read"",""FINS-Windows-file-renamed"") AND (fileName NOT CONTAIN "".exe"" AND fileName NOT CONTAIN "".dll"" AND fileName NOT CONTAIN "".cdf-ms"")) OR (eventType = ""Win-Security-4656"" AND (osObjName NOT CONTAIN "".exe"" AND osObjName NOT CONTAIN "".dll"" AND osObjName NOT CONTAIN "".cdf-ms"")) |
| Outbreak: HermeticWiper-Foxblade Malware Detected on Network | Security | A Fortinet product has detected HermeticWiper-Foxblade malware activity on network | Outbreak: HermeticWiper-Foxblade Malware Detected on Network | eventType IN (Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND (ipsSignatureId IN (10080460,778149) OR virusName = ""W32/KillDisk\\.NCV!tr"") |
| Network IPS Intf Util Critical | Performance | Detects that interface utilization of a network IPS device has reached a critical level (utilization greater than 80% based on 2 successive readings in a 10 minute interval. | Network IPS Intf Util Critical | eventType = ""PH_DEV_MON_NET_INTF_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND hostIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND intfName NOT CONTAIN ""Loopback"" AND intfName NOT IN (""lo"",""Null0"") |
| Server Disk Latency Critical | Performance | Detects that server disk I/O latency has reached a critical level (greater than 50 msec) based on 2 successive readings in a 10 minute interval | Server Disk Latency Critical | eventType = ""PH_DEV_MON_DISK_IO_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND diskName NOT IN (""/boot"") |
| SNMP Service Unavailable | Disponibilidade | Detects that SNMP service is unavailable | SNMP Service Unavailable | eventType = ""PH_DEV_MON_SNMP_PING_STAT"" |
| Service Staying Down: No Response to STM | Disponibilidade | Detects a service staying down - that is went from up to down and did not come up and is no longer responding to end user monitoring probes. | Service Staying Down: No Response to STM | eventType = ""PH_DEV_MON_EUM_FAIL"" AND hostIpAddr IS NULL |
| Server Degraded: Lossy Ping Response | Disponibilidade | Detects a host with degraded ping response - more than 50% packet loss and more than 100 ms avg response time | Server Degraded: Lossy Ping Response | eventType = ""PH_DEV_MON_PING_STAT"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Server CPU Critical | Performance | Detects that server CPU has reached a critical level (greater than 85% based on 2 successive readings in a 10 minute interval | Server CPU Critical | eventType = ""PH_DEV_MON_SYS_CPU_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND hostIpAddr NOT IN (Group@PH_SYS_DEVICE_VM_ESX_GUEST_ALL) |
| Server CPU Warning | Performance | Detects that server CPU has reached a warning level (between 75% and 85% based on 2 successive readings in a 10 minute interval | Server CPU Warning | eventType = ""PH_DEV_MON_SYS_CPU_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND hostIpAddr NOT IN (Group@PH_SYS_DEVICE_VM_ESX_GUEST_ALL) |
| Server Network Interface Flapping | Disponibilidade | Detects that a network interface of a server is flapping - that is, coming up and down more than 3 times in 15 minutes. This may indicate hardware issues. | Server Network Interface Flapping | eventType IN (Group@PH_SYS_EVENT_NetIntfRestart) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Server Disk space Warning | Performance | Detects that server disk space usage has reached a warning level (utilization between 90% and 95% and free disk still greater than 100 MB) based on 2 successive readings in a 10 minute interval | Server Disk space Warning | eventType = ""PH_DEV_MON_SYS_DISK_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND diskName NOT IN (""/boot"") |
| Server Down: No Ping Response | Disponibilidade | Detects a device does not respond to ping - 10 out of 10 ping packets are lost - either the host is down or there is a routing problem | Server Down: No Ping Response | eventType = ""PH_DEV_MON_PING_STAT"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Server Disk Latency Warning | Performance | Detects that server disk I/O latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval | Server Disk Latency Warning | eventType = ""PH_DEV_MON_DISK_IO_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND diskName NOT IN (""/boot"") |
| Service Degraded: Slow Response to STM: Has IP | Disponibilidade | Detects that the response time of an end user monitored service is greater than a defined threshold (average over 3 samples in 15 minutes is more than 5 seconds). This service has well known IP address. | Service Degraded: Slow Response to STM: Has IP | eventType = ""PH_DEV_MON_EUM_SUCCESS"" AND hostIpAddr IS NOT NULL |
| Sudden Increase In Firewall Connections | Security | Detects sudden increase in permitted firewall connections. Over a 30 minute window, the current firewall connections is more than 3 standard deviations away from the mean. | Sudden Increase In Firewall Connections | eventType = ""PH_DEV_MON_FW_CONN_UTIL"" |
| Server Intf Util Critical | Performance | Detects that interface utilization of a network device has reached a critical level (utilization greater than 50% based on 2 successive readings in a 10 minute interval | Server Intf Util Critical | eventType = ""PH_DEV_MON_NET_INTF_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND hostIpAddr NOT IN (Group@PH_SYS_APP_NETWORK_IPS) AND intfName NOT CONTAIN ""Loopback"" AND intfName NOT IN (""lo"",""Null0"") AND hostIpAddr NOT IN (Group@PH_SYS_DEVICE_VM_ESX_GUEST_ALL) |
| Service Down: No Response to STM | Disponibilidade | Detects a service suddenly went down from up state and is no longer responding to synthetic transaction monitoring probes. | Service Down: No Response to STM | eventType = ""PH_DEV_MON_EUM_FAIL"" AND hostIpAddr IS NULL |
| Server Swap Memory Critical | Performance | Detects that server swap memory has reached a critical level (free swap less than minimum swap) | Server Swap Memory Critical | eventType = ""PH_DEV_MON_SYS_MEM_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Server Memory Warning | Performance | Detects that server Memory has reached a warning level (between 75% and 85% based on 2 successive readings in a 10 minute interval | Server Memory Warning | eventType = ""PH_DEV_MON_SYS_MEM_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND memName = ""Physical Memory"" AND hostIpAddr NOT IN (Group@PH_SYS_APP_DATABASE_SERVER, Group@PH_SYS_APP_MAIL_SERVER) AND hostIpAddr NOT IN (Group@PH_SYS_DEVICE_VM_ESX_GUEST_ALL) |
| Sudden Increase In Firewall Denied Outbound Traffic To A Specific TCP/UDP port | Security | Detects anomalous denied outbound traffic profile on a specific TCP/UDP port - over a 30 minute window, both the total number of denies or the number of unique destination IP addresses are at least 3 standard deviations away from the mean for the current hour | Sudden Increase In Firewall Denied Outbound Traffic To A Specific TCP/UDP port | reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Sudden Increase in Disk I/O | Performance | Detects anomaly in disk I/O usage for servers, VMs and ESX hosts - over a 30 minute interval, either the read or write volume is more than 3 standard deviations away from the mean over that same time period and the read/write volume is at least 1 Mbps | Sudden Increase in Disk I/O | eventType IN (""PH_DEV_MON_DISK_IO_UTIL"",""PH_DEV_MON_VM_DISK_IO"",""PH_DEV_MON_ESX_DISK_IO"") |
| Storage CPU Warning | Performance | Detects that storage CPU has reached a warning level (between 85% and 95% based on 2 successive readings in a 10 minute interval | Storage CPU Warning | eventType IN (""PH_DEV_MON_SYS_CPU_UTIL"",""PH_DEV_MON_CLARION_SP_UTIL"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Storage) |
| Server Network Interface Flapping | Disponibilidade | Detects that a network interface of a server is flapping - that is, coming up and down more than 3 times in 15 minutes. This may indicate hardware issues. | Server Network Interface Flapping | eventType IN (Group@PH_SYS_EVENT_NetIntfShutdown) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Server Intf Error Critical | Performance | Detects that a server interface errors has reached a critical level (greater than 5% based on 2 successive readings in a 10 minute interval | Server Intf Error Critical | eventType = ""PH_DEV_MON_NET_INTF_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Ransomware outbreak detected | Security | Identifies ransomware detected on more than 10 hosts in a 30 minute window. | Ransomware outbreak detected | eventType = ""PH_RULE_RANSOMWARE_DETECTED"" |
| Scanner found medium vulnerability | Security | Detects a medium severity vulnerability reported by a vulnerability scanner | Scanner found medium vulnerability | eventType IN (Group@PH_SYS_EVENT_Vulnerability) AND reptVendor IN (""Qualys"", ""Nessus"", ""nCircle"", ""Rapid7"", ""McAfee"", ""Tenable"",""Fortinet"", ""Digital Defense"", ""FortiClient"") AND eventSeverity >= 5 AND eventSeverity <= 7 |
| Service Degraded: Slow Response to STM | Disponibilidade | Detects that the response time of an end user monitored service is greater than a defined threshold (average over 3 samples in 15 minutes is more than 5 seconds) | Service Degraded: Slow Response to STM | eventType = ""PH_DEV_MON_EUM_SUCCESS"" AND hostIpAddr IS NULL |
| Storage Device CPU Critical | Performance | Detects that storage CPU has reached a critical level (greater than 95% based on 2 successive readings in a 10 minute interval | Storage Device CPU Critical | eventType IN (""PH_DEV_MON_SYS_CPU_UTIL"",""PH_DEV_MON_CLARION_SP_UTIL"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Storage) |
| Sudden Increase In Firewall Denied Inbound Traffic To A Specific TCP/UDP port | Security | Detects anomalous denied inbound traffic profile on a specific TCP/UDP port - over a 30 minute window, both the total number of denies and the number of unique source IP addresses are at least 3 standard deviations away from the mean for the current hour | Sudden Increase In Firewall Denied Inbound Traffic To A Specific TCP/UDP port | reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Server Down: No Ping Response | Disponibilidade | Detects a device does not respond to ping - 10 out of 10 ping packets are lost - either the host is down or there is a routing problem | Server Down: No Ping Response | eventType IN (Group@PH_SYS_EVENT_SystemShutdown) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Service Staying Down: No Response to STM | Disponibilidade | Detects a service staying down - that is went from up to down and did not come up and is no longer responding to end user monitoring probes. | Service Staying Down: No Response to STM | eventType = ""PH_DEV_MON_EUM_SUCCESS"" |
| Server Disk Space Critical | Performance | Detects that server disk space usage has reached a critical level (greater than 95% and free disk less than 100 MB) based on 2 successive readings in a 10 minute interval | Server Disk Space Critical | eventType = ""PH_DEV_MON_SYS_DISK_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND diskName NOT IN (""/boot"") |
| Storage Port Down | Disponibilidade | Detects a storage port went down | Storage Port Down | eventType = ""PH_DEV_MON_STORAGE_PORT_UP_TO_DOWN"" |
| Storage Device Disk Space Critical | Performance | Detects that NFS disk space usage has reached a critical level (greater than 95% and free disk less than 100 MB) based on 2 successive readings in a 10 minute interval | Storage Device Disk Space Critical | eventType = ""PH_DEV_MON_SYS_DISK_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Storage) |
| Server Intf Util Warning | Performance | Detects that interface utilization of a server has reached a warning level (utilization between 30% and 50% based on 2 successive readings in a 10 minute interval | Server Intf Util Warning | eventType = ""PH_DEV_MON_NET_INTF_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND hostIpAddr NOT IN (Group@PH_SYS_APP_NETWORK_IPS) AND intfName NOT CONTAIN ""Loopback"" AND intfName NOT IN (""lo"",""Null0"") AND hostIpAddr NOT IN (Group@PH_SYS_DEVICE_VM_ESX_GUEST_ALL) |
| Server Intf Error Warning | Performance | Detects that a server interface error has reached a warning level (utilization between 1% and 5% based on 2 successive readings in a 10 minute interval | Server Intf Error Warning | eventType = ""PH_DEV_MON_NET_INTF_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Scanner found severe vulnerability | Security | Detects a high severity vulnerability reported by a vulnerability scanner | Scanner found severe vulnerability | eventType IN (Group@PH_SYS_EVENT_Vulnerability) AND reptVendor IN (""Qualys"", ""Nessus"", ""nCircle"", ""Rapid7"", ""McAfee"", ""Tenable"",""Fortinet"", ""Digital Defense"", ""FortiClient"") AND eventSeverity >= 8 |
| Server Memory Critical | Performance | Detects that server memory has reached a critical level (greater than 85% based on 2 successive readings in a 10 minute interval | Server Memory Critical | eventType = ""PH_DEV_MON_SYS_MEM_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND memName = ""Physical Memory"" AND hostIpAddr NOT IN (Group@PH_SYS_APP_DATABASE_SERVER, Group@PH_SYS_APP_MAIL_SERVER) AND hostIpAddr NOT IN (Group@PH_SYS_DEVICE_VM_ESX_GUEST_ALL) |
| Sudden Increase In System CPU Usage | Performance | Detects sudden increase in CPU usage - current average over 30 minute interval is more than 3 standard deviations away from the mean and the current average is at least 50 percent | Sudden Increase In System CPU Usage | eventType IN (""PH_DEV_MON_SYS_CPU_UTIL"",""PH_DEV_MON_FORTIGATE_PERF"",""PH_DEV_MON_FORTISWITCH_PERF"",""PH_DEV_MON_FORTIAP_PERF"") |
| Sudden Increase in Server Process Count | Performance | Detects that a server is suddenly running 25% more processes than the average | Sudden Increase in Server Process Count | eventType = ""PH_DEV_MON_SYS_PROC_COUNT"" |
| User deleted from Domain Admin Group | Change | Detects users deleted from domain admin group | User deleted from Domain Admin Group | reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER) AND eventType IN (Group@PH_SYS_EVENT_GroupMemberRemoved) AND targetUserGrp = ""Domain Admins"" |
| User deleted from Backup Operator Group | Change | Detects users deleted from backup operator group | User deleted from Backup Operator Group | reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) AND eventType IN (Group@PH_SYS_EVENT_GroupMemberRemoved) AND targetUserGrp = ""Backup Operators"" |
| TCP DDOS Attack | Security | Detects excessive number of half-open TCP connections from many distinct sources to the same destination host and on the same port in a short period of time. This may indicate that the destination server is under some sort of attack. | TCP DDOS Attack | ipProto = 6 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Sudden Increase in Network Interface Traffic | Security | Detects anomaly in aggregate traffic on a router/switch port. Over a 30 minute window, both the total sent bytes or the total received bytes are more than 3 standard deviations away from the mean for the current hour | Sudden Increase in Network Interface Traffic | eventType IN (""PH_DEV_MON_NET_INTF_UTIL"",""PH_DEV_MON_FORTIGATE_INTF_UTIL"",""PH_DEV_MON_FORTIAP_INTF_UTIL"") |
| Sudden Increase in System Memory Usage | Performance | Detects a sudden increase in system memory usage - over a 30 minute interval, either the physical or virtual memory is 25% more than the statistical average over that same time period and the current physical memory usage is at least 50% | Sudden Increase in System Memory Usage | eventType IN (""PH_DEV_MON_SYS_MEM_UTIL"",""PH_DEV_MON_FORTIGATE_PERF"",""PH_DEV_MON_FORTISWITCH_PERF"",""PH_DEV_MON_FORTIAP_PERF"") |
| Unix Server Health: Warning | Performance | Detects that the health of a unix server need to be watched carefully based average CPU, memory, disk and interface utilization and interface errors- at least one of the measured attributes has crossed the specified LOW threshold but has not yet crossed the specified HIGH threshold | Unix Server Health: Warning | eventType IN (""PH_RULE_SERVER_CPU_WARN"",""PH_RULE_SERVER_MEM_WARN"",""PH_RULE_SERVER_DISK_SPACE_WARN"", ""PH_RULE_SERVER_INTF_UTIL_WARN"",""PH_RULE_SERVER_INTF_ERR_WARN"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_UNIX_SERVER) |
| Sudden Increase in STM Response Times | Performance | Detects a sudden 50% increase of Synthetic Transaction Monitoring Response Times over a 30 minute time window | Sudden Increase in STM Response Times | eventType = ""PH_DEV_MON_EUM_SUCCESS"" |
| Sudden Increase in Firewall Permitted Inbound Traffic To A Specific TCP/UDP port | Security | Detects traffic anomaly on inbound TCP/UDP port usage on a firewall. This means that over a 30 minute time window, the permitted inbound traffic (both number of flows and total bytes) to a specific TCP/UDP port is more than three standard deviations away than the average for the current hour. | Sudden Increase in Firewall Permitted Inbound Traffic To A Specific TCP/UDP port | eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Virtual Machine Health: Critical | Performance | Detects that the health of a virtual machine is critical based on specific VM metrics such as CPU ready percent, memory swapping rates and disk I/O activity- at least one of the measured attributes has crossed the specified HIGH threshold | Virtual Machine Health: Critical | eventType IN (""PH_RULE_VM_CPU_CRIT"", ""PH_RULE_VM_MEM_CRIT"", ""PH_RULE_VM_DISKIO_CRIT"") |
| Virtual Machine Health: Warning | Performance | Detects that the health of a virtual machine need to be watched carefully based on specific VM metrics such as CPU ready percent, memory swapping rates and disk I/O activity- at least one of the measured attributes has crossed the specified LOW threshold but has not yet crossed the specified HIGH threshold | Virtual Machine Health: Warning | eventType IN (""PH_RULE_VM_CPU_WARN"", ""PH_RULE_VM_MEM_WARN"", ""PH_RULE_VM_DISKIO_WARN"") |
| Sudden Increase In Firewall Permitted Outbound Traffic To A Specific TCP/UDP port | Security | Detects traffic anomaly on outbound TCP/UDP port usage. Detects traffic anomaly on outbound TCP/UDP port usage on a firewall. This means that over a 30 minute time window, the permitted outbound traffic (both number of flows and total bytes) to a specific TCP/UDP port is more than 3 standard deviations away than the average for the current hour. | Sudden Increase In Firewall Permitted Outbound Traffic To A Specific TCP/UDP port | eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Unix Server Health: Critical | Performance | Detects that the health of a unix server is critical and needs immediate attention based average CPU, memory, disk and interface utilization and interface errors - at least one of the measured attributes has crossed the specified HIGH threshold | Unix Server Health: Critical | eventType IN (""PH_RULE_SERVER_CPU_CRIT"",""PH_RULE_SERVER_MEM_CRIT"",""PH_RULE_SERVER_DISK_SPACE_CRIT"", ""PH_RULE_SERVER_INTF_UTIL_CRIT"",""PH_RULE_SERVER_INTF_ERR_CRIT"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_UNIX_SERVER) |
| VCenter Datastore Space Critical | Performance | Detects that datastore usage has reached a critical level (utilization greater than 85% and free disk less than 10GB) based on 2 successive readings in a 10 minute interval | VCenter Datastore Space Critical | eventType = ""PH_DEV_MON_DATASTORE_UTIL"" |
| Virtual Machine CPU Critical | Performance | Detects that virtual server CPU ready percent has reached a critical level (greater than 25% based on 2 successive readings in a 10 minute interval | Virtual Machine CPU Critical | eventType = ""PH_DEV_MON_VM_CPU_UTIL"" |
| Sudden Increase in SNMP Response Times | Performance | Detects a sudden 100% increase of SNMP Response Times to a host over a 30 minute time window | Sudden Increase in SNMP Response Times | eventType = ""PH_DEV_MON_SNMP_PING_STAT"" |
| Sudden Increase in Ping Response Times | Performance | Detects a sudden 100% increase of Ping Response Times to a host, over a 30 minute time window | Sudden Increase in Ping Response Times | eventType = ""PH_DEV_MON_PING_STAT"" |
| Sudden Increase in ICMP Requests From A Host | Security | Detects that a host is making excessive ICMP requests - both the volume and the number of distinct destinations is more than twice the statistical average and at least 100 ICMP requests | Sudden Increase in ICMP Requests From A Host | ipProto = 1 AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL,Group@PH_SYS_DEVICE_ROUTER_SWITCH) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic, Group@PH_SYS_EVENT_DenyNetTraffic) |
| Unix System Shutting Down | Disponibilidade | Detects that a Unix Server is shutting down | Unix System Shutting Down | eventType IN (""Generic_Unix_System_Shutdown"", ""Generic_Unix_Power_Failure"") |
| User deleted from Administrator Group | Change | Detects users deleted from administrator group | User deleted from Administrator Group | reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) AND eventType IN (Group@PH_SYS_EVENT_GroupMemberRemoved) AND targetUserGrp = ""Administrator"" |
| Virtual Machine CPU Warning | Performance | Detects that virtual server CPU ready percent has reached a warning level (between 20% and 25% based on 2 successive readings in a 10 minute interval | Virtual Machine CPU Warning | eventType = ""PH_DEV_MON_VM_CPU_UTIL"" |
| Sudden Increase in Inbound Firewall Aggregate Denies | Security | Detects that a firewall is seeing a sudden increase inbound denied traffic - over a 30 minute window, either the number of denied flows or the number of distinct denied source ip addresses is more than 3 standard deviations away from the mean | Sudden Increase in Inbound Firewall Aggregate Denies | reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| User deleted from DNS Admins Group | Change | Detects users deleted from backup operator group | User deleted from DNS Admins Group | reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER) AND eventType IN (Group@PH_SYS_EVENT_GroupMemberRemoved) AND targetUserGrp = ""DnsAdmins"" |
| Sudden Increase In Permitted Traffic From Host | Security | Detects traffic anomaly from a source. This means that the permitted traffic pattern from the source is statistically anomalous in the following sense: over a 15 minute time window: at least 100 permitted flows from this host and excessive traffic, peers or ports. Excessive traffic is detected from the number of permitted flows from the source and the total exchanged bytes more than three standard deviations away from mean for the current hour. Excessive peers amounts to more than twice the statistical average for the hour. Excessive destination ports amounts to more than five times the statistical average for the hour. | Sudden Increase In Permitted Traffic From Host | (ipProto = 17 OR ipProto = 6) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL,Group@PH_SYS_DEVICE_ROUTER_SWITCH) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) |
| Sudden Increase in Outbound Firewall Aggregate Denies | Security | Detects that a firewall is seeing a sudden increase in outbound denied traffic - over a 30 minute window, either the number of denied flows or the number of distinct denied source ip addresses is more than 3 standard deviations away from the mean | Sudden Increase in Outbound Firewall Aggregate Denies | reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Sudden Increase in WMI or OMI Response Times | Performance | Detects a sudden 50% increase of WMI or OMI Response Times over a 30 minute time window | Sudden Increase in WMI or OMI Response Times | eventType IN (""PH_DEV_MON_WMI_PING_STAT"", ""PH_DEV_MON_OMI_PING_STAT"") |
| Sudden Increase In Permitted Traffic To Host | Security | Detects traffic anomaly to a destination. This means that the permitted traffic pattern to the destination is statistically anomalous in the following sense: over a 15 minute time window, at least 500 permitted flows and excessive traffic, peers or ports. Excessive traffic is detected from the number of permitted flows destined to this host and total exchanged bytes more than three standard deviations away from mean for the current hour. Excessive peers amounts to more than twice the statistical average for the current hour. Excessive destination ports amounts to more than five times the statistical average for the current hour. | Sudden Increase In Permitted Traffic To Host | (ipProto = 17 OR ipProto = 6) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL,Group@PH_SYS_DEVICE_ROUTER_SWITCH) AND destIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) |
| User deleted from Remote Desktop User Group | Change | Detects users deleted from remote desktop user group | User deleted from Remote Desktop User Group | reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) AND eventType IN (Group@PH_SYS_EVENT_GroupMemberRemoved) AND targetUserGrp = ""Remote Desktop Users"" |
| Virtual Machine Memory Swapping Critical | Performance | Detects that virtual machine memory has reached a warning level based on swapping rate greater than 1.5MBps based on 2 successive readings in a 10 minute interval | Virtual Machine Memory Swapping Critical | eventType = ""PH_DEV_MON_VM_MEM_UTIL"" |
| Windows: Network Communication With Crypto Mining Pool | Security | Detects initiated network connections to crypto mining pools. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_crypto_mining_pools.yml | Windows: Network Communication With Crypto Mining Pool | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND destName IN (""alimabi.cn"",""ap.luckpool.net"",""bcn.pool.minergate.com"",""bcn.vip.pool.minergate.com"",""bohemianpool.com"",""ca.minexmr.com"",""ca.monero.herominers.com"",""cbd.monerpool.org"",""cbdv2.monerpool.org"",""cryptmonero.com"",""crypto-pool.fr"",""crypto-pool.info"",""cryptonight-hub.miningpoolhub.com"",""d1pool.ddns.net"",""d5pool.us"",""daili01.monerpool.org"",""de.minexmr.com"",""dl.nbminer.com"",""donate.graef.in"",""donate.ssl.xmrig.com"",""donate.v2.xmrig.com"",""donate.xmrig.com"",""donate2.graef.in"",""drill.moneroworld.com"",""dwarfpool.com"",""emercoin.com"",""emercoin.net"",""emergate.net"",""ethereumpool.co"",""eu.luckpool.net"",""eu.minerpool.pw"",""fcn-xmr.pool.minergate.com"",""fee.xmrig.com"",""fr.minexmr.com"",""hellominer.com"",""herominers.com"",""huadong1-aeon.ppxxmr.com"",""iwanttoearn.money"",""jw-js1.ppxxmr.com"",""koto-pool.work"",""lhr.nbminer.com"",""lhr3.nbminer.com"",""linux.monerpool.org"",""lokiturtle.herominers.com"",""luckpool.net"",""masari.miner.rocks"",""mine.c3pool.com"",""mine.moneropool.com"",""mine.ppxxmr.com"",""mine.zpool.ca"",""mine1.ppxxmr.com"",""minemonero.gq"",""miner.ppxxmr.com"",""miner.rocks"",""minercircle.com"",""minergate.com"",""minerpool.pw"",""minerrocks.com"",""miners.pro"",""minerxmr.ru"",""minexmr.cn"",""minexmr.com"",""mining-help.ru"",""miningpoolhub.com"",""mixpools.org"",""moner.monerpool.org"",""moner1min.monerpool.org"",""monero-master.crypto-pool.fr"",""monero.crypto-pool.fr"",""monero.hashvault.pro"",""monero.herominers.com"",""monero.lindon-pool.win"",""monero.miners.pro"",""monero.riefly.id"",""monero.us.to"",""monerocean.stream"",""monerogb.com"",""monerohash.com"",""moneroocean.stream"",""moneropool.com"",""moneropool.nl"",""monerorx.com"",""monerpool.org"",""moriaxmr.com"",""mro.pool.minergate.com"",""multipool.us"",""myxmr.pw"",""na.luckpool.net"",""nanopool.org"",""nbminer.com"",""node3.luckpool.net"",""noobxmr.com"",""pangolinminer.comgandalph3000.com"",""pool.4i7i.com"",""pool.armornetwork.org"",""pool.cortins.tk"",""pool.gntl.co.uk"",""pool.hashvault.pro"",""pool.minergate.com"",""pool.minexmr.com"",""pool.monero.hashvault.pro"",""pool.ppxxmr.com"",""pool.somec.cc"",""pool.support"",""pool.supportxmr.com"",""pool.usa-138.com"",""pool.xmr.pt"",""pool.xmrfast.com"",""pool2.armornetwork.org"",""poolchange.ppxxmr.com"",""pooldd.com"",""poolmining.org"",""poolto.be"",""ppxvip1.ppxxmr.com"",""ppxxmr.com"",""prohash.net"",""r.twotouchauthentication.online"",""randomx.xmrig.com"",""ratchetmining.com"",""seed.emercoin.com"",""seed.emercoin.net"",""seed.emergate.net"",""seed1.joulecoin.org"",""seed2.joulecoin.org"",""seed3.joulecoin.org"",""seed4.joulecoin.org"",""seed5.joulecoin.org"",""seed6.joulecoin.org"",""seed7.joulecoin.org"",""seed8.joulecoin.org"",""sg.minexmr.com"",""sheepman.mine.bz"",""siamining.com"",""sumokoin.minerrocks.com"",""supportxmr.com"",""suprnova.cc"",""teracycle.net"",""trtl.cnpool.cc"",""trtl.pool.mine2gether.com"",""turtle.miner.rocks"",""us-west.minexmr.com"",""usxmrpool.com"",""viaxmr.com"",""webservicepag.webhop.net"",""xiazai.monerpool.org"",""xiazai1.monerpool.org"",""xmc.pool.minergate.com"",""xmo.pool.minergate.com"",""xmr-asia1.nanopool.org"",""xmr-au1.nanopool.org"",""xmr-eu1.nanopool.org"",""xmr-eu2.nanopool.org"",""xmr-jp1.nanopool.org"",""xmr-us-east1.nanopool.org"",""xmr-us-west1.nanopool.org"",""xmr-us.suprnova.cc"",""xmr-usa.dwarfpool.com"",""xmr.2miners.com"",""xmr.5b6b7b.ru"",""xmr.alimabi.cn"",""xmr.bohemianpool.com"",""xmr.crypto-pool.fr"",""xmr.crypto-pool.info"",""xmr.f2pool.com"",""xmr.hashcity.org"",""xmr.hex7e4.ru"",""xmr.ip28.net"",""xmr.monerpool.org"",""xmr.mypool.online"",""xmr.nanopool.org"",""xmr.pool.gntl.co.uk"",""xmr.pool.minergate.com"",""xmr.poolto.be"",""xmr.ppxxmr.com"",""xmr.prohash.net"",""xmr.simka.pw"",""xmr.somec.cc"",""xmr.suprnova.cc"",""xmr.usa-138.com"",""xmr.vip.pool.minergate.com"",""xmr1min.monerpool.org"",""xmrf.520fjh.org"",""xmrf.fjhan.club"",""xmrfast.com"",""xmrigcc.graef.in"",""xmrminer.cc"",""xmrpool.de"",""xmrpool.eu"",""xmrpool.me"",""xmrpool.net"",""xmrpool.xyz"",""xx11m.monerpool.org"",""xx11mv2.monerpool.org"",""xxx.hex7e4.ru"",""zarabotaibitok.ru"",""zer0day.ru"") |
| Windows: Disable Important Scheduled Task | Security | Detects when adversaries stop services or processes by disabling their respective scheduled tasks in order to conduct data destructive activities. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_disable.yml | Windows: Disable Important Scheduled Task | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".*/Change.*"" AND command REGEXP "".*/TN.*"" AND command REGEXP "".*/disable.*"" AND command REGEXP "".*\\Windows\\BitLocker.*|.*\\Windows\\ExploitGuard.*|.*\\Windows\\SystemRestore\\SR.*|.*\\Windows\\UpdateOrchestrator\\.*|.*\\Windows\\Windows Defender\\.*|.*\\Windows\\WindowsBackup\\.*|.*\\Windows\\WindowsUpdate\\.*"" |
| Windows: Delete Important Scheduled Task | Security | Detects when adversaries stop services or processes by deleting their respective scheduled tasks in order to conduct data destructive activities. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_delete.yml | Windows: Delete Important Scheduled Task | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".*/delete.*"" AND command REGEXP "".*/tn.*"" AND command REGEXP "".*\\Windows\\BitLocker.*|.*\\Windows\\ExploitGuard.*|.*\\Windows\\SystemRestore\\SR.*|.*\\Windows\\UpdateOrchestrator\\.*|.*\\Windows\\Windows Defender\\.*|.*\\Windows\\WindowsBackup\\.*|.*\\Windows\\WindowsUpdate\\.*"" |
| Windows: Suspicious Execution of Shutdown | Security | Use of the commandline to shutdown or reboot windows. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_shutdown_execution.yml | Windows: Suspicious Execution of Shutdown | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\shutdown\.exe"" AND command REGEXP "".*/r .*|.*/s .*"" |
| Windows: Suspicious Execution of Shutdown to Log Out | Security | Detects the rare use of the command line tool shutdown to logoff a user. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_shutdown_logoff.yml | Windows: Suspicious Execution of Shutdown to Log Out | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\shutdown\.exe"" AND command REGEXP "".*/l.*"" |
| Windows: Suspicious Volume Shadow Copy Vssapi.dll Load | Security | Detects the image load of VSS DLL by uncommon executables. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_dll_vssapi_susp_load.yml | Windows: Suspicious Volume Shadow Copy Vssapi.dll Load | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\vssapi\.dll"" AND ((procName NOT IN (""C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe"",""C:\\Windows\\explorer.exe"") AND procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\Temp\\\{.*|C:\\Windows\\WinSxS\\.*"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"") AND (procName NOT REGEXP ""C:\\ProgramData\\Package Cache\\.*"")) |
| Windows Server Shutting Down | Disponibilidade | Detects that a Microsoft Windows Server is shutting down | Windows Server Shutting Down | eventType = ""Win-System-USER32-1074"" |
| Windows: Application Uninstalled | Security | An application has been removed. Check if it is critical. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/msiinstaller/win_builtin_remove_application.yml | Windows: Application Uninstalled | eventType IN (""Win-App-MsiInstaller-1034"",""Win-App-MsiInstaller-11724"") |
| Windows Server Health: Warning | Performance | Detects that the health of a windows server need to be watched carefully based average CPU, memory, disk and interface utilization and interface errors- at least one of the measured attributes has crossed the specified LOW threshold but has not yet crossed the specified HIGH threshold | Windows Server Health: Warning | eventType IN (""PH_RULE_SERVER_CPU_WARN"",""PH_RULE_SERVER_MEM_WARN"",""PH_RULE_SERVER_DISK_SPACE_WARN"", ""PH_RULE_SERVER_INTF_UTIL_WARN"",""PH_RULE_SERVER_INTF_ERR_WARN"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) |
| Windows: Suspicious Creation TXT File in User Desktop | Security | Ransomware create txt file in the user Desktop. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_desktop_txt.yml | Windows: Suspicious Creation TXT File in User Desktop | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\cmd\.exe"" AND fileName REGEXP "".*\\Users\\.*"" AND fileName REGEXP "".*\\Desktop\\.*"" AND fileName REGEXP "".*\.txt"" |
| Windows Server Health: Critical | Performance | Detects that the health of a windows server is critical and needs immediate attention based average CPU, memory, disk and interface utilization and interface errors - at least one of the measured attributes has crossed the specified HIGH threshold | Windows Server Health: Critical | eventType IN (""PH_RULE_SERVER_CPU_CRIT"",""PH_RULE_SERVER_MEM_CRIT"",""PH_RULE_SERVER_DISK_SPACE_CRIT"", ""PH_RULE_SERVER_INTF_UTIL_CRIT"",""PH_RULE_SERVER_INTF_ERR_CRIT"") AND hostIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) |
| Website defacement attack | Security | Detects high severity website defacement attack | Website defacement attack | eventType IN (Group@PH_SYS_EVENT_WebsiteDefacementAttack) |
| Windows: Audit CVE Event | Security | Detects events generated by user-mode applications when they call the CveEventWrite API when a known vulnerability is trying to be exploited. MS started using this log in Jan. 2020 with CVE-2020-0601 (a Windows CryptoAPI vulnerability. Unfortunately, that is about the only instance of CVEs being written to this log. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/microsoft-windows_audit_cve/win_audit_cve.yml | Windows: Audit CVE Event | eventType=""Win-App-Microsoft-Windows-Audit-CVE-1"" |
| Windows: Deletion of Volume Shadow Copies via WMI with PowerShell | Security | Detects deletion of Windows Volume Shadow Copies with PowerShell code and Get-WMIObject. This technique is used by numerous ransomware families such as Sodinokibi/REvil. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_shadowcopy_deletion.yml | Windows: Deletion of Volume Shadow Copies via WMI with PowerShell | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Get-CimInstance.*|.*Get-WmiObject.*|.*gcim.*|.*gwmi.*"" AND command REGEXP "".*Win32_Shadowcopy.*"" AND command REGEXP "".*Remove-CimInstance.*|.*Remove-WmiObject.*|.*\.Delete\(\).*|.*rcim.*|.*rwmi.*"" |
| Windows: NTFS Vulnerability Exploitation | Security | This the exploitation of a NTFS vulnerability as reported without many details via Twitter. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/ntfs/win_system_ntfs_vuln_exploit.yml | Windows: NTFS Vulnerability Exploitation | eventType=""Win-System-Ntfs-55"" AND origLocation=""File System Driver"" AND description REGEXP "".*contains a corrupted file record.*"" AND description REGEXP "".*The name of the file is \""\\\"".*"" |
| Windows: Renamed Sysinternals Sdelete Execution | Security | Detects the use of a renamed SysInternals Sdelete, which is something an administrator shouldn't do (the renaming). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_sysinternals_sdelete.yml | Windows: Renamed Sysinternals Sdelete Execution | eventType=""Win-Sysmon-1-Create-Process"" AND srcFileName=""sdelete.exe"" AND (procName NOT REGEXP "".*\\sdelete64\.exe|.*\\sdelete\.exe"") |
| Windows File System Replication Down | Disponibilidade | Detects that Windows File System Replication Service is down | Windows File System Replication Down | eventType IN (""Win-App-DFSR-1006"",""Win-App-DFSR-1008"") |
| Windows: Boot Configuration Tampering Via Bcdedit.EXE | Security | Detects the use of the bcdedit command to tamper with the boot configuration data. This technique is often times used by malware or attackers as a destructive way before launching ransomware. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bcdedit_boot_conf_tamper.yml | Windows: Boot Configuration Tampering Via Bcdedit.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\bcdedit\.exe"" OR srcFileName=""bcdedit.exe"") AND command REGEXP "".*set.*"" AND ((command REGEXP "".*bootstatuspolicy.*"" AND command REGEXP "".*ignoreallfailures.*"") OR (command REGEXP "".*recoveryenabled.*"" AND command REGEXP "".*no.*"")) |
| Windows: Sensitive Registry Access via Volume Shadow Copy | Security | Detects a command that accesses password storing registry hives via volume shadow backups. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_malware_conti_shadowcopy.yml | Windows: Sensitive Registry Access via Volume Shadow Copy | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy.*"" AND command REGEXP "".*C:\\tmp\\log.*|.*\\NTDS\.dit.*|.*\\SECURITY.*|.*\\SYSTEM.*"" |
| Virtual Machine SCSI Bus Reset | Performance | Detects that virtual machine SCSI bus reset indicating that a read or write failed to complete within an acceptable amount of time. Storage could be a bottleneck. | Virtual Machine SCSI Bus Reset | eventType = ""PH_DEV_MON_VM_DISK_IO"" |
| Windows: Copy From VolumeShadowCopy Via Cmd.EXE | Security | Detects the execution of the builtin ""copy"" command that targets a shadow copy (sometimes used to copy registry hives that are in use). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_shadowcopy_access.yml | Windows: Copy From VolumeShadowCopy Via Cmd.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*copy .*"" AND command REGEXP "".*\\\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy.*"" |
| Windows: Suspicious Volume Shadow Copy VSS-PS.dll Load | Security | Detects the image load of vss_ps.dll by uncommon executables. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_dll_vss_ps_susp_load.yml | Windows: Suspicious Volume Shadow Copy VSS-PS.dll Load | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\vss_ps\.dll"" AND ((procName NOT REGEXP ""C:\\Windows\\.*"" OR procName NOT REGEXP "".*\\System32\\SystemPropertiesAdvanced\.exe|.*\\WmiPrvSE\.exe|.*\\clussvc\.exe|.*\\dismhost\.exe|.*\\dllhost\.exe|.*\\inetsrv\\appcmd\.exe|.*\\inetsrv\\iissetup\.exe|.*\\msiexec\.exe|.*\\rundll32\.exe|.*\\searchindexer\.exe|.*\\srtasks\.exe|.*\\svchost\.exe|.*\\taskhostw\.exe|.*\\thor64\.exe|.*\\thor\.exe|.*\\tiworker\.exe|.*\\vssvc\.exe"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"") AND (command NOT REGEXP ""C:\\\$WinREAgent\\Scratch\\.*"" OR command NOT REGEXP "".*\\dismhost\.exe \{.*"")) |
| Windows: Delete All Scheduled Tasks | Security | Detects the usage of schtasks with the delete flag and the asterisk symbole to delete all tasks from the schedule of the local computer, including tasks scheduled by other users. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_delete_all.yml | Windows: Delete All Scheduled Tasks | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\schtasks\.exe"" AND command REGEXP "".* /delete .*"" AND command REGEXP "".*/tn \.*"" AND command REGEXP "".* /f.*"" |
| Windows: Shadow Copies Deletion Using Operating Systems Utilities | Security | Shadow Copies deletion using operating systems utilities. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_shadow_copies_deletion.yml | Windows: Shadow Copies Deletion Using Operating Systems Utilities | eventType=""Win-Sysmon-1-Create-Process"" AND ((((procName REGEXP "".*\\diskshadow\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\vssadmin\.exe|.*\\wmic\.exe"" OR srcFileName IN (""PowerShell.EXE"",""VSSADMIN.EXE"",""diskshadow.exe"",""pwsh.dll"",""wmic.exe"")) AND (command REGEXP "".*shadow.*"" AND command REGEXP "".*delete.*"")) OR ((procName REGEXP "".*\\wbadmin\.exe"" OR srcFileName=""WBADMIN.EXE"") AND (command REGEXP "".*delete.*"" AND command REGEXP "".*catalog.*"" AND command REGEXP "".*quiet.*""))) OR ((procName REGEXP "".*\\vssadmin\.exe"" OR srcFileName=""VSSADMIN.EXE"") AND (command REGEXP "".*resize.*"" AND command REGEXP "".*shadowstorage.*"" AND command REGEXP "".*/MaxSize=.*|.*unbounded.*""))) |
| Windows: Stop Windows Service Via PowerShell Stop-Service | Security | Detects the stopping of a Windows service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_stop_service.yml | Windows: Stop Windows Service Via PowerShell Stop-Service | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName IN (""PowerShell.EXE"",""pwsh.dll"") OR procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"") AND command REGEXP "".*Stop-Service .*"" |
| Windows: Potential File Overwrite Via Sysinternals SDelete | Security | Detects the use of SDelete to erase a file not the free space. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_sdelete.yml | Windows: Potential File Overwrite Via Sysinternals SDelete | eventType=""Win-Sysmon-1-Create-Process"" AND srcFileName=""sdelete.exe"" AND (command NOT REGEXP "".* -c.*|.* -h.*|.* -z.*|.* /\\?.*"") |
| Windows: Stop Windows Service Via Sc.EXE | Security | Detects the stopping of a Windows service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_stop_service.yml | Windows: Stop Windows Service Via Sc.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((srcFileName=""sc.exe"" OR procName REGEXP "".*\\sc\.exe"") AND command REGEXP "".* stop .*"") AND ((command NOT IN (""sc stop KSCWebConsoleMessageQueue"",""sc stop LGHUBUpdaterService"") OR user NOT REGEXP "".*AUTHORI.*|.*AUTORI.*"")) |
| Windows: Potential Crypto Mining Activity | Security | Detects command line parameters or strings often used by crypto miners. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_crypto_mining_monero.yml | Windows: Potential Crypto Mining Activity | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* --algo=rx/0 .*|.* --cpu-priority=.*|.* --nicehash.*|.* -o pool\..*|.*--donate-level=0.*|.*0tZG9uYXRlLWxldmVsP.*|.*LS1kb25hdGUtbGV2ZWw9.*|.*N0cmF0dW0rdGNwOi8v.*|.*N0cmF0dW0rdWRwOi8v.*|.*c3RyYXR1bSt0Y3A6Ly.*|.*c3RyYXR1bSt1ZHA6Ly.*|.*stratum\+tcp://.*|.*stratum\+udp://.*|.*tLWRvbmF0ZS1sZXZlbD.*|.*zdHJhdHVtK3RjcDovL.*|.*zdHJhdHVtK3VkcDovL.*"" AND (command NOT REGEXP "".* pool\.c .*|.* pool\.o .*|.*gcc -.*"") |
| Virtual Machine Memory Swapping Warning | Performance | Detects that virtual machine memory has reached a warning level based on swapping rate between 1MBps and 1.5MBps based on 2 successive readings in a 10 minute interval | Virtual Machine Memory Swapping Warning | eventType = ""PH_DEV_MON_VM_MEM_UTIL"" |
| Windows: Suspicious Execution of Taskkill | Security | Adversaries may stop services or processes in order to conduct Data Destruction or Data Encrypted for Impact on the data stores of services like Exchange and SQL Server. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_taskkill_execution.yml | Windows: Suspicious Execution of Taskkill | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\taskkill\.exe"" OR srcFileName=""taskkill.exe"") AND (command REGEXP "".* /f.*"" AND command REGEXP "".* /im .*"") |
| Windows: Amsi.DLL Load By Uncommon Process | Security | Detects loading of Amsi.dll by uncommon processes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_dll_amsi_uncommon_process.yml | Windows: Amsi.DLL Load By Uncommon Process | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\amsi\.dll"" AND ((procName NOT IN (""C:\\Windows\\Sysmon64.exe"",""C:\\Windows\\explorer.exe"")) AND (procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\WinSxS\\.*"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"") AND (procName NOT REGEXP ""C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\.*"" OR procName NOT REGEXP "".*\\MsMpEng\.exe"") AND (procName NOT REGEXP ""C:\\Windows\\Microsoft\.NET\\Framework64\\.*|C:\\Windows\\Microsoft\.NET\\Framework\\.*"" OR procName NOT REGEXP "".*\\ngentask\.exe"") AND (procName IS NOT NULL) AND (procName IS NOT NULL)) |
| Windows: Suspicious Reg Add BitLocker | Security | Detects suspicious addition to BitLocker related registry keys via the reg.exe utility. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_bitlocker.yml | Windows: Suspicious Reg Add BitLocker | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*REG.*"" AND command REGEXP "".*ADD.*"" AND command REGEXP "".*\\SOFTWARE\\Policies\\Microsoft\\FVE.*"" AND command REGEXP "".*/v.*"" AND command REGEXP "".*/f.*"" AND command REGEXP "".*EnableBDEWithNoTPM.*|.*RecoveryKeyMessage.*|.*RecoveryKeyMessageSource.*|.*UseAdvancedStartup.*|.*UseTPM.*|.*UseTPMKey.*|.*UseTPMKeyPIN.*|.*UseTPMPIN.*"" |
| Windows Server Paging File Usage Critical | Performance | Detects that server paging file usage has reached a critical level (greater than 98% based on 5 successive readings in a 1 hour interval. The paging file is a reserved space on disk that backes up committed physical memory on a computer | Windows Server Paging File Usage Critical | eventType = ""PH_DEV_MON_SYS_PAGEFILE_USAGE"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Windows: Deleted Data Overwritten Via Cipher.EXE | Security | Detects usage of the ""cipher"" built-in utility in order to overwrite deleted data from disk. Adversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems, services, and network resources. Data destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cipher_overwrite_deleted_data.yml | Windows: Deleted Data Overwritten Via Cipher.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""CIPHER.EXE"" OR procName REGEXP "".*\\cipher\.exe"") AND command REGEXP "".* /w:.*"" |
| Windows: Stop Windows Service Via Net.EXE | Security | Detects the stopping of a Windows service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_stop_service.yml | Windows: Stop Windows Service Via Net.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName IN (""net.exe"",""net1.exe"") OR procName REGEXP "".*\\net1\.exe|.*\\net\.exe"") AND command REGEXP "".* stop .*"" |
| ICS Alert: Denial of Control | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0813 - Denial of Control. Adversaries may cause a denial of control to temporarily prevent operators and engineers from interacting with process controls. | ICS Alert: Denial of Control | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0813(,T\d+)*$"" |
| ICS Alert: Theft of Operational Information | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0882 - Theft of Operational Information. Adversaries may steal operational information on a production environment as a direct mission outcome for personal gain or to inform future operations. | ICS Alert: Theft of Operational Information | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0882(,T\d+)*$"" |
| ICS Alert: Loss of Protection | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0837 - Loss of Protection. Adversaries may compromise protective system functions designed to prevent the effects of faults and abnormal conditions. | ICS Alert: Loss of Protection | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0837(,T\d+)*$"" |
| AWS IAM Password Recovery Requested | Security | Detects AWS IAM password recovery requests. An adversary may attempt to gain unauthorized AWS access by abusing password recovery mechanisms. | AWS IAM Password Recovery Requested | eventType CONTAIN ""AWS-CloudTrail-SIGNIN-PasswordRecoveryRequested"" |
| ICS Alert: Command Blocked | Security | An ICS monitoring system has detected an event containing Mitre ICS Technique ID T0803 - Block Command Message. Adversaries may block a command message from reaching its intended target to prevent command execution. In OT networks, command messages are sent to provide instructions to control system devices. A blocked command message can inhibit response functions from correcting a disruption or unsafe condition. | ICS Alert: Command Blocked | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0803(,T\d+)*$"" |
| Windows: SystemStateBackup Deleted Using Wbadmin.EXE | Security | Deletes the Windows systemstatebackup using wbadmin.exe. This technique is used by numerous ransomware families. This may only be successful on server platforms that have Windows Backup enabled. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wbadmin_delete_systemstatebackup.yml | Windows: SystemStateBackup Deleted Using Wbadmin.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\wbadmin\.exe"" OR srcFileName=""WBADMIN.EXE"") AND (command REGEXP "".*delete .*"" AND command REGEXP "".*systemstatebackup .*"" AND command REGEXP "".*-keepVersions:0.*"") |
| ICS Alert: Device Restart/Shutdown | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0816 - Device Restart/Shutdown. Adversaries may forcibly restart or shutdown a device in an ICS environment to disrupt and potentially negatively impact physical processes. | ICS Alert: Device Restart/Shutdown | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0816(,T\d+)*$"" |
| ICS Alert: Loss of Control | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0827 - Loss of Control. Adversaries may seek to achieve a sustained loss of control or a runaway condition in which operators cannot issue any commands even if the malicious interference has subsided. | ICS Alert: Loss of Control | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0827(,T\d+)*$"" |
| ICS Alert: Manipulation of View | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0832 - Manipulation of View. Adversaries may attempt to manipulate the information reported back to operators or controllers. | ICS Alert: Manipulation of View | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0832(,T\d+)*$"" |
| ICS Alert: Modify Alarm Settings | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0838 - Modify Alarm Settings. Adversaries may modify alarm settings to prevent alerts that may inform operators of their presence or to prevent responses to dangerous and unintended scenarios. | ICS Alert: Modify Alarm Settings | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0838(,T\d+)*$"" |
| ICS Alert: Denial of View | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0815 - Denial of View. Adversaries may cause a denial of view in attempt to disrupt and prevent operator oversight on the status of an ICS environment. | ICS Alert: Denial of View | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0815(,T\d+)*$"" |
| WMI or OMI Service Unavailable | Disponibilidade | Detects that WMI or OMI service is unavailable | WMI or OMI Service Unavailable | eventType IN (""PH_DEV_MON_WMI_PING_STAT"", ""PH_DEV_MON_OMI_PING_STAT"") |
| ICS Alert: Modify Parameter | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0836 - Modify Parameter. Adversaries may modify parameters used to instruct industrial control system devices. T | ICS Alert: Modify Parameter | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0836(,T\d+)*$"" |
| ICS Alert: Activate Firmware Update Mode | Security | An ICS monitoring system has detected an event containing Mitre ICS Technique ID T0800 - Activate Firmware Update Mode. Adversaries may activate firmware update mode on devices to prevent expected response functions from engaging in reaction to an emergency or process malfunction. | ICS Alert: Activate Firmware Update Mode | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0800(,T\d+)*$"" |
| ICS Alert: Unauthorized Command Message | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0855 - Unauthorized Command Message. Adversaries may send unauthorized command messages to instruct control system assets to perform actions outside of their intended functionality, or without the logical preconditions to trigger their expected function. | ICS Alert: Unauthorized Command Message | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0855(,T\d+)*$"" |
| AWS IAM Group Created | Security | Identifies the creation of a group in AWS Identity and Access Management (IAM). Groups specify permissions for multiple users. Any user in a group automatically has the permissions that are assigned to the group. | AWS IAM Group Created | eventType CONTAIN ""AWS-CloudTrail-IAM-CreateGroup"" |
| ICS Alert: Denial of Service | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0814 - Denial of Service. Adversaries may perform Denial-of-Service (DoS) attacks to disrupt expected device functionality. Examples of DoS attacks include overwhelming the target device with a high volume of requests in a short time period and sending the target device a request it does not know how to handle. | ICS Alert: Denial of Service | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0814(,T\d+)*$"" |
| ICS Alert: Loss of View | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0829 - Loss of View. Adversaries may cause a sustained or permanent loss of view where the ICS equipment will require local, hands-on operator intervention; with the objective of effectively hiding the present state of operations. | ICS Alert: Loss of View | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0829(,T\d+)*$"" |
| Windows: Suspicious Volume Shadow Copy Vsstrace.dll Load | Security | Detects the image load of VSS DLL by uncommon executables. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_dll_vsstrace_susp_load.yml | Windows: Suspicious Volume Shadow Copy Vsstrace.dll Load | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\vsstrace\.dll"" AND ((procName NOT IN (""C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe"",""C:\\Windows\\explorer.exe"") AND procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\Temp\\\{.*|C:\\Windows\\WinSxS\\.*"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"")) |
| ICS Alert: Manipulate I/O Image | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0835 - Manipulate I/O Image. Adversaries may manipulate the I/O image of PLCs through various means to prevent them from functioning as expected. | ICS Alert: Manipulate I/O Image | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0835(,T\d+)*$"" |
| ICS Alert: Service Stop | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0881 - Service Stop. Adversaries may stop or disable services on a system to render those services unavailable to legitimate users. | ICS Alert: Service Stop | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0881(,T\d+)*$"" |
| ICS Alert: Brute Force I/O | Security | An ICS monitoring system has detected an event containing Mitre ICS Technique ID T0806 - Brute Force I/O. Adversaries may repetitively or successively change I/O point values to manipulate a process function. The adversary may be able to generate instability on the process function associated with that particular point. | ICS Alert: Brute Force I/O | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0806(,T\d+)*$"" |
| ICS Alert: Alarm Suppression | Security | An ICS monitoring system has detected an event containing Mitre ICS Technique ID T0878 - Alarm Suppression. Adversaries may target protection function alarms to prevent them from notifying operators of critical conditions. | ICS Alert: Alarm Suppression | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0878(,T\d+)*$"" |
| AWS EC2 Network Access Control List Created | Security | Identifies the creation of an AWS Elastic Compute Cloud (EC2) network access control list (ACL) or an entry in a network ACL with a specified rule number. | AWS EC2 Network Access Control List Created | eventType IN (""AWS-CloudTrail-EC2-CreateNetworkAcl"",""AWS-CloudTrail-EC2-CreateNetworkAclEntry"") |
| ICS Alert: Loss of Productivity and Revenue | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0828 - Loss of Productivity and Revenue. Adversaries may cause loss of productivity and revenue through disruption and even damage to the availability and integrity of control system operations, devices, and related processes. | ICS Alert: Loss of Productivity and Revenue | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0828(,T\d+)*$"" |
| ICS Alert: Data Destruction | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0809 - Data Destruction. The adversary may drop or create malware, tools, or other non-native files on a target system to accomplish this. | ICS Alert: Data Destruction | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0809(,T\d+)*$"" |
| ICS Alert: Loss of Availability | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0826 - Loss of Availability. Adversaries may attempt to disrupt essential components or systems to prevent owner and operator from delivering products or services. | ICS Alert: Loss of Availability | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0826(,T\d+)*$"" |
| ICS Alert: Block Reporting Message | Security | An ICS monitoring system has detected an event containing Mitre ICS Technique ID T0804 - Block Reporting Message. Adversaries may block or prevent a reporting message from reaching its intended target. In control systems, reporting messages contain telemetry data (e.g., I/O values) pertaining to the current state of equipment and the industrial process. By blocking these reporting messages, an adversary can potentially hide their actions from an operator. | ICS Alert: Block Reporting Message | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0804(,T\d+)*$"" |
| ICS Alert: Damage to Property | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0879 - Damage to Property. Adversaries may cause damage and destruction of property to infrastructure, equipment, and the surrounding environment when attacking control systems. | ICS Alert: Damage to Property | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0879(,T\d+)*$"" |
| ICS Alert: Serial COM Blocked | Security | An ICS monitoring system has detected an event containing Mitre ICS Technique ID T0805 - Block Serial COM. Adversaries may block access to serial COM to prevent instructions or configurations from reaching target devices. Serial Communication ports (COM) allow communication with control system devices. Devices can receive command and configuration messages over such serial COM. Devices also use serial COM to send command and reporting messages. Blocking device serial COM may also block command messages and block reporting messages. | ICS Alert: Serial COM Blocked | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0805(,T\d+)*$"" |
| ICS Alert: Manipulation of Control | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0831 - Adversaries may manipulate physical process control within the industrial environment. Methods of manipulating control can include changes to set point values, tags, or other parameters. | ICS Alert: Manipulation of Control | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0831(,T\d+)*$"" |
| AWS IAM Assume Role Policy Update | Security | Identifies attempts to modify an AWS IAM Assume Role Policy. An adversary may attempt to modify the AssumeRolePolicy of a misconfigured role in order to gain the privileges of that role. | AWS IAM Assume Role Policy Update | eventType CONTAIN ""AWS-CloudTrail-IAM-UpdateAssumeRolePolicy"" |
| ICS Alert: Loss of Safety | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0880 - Loss of Safety. Adversaries may compromise safety system functions designed to maintain safe operation of a process when unacceptable or dangerous conditions occur. | ICS Alert: Loss of Safety | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0880(,T\d+)*$"" |
| Windows: Failed Logon From Public IP | Security | A login from a public IP can indicate a misconfigured firewall or network boundary. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_susp_failed_logon_source.yml | Windows: Failed Logon From Public IP | eventType=""Win-Security-4625"" AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Windows: External Remote SMB Logon from Public IP | Security | Detects successful logon from public IP address via SMB. This can indicate a publicly-exposed SMB port. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_successful_external_remote_smb_login.yml | Windows: External Remote SMB Logon from Public IP | eventType=""Win-Security-4624"" AND winLogonType=3 AND srcIpAddr!=::1 AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Outbreak: Kaseya REvil Ransomware File Activity Detected on Network | Security | Malware known to be associated with REvil Ransomware activity detected by Fortinet Products on Network. These indicators were seen during the Kaseya VSA Supply Chain Attack. | Outbreak: Kaseya REvil Ransomware File Activity Detected on Network | eventType IN (Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ( virusName IN (""W32/Sodinokibi.EAD4!tr.ransom"",""W32/Sodinokibi.5421!tr.ransom"",""W32/Sodinokibi.8859!tr.ransom"") OR attackName IN (""W32/Sodinokibi.EAD4!tr.ransom"",""W32/Sodinokibi.5421!tr.ransom"",""W32/Sodinokibi.8859!tr.ransom"") ) |
| Azure Automation Account Created | Security | Identifies when an Azure Automation account is created. Azure Automation accounts can be used to automate management tasks and orchestrate actions across systems. An adversary may create an Automation account in order to maintain persistence in their target's environment. | Azure Automation Account Created | eventType = ""MS_EvtHub_automation_automationaccounts_write"" |
| AWS SecHub: Tactics: Initial Access Detected | Security | AWS Security Hub detected initial access tactics. Adversary is trying to get into your network. | AWS SecHub: Tactics: Initial Access Detected | eventType = ""AWS-Hub-TTPs-Initial_Access"" |
| AWS Management Console Root Login | Security | Identifies a successful login to the AWS Management Console by the Root user. | AWS Management Console Root Login | eventType CONTAIN ""AWS-CloudTrail-SIGNIN-ConsoleLogin"" AND userType = ""Root"" |
| Outbreak: Kaseya REvil Suspicious File Hash Found on Host | Security | Malware hash known to be associated with REvil Ransomware activity detected by Fortinet Products on host. These indicators were seen during the Kaseya VSA Supply Chain Attack. | Outbreak: Kaseya REvil Suspicious File Hash Found on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND hashMD5 IN (""939aae3cc456de8964cb182c75a5f8cc"",""561cffbaba71a6e8cc1cdceda990ead4"",""a47cf00aedf769d60d58bfe00c0b5421"",""7ea501911850a077cf0f9fe6a7518859"",""0299e3c2536543885860c7b61e1efc3f"",""835f242dde220cc76ee5544119562268"",""849fb558745e4089a8232312594b21d2"",""561cffbaba71a6e8cc1cdceda990ead4"",""4a91cb0705539e1d09108c60f991ffcf"",""7d1807850275485397ce2bb218eff159"",""8535397007ecb56d666b666c3592c26d"",""5a97a50e45e64db41049fd88a75f2dd2"",""040818b1b3c9b1bf8245f5bcb4eebbbc"",""be6c46239e9c753de227bf1f3428e271"",""a560890b8af60b9824c73be74ef24a46"",""a47cf00aedf769d60d58bfe00c0b5421"",""18786bfac1be0ddf23ff94c029ca4d63"") OR hashSHA1 IN (""3c2b0dcdb2a46fc1ec0a12a54309e35621caa925"",""656c4d285ea518d90c1b669b79af475db31e30b1"",""c2bb3eef783c18d9825134dc8b6e9cc261d4cca7"",""e1d689bf92ff338752b8ae5a2e8d75586ad2b67b"",""682389250d914b95d6c23ab29dffee11cb65cae9"",""8118474606a68c03581eef85a05a90275aa1ec24"",""1bcf1ae39b898aaa8b6b0207d7e307b234614ff6"",""5162f14d75e96edb914d1756349d6e11583db0b0"",""7895e4d017c3ed5edb9bf92c156316b4990361eb"",""45c1b556f5a875b71f2286e1ed4c7bd32e705758"",""0912b7cecfbe82d6903a8a0dc421c285480e5caa"",""20e3a0955baca4dc7f1f36d3b865e632474add77"",""c0f569fc22cb5dd8e02e44f85168b4b72a6669c3"",""13d57aba8df4c95185c1a6d2f945d65795ee825b"") OR hashSHA256 IN (""589C8E3CF270FB6AEE9BAD137A20C733F77A3AE190E8DDE29680878FFA07B824"",""45AEBD60E3C4ED8D3285907F5BF6C71B3B60A9BCB7C34E246C20410CF678FC0C"",""36a71c6ac77db619e18f701be47d79306459ff1550b0c92da47b8c46e2ec0752"",""e2a24ab94f865caeacdf2c3ad015f31f23008ac6db8312c2cbfb32e4a5466ea2"",""df2d6ef0450660aaae62c429610b964949812df2da1c57646fc29aa51c3f031e"",""dc6b0e8c1e9c113f0364e1c8370060dee3fcbe25b667ddeca7623a95cd21411f"",""d8353cfc5e696d3ae402c7c70565c1e7f31e49bcf74a6e12e5ab044f306b4b20"",""d55f983c994caa160ec63a59f6b4250fe67fb3e8c43a388aec60a4a6978e9f1e"",""d5ce6f36a06b0dc8ce8e7e2c9a53e66094c2adfc93cfac61dd09efe9ac45a75f"",""cc0cdc6a3d843e22c98170713abf1d6ae06e8b5e34ed06ac3159adafe85e3bd6"",""aae6e388e774180bc3eb96dad5d5bfefd63d0eb7124d68b6991701936801f1c7"",""66490c59cb9630b53fa3fa7125b5c9511afde38edab4459065938c1974229ca8"",""0496ca57e387b10dfdac809de8a4e039f68e8d66535d5d19ec76d39f7d0a4402"",""81d0c71f8b282076cd93fb6bb5bfd3932422d033109e2c92572fc49e4abc2471"",""8e846ed965bbc0270a6f58c5818e039ef2fb78def4d2bf82348ca786ea0cea4f"",""8dd620d9aeb35960bb766458c8890ede987c33d239cf730f93fe49d90ae759dd"",""1fe9b489c25bb23b04d9996e8107671edee69bd6f6def2fe7ece38a0fb35f98e"") |
| Rogue or Unsecure AP Detected | Security | Detects a rogue or unsecure AP association attempt | Rogue or Unsecure AP Detected | eventType IN (""Aruba-1053-wlsxUnsecureAPDetected"",""Aruba-1150-wlsxSuspectUnsecureAPDetected"", ""Aruba-1103-wlsxStaAssociatedToUnsecureAP"",""Cisco-WLC-36-bsnRogueAPDetected"", ""Cisco-WLC-59-bsnRogueAPDetectedOnWiredNetwork"", ""SonicOS-546"") |
| Excessive Rogue or Unsecure APs Detected | Security | Detects an excessive number of rogue or unsecure AP association attempts | Excessive Rogue or Unsecure APs Detected | eventType IN (""Cisco-WLC-50-bsnApMaxRogueCountExceeded"") |
| User Added as Owner for Azure Service Principal | Security | Identifies when a user is added as an owner for an Azure service principal. The service principal object defines what the application can do in the specific tenant, who can access the application, and what resources the app can access. A service principal object is created when an application is given permission to access resources in a tenant. An adversary may add a user account as an owner for a service principal and use that account in order to define what an application can do in the Azure AD tenant. | User Added as Owner for Azure Service Principal | eventType = ""MS_EvtHub_add_owner_to_service_principal"" |
| Windows: HTML Help HH.EXE Suspicious Child Process | Security | Detects a suspicious child process of a Microsoft HTML Help (HH.exe). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hh_html_help_susp_child_process.yml | Windows: HTML Help HH.EXE Suspicious Child Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\hh\.exe"" AND procName REGEXP "".*\\CertReq\.exe|.*\\CertUtil\.exe|.*\\MSHTA\.EXE|.*\\MSbuild\.exe|.*\\cmd\.exe|.*\\cscript\.exe|.*\\installutil\.exe|.*\\msiexec\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\schtasks\.exe|.*\\wmic\.exe|.*\\wscript\.exe"" |
| Azure Event Hub Authorization Rule Created or Updated | Security | Identifies Event Hub Authorization Rule creation or update in Azure. An authorization rule is associated with specific rights, and carries a pair of cryptographic keys. When you create an Event Hubs namespace, a policy rule named RootManageSharedAccessKey is created for the namespace. This has manage permissions for the entire namespace and it's recommended that you treat this rule like an administrative root account and don't use it in your application. | Azure Event Hub Authorization Rule Created or Updated | eventType = ""MS_EvtHub_eventhub_namespaces_authorizationrules_write"" |
| Sudden Increase in Failed Logons To A Host | Security | Detects a sudden 50% increase of failed logons to a specific host over a 30 minute window | Sudden Increase in Failed Logons To A Host | eventType IN (Group@PH_SYS_EVENT_HostLogonFailure) |
| Default password usage | Security | Detects use of default password on a destination host | Default password usage | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_DefaultPwd) |
| Outbreak: Windows HTTP Protocol Stack RCE Detected on Host | Security | A Fortinet product has detected an exploit related to CVE-2022-21907 on a host | Outbreak: Windows HTTP Protocol Stack RCE Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId = 70134 |
| Windows: ISO Image Mount | Security | Detects the mount of ISO images on an endpoint. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_iso_mount.yml | Windows: ISO Image Mount | (eventType=""Win-Security-4663"" AND serverName=""Security"" AND osObjType=""File"" AND osObjName REGEXP ""\\Device\\CdRom.*"") AND (osObjName!=""\\Device\\CdRom0\\setup.exe"") |
| Suspicious Database Logon | Security | Detects suspicious database logon - success or failure. This includes multiple login failures, privileged logins, brute force successful logins | Suspicious Database Logon | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_MultipleDBLogonFailure, Group@PH_SYS_EVENT_SuspiciousDBLogonAttempt) |
| Windows: External Disk Drive or USB Storage Device | Security | Detects external diskdrives or plugged in USB devices , EventID 6416 on windows 10 or later. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_external_device.yml | Windows: External Disk Drive or USB Storage Device | (eventType=""Win-Security-6416"" AND deviceType=""DiskDrive"") OR description=""USB Mass Storage Device"" |
| Windows: Arbitrary Shell Command Execution Via Settingcontent-Ms | Security | The .SettingContent-ms file type was introduced in Windows 10 and allows a user to create ""shortcuts"" to various Windows 10 setting pages. These files are simply XML and contain paths to various Windows 10 settings binaries. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_arbitrary_shell_execution_via_settingcontent.yml | Windows: Arbitrary Shell Command Execution Via Settingcontent-Ms | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\.SettingContent-ms.*"" AND (command NOT REGEXP "".*immersivecontrolpanel.*"") |
| Outbreak: X.509 Email Address Buffer Overflow in OpenSSL 3.0.0 to 3.0.6 detected on Host | Security | OpenSSL vulnerability detected (CVE-2022-3602,CVE-2022-3786) on host | Outbreak: X.509 Email Address Buffer Overflow in OpenSSL 3.0.0 to 3.0.6 detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId IN (73646,73657,73689,73674,73761,73760,73645,73658,4566) |
| Windows: External Remote RDP Logon from Public IP | Security | Detects successful logon from public IP address via RDP. This can indicate a publicly-exposed RDP port. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_successful_external_remote_rdp_login.yml | Windows: External Remote RDP Logon from Public IP | eventType=""Win-Security-4624"" AND winLogonType=10 AND srcIpAddr!=::1 AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Sudden Increase in Successful Logons To A Host | Security | Detects a sudden 50% increase of successful logons to a host over a 30 minute window | Sudden Increase in Successful Logons To A Host | eventType IN (Group@PH_SYS_EVENT_HostLogonSuccess) |
| Windows: Execution in Outlook Temp Folder | Security | Detects a suspicious program execution in Outlook temp folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_outlook_execution_from_temp.yml | Windows: Execution in Outlook Temp Folder | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\Temporary Internet Files\\Content\.Outlook\\.*"" |
| Windows: Addition of Domain Trusts | Security | Addition of domains is seldom and should be verified for legitimacy. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_add_domain_trust.yml | Windows: Addition of Domain Trusts | eventType=""Win-Security-4706"" |
| Windows: ISO File Created Within Temp Folders | Security | Detects the creation of a ISO file in the Outlook temp folder or in the Appdata temp folder. Typical of Qakbot TTP from end-July 2022. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_iso_file_mount.yml | Windows: ISO File Created Within Temp Folders | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\.iso"" AND ((fileName REGEXP "".*\\AppData\\Local\\Temp\\.*"" AND fileName REGEXP "".*\.zip\\.*"") OR fileName REGEXP "".*\\AppData\\Local\\Microsoft\\Windows\\INetCache\\Content\.Outlook\\.*"") |
| Outbreak: X.509 Email Address Buffer Overflow in OpenSSL 3.0.0 to 3.0.6 detected on Network | Security | OpenSSL vulnerability detected (CVE-2022-3602,CVE-2022-3786) on network | Outbreak: X.509 Email Address Buffer Overflow in OpenSSL 3.0.0 to 3.0.6 detected on Network | eventType IN (""FortiGate-ips-signature-52286"",""FortiGate-ips-signature-52291"",""FortiProxy-ips-signature-52286"",""FortiProxy-ips-signature-52291"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Windows HTTP Protocol Stack RCE Detected on Network | Security | A Fortinet product has detected an exploit related to CVE-2022-21907 on network | Outbreak: Windows HTTP Protocol Stack RCE Detected on Network | eventType IN (""FortiGate-ips-signature-51127"",""FortiProxy-ips-signature-51127"") |
| Azure External Guest User Invitation | Security | Identifies an invitation to an external user in Azure Active Directory (AD). Azure AD is extended to include collaboration, allowing you to invite people from outside your organization to be guest users in your cloud account. Unless there is a business need to provision guest access, it is best practice avoid creating guest users. Guest users could potentially be overlooked indefinitely leading to a potential vulnerability. | Azure External Guest User Invitation | eventType = ""MS_EvtHub_invite_external_user"" AND srcName = ""guest"" |
| Outbreak: Kaseya REvil Suspicious File Hash Found on Network | Security | Malware hash known to be associated with REvil Ransomware activity detected by Fortinet Products on network. These indicators were seen during the Kaseya VSA Supply Chain Attack. | Outbreak: Kaseya REvil Suspicious File Hash Found on Network | eventType IN (Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ( hashMD5 IN (""939aae3cc456de8964cb182c75a5f8cc"",""561cffbaba71a6e8cc1cdceda990ead4"",""a47cf00aedf769d60d58bfe00c0b5421"",""7ea501911850a077cf0f9fe6a7518859"",""0299e3c2536543885860c7b61e1efc3f"",""835f242dde220cc76ee5544119562268"",""849fb558745e4089a8232312594b21d2"",""561cffbaba71a6e8cc1cdceda990ead4"",""4a91cb0705539e1d09108c60f991ffcf"",""7d1807850275485397ce2bb218eff159"",""8535397007ecb56d666b666c3592c26d"",""5a97a50e45e64db41049fd88a75f2dd2"",""040818b1b3c9b1bf8245f5bcb4eebbbc"",""be6c46239e9c753de227bf1f3428e271"",""a560890b8af60b9824c73be74ef24a46"",""a47cf00aedf769d60d58bfe00c0b5421"",""18786bfac1be0ddf23ff94c029ca4d63"") OR hashSHA1 IN (""3c2b0dcdb2a46fc1ec0a12a54309e35621caa925"",""656c4d285ea518d90c1b669b79af475db31e30b1"",""c2bb3eef783c18d9825134dc8b6e9cc261d4cca7"",""e1d689bf92ff338752b8ae5a2e8d75586ad2b67b"",""682389250d914b95d6c23ab29dffee11cb65cae9"",""8118474606a68c03581eef85a05a90275aa1ec24"",""1bcf1ae39b898aaa8b6b0207d7e307b234614ff6"",""5162f14d75e96edb914d1756349d6e11583db0b0"",""7895e4d017c3ed5edb9bf92c156316b4990361eb"",""45c1b556f5a875b71f2286e1ed4c7bd32e705758"",""0912b7cecfbe82d6903a8a0dc421c285480e5caa"",""20e3a0955baca4dc7f1f36d3b865e632474add77"",""c0f569fc22cb5dd8e02e44f85168b4b72a6669c3"",""13d57aba8df4c95185c1a6d2f945d65795ee825b"") OR hashSHA256 IN (""589C8E3CF270FB6AEE9BAD137A20C733F77A3AE190E8DDE29680878FFA07B824"",""45AEBD60E3C4ED8D3285907F5BF6C71B3B60A9BCB7C34E246C20410CF678FC0C"",""36a71c6ac77db619e18f701be47d79306459ff1550b0c92da47b8c46e2ec0752"",""e2a24ab94f865caeacdf2c3ad015f31f23008ac6db8312c2cbfb32e4a5466ea2"",""df2d6ef0450660aaae62c429610b964949812df2da1c57646fc29aa51c3f031e"",""dc6b0e8c1e9c113f0364e1c8370060dee3fcbe25b667ddeca7623a95cd21411f"",""d8353cfc5e696d3ae402c7c70565c1e7f31e49bcf74a6e12e5ab044f306b4b20"",""d55f983c994caa160ec63a59f6b4250fe67fb3e8c43a388aec60a4a6978e9f1e"",""d5ce6f36a06b0dc8ce8e7e2c9a53e66094c2adfc93cfac61dd09efe9ac45a75f"",""cc0cdc6a3d843e22c98170713abf1d6ae06e8b5e34ed06ac3159adafe85e3bd6"",""aae6e388e774180bc3eb96dad5d5bfefd63d0eb7124d68b6991701936801f1c7"",""66490c59cb9630b53fa3fa7125b5c9511afde38edab4459065938c1974229ca8"",""0496ca57e387b10dfdac809de8a4e039f68e8d66535d5d19ec76d39f7d0a4402"",""81d0c71f8b282076cd93fb6bb5bfd3932422d033109e2c92572fc49e4abc2471"",""8e846ed965bbc0270a6f58c5818e039ef2fb78def4d2bf82348ca786ea0cea4f"",""8dd620d9aeb35960bb766458c8890ede987c33d239cf730f93fe49d90ae759dd"",""1fe9b489c25bb23b04d9996e8107671edee69bd6f6def2fe7ece38a0fb35f98e"")) |
| Outbreak: Kaseya REvil Ransomware File Activity Detected on Host | Security | A Fortinet product has detected a host with malware known to be associated with REvil Ransomware activity. These indicators were seen during the Kaseya VSA Supply Chain Attack. | Outbreak: Kaseya REvil Ransomware File Activity Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND ( virusName IN (""W32/Sodinokibi.8859!tr.ransom"",""W32/Sodinokibi.5421!tr.ransom"",""W32/Sodinokibi.EAD4!tr.ransom"") OR attackName IN (""W32/Sodinokibi.8859!tr.ransom"",""W32/Sodinokibi.5421!tr.ransom"",""W32/Sodinokibi.EAD4!tr.ransom"")) |
| User Added as Owner for Azure Application | Security | Identifies when a user is added as an owner for an Azure application. An adversary may add a user account as an owner for an Azure application in order to grant additional permissions and modify the application's configuration using another account. | User Added as Owner for Azure Application | eventType = ""MS_EvtHub_add_owner_to_application"" |
| AWS Root Login Without MFA | Security | Identifies attempts to login to AWS as the root user without using multi-factor authentication (MFA). Amazon AWS best practices indicate that the root user should be protected by MFA. | AWS Root Login Without MFA | eventType CONTAIN ""AWS-CloudTrail-SIGNIN-ConsoleLogin"" AND userType = ""Root"" |
| Azure Blob Container Access Level Modification | Security | Identifies changes to container access levels in Azure. Anonymous public read access to containers and blobs in Azure is a way to share data broadly, but can present a security risk if access to sensitive data is not managed judiciously. | Azure Blob Container Access Level Modification | eventType = ""MS_EvtHub_storage_storageaccounts_blobservices_containers_write"" |
| Windows: Unusual Child Process of dns.exe | Security | Detects an unexpected process spawning from dns.exe which may indicate activity related to remote code execution or other forms of exploitation as seen in CVE-2020-1350 (SigRed). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dns_susp_child_process.yml | Windows: Unusual Child Process of dns.exe | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\dns\.exe"" AND (procName NOT REGEXP "".*\\conhost\.exe"") |
| Windows: Office Macro File Download | Security | Detects the creation of a new office macro files on the systems via an application (browser, mail client). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_macro_files_downloaded.yml | Windows: Office Macro File Download | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\MicrosoftEdge\.exe|.*\\RuntimeBroker\.exe|.*\\brave\.exe|.*\\chrome\.exe|.*\\firefox\.exe|.*\\iexplore\.exe|.*\\maxthon\.exe|.*\\msedge\.exe|.*\\msedgewebview2\.exe|.*\\opera\.exe|.*\\outlook\.exe|.*\\safari\.exe|.*\\seamonkey\.exe|.*\\thunderbird\.exe|.*\\vivaldi\.exe|.*\\whale\.exe"" AND (fileName REGEXP "".*\.docm|.*\.dotm|.*\.potm|.*\.pptm|.*\.xlsm|.*\.xltm"" OR fileName REGEXP "".*\.docm:Zone.*|.*\.dotm:Zone.*|.*\.potm:Zone.*|.*\.pptm:Zone.*|.*\.xlsm:Zone.*|.*\.xltm:Zone.*"") |
| Windows: Suspicious Processes Spawned by WinRM | Security | Detects suspicious processes including shells spawnd from WinRM host process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_winrm_susp_child_process.yml | Windows: Suspicious Processes Spawned by WinRM | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\wsmprovhost\.exe"" AND procName REGEXP "".*\\bash\.exe|.*\\bitsadmin\.exe|.*\\certutil\.exe|.*\\cmd\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\schtasks\.exe|.*\\sh\.exe|.*\\whoami\.exe|.*\\wsl\.exe"" |
| ICS Alert: Drive-by Compromise | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0817 - Drive-by Compromise. Adversaries may gain access to a system during a drive-by compromise, when a user visits a compromised website as part of a regular browsing session. | ICS Alert: Drive-by Compromise | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0817(,T\d+)*$"" |
| Network Intf Error Warning | Performance | Detects that a network device interface error has reached a warning level (utilization between 1% and 5% based on 2 successive readings in a 10 minute interval | Network Intf Error Warning | eventType = ""PH_DEV_MON_NET_INTF_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Exposed Service Detected on Host | Security | A system has reported an exposed service such as a database, administrative, remote access, or unsecured protocol in use and visible from any source. | Exposed Service Detected on Host | eventType IN (Group@PH_SYS_EVENT_ExposedService) |
| ICS Alert: Exploit Public-Facing Application | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0819 - Exploit Public-Facing Application. Adversaries may leverage weaknesses to exploit internet-facing software for initial access into an industrial network. | ICS Alert: Exploit Public-Facing Application | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0819(,T\d+)*$"" |
| Windows: Office Macro File Creation From Suspicious Process | Security | Detects the creation of a office macro file from a a suspicious process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_macro_files_from_susp_process.yml | Windows: Office Macro File Creation From Suspicious Process | eventType=""Win-Sysmon-11-FileCreate"" AND (procName REGEXP "".*\\cscript\.exe|.*\\mshta\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wscript\.exe"" OR parentProcName REGEXP "".*\\cscript\.exe|.*\\mshta\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wscript\.exe"") AND fileName REGEXP "".*\.docm|.*\.dotm|.*\.potm|.*\.pptm|.*\.xlsm|.*\.xltm"" |
| Cisco AVC: P2P Applications that exceed interface utilization | Performance | Detects P2P applications that exceed interface utilization as reported by Cisco AVC. | Cisco AVC: P2P Applications that exceed interface utilization | (eventType = ""IOS-AVC-NETFLOW"" OR eventType = ""Cisco-WLC-AVC-NETFLOW"") AND nbarP2PFlag = 1 AND (inIntfUtil > 10 OR outIntfUtil > 10) |
| FortiDeceptor: Successful SAMBA Operations to Decoy | Security | Detects successful SAMBA Operations to a FortiDeceptor decoy. | FortiDeceptor: Successful SAMBA Operations to Decoy | eventType CONTAIN ""FortiDeceptor-"" AND serviceName CONTAIN ""SAMBA"" |
| Windows: Remote Access Tool - ScreenConnect Suspicious Execution | Security | Detects ScreenConnect program starts that establish a remote access to that system (not meeting, not remote support). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_access.yml | Windows: Remote Access Tool - ScreenConnect Suspicious Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*e=Access&.*"" AND command REGEXP "".*y=Guest&.*"" AND command REGEXP "".*&p=.*"" AND command REGEXP "".*&c=.*"" AND command REGEXP "".*&k=.*"" |
| Network Intf Error Critical | Performance | Detects that a network device interface errors has reached a critical level (greater than 5% based on 2 successive readings in a 10 minute interval | Network Intf Error Critical | eventType = ""PH_DEV_MON_NET_INTF_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Windows: Windows Registry Trust Record Modification | Security | Alerts on trust record modification within the registry, indicating usage of macros. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_trust_record_modification.yml | Windows: Windows Registry Trust Record Modification | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*TrustRecords.*"" |
| ICS Alert: Supply Chain Compromise | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0862 - Supply Chain Compromise. Adversaries may perform supply chain compromise to gain control systems environment access by means of infected products, software, and workflows. | ICS Alert: Supply Chain Compromise | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0862(,T\d+)*$"" |
| FortiDeceptor: Successful FTP/TFTP Operations to Decoy | Security | Detects successful FTP/TFTP Operations to a FortiDeceptor decoy. | FortiDeceptor: Successful FTP/TFTP Operations to Decoy | eventType CONTAIN ""FortiDeceptor-"" AND ((opName CONTAIN ""TFTP"") OR (opName CONTAIN ""FTP"")) |
| FortiDeceptor: Successful RDP Login to Decoy | Security | Detects successful RDP logins to a FortiDeceptor decoy. | FortiDeceptor: Successful RDP Login to Decoy | eventType = ""FortiDeceptor-Logon_via_Remote_Desktop"" |
| ICS Alert: Transient Cyber Asset | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0864 - Transient Cyber Asset. Adversaries may target devices that are transient across ICS networks and external networks. Transient assets are brought into an environment by authorized personnel and do not remain in that environment on a permanent basis. | ICS Alert: Transient Cyber Asset | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0864(,T\d+)*$"" |
| Windows: Suspicious Microsoft OneNote Child Process | Security | Detects suspicious child processes of the Microsoft OneNote application. This may indicate an attempt to execute malicious embedded objects from a .one file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_onenote_susp_child_processes.yml | Windows: Suspicious Microsoft OneNote Child Process | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\onenote\.exe"" AND ((srcFileName IN (""CMSTP.EXE"",""CertOC.exe"",""CertUtil.exe"",""Cmd.Exe"",""HH.exe"",""IEExec.exe"",""InstallUtil.exe"",""MSHTA.EXE"",""Microsoft.Workflow.Compiler.exe"",""Msxsl.exe"",""PowerShell.EXE"",""REGSVR32.exe"",""RUNDLL32.exe"",""RegAsm.exe"",""RegSvcs.exe"",""ScriptRunner.exe"",""WorkFolders.exe"",""bitsadmin.exe"",""cscript.exe"",""curl.exe"",""javaw.exe"",""msdt.exe"",""msiexec.exe"",""odbcconf.exe"",""pcalua.exe"",""schtasks.exe"",""wmic.exe"",""wscript.exe"") OR procName REGEXP "".*\\AppVLP\.exe|.*\\Microsoft\.Workflow\.Compiler\.exe|.*\\bash\.exe|.*\\bitsadmin\.exe|.*\\certoc\.exe|.*\\certutil\.exe|.*\\cmd\.exe|.*\\cmstp\.exe|.*\\control\.exe|.*\\cscript\.exe|.*\\curl\.exe|.*\\forfiles\.exe|.*\\hh\.exe|.*\\ieexec\.exe|.*\\installutil\.exe|.*\\javaw\.exe|.*\\mftrace\.exe|.*\\msbuild\.exe|.*\\msdt\.exe|.*\\mshta\.exe|.*\\msidb\.exe|.*\\msiexec\.exe|.*\\msxsl\.exe|.*\\odbcconf\.exe|.*\\pcalua\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regasm\.exe|.*\\regsvcs\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\schtasks\.exe|.*\\scrcons\.exe|.*\\scriptrunner\.exe|.*\\sh\.exe|.*\\svchost\.exe|.*\\verclsid\.exe|.*\\wmic\.exe|.*\\workfolders\.exe|.*\\wscript\.exe"") OR (procName REGEXP "".*\\explorer\.exe"" AND command REGEXP "".*\.bat.*|.*\.cmd.*|.*\.hta.*|.*\.js.*|.*\.pif.*|.*\.ps.*|.*\.scr.*|.*\.vb.*|.*\.wsh.*"") OR procName REGEXP "".*\\AppData\\.*|.*\\ProgramData\\.*|.*\\Users\\Public\\.*|.*\\Windows\\System32\\Tasks\\.*|.*\\Windows\\Tasks\\.*|.*\\Windows\\Temp\\.*"")) AND ((procName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams\\current\\Teams\.exe"" OR command NOT REGEXP "".*-Embedding"") AND (procName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\OneDrive\\.*"" OR procName NOT REGEXP "".*\\FileCoAuth\.exe"" OR command NOT REGEXP "".*-Embedding"")) |
| ICS Alert: Wireless Compromise | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0860 - Wireless Compromise. Adversaries may perform wireless compromise as a method of gaining communications and unauthorized access to a wireless network. | ICS Alert: Wireless Compromise | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0860(,T\d+)*$"" |
| Windows: Octopus Scanner Malware Detected | Security | Detects Octopus Scanner Malware. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_mal_octopus_scanner.yml | Windows: Octopus Scanner Malware Detected | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\AppData\\Local\\Microsoft\\Cache134\.dat|.*\\AppData\\Local\\Microsoft\\ExplorerSync\.db"" |
| ICS Alert: Rogue Master | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0848 - Rogue Master. Adversaries may setup a rogue master to leverage control server functions to communicate with outstations. A rogue master can be used to send legitimate control messages to other control system devices, affecting processes in unintended ways. | ICS Alert: Rogue Master | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0848(,T\d+)*$"" |
| ICS Alert: Internet Accessible Device | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0883 - Internet Accessible Device. Adversaries may gain access into industrial environments through systems exposed directly to the internet for remote access rather than through External Remote Services. | ICS Alert: Internet Accessible Device | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0883(,T\d+)*$"" |
| Sudden Increase in Network Interface Errors | Performance | Detects anomaly in interface errors seen on a router/switch port. Over a 30 minute window, either the total inbound or outbound interface errored packets or discarded packets is more than 2 standard deviations away from the mean. To detect significant issues, the average packet error or discarded packet error is more than 1 percent. | Sudden Increase in Network Interface Errors | eventType IN (""PH_DEV_MON_NET_INTF_UTIL"",""PH_DEV_MON_FORTIGATE_INTF_UTIL"",""PH_DEV_MON_FORTIAP_INTF_UTIL"") |
| Windows: Suspicious HH.EXE Execution | Security | Detects a suspicious execution of a Microsoft HTML Help (HH.exe). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hh_susp_execution.yml | Windows: Suspicious HH.EXE Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""HH.exe"" OR procName REGEXP "".*\\hh\.exe"") AND command REGEXP "".*\.application.*|.*\\AppData\\Local\\Temp\\.*|.*\\Content\.Outlook\\.*|.*\\Downloads\\.*|.*\\Users\\Public\\.*|.*\\Windows\\Temp\\.*"" |
| Windows: Office Macro File Creation | Security | Detects the creation of a new office macro files on the systems. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_macro_files_created.yml | Windows: Office Macro File Creation | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\.docm|.*\.dotm|.*\.potm|.*\.pptm|.*\.xlsm|.*\.xltm"" |
| Windows: LPE InstallerFileTakeOver PoC CVE-2021-41379 | Security | Detects PoC tool used to exploit LPE vulnerability CVE-2021-41379. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/msiinstaller/win_vul_cve_2021_41379.yml | Windows: LPE InstallerFileTakeOver PoC CVE-2021-41379 | eventType=""Win-App-MsiInstaller-1033"" AND lineContent REGEXP "".*test pkg.*"" |
| FortiDeceptor: Successful IOT SCADA Operations to Decoy | Security | Detects successful IOT SCADA, Modbus and S7 Operations to a FortiDeceptor decoy. | FortiDeceptor: Successful IOT SCADA Operations to Decoy | eventType CONTAIN ""FortiDeceptor-"" AND ((serviceName CONTAIN ""MODBUS"") OR (serviceName CONTAIN ""Bacnet"") OR (opName CONTAIN ""S7"")) |
| ICS Alert: External Remote Services | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0822 - External Remote Services. Adversaries may leverage external remote services as a point of initial access into your network. These services allow users to connect to internal network resources from external locations. | ICS Alert: External Remote Services | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0822(,T\d+)*$"" |
| FortiGate ICS Alert: Exploitation of Remote Services | Security | A FortiGate product has detected an event containing MITRE ICS Technique ID T0866 - Exploitation of Remote Services. Adversaries may exploit a software vulnerability to take advantage of a programming error in a program, service, or within the operating system software or kernel itself to enable remote service abuse. | FortiGate ICS Alert: Exploitation of Remote Services | eventType IN (""FortiGate-ips-signature-50485"",""FortiGate-ips-signature-50490"",""FortiGate-ips-signature-50512"",""FortiGate-ips-signature-50513"",""FortiGate-ips-signature-50514"",""FortiGate-ips-signature-50515"") |
| ICS Alert: Spearphishing Attachment | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0865 - Spearphishing Attachment. Adversaries may use a spearphishing attachment, a variant of spearphishing, as a form of a social engineering attack against specific targets. | ICS Alert: Spearphishing Attachment | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0865(,T\d+)*$"" |
| FortiDeceptor: Successful SSH Login to Decoy | Security | Detects successful SSH logins to a FortiDeceptor decoy. | FortiDeceptor: Successful SSH Login to Decoy | eventType = ""FortiDeceptor-Established_SSH_connection"" |
| ICS Alert: Replication Through Removable Media | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0847 - Replication Through Removable Media. Adversaries may move onto systems, such as those separated from the enterprise network, by copying malware to removable media which is inserted into the control systems environment. | ICS Alert: Replication Through Removable Media | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0847(,T\d+)*$"" |
| Windows: Suspicious HWP Sub Processes | Security | Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hwp_exploits.yml | Windows: Suspicious HWP Sub Processes | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\Hwp\.exe"" AND procName REGEXP "".*\\gbb\.exe"" |
| Windows: Suspicious Double Extension File Execution | Security | Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe, a set of spaces or underlines to cloak the executable file in spear phishing campaigns. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_double_extension.yml | Windows: Suspicious Double Extension File Execution | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".* \.exe|.*\.doc\.exe|.*\.doc\.js|.*\.docx\.exe|.*\.docx\.js|.*\.pdf\.exe|.*\.pdf\.js|.*\.ppt\.exe|.*\.ppt\.js|.*\.pptx\.exe|.*\.pptx\.js|.*\.rtf\.exe|.*\.rtf\.js|.*\.txt\.exe|.*\.txt\.js|.*\.xls\.exe|.*\.xls\.js|.*\.xlsx\.exe|.*\.xlsx\.js|.*______\.exe"" AND command REGEXP "".* \.exe.*|.*\.doc\.exe.*|.*\.doc\.js.*|.*\.docx\.exe.*|.*\.docx\.js.*|.*\.pdf\.exe.*|.*\.pdf\.js.*|.*\.ppt\.exe.*|.*\.ppt\.js.*|.*\.pptx\.exe.*|.*\.pptx\.js.*|.*\.rtf\.exe.*|.*\.rtf\.js.*|.*\.txt\.exe.*|.*\.txt\.js.*|.*\.xls\.exe.*|.*\.xls\.js.*|.*\.xlsx\.exe.*|.*\.xlsx\.js.*|.*______\.exe.*"" |
| AWS SecHub: Tactics: Lateral Movement Detected | Security | AWS Security Hub detected Lateral Movement tactics. Adversary is trying to move through your environment. | AWS SecHub: Tactics: Lateral Movement Detected | eventType = ""AWS-Hub-TTPs-Lateral_Movement"" |
| FortiRecon: Certificate Issue Found for an Asset | Security | FortiRecon External Attack Surface Mgmt: certificate issue found for an asset. | FortiRecon: Certificate Issue Found for an Asset | eventType = ""FortiRecon-easm-certificate_issues"" |
| Outbreak: 3CX Supply Chain Attack Detected on Host | Security | This indicates that 3CX DesktopApp Supply Chain Backdoor traffic was detected in the host. Related to CVE-2023-29059.
3CX DesktopApp is a popular video conference desktop client. Details: https://www.3cx.com/blog/news/desktopapp-security-alert/ | Outbreak: 3CX Supply Chain Attack Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND virusName = ""Riskware/Sphone_XC3"" |
| Outbreak: Agent Tesla Malware Attack Detected on Network | Security | Agent Tesla Malware Attack detected (CVE-2018-0802,CVE-2017-11882) on network. Details: https://www.fortiguard.com/outbreak-alert/agent-tesla-malware-attack | Outbreak: Agent Tesla Malware Attack Detected on Network | eventType IN (""FortiGate-ips-signature-44947"",""FortiProxy-ips-signature-44947"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (44947,10150614,10150615,10147887) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""Alert_Deny""))) |
| Outbreak: Apache RocketMQ RCE Vuln Detected on Network | Security | Apache RocketMQ Remote Command Execution Vulnerability detected (CVE-2023-33246) on network. Details: https://www.fortiguard.com/outbreak-alert/apache-rocketmq-rce | Outbreak: Apache RocketMQ RCE Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-53315"",""FortiProxy-ips-signature-53315"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Atlassian Confluence CVE-2022-26134 Vuln Detected on Network | Security | A Fortinet product has detected Atlassian Confluence (CVE-2022-26134) Vuln on network | Outbreak: Atlassian Confluence CVE-2022-26134 Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-51648"",""FortiProxy-ips-signature-51648"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: ABB Flow Computer Path Traversal Vulnerability Detected on Network | Security | Detects an attempt to exploit ABB Flow Computer and Remote Controller Vulnerability (CVE-2022-0902). A path traversal vulnerability exists in the implementation of the Totalflow TCP protocol in ABB G5 products. can allow unauthenticated users to gain access to restricted directories. Exploiting this vulnerability can lead to pre-authenticated remote code execution in root context. It can enable an attacker to take over flow computers and remotely disrupt the flow computers' ability to accurately measure oil and gas flow. | Outbreak: ABB Flow Computer Path Traversal Vulnerability Detected on Network | eventType IN (""FortiGate-ips-signature-52307"",""FortiProxy-ips-signature-52307"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| FortiRecon: High Severity Reputation Issue Found for an Asset | Security | FortiRecon External Attack Surface Mgmt: HIGH severity reputation issue found for an asset. | FortiRecon: High Severity Reputation issue found for an asset | eventType = ""FortiRecon-easm-reputation"" AND eventSeverityCat = ""HIGH"" |
| Outbreak: 3CX Supply Chain Attack Detected on Network | Security | This indicates that 3CX DesktopApp Supply Chain Backdoor traffic was detected in the network. Related to CVE-2023-29059.
3CX DesktopApp is a popular video conference desktop client. . Details: https://www.3cx.com/blog/news/desktopapp-security-alert/ | Outbreak: 3CX Supply Chain Attack Detected on Network | eventType IN (""FortiGate-ips-signature-52796"",""FortiProxy-ips-signature-52796"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (52796,10131498) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Cacti Server Command Injection Vulnerability Detected on Host | Security | Cacti server command injection vuln detected (CVE-2022-46169) on host. Details: https://www.fortiguard.com/outbreak-alert/cacti-command-injection | Outbreak: Cacti Server Command Injection Vulnerability Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId = 4603 |
| FortiDeceptor: IPS Attack to Decoy | Security | Detects IPS Attacks to a FortiDeceptor decoy from inside | FortiDeceptor: IPS Attack to Decoy | eventType = ""FortiDeceptor-IPS_attack"" AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Outbreak: Cacti Server Command Injection Attack Detected on Network | Security | Cacti server command injection attack detected (CVE-2022-46169) on network. Details: https://www.fortiguard.com/outbreak-alert/cacti-command-injection | Outbreak: Cacti Server Command Injection Attack Detected on Network | eventType IN (""FortiGate-ips-signature-52456"",""FortiProxy-ips-signature-52456"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Cisco IOS XE Web UI Attack Detected on Network | Security | Cisco IOS XE Web UI Attack detected (CVE-2023-20198,CVE-2023-20273) on network. Details: https://www.fortiguard.com/outbreak-alert/cisco-ios-xe-web-ui-vulnerability | Outbreak: Cisco IOS XE Web UI Attack Detected on Network | eventType IN (""FortiGate-ips-signature-54224"",""FortiProxy-ips-signature-54224"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""Alert_Deny""))) |
| FortiSandbox detects multiple attacks from same source | Security | FortiSandbox detects multiple attacks from the same source | FortiSandbox detects multiple attacks from same source | eventType IN (""FortiSandbox-NetAlert-Attack"", ""FortiSandbox-Malware-Detected"", ""FortiSandbox-NetAlert-URL"", ""FortiSandbox-NetAlert-Botnet"") |
| Outbreak: Atlassian Pre-Auth Arbitrary File Read Vuln detected on Host | Security | Atlassian Pre-Auth arbitrary file read vuln (CVE-2021-26085,CVE-2021-26086) detected on host | Outbreak: Atlassian Pre-Auth Arbitrary File Read Vuln detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId IN (71120,4610) |
| Outbreak: Apache Path Traversal Vuln Detected on Host | Security | Apache Path Traversal Vuln (CVE-2021-42013, CVE-2021-41773) detected on a host | Outbreak: Apache Path Traversal Vuln Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND (vulnId = 2711) |
| Log4J Exploit Request Detected on Network by Fortinet Products | Security | Log4J Exploit Request Detected on Network by Fortinet Product. IPS signature ID 51006 for Log4J CVE-2021-44228 seen by a Fortinet product. | Log4J Exploit Request Detected on Network by Fortinet Products | eventType IN (""FortiGate-ips-signature-51006"",""FortiProxy-ips-signature-51006"") AND (ipsSignatureId = 51006 OR attackName = ""Apache.Log4j.Error.Log.Remote.Code.Execution"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: FortiGate Authentication bypass on Aministrative Interface | Security | A FortiGate or FortiProxy network appliance reported a authentication bypass on an administrative interface. This is a detection for vulnerability (CVE-2022-40684). | Outbreak: FortiGate Authentication bypass on Aministrative Interface | ( eventType = ""FortiGate-event-admin-action"" OR eventType = ""FortiProxy-event-admin-action"" ) AND user = ""Local_Process_Access"" |
| Outbreak: CISA Top 20 Vulnerability detected on Host | Security | One of the CISA Top 20 most common vulnerabilities detected on host | Outbreak: CISA Top 20 Vulnerability detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId IN (69887,70935,4505,69885,4506,4507,69884,69888,2700,4387,66853,2710,4152,66854,66855,66856,2711) |
| Outbreak: CosmicEnergy Malware Detected on Network | Security | CosmicEnergy Malware detected on network. Details: https://www.fortiguard.com/outbreak-alert/cosmicenergy-malware | Outbreak: CosmicEnergy Malware Detected on Network | eventType IN (Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (10138907,10138908) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Adobe ColdFusion Deserialization of Untrusted Data Vuln Detected on Host | Security | Adobe ColdFusion Deserialization of Untrusted Data Vulnerabilities detected (CVE-2023-26359,CVE-2023-26360) on host. Details: https://www.fortiguard.com/outbreak-alert/adobe-coldfusion-code-execution | Outbreak: Adobe ColdFusion Deserialization of Untrusted Data Vuln Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND virusName = ""Riskware/Adntac"" |
| Outbreak: FortiGate detected CISA Top 20 Vulnerability on Network | Security | One of the CISA Top 20 most common vulnerabilities detected on network | Outbreak: FortiGate detected CISA Top 20 Vulnerability on Network | eventType IN (Group@PH_SYS_EVENT_TopCISA_CVE) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Linux: Remote Terminal Session Started | Security | Detects attempts to use Valid Accounts to log into a service specifically designed to accept remote connections. | Linux: Remote Terminal Session Started | eventType = ""LINUX_PROCESS_EXEC"" AND procName IN (""putty.exe"",""ssh"",""telnet.exe"") |
| Outbreak: Atlassian Confluence CVE-2022-26134 Vuln Detected on Host | Security | A Fortinet product has detected Atlassian Confluence (CVE-2022-26134) Vuln on a host | Outbreak: Atlassian Confluence CVE-2022-26134 Vuln Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND (vulnId = 4387) |
| Outbreak: Atlassian Pre-Auth Arbitrary File Read Vuln detected on Network | Security | Atlassian Pre-Auth arbitrary file read vuln (CVE-2021-26085,CVE-2021-26086) detected on network | Outbreak: Atlassian Pre-Auth Arbitrary File Read Vuln detected on Network | eventType IN (""FortiGate-ips-signature-50857"",""FortiProxy-ips-signature-50857"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Log4J Exploit Request Detected on Host by Fortinet Products | Security | Log4J Exploit Request Detected on Host by Fortinet Product. IPS signature ID 51006 for Log4J CVE-2021-44228 seen by a Fortinet product. | Log4J Exploit Request Detected on Host by Fortinet Products | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId = 4505 |
| FortiWeb: Permitted Inbound Attack Detected | Security | FortiWeb detected an inbound attack to your organization that was not blocked by FortiWeb. This rule triggers if the source IP is public, the firewall did not block, and Threat Level is one of Substantial, Severe, Critical or Attack Severity is High. | FortiWeb: Permitted Inbound Attack Detected | eventType CONTAIN ""FortiWeb-"" AND type=""attack"" AND fwAction IS NOT NULL AND fwAction NOT IN (""block"",""blocked"",""alert_deny"",""deny"",""drop"",""dropped"") AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND (threatLevel IN (""Substantial"",""Severe"",""Critical"") OR ipsSeverity = ""High"") |
| Outbreak: CosmicEnergy Malware Detected on Host | Security | CosmicEnergy Malware detected on host. Details: https://www.fortiguard.com/outbreak-alert/cosmicenergy-malware | Outbreak: CosmicEnergy Malware Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND virusName IN (""W32/Cosmic.DISR!tr"",""Python/Cosmic.DISR!tr"") |
| Outbreak: Apache Path Traversal Vuln Detected on Network | Security | Apache Path Traversal Vuln (CVE-2021-42013, CVE-2021-41773) detected on network | Outbreak: Apache Path Traversal Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-50825"",""FortiProxy-ips-signature-50825"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Adobe ColdFusion Deserialization of Untrusted Data Vuln Detected on Network | Security | Adobe ColdFusion Deserialization of Untrusted Data Vulnerabilities detected (CVE-2023-26359,CVE-2023-26360) on network. Details: https://www.fortiguard.com/outbreak-alert/adobe-coldfusion-code-execution | Outbreak: Adobe ColdFusion Deserialization of Untrusted Data Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-52899"",""FortiProxy-ips-signature-52899"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (52899,10150208) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""Alert_Deny""))) |
| Log4J Exploit Request Detected By Regex | Security | Log4J Exploit Request Detected by Regex. Regex Inspection of http user agent, referrer, cookie, content type, and cache control for Log4J CVE-2021-44228. | Log4J Exploit Request Detected By Regex | (( eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND destIpPort IN (80,443) ) OR eventType IN (Group@PH_SYS_EVENT_Exploit,Group@PH_SYS_EVENT_PermitWebTraffic) ) AND ( uriStem REGEXP ""(?:.*jndi.*|.*{env:[^:]+:-[jndi].*|.*\${::-\w+}.*|.*base64:.*|.*\${(?:lower|upper):\w+}.*)"" OR httpEndUri REGEXP ""(?:.*jndi.*|.*{env:[^:]+:-[jndi].*|.*\${::-\w+}.*|.*base64:.*|.*\${(?:lower|upper):\w+}.*)"" OR httpUserAgent REGEXP ""(?:.*jndi.*|.*{env:[^:]+:-[jndi].*|.*\${::-\w+}.*|.*base64:.*|.*\${(?:lower|upper):\w+}.*)"" OR httpReferrer REGEXP ""(?:.*jndi.*|.*{env:[^:]+:-[jndi].*|.*\${::-\w+}.*|.*base64:.*|.*\${(?:lower|upper):\w+}.*)"" OR httpCookie REGEXP ""(?:.*jndi.*|.*{env:[^:]+:-[jndi].*|.*\${::-\w+}.*|.*base64:.*|.*\${(?:lower|upper):\w+}.*)"" OR httpContentType REGEXP ""(?:.*jndi.*|.*{env:[^:]+:-[jndi].*|.*\${::-\w+}.*|.*base64:.*|.*\${(?:lower|upper):\w+}.*)"" OR httpHeaderCacheControl REGEXP ""(?:.*jndi.*|.*{env:[^:]+:-[jndi].*|.*\${::-\w+}.*|.*base64:.*|.*\${(?:lower|upper):\w+}.*)"" ) |
| Outbreak: Agent Tesla Malware Attack Detected on Host | Security | Agent Tesla Malware Attack detected (CVE-2018-0802,CVE-2017-11882) on host. Details: https://www.fortiguard.com/outbreak-alert/agent-tesla-malware-attack | Outbreak: Agent Tesla Malware Attack Detected on Host | eventType IN (""FortiClient-vulnerabilityscan-vulnerability-record"",Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND (vulnId IN (41650,41106) OR virusName IN (""MSExcel/CVE_2017_11882.EQMA!exploit"",""MSIL/AgentTesla.BEDA!tr"",""MSIL/Kryptik.AJHS!tr"")) |
| Lateral Movement Detected | Security | Detects excessive failed logins followed by unusual communication pattern for a user from a set of workstations to another set of workstations indicating lateral movement. | Lateral Movement Detected | eventType = ""PH_ANOMALY_LATERAL_MOVEMENT_DETECT"" |
| Outbreak: IBM Aspera Faspex Code Execution Vulnerability Detected on Host | Security | IBM Aspera Faspex Code Execution Vulnerability detected (CVE-2022-47986) on host. Details: https://www.ibm.com/support/pages/node/6952319 | Outbreak: IBM Aspera Faspex Code Execution Vulnerability Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId = 4795 |
| Outbreak: Microsoft Office and Windows HTML RCE Vuln Detected on Network | Security | Microsoft Office and Windows HTML RCE Vulnerability detected (CVE-2023-36884) on network. Details: https://www.fortiguard.com/outbreak-alert/microsoft-office-and-windows-html-attack | Outbreak: Microsoft Office and Windows HTML RCE Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-43872"",""FortiProxy-ips-signature-43872"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (43872,10134905,10145109,10145110,10145118,10145231,10145230) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: FortiWeb detected Zerobot Botnet Activity on Network | Security | Zerobot Botnet activity detected (CVE-2017-17105,CVE-2019-10655,CVE-2020-25223,CVE-2021-42013,CVE-2022-31137,CVE-2022-33891) on network | Outbreak: FortiWeb detected Zerobot Botnet Activity on Network | eventType = ""FortiWeb-20000010"" AND ipsSignatureId IN (1090490133,1050180008) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Hive Ransomware Detected on Network | Security | Hive Ransomware detected (CVE-2021-31207,CVE-2021-34473,CVE-2021-34523,CVE-2021-42321) on network | Outbreak: Hive Ransomware Detected on Network | eventType IN (""FortiGate-ips-signature-50738"",""FortiGate-ips-signature-50584"",""FortiGate-ips-signature-50695"",""FortiGate-ips-signature-50945"",""FortiProxy-ips-signature-50738"",""FortiProxy-ips-signature-50584"",""FortiProxy-ips-signature-50695"",""FortiProxy-ips-signature-50945"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (50738,50584,50695,50945,10053760,10102238,10104624,10104893,10109240,10110134,10112092,10112251) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Microsoft Driver RCE vulnerability - CVE-2022-26809 Detected on Host | Security | A Fortinet product has detected Microsoft Driver RCE vulnerability (CVE-2022-26809) activity on a host | Outbreak: Microsoft Driver RCE vulnerability - CVE-2022-26809 Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId = 72056 |
| Outbreak: IBM Aspera Faspex Code Execution Vulnerability Detected on Network | Security | IBM Aspera Faspex Code Execution Vulnerability detected (CVE-2022-47986) on network. Details: https://www.ibm.com/support/pages/node/6952319 | Outbreak: IBM Aspera Faspex Code Execution Vulnerability Detected on Network | eventType IN (""FortiGate-ips-signature-52658"",""FortiProxy-ips-signature-52658"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Ivanti Endpoint Manager Mobile Authentication Bypass Vuln Detected on Network | Security | Ivanti Endpoint Manager Mobile Authentication Bypass Vulnerability detected (CVE-2023-35081,CVE-2023-35078) on network. Details: https://www.fortiguard.com/outbreak-alert/ivanti-epmm-authentication-bypass | Outbreak: Ivanti Endpoint Manager Mobile Authentication Bypass Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-53518"",""FortiProxy-ips-signature-53518"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (53518,10147844) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""Alert_Deny""))) |
| Outbreak: Fortra GoAnywhere MFT RCE Vulnerability Detected on Host | Security | Fortra GoAnywhere MFT RCE Vulnerability detected (CVE-2023-0669) on host. Details: https://www.fortiguard.com/outbreak-alert/goanywhere-mft-rce | Outbreak: Fortra GoAnywhere MFT RCE Vulnerability Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId = 4765 |
| Outbreak: Hikvision IP Camera Command Injection Vulnerability CVE-2021-36260 on Network | Security | Hikvision IP Camera Command Injection Vulnerability (CVE-2021-36260) detected on network | Outbreak: Hikvision IP Camera Command Injection Vulnerability CVE-2021-36260 on Network | eventType IN (""FortiGate-ips-signature-50872"",""FortiProxy-ips-signature-50872"") AND (ipsSignatureId = 50872 OR attackName = ""Hikvision.Product.SDK.WebLanguage.Tag.Command.Injection"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: HTTP2 Rapid Reset Attack Detected on Network | Security | HTTP/2 Rapid Reset Attack detected (CVE-2023-44487) on network. Details: https://www.fortiguard.com/outbreak-alert/http2-rapid-reset-attack | Outbreak: HTTP2 Rapid Reset Attack Detected on Network | eventType IN (""FortiGate-ips-signature-54090"",""FortiProxy-ips-signature-54090"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""Alert_Deny""))) |
| Outbreak: Multiple Vendor Camera System Attack Detected on Network | Security | Multiple Vendor Camera System Attack detected (CVE-2018-15745,CVE-2018-10661,CVE-2018-10662,CVE-2016-20016) on network. Details: https://www.fortiguard.com/outbreak-alert/multiple-vendor-camera-system-attack | Outbreak: Multiple Vendor Camera System Attack Detected on Network | eventType IN (""FortiGate-ips-signature-44754"",""FortiProxy-ips-signature-44754"",""FortiGate-ips-signature-43737"",""FortiProxy-ips-signature-43737"",""FortiGate-ips-signature-46273"",""FortiProxy-ips-signature-46273"",""FortiGate-ips-signature-46946"",""FortiProxy-ips-signature-46946"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Ivanti Endpoint Manager Mobile Authentication Bypass Vuln Detected on Host | Security | Ivanti Endpoint Manager Mobile Authentication Bypass Vulnerability detected (CVE-2023-35081,CVE-2023-35078) on host. Details: https://www.fortiguard.com/outbreak-alert/ivanti-epmm-authentication-bypass | Outbreak: Ivanti Endpoint Manager Mobile Authentication Bypass Vuln Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND virusName IN (""Java/Ivmob.EPMM!tr"") |
| Outbreak: Microsoft Outlook Elevation of Privilege Vulnerability Detected on Network | Security | Microsoft Outlook Elevation of Privilege Vulnerability detected (CVE-2023-23397) on network. Details: https://msrc.microsoft.com/blog/2023/03/microsoft-mitigates-outlook-elevation-of-privilege-vulnerability/ | Outbreak: Microsoft Outlook Elevation of Privilege Vulnerability Detected on Network | eventType IN (""FortiGate-ips-signature-52754"",""FortiProxy-ips-signature-52754"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (52754,10130476,10129427,10131142,10129669,10131254) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Joomla CMS Improper Access Check Vulnerability Detected on Network | Security | Joomla CMS Improper Access Check Vulnerability detected (CVE-2023-23752) on network. Details: https://developer.joomla.org/security-centre/894-20230201-core-improper-access-check-in-webservice-endpoints.html | Outbreak: Joomla CMS Improper Access Check Vulnerability Detected on Network | eventType IN (""FortiGate-ips-signature-52677"",""FortiProxy-ips-signature-52677"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Microsoft Office and Windows HTML RCE Vuln Detected on Host | Security | Microsoft Office and Windows HTML RCE Vulnerability detected (CVE-2023-36884) on host. Details: https://www.fortiguard.com/outbreak-alert/microsoft-office-and-windows-html-attack | Outbreak: Microsoft Office and Windows HTML RCE Vuln Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND virusName IN (""MSOffice/Reoff.MOWH!exploit"",""LNK/Agent.OF!tr"",""RTF/Reoff.MOWH!exploit"",""XML/Agent.25A0!exploit"",""XML/Agent.C0F3!exploit"",""RTF/Agent.3527!exploit"") |
| Outbreak: Fortra GoAnywhere MFT RCE Vulnerability Detected on Network | Security | Fortra GoAnywhere MFT RCE Vulnerability detected (CVE-2023-0669) on network. Details: https://www.fortiguard.com/outbreak-alert/goanywhere-mft-rce | Outbreak: Fortra GoAnywhere MFT RCE Vulnerability Detected on Network | eventType IN (""FortiGate-ips-signature-52630"",""FortiProxy-ips-signature-52630"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Microsoft Driver RCE vulnerability - CVE-2022-26809 Detected on Network | Security | A Fortinet product has detected Microsoft Driver RCE vulnerability (CVE-2022-26809) activity on network | Outbreak: Microsoft Driver RCE vulnerability - CVE-2022-26809 Detected on Network | eventType IN (""FortiGate-ips-signature-51469"",""FortiProxy-ips-signature-51469"") |
| Outbreak: HTTP2 Rapid Reset Attack Detected on Host | Security | HTTP/2 Rapid Reset Attack detected (CVE-2023-44487) on host. Details: https://www.fortiguard.com/outbreak-alert/http2-rapid-reset-attack | Outbreak: HTTP2 Rapid Reset Attack Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId IN (76830,76815) |
| Outbreak: Microsoft Outlook Elevation of Privilege Vulnerability Detected on Host | Security | Microsoft Outlook Elevation of Privilege Vulnerability detected (CVE-2023-23397) on host. Details: https://msrc.microsoft.com/blog/2023/03/microsoft-mitigates-outlook-elevation-of-privilege-vulnerability/ | Outbreak: Microsoft Outlook Elevation of Privilege Vulnerability Detected on Host | eventType IN (""FortiClient-vulnerabilityscan-vulnerability-record"",Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND (vulnId = 74780 OR virusName IN (""MSOffice/CVE_2023_23397.A!exploit"",""Data/CVE_2023_23397.A!exploit"",""MSOffice/CVE_2023_23397.B!exploit"",""MSOffice/CVE_2023_23397.FBFC!exploit"",""Data/CVE202323397.A!exploit"",""MSOffice/Reminder.EOP!tr"")) |
| Outbreak: Google Chromium WebP Vuln Detected on Network | Security | Google Chromium WebP Vulnerability detected (CVE-2023-4863) on network. Details: https://www.fortiguard.com/outbreak-alert/google-chromium-buffer-overflow | Outbreak: Google Chromium WebP Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-53914"",""FortiProxy-ips-signature-53914"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""Alert_Deny""))) |
| Outbreak: FortiWeb detected VMware Spring Cloud Func RCE Vulnerability on Network | Security | VMware Spring Cloud Func RCE Vulnerability (CVE-2022-22963) detected on network | Outbreak: FortiWeb detected VMware Spring Cloud Func RCE Vulnerability on Network | eventType = ""FortiWeb-20000010"" AND ipsSignatureId IN (1090501441,1090501440) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: FortiOS SSLVPN Heap Buffer Overflow attack - CVE-2022-42475 Detected on Network | Security | SSLVPN heap buffer overflow attack (CVE-2022-42475) detected on network | Outbreak: FortiOS SSLVPN Heap Buffer Overflow attack - CVE-2022-42475 Detected on Network | eventType IN (""FortiGate-ips-signature-52258"",""FortiProxy-ips-signature-52258"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Google Chromium WebP Vuln Detected on Host | Security | Google Chromium WebP Vulnerability detected (CVE-2023-4863) on host. Details: https://www.fortiguard.com/outbreak-alert/google-chromium-buffer-overflow | Outbreak: Google Chromium WebP Vuln Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId IN (76450,76557,76622,76585,76590,76449,76446) |
| Outbreak: Hive Ransomware Detected on Host | Security | Hive Ransomware detected (CVE-2021-31207,CVE-2021-34473,CVE-2021-34523,CVE-2021-42321) on host | Outbreak: Hive Ransomware Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected,""FortiClient-vulnerabilityscan-vulnerability-record"") AND (ipsSignatureId IN (10053760,10102238,10104624,10104893,10109240,10110134,10112092,10112251) OR vulnId IN (67695,68171,68170,69603) ) |
| Outbreak: FortiWeb detected CISA Top 20 Vulnerability on Network | Security | One of the CISA Top 20 most common vulnerabilities detected on network | Outbreak: FortiWeb detected CISA Top 20 Vulnerability on Network | eventType = ""FortiWeb-20000010"" AND ipsSignatureId IN (1090490119,1090490120,1090490121,1090501263,1090501141,1090501358,1090501360,1090501033,1090501366,1090501565,1090501475,1090501445,1090501355,1090501371,1090501267,1090501265,1090490117) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Progress Telerik UI Attack Detected on Network | Security | Progress Telerik UI Attack detected (CVE-2019-18935,CVE-2017-11317,CVE-2017-11357) on network. Details: https://docs.telerik.com/devtools/aspnet-ajax/knowledge-base/common-allows-javascriptserializer-deserialization | Outbreak: Progress Telerik UI Attack Detected on Network | eventType IN (""FortiGate-ips-signature-48789"",""FortiProxy-ips-signature-48789"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (48789,8192240,8238144,10128150) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Realtek SDK Attack Detected on Network | Security | Realtek SDK attack detected (CVE-2014-8361,CVE-2021-35394) on network. Details: https://www.fortiguard.com/outbreak-alert/realtek-sdk-attack | Outbreak: Realtek SDK Attack Detected on Network | eventType IN (""FortiGate-ips-signature-51534"",""FortiProxy-ips-signature-51534"",""FortiGate-ips-signature-40774"",""FortiProxy-ips-signature-40774"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (51534,40774,10130044,10130046,10130045) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: VMware Aria Operations for Networks Command Injection Vuln Detected on Network | Security | VMware Aria Operations for Networks Command Injection Vulnerability detected (CVE-2023-20887) on network. Details: https://www.fortiguard.com/outbreak-alert/vmware-aria-command-injection | Outbreak: VMware Aria Operations for Networks Command Injection Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-53324"",""FortiProxy-ips-signature-53324"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Wordpress WPGateway Plugin Vuln Detected on Network | Security | Wordpress WPGateway Plugin Vuln (CVE-2022-3180) detected on network | Outbreak: Wordpress WPGateway Plugin Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-52145"",""FortiProxy-ips-signature-52145"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: TBK DVR Authentication Bypass Attack Detected on Network | Security | TBK DVR Authentication Bypass Attack detected (CVE-2018-9995) on network. Details: https://www.fortiguard.com/outbreak-alert/tbk-dvr-attack | Outbreak: TBK DVR Authentication Bypass Attack Detected on Network | eventType IN (""FortiGate-ips-signature-45993"",""FortiProxy-ips-signature-45993"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: ThinkPHP Remote Code Execution Vulnerability Detected on Host | Security | ThinkPHP RCE vuln detected (CVE-2019-9082,CVE-2018-20062) on host. Details: https://www.fortiguard.com/outbreak-alert/thinkphp-rce | Outbreak: ThinkPHP Remote Code Execution Vulnerability Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND (ipsSignatureId IN (10134062,10134063) OR virusName IN (""W32/FlyStudio.PHP!tr"",""W32/CoinMiner.PHP!tr"")) |
| Outbreak: Sandbreak vm2 sandbox module RCE Vulnerability Detected on Network | Security | Sandbreak vm2 sandbox module RCE Vulnerability (CVE-2022-36067) detected on Network | Outbreak: Sandbreak vm2 sandbox module RCE Vulnerability Detected on Network | eventType IN (""FortiGate-ips-signature-52237"",""FortiProxy-ips-signature-52237"",""FortiWeb-20000010"") AND ipsSignatureId IN (52237,1090501592) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Progress Telerik UI Attack Detected on Host | Security | Progress Telerik UI Attack detected (CVE-2019-18935,CVE-2017-11317,CVE-2017-11357) on host. Details: https://docs.telerik.com/devtools/aspnet-ajax/knowledge-base/common-allows-javascriptserializer-deserialization | Outbreak: Progress Telerik UI Attack Detected on Host | eventType IN (""FortiClient-vulnerabilityscan-vulnerability-record"",Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND (vulnId IN (4128,4737,4351) OR virusName IN (""W32/NetWalker.B!tr.ransom"",""PowerShell/NetWalker.B!tr"",""Riskware/BlueMiner"")) |
| Outbreak: PaperCut MF/NG Improper Access Control Vulnerability Detected on Host | Security | PaperCut MF/NG Improper Access Control Vulnerability detected (CVE-2023-27350) on host. Details: https://www.fortiguard.com/outbreak-alert/papercut-rce | Outbreak: PaperCut MF/NG Improper Access Control Vulnerability Detected on Host | eventType IN (""FortiClient-vulnerabilityscan-vulnerability-record"",Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND (vulnId = 4950 OR virusName = ""Riskware/RemoteAdmin"") |
| Outbreak: VMware Spring Cloud Func RCE Vulnerability on Network | Security | VMware Spring Cloud Func RCE Vulnerability (CVE-2022-22963) detected on network | Outbreak: VMware Spring Cloud Func RCE Vulnerability on Network | eventType IN (""FortiGate-ips-signature-51355"",""FortiProxy-ips-signature-51355"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: PaperCut MF/NG Improper Access Control Vulnerability Detected on Network | Security | PaperCut MF/NG Improper Access Control Vulnerability detected (CVE-2023-27350) on network. Details: https://www.fortiguard.com/outbreak-alert/papercut-rce | Outbreak: PaperCut MF/NG Improper Access Control Vulnerability Detected on Network | eventType IN (""FortiGate-ips-signature-52900"",""FortiProxy-ips-signature-52900"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (52900,2985176) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Redigo Malware Detected on Host | Security | Redigo malware (CVE-2022-0543) detected on host | Outbreak: Redigo Malware Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId = 71859 |
| Outbreak: VMWare Workspace ONE Vulnerability - CVE-2022-22954 on Network | Security | VMWare Workspace ONE Vulnerability (CVE-2022-22954) detected on network | Outbreak: VMWare Workspace ONE Vulnerability - CVE-2022-22954 on Network | eventType IN (""FortiGate-ips-signature-51468"",""FortiProxy-ips-signature-51468"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (51468,10108336,10108300,10108335,10109643,10057675,10062066,7657554,10101766,8213066) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Oracle WebLogic Server Vuln Detected on Network | Security | Oracle WebLogic Server Vulnerability detected (CVE-2023-21839) on network. Details: https://www.fortiguard.com/outbreak-alert/oracle-weblogic-server-vulnerability | Outbreak: Oracle WebLogic Server Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-52696"",""FortiProxy-ips-signature-52696"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: WooCommerce Payments Improper Authentication Vuln Detected on Network | Security | WooCommerce Payments Improper Authentication Vulnerability detected (CVE-2023-28121) on network. Details: https://www.fortiguard.com/outbreak-alert/woocommerce-payments-attack | Outbreak: WooCommerce Payments Improper Authentication Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-53409"",""FortiProxy-ips-signature-53409"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (53409,10150208) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""Alert_Deny""))) |
| Outbreak: TP-Link Archer AX-21 Command Injection Attack Detected on Network | Security | TP-Link Archer AX-21 Command Injection Attack detected (CVE-2023-1389) on network. Details: https://www.fortiguard.com/outbreak-alert/tp-link-archer-ax-21-command-injection | Outbreak: TP-Link Archer AX-21 Command Injection Attack Detected on Network | eventType IN (""FortiGate-ips-signature-52742"",""FortiProxy-ips-signature-52742"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (52742,10052969,7194143,7860912,10122905) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Progress MOVEit Transfer SQL Injection Vuln Detected on Network | Security | Progress MOVEit Transfer SQL Injection Vulnerability detected (CVE-2023-34362) on network. Details: https://www.fortiguard.com/outbreak-alert/progress-moveit-transfer-sql-injection | Outbreak: Progress MOVEit Transfer SQL Injection Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-53240"",""FortiProxy-ips-signature-53240"",""FortiGate-ips-signature-53241"",""FortiProxy-ips-signature-53241"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (53240,53241,10140241) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: WooCommerce Payments Improper Authentication Vuln Detected on Host | Security | WooCommerce Payments Improper Authentication Vulnerability detected (CVE-2023-28121) on host. Details: https://www.fortiguard.com/outbreak-alert/woocommerce-payments-attack | Outbreak: WooCommerce Payments Improper Authentication Vuln Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND virusName = ""PHP/Payoow.CO!tr"" |
| Outbreak: TP-Link Archer AX-21 Command Injection Attack Detected on Host | Security | TP-Link Archer AX-21 Command Injection Attack detected (CVE-2023-1389) on host. Details: https://www.fortiguard.com/outbreak-alert/tp-link-archer-ax-21-command-injection | Outbreak: TP-Link Archer AX-21 Command Injection Attack Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND virusName IN (""BASH/Mirai.4C55!tr"",""ELF/Mirai.A!tr"",""ELF/Mirai.BL!tr"",""Linux/Redis.TSU!tr"") |
| Outbreak: SolarView Compact Command Injection Vuln Detected on Network | Security | SolarView Compact Command Injection Vulnerability detected (CVE-2022-40881,CVE-2022-29303) on network. Details: https://www.fortiguard.com/outbreak-alert/solarview-compact-command-injection | Outbreak: SolarView Compact Command Injection Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-52317"",""FortiProxy-ips-signature-52317"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: ThinkPHP Remote Code Execution Vulnerability Detected on Network | Security | ThinkPHP RCE vuln detected (CVE-2019-9082,CVE-2018-20062) on network. Details: https://www.fortiguard.com/outbreak-alert/thinkphp-rce | Outbreak: ThinkPHP Remote Code Execution Vulnerability Detected on Network | eventType IN (""FortiGate-ips-signature-47291"",""FortiProxy-ips-signature-47291"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Progress MOVEit Transfer SQL Injection Vuln Detected on Host | Security | Progress MOVEit Transfer SQL Injection Vulnerability detected (CVE-2023-34362) on host. Details: https://www.fortiguard.com/outbreak-alert/progress-moveit-transfer-sql-injection | Outbreak: Progress MOVEit Transfer SQL Injection Vuln Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId = 5083 |
| Outbreak: Zerobot Botnet Activity Detected on Host | Security | Zerobot Botnet activity detected (CVE-2017-17105,CVE-2019-10655,CVE-2020-25223,CVE-2021-42013,CVE-2022-31137,CVE-2022-33891) on host | Outbreak: Zerobot Botnet Activity Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND ipsSignatureId IN (10116867,10113511,10116868,10116869) |
| Outbreak: Realtek SDK Attack Detected on Host | Security | Realtek SDK attack detected (CVE-2014-8361,CVE-2021-35394) on host. Details: https://www.fortiguard.com/outbreak-alert/realtek-sdk-attack | Outbreak: Realtek SDK Attack Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND virusName IN (""Linux/Mirai.REAL!tr"",""Linux/Hinata.REAL!tr"",""Linux/RedGo.REAL!tr"") |
| Outbreak: Redigo Malware Detected on Network | Security | Redigo malware (CVE-2022-0543) detected on network | Outbreak: Redigo Malware Detected on Network | eventType IN (""FortiGate-ips-signature-51512"",""FortiProxy-ips-signature-51512"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (51512,10113939) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Teclib GLPI Remote Code Execution Vulnerability Detected on Network | Security | Teclib GLPI Remote Code Execution Vulnerability detected (CVE-2022-35914) on network. Details: https://github.com/glpi-project/glpi/releases | Outbreak: Teclib GLPI Remote Code Execution Vulnerability Detected on Network | eventType IN (""FortiGate-ips-signature-52227"",""FortiProxy-ips-signature-52227"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Zoho ManageEngine RCE Vulnerability Detected on Network | Security | Zoho ManageEngine RCE Vulnerability detected (CVE-2022-47966) on network. Details: https://www.fortiguard.com/outbreak-alert/zoho-manageengine-rce | Outbreak: Zoho ManageEngine RCE Vulnerability Detected on Network | eventType IN (""FortiGate-ips-signature-52571"",""FortiProxy-ips-signature-52571"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Windows: Potential DCOM InternetExplorer.Application DLL Hijack | Security | Detects potential DLL hijack of ""iertutil.dll"" found in the DCOM InternetExplorer.Application Class over the network. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_dcom_iertutil_dll_hijack.yml | Windows: Potential DCOM InternetExplorer.Application DLL Hijack | eventType=""Win-Sysmon-11-FileCreate"" AND procName=""System"" AND fileName REGEXP "".*\\Internet Explorer\\iertutil\.dll"" |
| Virus outbreak | Security | Detects potential virus outbreak - same virus found on three distinct computers/IP addresses | Virus outbreak | eventType IN (Group@PH_SYS_EVENT_Worm_Found) AND reptDevIpAddr IN (Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_SEC_GW, Group@PH_SYS_DEVICE_FIREWALL,Group@PH_SYS_DEVICE_NETWORK_IPS) |
| Outbreak: Zyxel Router Command Injection Attack Detected on Network | Security | Zyxel Router Command Injection Attack detected (CVE-2017-18368) on network. Details: https://www.fortiguard.com/outbreak-alert/zyxel-router-command-injection | Outbreak: Zyxel Router Command Injection Attack Detected on Network | eventType IN (""FortiGate-ips-signature-43619"",""FortiProxy-ips-signature-43619"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""Alert_Deny""))) |
| Windows: Impacket PsExec Execution | Security | Detects execution of Impacket's psexec.py, which is a python version of Microsoft's psexec. The psexec.py script is one of many examples of powerful penetration testing scripts that enables you to execute remote commands on another machine. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_impacket_psexec.yml | Windows: Impacket PsExec Execution | eventType=""Win-Security-5145"" AND fileName REGEXP ""\\\\\.*\\IPC\$"" AND targetName REGEXP "".*RemCom_stderr.*|.*RemCom_stdin.*|.*RemCom_stdout.*"" |
| Windows: OpenSSH Server Listening On Socket | Security | Detects scenarios where an attacker enables the OpenSSH server and server starts to listening on SSH socket. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/openssh/win_sshd_openssh_server_listening_on_socket.yml | Windows: OpenSSH Server Listening On Socket | eventType = ""Win-OpenSSH-4"" AND procName=""sshd"" AND dataPayload REGEXP ""Server listening on .*"" |
| Remote Desktop traffic from Internet | Security | Detects remote desktop from the Internet, which is defined as anything outside the Internal network. Please make sure that the Internal network definition is correct to avoid false positives. Remote desktop is detected from a windows log or from a flow to the RDP port | Remote Desktop traffic from Internet | srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND ((destIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) AND ((winLogonType = 10 AND eventType IN (Group@PH_SYS_EVENT_HostLogonFailure,Group@PH_SYS_EVENT_HostLogonSuccess)) OR eventType IN (""Win-TerminalServices-Gateway-200"",""Win-TerminalServices-Gateway-300"",""Win-TerminalServices-LocalSessionManager-21""))) OR (destIpPort = 3389 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic))) |
| Windows: Metasploit Or Impacket Service Installation Via SMB PsExec | Security | Detects usage of Metasploit SMB PsExec (exploit/windows/smb/psexec) and Impacket psexec.py by triggering on specific service installation. These tools are one of many examples of powerful penetration testing scripts that enables you to execute remote commands on another machine. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_metasploit_or_impacket_smb_psexec_service_install.yml | Windows: Metasploit Or Impacket Service Installation Via SMB PsExec | (eventType=""Win-Security-4697"" AND serviceStartType=""3"" AND serviceType=""0x10"") AND (serviceName!=""PSEXESVC"") |
| Windows: Metasploit SMB Authentication | Security | Alerts on Metasploit host's authentications on the domain. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_metasploit_authentication.yml | Windows: Metasploit SMB Authentication | ((eventType IN (""Win-Security-4624"", ""Win-Security-4625"") AND winLogonType = 3 AND authenMethod = ""NTLM"") OR (procName IS NULL AND eventType = ""Win-Security-4776"")) AND computer REGEXP ""^[A-Za-z0-9]{16}$"" |
| Windows: MMC20 Lateral Movement | Security | Detects MMC20.Application Lateral Movement; specifically looks for the spawning of the parent MMC.exe with a command line of ""-Embedding"" as a child of svchost.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mmc_mmc20_lateral_movement.yml | Windows: MMC20 Lateral Movement | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\svchost\.exe"" AND procName REGEXP "".*\\mmc\.exe"" AND command REGEXP "".*-Embedding.*"" |
| Windows: MMC Spawning Windows Shell | Security | Detects a Windows command line executable started from MMC. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mmc_susp_child_process.yml | Windows: MMC Spawning Windows Shell | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\mmc\.exe"" AND (procName REGEXP "".*\\bash\.exe|.*\\cmd\.exe|.*\\cscript\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\reg\.exe|.*\\regsvr32\.exe|.*\\sh\.exe|.*\\wscript\.exe"" OR procName REGEXP "".*\\BITSADMIN.*"") |
| Windows: New Remote Desktop Connection Initiated Via Mstsc.EXE | Security | Detects the usage of ""mstsc.exe"" with the ""/v"" flag to initiate a connection to a remote server. Adversaries may use valid accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mstsc_remote_connection.yml | Windows: New Remote Desktop Connection Initiated Via Mstsc.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\mstsc\.exe"" OR srcFileName=""mstsc.exe"") AND command REGEXP "".* /v:.*"") AND ((parentProcName!=""C:\\Windows\\System32\\lxss\\wslhost.exe"" OR command NOT REGEXP "".*C:\\ProgramData\\Microsoft\\WSL\\wslg\.rdp.*"")) |
| Windows: Potential DCOM InternetExplorer.Application DLL Hijack - Image Load | Security | Detects potential DLL hijack of ""iertutil.dll"" found in the DCOM InternetExplorer.Application Class. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_dcom_iertutil_dll_hijack.yml | Windows: Potential DCOM InternetExplorer.Application DLL Hijack - Image Load | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\Internet Explorer\\iexplore\.exe"" AND loadedProcName REGEXP "".*\\Internet Explorer\\iertutil\.dll"" |
| Traffic to Dragos Worldview Malware IP List | Security | Detects network traffic to Dragos Worldview Blocked IP List | Traffic to Dragos Worldview Malware IP List | destIpAddr IN (Group@PH_SYS_DRAGOSWORLDVIEW_BLOCKED_IP) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic,Group@PH_SYS_EVENT_DenyNetTraffic) |
| Permitted Traffic from Dragos Worldview Malware IP List | Security | Detects network traffic from Dragos Worldview Malware IP List | Permitted Traffic from Dragos Worldview Malware IP List | srcIpAddr IN (Group@PH_SYS_DRAGOSWORLDVIEW_BLOCKED_IP) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Windows: Access to ADMIN$ Share | Security | Detects access to $ADMIN share. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_admin_share_access.yml | Windows: Access to ADMIN$ Share | (eventType=""Win-Security-5140"" AND fileName=""Admin$"") AND (user NOT REGEXP "".*\$"") |
| Windows: Possible Exploitation of Exchange RCE CVE-2021-42321 | Security | Detects log entries that appear in exploitation attempts against MS Exchange RCE CVE-2021-42321. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/msexchange/win_exchange_cve_2021_42321.yml | Windows: Possible Exploitation of Exchange RCE CVE-2021-42321 | eventType IN (""Win-MSExchange-Management-6"",""Win-MSExchange-Management-8"") AND lineContent REGEXP "".*Cmdlet failed\. Cmdlet Get-App, .*|.*Task Get-App throwing unhandled exception: System\.InvalidCastException:.*"" |
| Windows: DCERPC SMB Spoolss Named Pipe | Security | Detects the use of the spoolss named pipe over SMB. This can be used to trigger the authentication via NTLM of any machine that has the spoolservice enabled. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_dce_rpc_smb_spoolss_named_pipe.yml | Windows: DCERPC SMB Spoolss Named Pipe | eventType=""Win-Security-5145"" AND fileName REGEXP ""\\\\\.*\\IPC\$"" AND targetName=""spoolss"" |
| Outbreak: Zyxel Multiple Firewall Vuln Detected on Network | Security | Zyxel Multiple Firewall Vulnerabilities detected (CVE-2023-28771,CVE-2023-33009,CVE-2023-33010) on network. Details: https://www.fortiguard.com/outbreak-alert/zyxel-multiple-firewall-vulnerabilities | Outbreak: Zyxel Multiple Firewall Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-53203"",""FortiProxy-ips-signature-53203"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (53203,10130044,10139968,10139972,10113511,7509801) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| VNC traffic from Internet | Security | Detects VNC from Internet, which is defined as anything outside the Internal network. Please make sure that the Internal network definition is correct to avoid false positives | VNC traffic from Internet | srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND srcIpPort >= 1024 AND ((destIpPort >= 5800 AND destIpPort <= 5820) OR (destIpPort >= 5900 AND destIpPort <= 5920) OR (destIpPort >= 6000 AND destIpPort <= 6020)) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Windows: Denied Access To Remote Desktop | Security | This event is generated when an authenticated user who is not allowed to log on remotely attempts to connect to this computer through Remote Desktop. Often, this event can be generated by attackers when searching for available windows servers in the network. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_not_allowed_rdp_access.yml | Windows: Denied Access To Remote Desktop | eventType=""Win-Security-4825"" |
| PowerShell Downgrade Attack Detected | Security | Detects PowerShell downgrade attack by comparing the host version with the actually used engine version for 2.0. Ref: http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/. This rule requires collection of the Windows PowerShell Event Log via the FortiSIEM Agent. | PowerShell Downgrade Attack Detected | eventType = ""Win-PowerShell-400"" AND engineVersion REGEXP ""^2.\d+"" AND version NOT REGEXP ""^2/\d+"" |
| Windows: First Time Seen Remote Named Pipe | Security | This detection excludes known namped pipes accessible remotely and notify on newly observed ones, may help to detect lateral movement and remote exec using named pipes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_lm_namedpipe.yml | Windows: First Time Seen Remote Named Pipe | (eventType=""Win-Security-5145"" AND fileName REGEXP ""\\\\\*\\IPC\$"") AND (targetName NOT IN (""HydraLsPipe"",""LSM_API_service"",""MsFteWds"",""TermSrv_API_service"",""atsvc"",""browser"",""eventlog"",""lsarpc"",""lsass"",""netdfs"",""netlogon"",""ntsvcs"",""protected_storage"",""samr"",""spoolss"",""sql\\query"",""srvsvc"",""svcctl"",""winreg"",""wkssvc"")) |
| Outbreak: Zyxel Multiple Firewall Vuln Detected on Host | Security | Zyxel Multiple Firewall Vulnerabilities detected (CVE-2023-28771,CVE-2023-33009,CVE-2023-33010) on host. Details: https://www.fortiguard.com/outbreak-alert/zyxel-multiple-firewall-vulnerabilities | Outbreak: Zyxel Multiple Firewall Vuln Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND virusName IN (""BAT/Agent.1763!tr.dldr"",""Linux/Mirai.REAL!tr"",""Linux/Mirai.IZ1H9!tr"",""Linux/Agent.IZ1H9!tr.dldr"",""ELF/Zerobot.A!tr"",""ELF/Mirai.AE!tr"") |
| Windows: DCOM Internet Explorer.Application Iertutil DLL Hijack: Security Log | Security | Detects a threat actor creating a file named `iertutil.dll` in the `C:\Program Files\Internet Explorer\` directory over the network for a DCOM InternetExplorer DLL Hijack scenario. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_dcom_iertutil_dll_hijack.yml | Windows: DCOM Internet Explorer.Application Iertutil DLL Hijack: Security Log | (eventType=""Win-Security-5145"" AND targetName REGEXP "".*\\Internet Explorer\\iertutil\.dll"") AND (user NOT REGEXP "".*\$"") |
| Outbreak: Zerobot Botnet Activity Detected on Network | Security | Zerobot Botnet activity detected (CVE-2017-17105,CVE-2019-10655,CVE-2020-25223,CVE-2021-42013,CVE-2022-31137,CVE-2022-33891) on network | Outbreak: Zerobot Botnet Activity Detected on Network | eventType IN (Group@PH_SYS_EVENT_FortiGate_AV_Detected,""FortiGate-ips-signature-45494"",""FortiGate-ips-signature-47699"",""FortiGate-ips-signature-50704"",""FortiGate-ips-signature-102891577"",""FortiGate-ips-signature-51928"",""FortiGate-ips-signature-51924"",""FortiProxy-ips-signature-45494"",""FortiProxy-ips-signature-47699"",""FortiProxy-ips-signature-50704"",""FortiProxy-ips-signature-102891577"",""FortiProxy-ips-signature-51928"",""FortiProxy-ips-signature-51924"") AND ipsSignatureId IN (45494,47699,50704,102891577,51928,51924,10113511) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Windows: RDP Login from Localhost | Security | RDP login with localhost source address may be a tunnelled login. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_rdp_localhost_login.yml | Windows: RDP Login from Localhost | eventType=""Win-Security-4624"" AND winLogonType=10 AND srcIpAddr IN (127.0.0.1,::1) |
| Mail Hard Bounce Delivery Failures | Disponibilidade | Detect mail hard bounce delivery failures | Mail Hard Bounce Delivery Failures | eventType = ""Cisco-IronPort-Mail-HardBounce"" |
| ICS Alert: Program Download | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0843 - Program Download. Adversaries may perform a program download to transfer a user program to a controller. | ICS Alert: Program Download | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0843(,T\d+)*$"" |
| Windows: Potential RDP Exploit CVE-2019-0708 | Security | Detect suspicious error on protocol RDP, potential CVE-2019-0708. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/termdd/win_system_rdp_potential_cve_2019_0708.yml | Windows: Potential RDP Exploit CVE-2019-0708 | eventType IN (""Win-System-TermDD-50"",""Win-System-TermDD-56"") |
| Windows: WinRM Access with Evil-WinRM | Security | Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_evil_winrm.yml | Windows: WinRM Access with Evil-WinRM | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\ruby\.exe"" AND command REGEXP "".*-i .*"" AND command REGEXP "".*-u .*"" AND command REGEXP "".*-p .*"" |
| ICS Alert: Remote Services | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0886 - Remote Services. Adversaries may leverage remote services (such as RDP, SMB, SSH) to move between assets and network segments. | ICS Alert: Remote Services | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0886(,T\d+)*$"" |
| Windows: Rundll32 Execution Without Parameters | Security | Detects rundll32 execution without parameters as observed when running Metasploit windows/smb/psexec exploit module. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_without_parameters.yml | Windows: Rundll32 Execution Without Parameters | eventType=""Win-Sysmon-1-Create-Process"" AND command IN (""rundll32"",""rundll32.exe"") |
| ICS Alert: Exploitation of Remote Services | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0866 - Exploitation of Remote Services. Adversaries may exploit a software vulnerability to take advantage of a programming error in a program, service, or within the operating system software or kernel itself to enable remote service abuse. | ICS Alert: Exploitation of Remote Services | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0866(,T\d+)*$"" |
| Windows: Suspicious UltraVNC Execution | Security | Detects suspicious UltraVNC command line flag combination that indicate a auto reconnect upon execution, e.g. startup (as seen being used by Gamaredon threat group). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ultravnc_susp_execution.yml | Windows: Suspicious UltraVNC Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*-autoreconnect .*"" AND command REGEXP "".*-connect .*"" AND command REGEXP "".*-id:.*"" |
| Windows: Suspicious PsExec Execution | Security | Detects execution of psexec or paexec with renamed service name, this rule helps to filter out the noise if psexec is used for legit purposes or if attacker uses a different psexec client other than sysinternal one. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_psexec.yml | Windows: Suspicious PsExec Execution | (eventType=""Win-Security-5145"" AND fileName REGEXP ""\\\\\*\\IPC\$"" AND targetName REGEXP "".*-stderr|.*-stdin|.*-stdout"") AND (targetName NOT REGEXP ""PSEXESVC.*"") |
| Windows: Protected Storage Service Access | Security | Detects access to a protected_storage service over the network. Potential abuse of DPAPI to extract domain backup keys from Domain Controllers. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_protected_storage_service_access.yml | Windows: Protected Storage Service Access | eventType=""Win-Security-5145"" AND fileName REGEXP "".*IPC.*"" AND targetName=""protected_storage"" |
| Windows: WCE wceaux dll Access | Security | Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_mal_wceaux_dll.yml | Windows: WCE wceaux dll Access | eventType IN (""Win-Security-4656"",""Win-Security-4658"",""Win-Security-4660"",""Win-Security-4663"") AND osObjName REGEXP "".*\\wceaux\.dll"" |
| License Issue | Disponibilidade | Detect license issues for operational systems and software in the data center - this may include license about to expire or already expired, or license limiting system operation | License Issue | eventType IN (Group@PH_SYS_EVENT_LicenseExpired) |
| ICS Alert: Default Credentials | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0812 - Default Credentials. Adversaries may leverage manufacturer or supplier set default credentials on control system devices. | ICS Alert: Default Credentials | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0812(,T\d+)*$"" |
| FortiMail Failover | Disponibilidade | Detects that a FortiMail Server is failing over | FortiMail Failover | eventType = ""FortiMail-Event-HA-Role-Change"" |
| Windows: PSEXEC Remote Execution File Artefact | Security | Detects creation of the PSEXEC key file, which is created anytime a PsExec command is executed. It gets written to the file system and will be recorded in the USN Journal on the target system. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_sysinternals_psexec_service_key.yml | Windows: PSEXEC Remote Execution File Artefact | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP ""C:\\Windows\\PSEXEC-.*"" AND fileName REGEXP "".*\.key"" |
| Windows: smbexec.py Service Installation | Security | Detects the use of smbexec.py tool by detecting a specific service installation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_hack_smbexec.yml | Windows: smbexec.py Service Installation | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceName=""BTOBTO"" AND serviceFileName REGEXP "".*\\execute\.bat"" |
| Windows: Windows Share Mount Via Net.EXE | Security | Detects when a share is mounted using the ""net.exe"" utility. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_use_mount_share.yml | Windows: Windows Share Mount Via Net.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR srcFileName IN (""net.exe"",""net1.exe"")) AND command REGEXP "".* \\\\\.*|.* use .*"" |
| Windows: Windows Admin Share Mount Via Net.EXE | Security | Detects when an admin share is mounted using net.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_use_mount_admin_share.yml | Windows: Windows Admin Share Mount Via Net.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR srcFileName IN (""net.exe"",""net1.exe"")) AND (command REGEXP "".* use .*"" AND command REGEXP "".* \\\\.*\\.*\$.*"") |
| Windows: Windows Internet Hosted WebDav Share Mount Via Net.EXE | Security | Detects when an internet hosted webdav share is mounted using the ""net.exe"" utility. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_use_mount_internet_share.yml | Windows: Windows Internet Hosted WebDav Share Mount Via Net.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR srcFileName IN (""net.exe"",""net1.exe"")) AND command REGEXP "".* http.*|.* use .*"" |
| Windows: Potential MSTSC Shadowing Activity | Security | Detects RDP session hijacking by using MSTSC shadowing. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mstsc_rdp_hijack_shadowing.yml | Windows: Potential MSTSC Shadowing Activity | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*noconsentprompt.*"" AND command REGEXP "".*shadow:.*"" |
| Windows: Terminal Service Process Spawn | Security | Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_svchost_termserv_proc_spawn.yml | Windows: Terminal Service Process Spawn | eventType=""Win-Sysmon-1-Create-Process"" AND (parentCommand REGEXP "".*\\svchost\.exe.*"" AND parentCommand REGEXP "".*termsvcs.*"") AND ((procName NOT REGEXP "".*:\\Windows\\System32\\csrss\.exe|.*:\\Windows\\System32\\wininit\.exe|.*:\\Windows\\System32\\winlogon\.exe|.*\\rdpclip\.exe"") AND (procName IS NOT NULL)) |
| Windows: Scanner PoC for CVE-2019-0708 RDP RCE Vuln | Security | Detects the use of a scanner by zerosum0x0 that discovers targets vulnerable to CVE-2019-0708 RDP RCE aka BlueKeep. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_rdp_bluekeep_poc_scanner.yml | Windows: Scanner PoC for CVE-2019-0708 RDP RCE Vuln | eventType=""Win-Security-4625"" AND user=""AAAAAAA"" |
| Windows: Suspicious RDP Redirect Using TSCON | Security | Detects a suspicious RDP session redirect using tscon.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_tscon_rdp_redirect.yml | Windows: Suspicious RDP Redirect Using TSCON | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* /dest:rdp-tcp:.*"" |
| Windows: Remote Service Activity via SVCCTL Named Pipe | Security | Detects remote service activity via remote access to the svcctl named pipe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_svcctl_remote_service.yml | Windows: Remote Service Activity via SVCCTL Named Pipe | eventType=""Win-Security-5145"" AND fileName REGEXP ""\\\\\*\\IPC\$"" AND targetName=""svcctl"" AND osObjAccessType REGEXP "".*WriteData.*"" |
| ICS Alert: Lateral Tool Transfer | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0867 - Lateral Tool Transfer. Adversaries may transfer tools or other files from one system to another to stage adversary tools or other files over the course of an operation. | ICS Alert: Lateral Tool Transfer | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0867(,T\d+)*$"" |
| Windows: SMB Create Remote File Admin Share | Security | Look for non-system accounts SMB accessing a file with write (0x2) access mask via administrative share (i.e C$). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_smb_file_creation_admin_shares.yml | Windows: SMB Create Remote File Admin Share | (eventType=""Win-Security-5145"" AND fileName REGEXP "".*C\$"" AND fileAccess=""0x2"") AND (user NOT REGEXP "".*\$"") |
| Meraki No DHCP lease | Disponibilidade | Meraki detects no DHCP lease | Meraki No DHCP lease | eventType = ""Cisco-Meraki-noDhcpLeases"" |
| Crowdstrike: Activity Prevented | Security | Crowdstrike agent prevented host/user activity | Crowdstrike: Activity Prevented | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Activity-Prevented"" |
| FortiNDR: Attack Chain Blocked | Security | FortiNDR Reported that a string of one or more attacks was blocked by submitting device. | FortiNDR: Attack Chain Blocked | eventType = ""FortiNDR-AttackChain-Blocked"" |
| ES Coordinator Node Staying Down | Disponibilidade | Detects that an ES Coordinator node stays down - that is didn't come up within 5 minutes of going down | ES Coordinator Node Staying Down | eventType = ""PH_DATA_CLUSTER_COORDINATOR_DOWN"" |
| Meraki VPN Failover | Disponibilidade | Meraki detects VPN Failover | Meraki VPN Failover | eventType = ""Cisco-Meraki-vpnFailoverDetected"" |
| Meraki Device VPN Connectivity Down | Disponibilidade | Detects a Meraki Device VPN Connectivity is down | Meraki Device VPN Connectivity Down | eventType = ""Cisco-Meraki-vpnConnectivityChange-down"" |
| Crowdstrike: Attacker Methodology | Security | Crowdstrike agent detected attacker methodology likely indicating attacker has gained access into a compromised system | Crowdstrike: Attacker Methodology | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Attacker-Methodology"" |
| FortiAnalyzer: No logs received from a device in 4 hours | Disponibilidade | FortiAnalyzer has sent a log message stating that it has not received any logs from a registered device in over 4 hours. The metric offlineDuration describes in minutes, since the device was last seen. FortiAnalyzer may send this log on an interval while the device is offline. FortiAnalyzer must be configured to send internal syslog messages to FortiSIEM to trigger this rule. | FortiAnalyzer: No logs received from a device in 4 hours | eventType = ""FortiAnalyzer-logdev-device-offline"" AND hostName IS NOT NULL AND offlineDuration >= 14400 |
| Meraki Device Interface Down | Disponibilidade | Detects a Meraki Device interface is down | Meraki Device Interface Down | eventType = ""Cisco-Meraki-portDisconnected"" |
| Meraki Device Cellular Connection Disconnected | Disponibilidade | Detects a cellular network is disconnected | Meraki Device Cellular Connection Disconnected | eventType = ""Cisco-Meraki-cellularNetworkDown"" |
| Meraki New DHCP Server | Security | Meraki detects a new DHCP Server | Meraki New DHCP Server | eventType = ""Cisco-Meraki-newDhcpServerAlert"" |
| Critical Network Device Interface Staying Down | Disponibilidade | Detects that a critical network interface of a network device is staying down - that is didn't come up within 5 minutes of going down. An interface is critical if it appears in Critical Interface list in GUI | Critical Network Device Interface Staying Down | eventType IN (Group@PH_SYS_EVENT_NetIntfShutdown) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND isHostIntfCritical = ""Yes"" |
| Network Interface Duplex Mismatch | Disponibilidade | Detects half/Full duplex mismatch on an network interface. This indicates configuration issues. | Network Interface Duplex Mismatch | eventType = ""IOS-CDP-DUPLEX_MISMATCH"" AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| ES Coordinator Node Staying Down | Disponibilidade | Detects that an ES Coordinator node stays down - that is didn't come up within 5 minutes of going down | ES Coordinator Node Staying Down | eventType = ""PH_DATA_CLUSTER_COORDINATOR_UP"" |
| ES Coordinator Node Down | Disponibilidade | Detects that an ES Coordinator node down | ES Coordinator Node Down | eventType = ""PH_DATA_CLUSTER_COORDINATOR_DOWN"" |
| Meraki Unreachable RADIUS Server | Disponibilidade | Meraki detects unreachable RADIUS servers | Meraki Unreachable RADIUS Server | eventType = ""Cisco-Meraki-unreachableRadiusServer"" |
| Network Device Redundancy Lost | Disponibilidade | Detects loss of redundancy for Cisco IOS Catalyst switches | Network Device Redundancy Lost | eventType = ""IOS-C4K_REDUNDANCY-COMMUNICATION-LOST"" |
| Meraki Device IP Conflict | Disponibilidade | Meraki detects IP conflict errors | Meraki Device IP Conflict | eventType = ""Cisco-Meraki-ipConflict"" |
| IOS Packet Memory Test Failure | Disponibilidade | Detects IOS Packet Memory Test Failure - triggers when more than 25 pct packets are lost | IOS Packet Memory Test Failure | eventType = ""IOS-C4K_SWITCHINGENGINEMAN-PACKETMEMORYTESTPARTIALFAILURE"" |
| Meraki Unreachable Device | Disponibilidade | Meraki detects unreachable devices | Meraki Unreachable Device | eventType = ""Cisco-Meraki-unreachableDevicesDetected"" |
| Critical Network Device Interface Staying Down | Disponibilidade | Detects that a critical network interface of a network device is staying down - that is didn't come up within 5 minutes of going down. An interface is critical if it appears in Critical Interface list in GUI | Critical Network Device Interface Staying Down | eventType IN (Group@PH_SYS_EVENT_NetIntfRestart) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND isHostIntfCritical = ""Yes"" |
| Cisco Unified Contact Center Express JVM heap memory high | Performance | Cisco Unified Contact Center Express JVM heap memory greater than threshold | Cisco Unified Contact Center Express JVM heap memory high | eventType = ""Cisco_UC_RTMT_UnifiedCCXEngineMemoryUsageHigh"" |
| Meraki Device Port Cable Error | Disponibilidade | Meraki detects port cable errors | Meraki Device Port Cable Error | eventType = ""Cisco-Meraki-portCableError"" |
| Excessive ICMP Unreachables | Disponibilidade | Detects an usually high frequency of ICMP destination unreachable packets between the same source and destination - this indicates routing error | Excessive ICMP Unreachables | ipProto = 1 AND icmpType = 3 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic, Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) |
| Oracle DB Low Row Memory Sorts Ratio | Performance | Detects that average Oracle database memory sorts ratio is less than 90 for 2 successive readings | Oracle DB Low Row Memory Sorts Ratio | eventType = ""PH_DEV_MON_PERF_ORADB"" |
| Cisco Call Manager Virtual Memory Low | Performance | Available virtual memory is below the configured limit | Cisco Call Manager Virtual Memory Low | eventType = ""Cisco_UC_RTMT_LowAvailableVirtualMemory"" |
| FortiNDR: Attack Chain Permitted | Security | FortiNDR Reported that a string of one or more attacks was permitted by submitting device. | FortiNDR: Attack Chain Permitted | eventType = ""FortiNDR-AttackChain-Permit"" |
| Azure Automation Runbook Created or Modified | Security | Identifies when an Azure Automation runbook is created or modified. An adversary may create or modify an Azure Automation runbook to execute malicious code and maintain persistence in their target's environment. | Azure Automation Runbook Created or Modified | eventType IN (""MS_EvtHub_automation_automationaccounts_runbooks_publish_action"",""MS_EvtHub_automation_automationaccounts_runbooks_write"",""MS_EvtHub_automation_automationaccounts_runbooks_draft_write"") |
| AWS RDS Cluster Created | Security | Identifies the creation of a new Amazon Relational Database Service (RDS) Aurora DB cluster or global database spread across multiple regions. | AWS RDS Cluster Created | eventType IN (""AWS-CloudTrail-RDS-CreateDBCluster"",""AWS-CloudTrail-RDS-CreateGlobalCluster"") |
| Azure Privilege Identity Management Role Modified | Security | Azure Active Directory (AD) Privileged Identity Management (PIM) is a service that enables you to manage, control, and monitor access to important resources in an organization. PIM can be used to manage the built-in Azure resource roles such as Global Administrator and Application Administrator. An adversary may add a user to a PIM role in order to maintain persistence in their target's environment or modify a PIM role to weaken their target's security controls. | Azure Privilege Identity Management Role Modified | eventType = ""MS_EvtHub_update_role_setting_in_pim"" |
| Server Network Interface Staying Down | Disponibilidade | Detects that a network interface of a server stays down - that is didn't come up within 5 minutes of going down | Server Network Interface Staying Down | eventType IN (Group@PH_SYS_EVENT_NetIntfRestart) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Server Network Low Port Staying Down | Disponibilidade | Detects a low TCP/UDP port on a server staying down - that is, went from up to down and did not come up in 10 min | Server Network Low Port Staying Down | eventType = ""PH_DEV_MON_PORT_CLOSE"" AND ipPort <= 1024 AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| AWS IAM User Added to Group | Security | Identifies the addition of a user to a specified group in AWS Identity and Access Management (IAM). | AWS IAM User Added to Group | eventType CONTAIN ""AWS-CloudTrail-IAM-AddUserToGroup"" |
| Server Network Interface Staying Down | Disponibilidade | Detects that a network interface of a server stays down - that is didn't come up within 5 minutes of going down | Server Network Interface Staying Down | eventType IN (Group@PH_SYS_EVENT_NetIntfShutdown) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Crowdstrike: Establish Persistence | Security | Crowdstrike agent detected attempts by malware to persist on the host | Crowdstrike: Establish Persistence | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Establish-Persistence"" |
| Crowdstrike: Malicious Document Detected | Security | Crowdstrike agent detected malicious document at a host | Crowdstrike: Malicious Document Detected | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Malicious-Document"" |
| Noncritical Network Device Interface Staying Down | Disponibilidade | Detects that a non-critical interface of a network device is staying down - that is didn't come up within 5 minutes of going down | Noncritical Network Device Interface Staying Down | eventType IN (Group@PH_SYS_EVENT_NetIntfRestart) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND isHostIntfCritical = ""No"" |
| Server Network Low Port Staying Down | Disponibilidade | Detects a low TCP/UDP port on a server staying down - that is, went from up to down and did not come up in 10 min | Server Network Low Port Staying Down | eventType = ""PH_DEV_MON_PORT_OPEN"" AND ipPort <= 1024 AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Crowdstrike: Intel Detection | Security | Crowdstrike agent detected host matching malware IOCs - either communicatiing to a malware domain or showng the presence of malware hash file | Crowdstrike: Intel Detection | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Intel-Detection"" |
| Azure Global Administrator Role Added to PIM User | Security | Identifies an Azure Active Directory (AD) Global Administrator role addition to a Privileged Identity Management (PIM) user account. PIM is a service that enables you to manage, control, and monitor access to important resources in an organization. Users who are assigned to the Global administrator role can read and modify any administrative setting in your Azure AD organization. | Azure Global Administrator Role Added to PIM User | azureEventCategory = ""RoleManagement"" AND eventType IN (""MS_EvtHub_add_member_to_role_in_pim_completed_timebound"",""MS_EvtHub_add_eligible_member_to_role_in_pim_completed_permanent"") AND srcName = ""Global Administrator"" |
| AWS SecHub: Tactics: Persistence Detected | Security | AWS Security Hub detected persistence tactics. Adversary is trying to maintain foothold in your network. | AWS SecHub: Tactics: Persistence Detected | eventType = ""AWS-Hub-TTPs-Persistence"" |
| Azure Conditional Access Policy Modified | Security | Identifies when an Azure Conditional Access policy is modified. Azure Conditional Access policies control access to resources via if-then statements. For example, if a user wants to access a resource, then they must complete an action such as using multi-factor authentication to access it. An adversary may modify a Conditional Access policy in order to weaken their target's security controls. | Azure Conditional Access Policy Modified | ( eventType = ""MS_EvtHub_update_policy"" OR eventType = ""MS_EvtHub_update_policy"" ) |
| Adware process found | Security | Detects suspicious adware process on a host | Adware process found | swProcName IN (Group@PH_SYS_MAL_PROC_ADWARE) AND eventType = ""PH_DEV_MON_PROC_RESOURCE_UTIL"" |
| Common Windows process launched by unusual parent | Security | Detects common windows processes being launched by an unusual parent process. Processes include: Service Control Manager Service (services.exe), Shared Service Process (svchost.exe), Local Security Authority Subsystem Service (lssass.exe), Command lone process (cmd.exe), powershell.exe, notepad++.exe, notepad.exe, firefox.exe, chrome.exe, Console Windows Host process (Conhost.exe) | Common Windows process launched by unusual parent | eventType IN (""PH_OSQUERY_WIN_SERVICES_BAD_PARENT"", ""PH_OSQUERY_WIN_SVCHOST_BAD_PARENT"", ""PH_OSQUERY_WIN_LSASS_BAD_PARENT"", ""PH_OSQUERY_WIN_CMD_BAD_PARENT"", ""PH_OSQUERY_WIN_POWERSHELL_BAD_PARENT"", ""PH_OSQUERY_WIN_NOTEPAD_PLUS_BAD_PARENT"", ""PH_OSQUERY_WIN_NOTEPAD_BAD_PARENT"", ""PH_OSQUERY_WIN_FIREFOX_BAD_PARENT"", ""PH_OSQUERY_WIN_CHROME_BAD_PARENT"", ""PH_OSQUERY_WIN_CONHOST_BAD_PARENT"") AND totalNum >= 1 |
| Compromised Host Detected by Network IPS | Security | Detects traffic that indicates a compromised host | Compromised Host Detected by Network IPS | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_Compromised) |
| Crowdstrike: Ransomware | Security | Crowdstrike agent detected ransomware processes on a host | Crowdstrike: Ransomware | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Ransomware"" |
| Common Windows process launched from unusual path | Security | Detects common windows processes not running from their well-known path. Processes checked are: Console Windows Host process (Conhost.exe), Client Server Runtime Subsystem (csrss.exe), File explorer (explorer.exe), Dllhost.exe, Local Security Authority Subsystem Service (lssass.exe), Service Control Manager Service (services.exe), Session Manager Subsystem (smss.exe), Shared Service Process (svchost.exe), Windows startup initialization process (wininit.exe), Logon/logoff Management service (winlogon.exe), WMI Provider service (wmiprvse.exe) | Common Windows process launched from unusual path | eventType IN (""PH_OSQUERY_WIN_CONHOST_BAD_PATH"", ""PH_OSQUERY_WIN_CSRSS_BAD_PATH"", ""PH_OSQUERY_WIN_EXPLORER_BAD_PATH"", ""PH_OSQUERY_WIN_DLLHOST_BAD_PATH"", ""PH_OSQUERY_WIN_LSASS_BAD_PATH"", ""PH_OSQUERY_WIN_SERVICES_BAD_PATH"", ""PH_OSQUERY_WIN_SMSS_BAD_PATH"", ""PH_OSQUERY_WIN_SVCHOST_BAD_PATH"", ""PH_OSQUERY_WIN_WININIT_BAD_PATH"", ""PH_OSQUERY_WIN_WINLOGIN_BAD_PATH"", ""PH_OSQUERY_WIN_WMIPRVSE_BAD_PATH"") AND totalNum >= 1 |
| ArubaOS-CX: User Added | Change | Aruba OS CX Switch Platform: User Added | ArubaOS-CX: User Added | eventType = ""ArubaCx-UserAdded"" |
| Crowdstrike: Machine Learning Anomaly Detected | Security | Crowdstrike agent detected machine learning based anomaly at a host | Crowdstrike: Machine Learning Anomaly Detected | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Machine-Learning"" |
| Azure Automation Webhook Created | Security | Identifies when an Azure Automation webhook is created. Azure Automation runbooks can be configured to execute via a webhook. A webhook uses a custom URL passed to Azure Automation along with a data payload specific to the runbook. An adversary may create a webhook in order to trigger a runbook that contains malicious code. | Azure Automation Webhook Created | eventType IN (""MS_EvtHub_automation_automationaccounts_webhooks_write"",""MS_EvtHub_automation_automationaccounts_webhooks_action"") |
| Crowdstrike: Exploit Pivot | Security | Crowdstrike agent detected post-exploit behavior at a host | Crowdstrike: Exploit Pivot | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Exploit-Pivot"" |
| Crowdstrike: Server Compromise Likely | Security | Crowdstrike agent detected likely server compromise involving suspiciously behaving processes | Crowdstrike: Server Compromise Likely | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Server-Compromise"" |
| Noncritical Network Device Interface Staying Down | Disponibilidade | Detects that a non-critical interface of a network device is staying down - that is didn't come up within 5 minutes of going down | Noncritical Network Device Interface Staying Down | eventType IN (Group@PH_SYS_EVENT_NetIntfShutdown) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND isHostIntfCritical = ""No"" |
| Crowdstrike: Excessive suspicious activity on a host | Security | detects more than 5 Crowdstrike suspicious activites at a host in 10 minutes | Crowdstrike: Excessive suspicious activity on a host | eventType CONTAIN ""Crowdstrike-Falcon-DetectionSummaryEvent-"" |
| Crowdstrike: NextGen Antivirus based Malware | Security | Crowdstrike agent detected ,alware based on NextGen Anti-virus techniques | Crowdstrike: NextGen Antivirus based Malware | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-NGAV"" |
| Linux User Deleted from Admin Groups | Change | Detects Linux user deleted from Administrative Groups | Linux User Deleted from Admin Groups | eventType CONTAIN ""Generic_Unix_User_Del_Group"" AND targetUserGrp IN (""root"", ""sudo"") |
| FireEye HX IOC found | Security | FireEye Mandiant Agent found indicators of comporomise on a host | FireEye HX IOC found | eventType = ""FireEye-HX_IOC_Hit_Found"" |
| FireAMP Malicious file execution | Security | FireAMP detects that an application downloaded and executed malicious executable or general threats | FireAMP Malicious file execution | eventType IN (Group@PH_SYS_EVENT_Compromised) AND eventType CONTAIN ""FireAMP_"" |
| Domain Controller User or Group Modification | Change | Detects user/group configuration in a domain controller. This rule would trigger on all changes made by any person. To prevent false positives, a restriction on the user attribute should be made by excluding the domain administrators. | Domain Controller User or Group Modification | reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER) AND eventType IN ( Group@PH_SYS_EVENT_AccountChanged) |
| Linux Account Unlocked | Change | Detects Linux user account unlocked | Linux Account Unlocked | eventType = ""Generic_Unix_User_Account_Unlocked"" |
| Google Workspace: Role Created by User | Change | Google Workspace: Role Created by Admin User | Google Workspace: Role Created by User | eventType = ""Google_Apps_DELEGATED_ADMIN_SETTINGS_CREATE_ROLE"" |
| GCP: Service Account Access Key Created | Change | Google Cloud Platform: A Service Account Access Key was created. These are used to programmatically authenticate using this service accounts permissions. | GCP: Service Account Access Key Created | eventType = ""GCP_Audit_activity_CreateServiceAccountKey"" |
| FortiGate: Admin User Added | Change | FortiOS Admin has created a new admin user account. This triggers due to account creations under System Administrators tab. | FortiGate: Admin User Added | eventType = ""FortiGate-event-admin-add"" |
| Database user or group changes | Change | Detects database user or group changes | Database user or group changes | eventType IN (Group@PH_SYS_EVENT_DatabaseChange) AND eventType CONTAIN ""user"" |
| GCP: IAM Member assigned role of type admin or owner | Change | Google Cloud Platform: A member is assigned the Admin role. This can be in addition to or in replacement of existing roles. | GCP: IAM Member assigned role of type admin or owner | eventType = ""GCP_Audit_activity_SetIamPolicy_ADD"" AND ( role CONTAIN ""Admin"" OR role = ""roles/owner"" ) |
| Cylance Low Severity Threat | Security | This rule detects a low severity Cylance alert | Cylance Low Severity Threat | eventType = ""CylanceProtect-Threat-threat_found"" AND threatScore BETWEEN (0,44) |
| Google Workspace: Role Modified by User | Change | Google Workspace: Role Modified by Admin User | Google Workspace: Role Modified by User | eventType = ""Google_Apps_DELEGATED_ADMIN_SETTINGS_ADD_PRIVILEGE"" |
| Crowdstrike: Suspicious Processes Terminated | Security | Crowdstrike agent terminated suspicious processes on a host | Crowdstrike: Suspicious Processes Terminated | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Process-Terminated"" |
| FortiSIEM User Created | Change | A FortiSIEM user is created | FortiSIEM User Created | eventType = ""PH_AUDIT_USER_ADDED"" |
| Google Workspace: API Access Permitted for OAUTH Client | Change | Google Workspace: API Access Permitted for OAUTH Client. | Google Workspace: API Access Permitted for OAUTH Client | eventType = ""Google_Apps_DOMAIN_SETTINGS_AUTHORIZE_API_CLIENT_ACCESS"" |
| GCP: Service Account Created | Change | Google Cloud Platform: A Service Account was Created | GCP: Service Account Created | eventType = ""GCP_Audit_activity_CreateServiceAccount"" |
| Linux User Account Properties Changed | Change | Detects Linux user account properties changed on a server. This includes home, shell, UID, GID and password expiry | Linux User Account Properties Changed | eventType CONTAIN ""Generic_Unix_User_Change"" AND eventType != ""Generic_Unix_User_Change_Name"" |
| Linux User Added to Groups | Change | Detects Linux user added to Groups | Linux User Added to Groups | eventType = ""Generic_Unix_User_Add_Group"" AND targetUserGrp NOT IN (""root"", ""sudo"") |
| Linux User Added to Administrative Groups | Change | Detects Linux user added to Administrative Groups | Linux User Added to Administrative Groups | eventType = ""Generic_Unix_User_Add_Group"" AND targetUserGrp IN (""root"", ""sudo"") |
| Linux User Created | Change | Detects Linux user account being created on a server | Linux User Created | eventType =""Generic_Unix_User_Add"" |
| Crowdstrike: Suspicious Activity | Security | Crowdstrike agent detected suspicious activity | Crowdstrike: Suspicious Activity | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Suspicious-Activity"" |
| Cylance Medium Severity Threat | Security | This rule detects a medium severity Cylance alert | Cylance Medium Severity Threat | eventType = ""CylanceProtect-Threat-threat_found"" AND threatScore BETWEEN (45,69) |
| Linux User Deleted from Groups | Change | Detects Linux user deleted from Groups | Linux User Deleted from Groups | eventType = ""Generic_Unix_User_Del_Group"" AND targetUserGrp NOT IN (""root"", ""sudo"") |
| Linux User Deleted | Change | Detects Linux user account being deleted on a server | Linux User Deleted | eventType =""Generic_Unix_User_Del"" |
| Cylance High Severity Threat | Security | This rule detects a high severity Cylance alert | Cylance High Severity Threat | eventType = ""CylanceProtect-Threat-threat_found"" AND threatScore >= 70 |
| GCP: IAM Custom Role Created | Change | Google Cloud Platform: A Custom IAM Role was created | GCP: IAM Custom Role Created | eventType = ""GCP_Audit_activity_CreateRole"" |
| Google Workspace: Role Assigned to User | Change | Google Workspace: Role Assigned to User. | Google Workspace: Role Assigned to User | eventType = ""Google_Apps_DELEGATED_ADMIN_SETTINGS_ASSIGN_ROLE"" |
| Oracle OCI: User Disabled MFA | Security | Oracle OCI User Disabled MFA for a device. | Oracle OCI: User Disabled MFA | eventType = ""Oracle-OCI-identitycontrolplane-deletemfatotpdevice"" |
| Linux: Modifications of .bash-profile and .bashrc | Security | Detect modification of .bash_profile and .bashrc files for persistent commands | Linux: Modifications of .bash-profile and .bashrc | eventType = ""FSM_LINUX_FILE_MODIFY"" AND (targetOsObjName REGEXP ""\.bash_profile|\.bashrc"") |
| Oracle OCI: Customer Secret Key Created | Security | Oracle OCI customer secret key was created. Admin users can create keys for other users, and some users are allowed to create keys for themselves. So the user and target user id may not always refer to the same account. | Oracle OCI: Customer Secret Key Created | eventType = ""Oracle-OCI-identitycontrolplane-createcustomersecretkey"" |
| Oracle OCI: User API Key Created and Uploaded | Security | Oracle OCI API key was created. Admin users can create keys, tokens, and credentials for other users, and some users are allowed to create these themselves. So the user and target user id may not always refer to the same account. API keys can be manually uploaded by users, or dynamically generated, but the event is the same. | Oracle OCI: User API Key Created and Uploaded | eventType = ""Oracle-OCI-identitycontrolplane-uploadapikey"" |
| MS 365 Defender: Suspicious Activity Detected | Security | Windows Defender Advanced Threat Protection detected suspicious activity | MS 365 Defender: Suspicious Activity Detected | eventType = ""Microsoft-WinDefATP-Alert-SuspiciousActivity"" |
| MS 365 Defender: Persistence Detected | Security | Windows Defender Advanced Threat Protection detected persistence | MS 365 Defender: Persistence Detected | eventType = ""Microsoft-WinDefATP-Alert-Persistence"" |
| Linux: Creation or Modification of Systemd Service | Security | Systemd services can be used to establish persistence on a Linux system. The systemd service manager is commonly used for managing background daemon processes (also known as services) and other system resources. | Linux: Creation or Modification of Systemd Service | eventType != ""FSM_LINUX_FILE_DELETE"" AND targetOsObjName CONTAIN "".service"" AND targetOsObjName REGEXP (""/etc/systemd/system/.*|/usr/lib/systemd/system/.*"") |
| Meraki New Splash User | Security | Meraki detects a new splash user registers to an SSID | Meraki New Splash User | eventType = ""Cisco-Meraki-newSplashSignup"" |
| User added to Administrator Group | Change | Detects users added to administrator group | User added to Administrator Group | reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) AND eventType IN (Group@PH_SYS_EVENT_GroupMemberAdded) AND targetUserGrp = ""Administrators"" |
| Linux: Potential Shell via Web Server | Security | Identifies suspicious commands executed via a web server, which may suggest a vulnerability and remote shell access This requires process monitoring via FortiSIEM Linux agent. | Linux: Potential Shell via Web Server | eventType = ""LINUX_PROCESS_EXEC"" AND procName IN (""bash"", ""dash"") AND user IN (""apache"",""nginx"",""www"",""www-data"") |
| Linux: Kernel Module Modification | Security | Identifies loadable kernel module modification, which may indicate indicative of potential persistence attempts. Security tools and device drivers may run these programs in order to load legitimate kernel modules. Use of these programs by ordinary users is uncommon. This requires process monitoring via FortiSIEM Linux agent. | Linux: Kernel Module Modification | eventType = ""LINUX_PROCESS_EXEC"" AND procName IN (""insmod"", ""kmod"", ""modprobe"", ""rmod"") |
| MS 365 Defender: Suspicious Task Scheduler activity - Persistence Alert | Security | Suspicious Task Scheduler activity - Persistence Alert from MS 365 Defender | MS 365 Defender: Suspicious Task Scheduler activity - Persistence Alert | (eventType = ""MS-Defender-Endpoint-Alert-Persistence"" OR eventType CONTAIN ""M365Defender-Alert"") AND attackTechniqueId = ""T1053"" |
| Linux: Creation of Kernel Module | Security | Detects activities related to loading kernel modules on Linux via creation of new ko files in the LKM directory | Linux: Creation of Kernel Module | eventType = ""FSM_LINUX_FILE_CREATE"" AND targetOsObjName REGEXP ""/lib/modules/.*"" AND targetOsObjName REGEXP "".*\.ko"" |
| Malware found by firewall but not remediated | Security | Detects that firewall content inspection devices found a virus but could not remediate it | Malware found by firewall but not remediated | eventType CONTAIN ""FortiGate-ips-signature"" AND eventType IN (Group@PH_SYS_EVENT_Worm_Remedy_Failed,Group@PH_SYS_EVENT_Worm_Found) AND fwAction NOT IN (""block"",""blocked"",""deny"",""dropped"") |
| Linux User Password Changed | Change | Detects Linux user password changed on a server | Linux User Password Changed | eventType = ""Generic_Unix_User_Password_Change"" |
| Oracle OCI: Group Created | Security | Oracle OCI group was created | Oracle OCI: Group Created | eventType = ""Oracle-OCI-identitycontrolplane-creategroup"" |
| Oracle OCI: User OAuth Client Credential Created | Security | Oracle OCI OAuth client credential was created. Admin users can create keys, tokens, and credentials for other users, and some users are allowed to create these themselves. So the user and target user id may not always refer to the same account. | Oracle OCI: User OAuth Client Credential Created | eventType = ""Oracle-OCI-identitycontrolplane-createoauthclientcredential"" |
| Oracle OCI: User Created | Security | Oracle OCI user was created | Oracle OCI: User Created | eventType IN (""Oracle-OCI-identitycontrolplane-createuser"",""Oracle-OCI-identitycontrolplane-createidpuser"") |
| Rootkit found | Security | Detects that host anti-virus or content inspection devices found a rootkit that it failed to remediate | Rootkit found | eventType IN (Group@PH_SYS_EVENT_Rootkit_Found) |
| Linux: Scheduled Job Execution | Security | Detects attempt to create pre-scheduled and periodic background jobs on Linux systems by launching crond or launchd | Linux: Scheduled Job Execution | eventType = ""LINUX_PROCESS_EXEC"" AND procName IN (""at"",""cron"",""launchd"") |
| Oracle OCI: User Added to a Group | Security | Oracle OCI user was added to a group | Oracle OCI: User Added to a Group | eventType = ""Oracle-OCI-identitycontrolplane-addusertogroup"" |
| User added to Backup Operator Group | Change | Detects users added to backup operator group | User added to Backup Operator Group | reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) AND eventType IN (Group@PH_SYS_EVENT_GroupMemberAdded) AND targetUserGrp = ""Backup Operators"" |
| MS 365 Defender: Unwanted Software Detected | Security | Windows Defender Advanced Threat Protection detected unwanted software | MS 365 Defender: Unwanted Software Detected | eventType = ""Microsoft-WinDefATP-Alert-UnwantedSoftware"" |
| Oracle OCI: User Auth Token Created | Security | Oracle OCI Auth token was created. Admin users can create keys, tokens, and credentials for other users, and some users are allowed to create these themselves. So the user and target user id may not always refer to the same account. | Oracle OCI: User Auth Token Created | eventType = ""Oracle-OCI-identitycontrolplane-createauthtoken"" |
| Linux User Name Changed | Change | Detects Linux user account name changed on a server | Linux User Name Changed | eventType = ""Generic_Unix_User_Change_Name"" |
| Malware found by firewall but not remediated | Security | Detects that firewall content inspection devices found a virus but could not remediate it | Malware found by firewall but not remediated | eventType IN (Group@PH_SYS_EVENT_Worm_Remedy_Failed,Group@PH_SYS_EVENT_Worm_Found) AND eventType NOT CONTAIN ""FortiGate-ips-signature"" AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL,Group@PH_SYS_DEVICE_NETWORK_IPS) AND fwAction NOT IN (""block"",""blocked"",""deny"",""dropped"") |
| Linux: Job Schedule Modification | Security | Detects attempt to create pre-scheduled and periodic background jobs on Linux systems by modifying crontab files | Linux: Job Schedule Modification | eventType REGEXP ""FSM_LINUX_FILE_.*"" AND targetOsObjName REGEXP "".*LaunchDaemons.*|/etc/cron\.d|/etc/crontab"" |
| Windows User Deleted | Change | Detects Windows user account being deleted on a server | Windows User Deleted | eventType =""Win-Security-4726"" |
| User added to Domain Admin Group | Change | Detects users added to domain admin group | User added to Domain Admin Group | reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER) AND eventType IN (Group@PH_SYS_EVENT_GroupMemberAdded) AND targetUserGrp = ""Domain Admins"" |
| Windows User Account Name Changed | Change | Detects Windows user account name changed on a server | Windows User Account Name Changed | eventType = ""Win-Security-4781"" |
| Windows User Password Changed | Change | Detects Windows user password changed on a server | Windows User Password Changed | eventType IN (""Win-Security-4723"", ""Win-Security-4724"") |
| Windows Groups Changed | Change | Detects Security or Distribution Groups Changed | Windows Groups Changed | eventType CONTAIN ""Win-Security"" AND eventType IN (Group@PH_SYS_EVENT_GroupChanged) |
| Windows: Abused Debug Privilege by Arbitrary Parent Processes | Security | Detection of unusual child processes by different system processes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_abusing_debug_privilege.yml | Windows: Abused Debug Privilege by Arbitrary Parent Processes | eventType=""Win-Sysmon-1-Create-Process"" AND ((parentProcName REGEXP "".*\\csrss\.exe|.*\\lsass\.exe|.*\\searchindexer\.exe|.*\\services\.exe|.*\\smss\.exe|.*\\spoolsv\.exe|.*\\wininit\.exe|.*\\winlogon\.exe"" AND user REGEXP "".*AUTHORI.*|.*AUTORI.*"") AND (procName REGEXP "".*\\cmd\.exe|.*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""Cmd.Exe"",""PowerShell.EXE"",""pwsh.dll""))) AND (command NOT REGEXP "".* route .*"" OR command NOT REGEXP "".* ADD .*"") |
| Windows: Active Directory Structure Export Via Csvde.EXE | Security | Detects the execution of ""csvde.exe"" in order to export organizational Active Directory structure. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_csvde_export.yml | Windows: Active Directory Structure Export Via Csvde.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\csvde\.exe"" OR srcFileName=""csvde.exe"") AND command REGEXP "".* -f.*"") AND ((command NOT REGEXP "".* -i.*"")) |
| Windows User Account Properties Changed | Change | Detects Windows user account properties changed on a server | Windows User Account Properties Changed | eventType = ""Win-Security-4738"" |
| Windows Account Unlocked | Change | Detects Windows user account unlocked | Windows Account Unlocked | eventType = ""Win-Security-4767"" |
| User added to Remote Desktop User Group | Change | Detects users added to remote desktop user group | User added to Remote Desktop User Group | reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) AND eventType IN (Group@PH_SYS_EVENT_GroupMemberAdded) AND targetUserGrp = ""Remote Desktop Users"" |
| Windows: Account Tampering - Suspicious Failed Logon Reasons | Security | This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_failed_logon_reasons.yml | Windows: Account Tampering - Suspicious Failed Logon Reasons | (eventType IN (""Win-Security-4625"",""Win-Security-4776"") AND winLogonFailCode2 IN (""0xC000006F"",""0xC0000070"",""0xC0000072"",""0xC000015B"",""0xC000018C"",""0xC0000413"")) AND (securityId!=""S-1-0-0"") |
| Windows: AADInternals PowerShell Cmdlets Execution - ProccessCreation | Security | Detects AADInternals Cmdlet execution. A tool for administering Azure AD and Office 365. Which can be abused by threat actors to attack Azure AD or Office 365. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_aadinternals_cmdlets_execution.yml | Windows: AADInternals PowerShell Cmdlets Execution - ProccessCreation | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.Exe"",""pwsh.dll"")) AND command REGEXP "".*Add-AADInt.*|.*ConvertTo-AADInt.*|.*Disable-AADInt.*|.*Enable-AADInt.*|.*Export-AADInt.*|.*Get-AADInt.*|.*Grant-AADInt.*|.*Install-AADInt.*|.*Invoke-AADInt.*|.*Join-AADInt.*|.*New-AADInt.*|.*Open-AADInt.*|.*Read-AADInt.*|.*Register-AADInt.*|.*Remove-AADInt.*|.*Restore-AADInt.*|.*Search-AADInt.*|.*Send-AADInt.*|.*Set-AADInt.*|.*Start-AADInt.*|.*Update-AADInt.*"" |
| Windows User Removed from Groups | Change | Detects Windows user removed from Security or Distribution Groups | Windows User Removed from Groups | eventType CONTAIN ""Win-Security"" AND eventType IN (Group@PH_SYS_EVENT_GroupMemberRemoved) |
| Windows: A Security-Enabled Global Group Was Deleted | Security | Detects activity when a security-enabled global group is deleted. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_security_enabled_global_group_deleted.yml | Windows: A Security-Enabled Global Group Was Deleted | eventType IN (""Win-Security-4730"",""Win-Security-634"") |
| Windows: A Member Was Added to a Security-Enabled Global Group | Security | Detects activity when a member is added to a security-enabled global group. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_member_added_security_enabled_global_group.yml | Windows: A Member Was Added to a Security-Enabled Global Group | eventType IN (""Win-Security-4728"",""Win-Security-632"") |
| Windows User Added to Groups | Change | Detects Windows user added to Security or Distribution Groups | Windows User Added to Groups | eventType CONTAIN ""Win-Security"" AND eventType IN (Group@PH_SYS_EVENT_GroupMemberAdded) |
| Windows User Account Enabled | Change | Detects Windows user account enabled on a server | Windows User Account Enabled | eventType = ""Win-Security-4722"" |
| Windows Groups Created | Change | Detects Security or Distribution Groups Created | Windows Groups Created | eventType CONTAIN ""Win-Security"" AND eventType IN (Group@PH_SYS_EVENT_GroupCreated) |
| User added to DNS Admin Group | Change | Detects users added to DNS Admin group | User added to DNS Admin Group | reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER) AND eventType IN (Group@PH_SYS_EVENT_GroupMemberAdded) AND targetUserGrp = ""DnsAdmins"" |
| Windows: A Rule Has Been Deleted From The Windows Firewall Exception List | Security | Detects when a single rules or all of the rules have been deleted from the Windows Defender Firewall. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/firewall_as/win_firewall_as_delete_rule.yml | Windows: A Rule Has Been Deleted From The Windows Firewall Exception List | (eventType REGEXP ""Win-.*-2006[^\d]*|Win-.*-2052[^\d]*"" AND ((appName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"") AND (appName!=""C:\\Windows\\System32\\svchost.exe""))) AND ((appName NOT REGEXP ""C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\.*"" OR appName NOT REGEXP "".*\\MsMpEng\.exe"")) |
| Windows: Active Directory Structure Export Via Ldifde.EXE | Security | Detects the execution of ""ldifde.exe"" in order to export organizational Active Directory structure. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ldifde_export.yml | Windows: Active Directory Structure Export Via Ldifde.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\ldifde\.exe"" OR srcFileName=""ldifde.exe"") AND command REGEXP "".*-f.*"") AND ((command NOT REGEXP "".* -i.*"")) |
| Windows: Abusing IEExec To Download Payloads | Security | Detects execution of the IEExec utility to download payloads. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_ieexec_download.yml | Windows: Abusing IEExec To Download Payloads | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\IEExec\.exe"" OR srcFileName=""IEExec.exe"") AND command REGEXP "".*http://.*|.*https://.*"" |
| Windows: Abusing Print Executable | Security | Attackers can use print.exe for remote file copy. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_print_remote_file_copy.yml | Windows: Abusing Print Executable | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\print\.exe"" AND command REGEXP ""print.*"" AND command REGEXP "".*/D.*"" AND command REGEXP "".*\.exe.*"") AND (command NOT REGEXP "".*print\.exe.*"") |
| Windows: A Member Was Removed From a Security-Enabled Global Group | Security | Detects activity when a member is removed from a security-enabled global group. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_member_removed_security_enabled_global_group.yml | Windows: A Member Was Removed From a Security-Enabled Global Group | eventType IN (""Win-Security-4729"",""Win-Security-633"") |
| Windows User Created | Change | Detects Windows user account being created on a server | Windows User Created | eventType =""Win-Security-4720"" |
| Windows User Account Disabled | Change | Detects Windows user account disabled on a server | Windows User Account Disabled | eventType = ""Win-Security-4725"" |
| Windows Groups Deleted | Change | Detects Security or Distribution Groups Deleted | Windows Groups Deleted | eventType CONTAIN ""Win-Security"" AND eventType IN (Group@PH_SYS_EVENT_GroupDeleted) |
| Windows: Anydesk Remote Access Software Service Installation | Security | Detects the installation of the anydesk software service. Which could be an indication of anydesk abuse if you the software isn't already used. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_install_anydesk.yml | Windows: Anydesk Remote Access Software Service Installation | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceName=""AnyDesk Service"" |
| Windows: Capture Credentials with Rpcping.exe | Security | Detects using Rpcping.exe to send a RPC test connection to the target server (-s) and force the NTLM hash to be sent in the process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rpcping_credential_capture.yml | Windows: Capture Credentials with Rpcping.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rpcping\.exe"" AND command REGEXP "".*-s.*|.*/s.*"") AND ((command REGEXP "".*-u.*"" AND command REGEXP "".*NTLM.*"") OR (command REGEXP "".*/u.*"" AND command REGEXP "".*NTLM.*"") OR (command REGEXP "".*-t.*"" AND command REGEXP "".*ncacn_np.*"") OR (command REGEXP "".*/t.*"" AND command REGEXP "".*ncacn_np.*"")) |
| Windows: AWL Bypass with Winrm.vbs and WsmPty.xsl/WsmTxt.xsl: Sysmon | Security | Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via winrm.vbs and copied cscript.exe (can be renamed). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_winrm_awl_bypass.yml | Windows: AWL Bypass with Winrm.vbs and WsmPty.xsl/WsmTxt.xsl: Sysmon | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*WsmPty\.xsl|.*WsmTxt\.xsl"" AND (fileName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*"") |
| Windows: Application Whitelisting Bypass via Dxcap.exe | Security | Detects execution of of Dxcap.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_susp_dxcap.yml | Windows: Application Whitelisting Bypass via Dxcap.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\DXCap\.exe"" OR srcFileName=""DXCap.exe"") AND command REGEXP "".* -c .*"" |
| Windows: Add or Remove Computer from DC | Security | Detects the creation or removal of a computer. Can be used to detect attacks such as DCShadow via the creation of a new SPN. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_add_remove_computer.yml | Windows: Add or Remove Computer from DC | eventType IN (""Win-Security-4741"",""Win-Security-4743"") |
| Windows: ADCS Certificate Template Configuration Vulnerability | Security | Detects certificate creation with template allowing risk permission subject. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_adcs_certificate_template_configuration_vulnerability.yml | Windows: ADCS Certificate Template Configuration Vulnerability | (eventType=""Win-Security-4898"" AND templateContent REGEXP "".*CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT.*"") OR (eventType=""Win-Security-4899"" AND newTemplateContent REGEXP "".*CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT.*"") |
| Windows: Base64 MZ Header In CommandLine | Security | Detects encoded base64 MZ header in the commandline. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_inline_base64_mz_header.yml | Windows: Base64 MZ Header In CommandLine | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*TVoAAAAAAAAAAAAA.*|.*TVpQAAIAAAAEAA8A.*|.*TVpTAQEAAAAEAAAA.*|.*TVqAAAEAAAAEABAA.*|.*TVqQAAMAAAAEAAAA.*"" |
| Windows: Atbroker Registry Change | Security | Detects creation/modification of Assistive Technology applications and persistence with usage of 'at'. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_susp_atbroker_change.yml | Windows: Atbroker Registry Change | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*Software\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\ATs.*|.*Software\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\Configuration.*"" AND ((procName!=""C:\\Windows\\system32\\atbroker.exe"" OR regKeyPath NOT REGEXP "".*\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\Configuration.*"" OR details!=""(Empty)"") AND (procName NOT REGEXP ""C:\\Windows\\Installer\\MSI.*"" OR regKeyPath NOT REGEXP "".*Software\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\ATs.*"")) |
| Windows: ADCS Certificate Template Configuration Vulnerability with Risky EKU | Security | Detects certificate creation with template allowing risk permission subject and risky EKU. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_adcs_certificate_template_configuration_vulnerability_eku.yml | Windows: ADCS Certificate Template Configuration Vulnerability with Risky EKU | (eventType=""Win-Security-4898"" AND templateContent REGEXP "".*1\.3\.6\.1\.4\.1\.311\.20\.2\.2.*|.*1\.3\.6\.1\.5\.2\.3\.4.*|.*1\.3\.6\.1\.5\.5\.7\.3\.2.*|.*2\.5\.29\.37\.0.*"" AND templateContent REGEXP "".*CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT.*"") OR (eventType=""Win-Security-4899"" AND newTemplateContent REGEXP "".*1\.3\.6\.1\.4\.1\.311\.20\.2\.2.*|.*1\.3\.6\.1\.5\.2\.3\.4.*|.*1\.3\.6\.1\.5\.5\.7\.3\.2.*|.*2\.5\.29\.37\.0.*"" AND newTemplateContent REGEXP "".*CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT.*"") |
| Windows: AgentExecutor PowerShell Execution | Security | Detects execution of the AgentExecutor.exe binary. Which can be abused as a LOLBIN to execute powershell scripts with the ExecutionPolicy ""Bypass"" or any binary named ""powershell.exe"" located in the path provided by 6th positional argument. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_agentexecutor.yml | Windows: AgentExecutor PowerShell Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName=""\\AgentExecutor.exe"" OR srcFileName=""AgentExecutor.exe"") AND command REGEXP "".* -powershell.*|.* -remediationScript.*"" |
| Windows: Allow Service Access Using Security Descriptor Tampering Via Sc.EXE | Security | Detects suspicious DACL modifications to allow access to a service from a suspicious trustee. This can be used to override access restrictions set by previous ACLs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_sdset_allow_service_changes.yml | Windows: Allow Service Access Using Security Descriptor Tampering Via Sc.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\sc\.exe"" OR srcFileName=""sc.exe"") AND (command REGEXP "".*sdset.*"" AND command REGEXP "".*A;.*"") AND command REGEXP "".*;BA.*|.*;IU.*|.*;SU.*|.*;SY.*|.*;WD.*"" |
| Windows: AWL Bypass with Winrm.vbs and WsmPty.xsl/WsmTxt.xsl: Sysmon2 | Security | Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via winrm.vbs and copied cscript.exe (can be renamed). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_winrm_awl_bypass.yml | Windows: AWL Bypass with Winrm.vbs and WsmPty.xsl/WsmTxt.xsl: Sysmon2 | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*winrm.*"" AND command REGEXP "".*format:\""pretty\"".*|.*format:\""text\"".*|.*format:pretty.*|.*format:text.*"" AND (procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*"") |
| Windows: Add Potential Suspicious New Download Source To Winget | Security | Detects usage of winget to add new potentially suspicious download sources. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_winget_add_susp_custom_source.yml | Windows: Add Potential Suspicious New Download Source To Winget | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\winget\.exe"" OR srcFileName=""winget.exe"") AND (command REGEXP "".*source .*"" AND command REGEXP "".*add .*"") |
| Windows: Chafer Activity: Sysmon2 | Security | Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_apt_chafer_mar18.yml | Windows: Chafer Activity: Sysmon2 | ( eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*\\Service\.exe i|.*\\Service\.exe u|.*\\microsoft\\Taskbar\\autoit3\.exe|C:\\wsc\.exe.*"" OR procName REGEXP "".*\\Windows\\Temp\\DB\\.*\.exe"" OR (command REGEXP "".*\\nslookup\.exe -q=TXT.*"" AND parentProcName REGEXP "".*\\Autoit.*""))) OR (eventType=""Win-System-Service-Control-Manager-7045"" AND serviceName IN (""SC Scheduled Scan"",""UpdatMachine"")) |
| Windows: Add Windows Capability Via PowerShell Cmdlet | Security | Detects usage of the ""Add-WindowsCapability"" cmdlet to add Windows capabilities. Notable capabilities could be ""OpenSSH"" and others. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_add_windows_capability.yml | Windows: Add Windows Capability Via PowerShell Cmdlet | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".*Add-WindowsCapability.*"" AND command REGEXP "".*OpenSSH\..*"" |
| Windows: Add Insecure Download Source To Winget | Security | Detects usage of winget to add a new insecure (http) download source. Winget will not allow the addition of insecure sources, hence this could indicate potential suspicious activity (or typos) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_winget_add_insecure_custom_source.yml | Windows: Add Insecure Download Source To Winget | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\winget\.exe"" OR srcFileName=""winget.exe"") AND (command REGEXP "".*source .*"" AND command REGEXP "".*add .*"" AND command REGEXP "".*http://.*"") |
| Windows: All Rules Have Been Deleted From The Windows Firewall Configuration | Security | Detects when a all the rules have been deleted from the Windows Defender Firewall configuration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/firewall_as/win_firewall_as_delete_all_rules.yml | Windows: All Rules Have Been Deleted From The Windows Firewall Configuration | (eventType REGEXP ""Win-.*-2033[^\d]*|Win-.*-2059[^\d]*"" AND ((appName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"") AND (appName!=""C:\\Windows\\System32\\svchost.exe""))) AND ((appName NOT REGEXP ""C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\.*"" OR appName NOT REGEXP "".*\\MsMpEng\.exe"")) |
| Windows: Certificate Exported Via Certutil.EXE | Security | Detects the execution of the certutil with the ""exportPFX"" flag which allows the utility to export certificates. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_certutil_export_pfx.yml | Windows: Certificate Exported Via Certutil.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\certutil\.exe"" OR srcFileName=""CertUtil.exe"") AND command REGEXP "".*-exportPFX .*|.*/exportPFX .*"" |
| Windows: Add New Download Source To Winget | Security | Detects usage of winget to add new additional download sources. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_winget_add_custom_source.yml | Windows: Add New Download Source To Winget | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\winget\.exe"" OR srcFileName=""winget.exe"") AND (command REGEXP "".*source .*"" AND command REGEXP "".*add .*"") |
| Windows: Arbitrary File Download Via MSPUB.EXE | Security | Detects usage of ""MSPUB"" (Microsoft Publisher) to download arbitrary files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_mspub_download.yml | Windows: Arbitrary File Download Via MSPUB.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\MSPUB\.exe"" OR srcFileName=""MSPUB.exe"") AND command REGEXP "".*ftp://.*|.*http://.*|.*https://.*"" |
| Windows: Block Load Of Revoked Driver | Security | Detects blocked load attempts of revoked drivers. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/code_integrity/win_codeintegrity_revoked_driver.yml | Windows: Block Load Of Revoked Driver | eventType =""Win-CodeIntegrity-Operational-3023"" |
| Windows: Application Whitelisting Bypass via PresentationHost.exe | Security | Detects usage of ""PresentationHost"" which is a utility that runs "".xbap"" (Browser Applications) files. It can be abused to run malicious "".xbap"" files any bypass AWL. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_presentationhost.yml | Windows: Application Whitelisting Bypass via PresentationHost.exe | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\presentationhost\.exe"" OR srcFileName=""PresentationHost.exe"") AND command REGEXP "".*\.xbap.*"") AND (command NOT REGEXP "".*C:\\Program Files.*|.*C:\\Windows\\.*"") |
| Windows: Active Directory User Backdoors | Security | Detects scenarios where one can control another users or computers account without having to use their credentials. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_alert_ad_user_backdoors.yml | Windows: Active Directory User Backdoors | (eventType=""Win-Security-4738"") OR (eventType=""Win-Security-5136"" AND (propName=""msDS-AllowedToDelegateTo"" OR (osObjType=""user"" AND propName=""servicePrincipalName"") OR propName=""msDS-AllowedToActOnBehalfOfOtherIdentity"")) |
| Windows: Add User to Local Administrators Group | Security | Detects suspicious command line that adds an account to the local administrators/administrateurs group. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_add_user_local_admin_group.yml | Windows: Add User to Local Administrators Group | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*localgroup .*"" AND command REGEXP "".* /add.*"") OR (command REGEXP "".*Add-LocalGroupMember .*"" AND command REGEXP "".* -Group .*"")) AND command REGEXP "".* administrateur.*|.* administrators .*"" |
| Windows: Arbitrary Binary Execution Using GUP Utility | Security | Detects execution of the Notepad++ updater (gup) to launch other commands or executables. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_gup_arbitrary_binary_execution.yml | Windows: Arbitrary Binary Execution Using GUP Utility | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\gup\.exe"" AND procName REGEXP "".*\\explorer\.exe"") AND ((procName NOT REGEXP "".*\\explorer\.exe"" OR command NOT REGEXP "".*\\Notepad\+\+\\notepad\+\+\.exe.*"") AND (parentProcName NOT REGEXP "".*\\Notepad\+\+\\updater\\.*"") AND (command IS NOT NULL)) |
| Windows: Arbitrary MSI Download Via Devinit.EXE | Security | Detects a certain command line flag combination used by ""devinit.exe"", which can be abused as a LOLBIN to download arbitrary MSI packages on a Windows system. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_devinit_lolbin_usage.yml | Windows: Arbitrary MSI Download Via Devinit.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* -t msi-install .*"" AND command REGEXP "".* -i http.*"" |
| Windows: Enabled User Right in AD to Control User Objects | Security | Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_alert_active_directory_user_control.yml | Windows: Enabled User Right in AD to Control User Objects | eventType=""Win-Security-4704"" AND privName REGEXP "".*SeEnableDelegationPrivilege.*"" |
| Windows: Deployment Of The AppX Package Was Blocked By The Policy | Security | Detects an appx package deployment that was blocked by the local computer policy. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_policy_block.yml | Windows: Deployment Of The AppX Package Was Blocked By The Policy | eventType IN (""Win-AppXDeployment-Server-441"", ""Win-AppXDeployment-Server-442"", ""Win-AppXDeployment-Server-453"", ""Win-AppXDeployment-Server-454"") |
| Windows: Detected Windows Software Discovery | Security | Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_software_discovery.yml | Windows: Detected Windows Software Discovery | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\reg\.exe"" AND command REGEXP "".*query.*"" AND command REGEXP "".*\\software\\.*"" AND command REGEXP "".*/v.*"" AND command REGEXP "".*svcversion.*"" |
| Windows: DumpStack.log Defender Evasion | Security | Detects the use of the filename DumpStack.log to evade Microsoft Defender. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_dumpstack_log_evasion.yml | Windows: DumpStack.log Defender Evasion | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\DumpStack\.log"" OR command REGEXP "".* -o DumpStack\.log.*"") |
| Windows: Drop Binaries Into Spool Drivers Color Folder | Security | Detects the creation of suspcious binary files inside the ""\windows\system32\spool\drivers\color\"" as seen in the blog referenced below. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_spool_drivers_color_drop.yml | Windows: Drop Binaries Into Spool Drivers Color Folder | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP ""C:\\Windows\\System32\\spool\\drivers\\color\\.*"" AND fileName REGEXP "".*\.dll|.*\.exe|.*\.sys"" |
| Windows: Console CodePage Lookup Via CHCP | Security | Detects use of chcp to look up the system locale value as part of host discovery. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_chcp_codepage_lookup.yml | Windows: Console CodePage Lookup Via CHCP | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\cmd\.exe"" AND parentCommand REGEXP "".* /c .*|.* /k .*|.* /r .*"" AND procName REGEXP "".*\\chcp\.com"" AND command REGEXP "".*chcp |.*chcp |.*chcp"" |
| Windows: Conhost Spawned By Uncommon Parent Process | Security | Detects when the Console Window Host (conhost.exe) process is spawned by an uncommon parent process, which could be indicative of potential code injection activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_conhost_uncommon_parent.yml | Windows: Conhost Spawned By Uncommon Parent Process | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\conhost\.exe"" AND parentProcName REGEXP "".*\\explorer\.exe|.*\\lsass\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\services\.exe|.*\\smss\.exe|.*\\spoolsv\.exe|.*\\svchost\.exe|.*\\userinit\.exe|.*\\wininit\.exe|.*\\winlogon\.exe"") AND ((parentCommand NOT REGEXP "".*-k LocalSystemNetworkRestricted -p -s NgcSvc.*|.*-k NetSvcs -p -s NcaSvc.*|.*-k NetworkService -p -s DoSvc.*|.*-k apphost -s AppHostSvc.*|.*-k imgsvc.*|.*-k localService -p -s RemoteRegistry.*|.*-k netsvcs -p -s NetSetupSvc.*|.*-k netsvcs -p -s wlidsvc.*|.*-k wsappx -p -s AppXSvc.*|.*-k wsappx -p -s ClipSVC.*""))) AND ((parentCommand NOT REGEXP "".*C:\\Program Files \(x86\)\\Dropbox\\Client\\.*|.*C:\\Program Files\\Dropbox\\Client\\.*"")) |
| Windows: DiagTrackEoP Default Login Username | Security | Detects the default ""UserName"" used by the DiagTrackEoP POC. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_diagtrack_eop_default_login_username.yml | Windows: DiagTrackEoP Default Login Username | eventType=""Win-Security-4624"" AND winLogonType=9 AND user=""thisisnotvaliduser"" |
| Windows: Creation of a Diagcab | Security | Detects the creation of diagcab file, which could be caused by some legitimate installer or is a sign of exploitation (review the filename and its location). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_diagcab.yml | Windows: Creation of a Diagcab | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\.diagcab"" |
| Windows: DLL Execution Via Register-cimprovider.exe | Security | Detects using register-cimprovider.exe to execute arbitrary dll file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_registry_cimprovider_dll_load.yml | Windows: DLL Execution Via Register-cimprovider.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\register-cimprovider\.exe"" AND command REGEXP "".*-path.*"" AND command REGEXP "".*dll.*"" |
| Windows: DLL Execution via Rasautou.exe | Security | Detects using Rasautou.exe for loading arbitrary .DLL specified in -d option and executes the export specified in -p. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_rasautou_dll_execution.yml | Windows: DLL Execution via Rasautou.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rasautou\.exe"" OR srcFileName=""rasdlui.exe"") AND (command REGEXP "".* -d .*"" AND command REGEXP "".* -p .*"") |
| Windows: CVE-2021-1675 Print Spooler Exploitation Filename Pattern | Security | Detects the default filename used in PoC code against print spooler vulnerability CVE-2021-1675. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_cve_2021_1675_printspooler.yml | Windows: CVE-2021-1675 Print Spooler Exploitation Filename Pattern | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*C:\\Windows\\System32\\spool\\drivers\\x64\\3\\old\\1\\123.*"" |
| Windows: Detecting Fake Instances Of Hxtsr.exe | Security | HxTsr.exe is a Microsoft compressed executable file called Microsoft Outlook Communications. HxTsr.exe is part of Outlook apps, because it resides in a hidden ""WindowsApps"" subfolder of ""C:\Program Files"". Its path includes a version number, e.g., ""C:\Program Files\WindowsApps\microsoft.windowscommunicationsapps_17.7466.41167.0_x64__8wekyb3d8bbwe\HxTsr.exe"". Any instances of hxtsr.exe not in this folder may be malware camouflaging itself as HxTsr.exe . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hxtsr_masquerading.yml | Windows: Detecting Fake Instances Of Hxtsr.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName=""hxtsr.exe"" AND (dirName NOT REGEXP ""C:\\program files\\windowsapps\\microsoft\.windowscommunicationsapps_.*"" OR dirName NOT REGEXP "".*\\hxtsr\.exe"") |
| Windows: Created Files by Microsoft Sync Center | Security | This rule detects suspicious files created by Microsoft Sync Center (mobsync). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_creation_by_mobsync.yml | Windows: Created Files by Microsoft Sync Center | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\mobsync\.exe"" AND fileName REGEXP "".*\.dll|.*\.exe"" |
| Windows: Direct Autorun Keys Modification | Security | Detects direct modification of autostart extensibility point (ASEP) in registry using reg.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_direct_asep_registry_keys_modification.yml | Windows: Direct Autorun Keys Modification | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\reg\.exe"" AND command REGEXP "".*add.*"" AND command REGEXP "".*\\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows.*|.*\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell.*|.*\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit.*|.*\\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders.*|.*\\software\\Microsoft\\Windows\\CurrentVersion\\Run.*|.*\\system\\CurrentControlSet\\Control\\SafeBoot\\AlternateShell.*"" |
| Windows: Dotnet.exe Exec Dll and Execute Unsigned Code LOLBIN | Security | dotnet.exe will execute any DLL and execute unsigned code. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_dotnet.yml | Windows: Dotnet.exe Exec Dll and Execute Unsigned Code LOLBIN | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\dotnet\.exe"" OR srcFileName="".NET Host"") AND command REGEXP "".*\.csproj|.*\.dll"" |
| Windows: DLL Load via LSASS | Security | Detects a method to load DLL via LSASS process using an undocumented Registry key. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_susp_lsass_dll_load.yml | Windows: DLL Load via LSASS | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*\\CurrentControlSet\\Services\\NTDS\\DirectoryServiceExtPt.*|.*\\CurrentControlSet\\Services\\NTDS\\LsaDbExtPt.*"" AND ((procName!=""C:\\Windows\\system32\\lsass.exe"" OR details NOT IN (""%%systemroot%%\\system32\\lsadb.dll"",""%%systemroot%%\\system32\\ntdsa.dll""))) |
| Windows: Computer Password Change Via Ksetup.EXE | Security | Detects password change for the computer's domain account or host principal via ""ksetup.exe"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ksetup_password_change_computer.yml | Windows: Computer Password Change Via Ksetup.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\ksetup\.exe"" OR srcFileName=""ksetup.exe"") AND command REGEXP "".* /setcomputerpassword .*"" |
| Windows: DLL Loaded via CertOC.EXE | Security | Detects when a user installs certificates by using CertOC.exe to loads the target DLL file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_certoc_load_dll.yml | Windows: DLL Loaded via CertOC.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\certoc\.exe"" OR srcFileName=""CertOC.exe"") AND command REGEXP "".* -LoadDLL .*|.* /LoadDLL .*"" |
| Windows: Download Arbitrary Files Via MSOHTMED.EXE | Security | Detects usage of ""MSOHTMED"" to download arbitrary files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_msohtmed_download.yml | Windows: Download Arbitrary Files Via MSOHTMED.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\MSOHTMED\.exe"" OR srcFileName=""MsoHtmEd.exe"") AND command REGEXP "".*ftp://.*|.*http://.*|.*https://.*"" |
| Windows: Dump Ntds.dit To Suspicious Location | Security | Detects potential abuse of ntdsutil to dump ntds.dit database to a suspicious location. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/esent/win_esent_ntdsutil_abuse_susp_location.yml | Windows: Dump Ntds.dit To Suspicious Location | eventType=""Win-PrintService-Publish-Printer-Failed"" AND lineContent REGEXP "".*ntds\.dit.*"" AND lineContent REGEXP "".*C:\\ntds\.dit.*|.*\\Appdata\\.*|.*\\Desktop\\.*|.*\\Downloads\\.*|.*\\Perflogs\\.*|.*\\Temp\\.*|.*\\Users\\Public\\.*"" |
| Windows: Download Arbitrary Files Via PresentationHost.exe | Security | Detects usage of ""PresentationHost"" which is a utility that runs "".xbap"" (Browser Applications) files to download arbitrary files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_presentationhost_download.yml | Windows: Download Arbitrary Files Via PresentationHost.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\presentationhost\.exe"" OR srcFileName=""PresentationHost.exe"") AND command REGEXP "".*ftp://.*|.*http://.*|.*https://.*"" |
| Windows: Dllhost.EXE Execution Anomaly | Security | Detects a ""dllhost"" process spawning with no commandline arguments which is very rare to happen and could indicate process injection activity or malware mimicking similar system processes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dllhost_no_cli_execution.yml | Windows: Dllhost.EXE Execution Anomaly | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\dllhost\.exe"" AND command IN (""dllhost"",""dllhost.exe"")) AND ((command IS NOT NULL)) |
| Windows: ETW Logging Tamper In .NET Processes | Security | Detects changes to environment variables related to ETW logging. This could indicate potential adversaries stopping ETW providers recording loaded .NET assemblies. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_etw_modification_cmdline.yml | Windows: ETW Logging Tamper In .NET Processes | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*COMPlus_ETWEnabled.*|.*COMPlus_ETWFlags.*"" |
| Windows: Copy .DMP/.DUMP Files From Remote Share Via Cmd.EXE | Security | Detects usage of the copy builtin cmd command to copy files with the "".dmp""/"".dump"" extension from a remote share. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_copy_dmp_from_share.yml | Windows: Copy .DMP/.DUMP Files From Remote Share Via Cmd.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe"" OR srcFileName=""Cmd.Exe"") AND (command REGEXP "".*copy .*"" AND command REGEXP "".* \\\\\.*"" AND command REGEXP "".*\.dmp.*|.*\.dump.*"") |
| Windows: Deployment AppX Package Was Blocked By AppLocker | Security | Detects an appx package deployment that was blocked by AppLocker policy. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_applocker_block.yml | Windows: Deployment AppX Package Was Blocked By AppLocker | eventType = ""Win-AppXDeployment-Server-412"" |
| Windows: DNS HybridConnectionManager Service Bus | Security | Detects Azure Hybrid Connection Manager services querying the Azure service bus service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_hybridconnectionmgr_servicebus.yml | Windows: DNS HybridConnectionManager Service Bus | eventType=""Win-Sysmon-22-DNS-Query"" AND queryId REGEXP "".*servicebus\.windows\.net.*"" AND procName REGEXP "".*HybridConnectionManager.*"" |
| Windows: Device Installation Blocked | Security | Detects an installation of a device that is forbidden by the system policy. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_device_installation_blocked.yml | Windows: Device Installation Blocked | eventType=""Win-Security-6423"" |
| Windows: Chopper Webshell Process Pattern | Security | Detects patterns found in process executions cause by China Chopper like tiny (ASPX) webshells. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_chopper.yml | Windows: Chopper Webshell Process Pattern | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\w3wp\.exe"" OR parentProcName REGEXP "".*\\w3wp\.exe"") AND command REGEXP "".*&c:&echo.*|.*&cd&echo.*|.*&dir&echo.*|.*&echo \[E\].*|.*&echo \[S\].*|.*&ipconfig&echo.*|.*&quser&echo.*|.*&whoami&echo.*"" |
| Windows: Custom Class Execution via Xwizard | Security | Detects the execution of Xwizard tool with specific arguments which utilized to run custom class properties. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_class_exec_xwizard.yml | Windows: Custom Class Execution via Xwizard | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\xwizard\.exe"" |
| Windows: DLL Load By System Process From Suspicious Locations | Security | Detects when a system process (i.e. located in system32, syswow64, etc.) loads a DLL from a suspicious location such as C:\Users\Public. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_susp_dll_load_system_process.yml | Windows: DLL Load By System Process From Suspicious Locations | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP ""C:\\Windows\\.*"" AND loadedProcName REGEXP ""C:\\PerfLogs\\.*|C:\\Users\\Public\\.*"" |
| Windows: CL-LoadAssembly.ps1 Proxy Execution | Security | Detects the use of a Micorsoft signed script to execute commands and bypassing AppLocker. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_cl_loadassembly.yml | Windows: CL-LoadAssembly.ps1 Proxy Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*LoadAssemblyFromPath .*|.*\\CL_LoadAssembly\.ps1.*"" |
| Windows: Deny Service Access Using Security Descriptor Tampering Via Sc.EXE | Security | Detects suspicious DACL modifications to deny access to a service that affects critical trustees. This can be used to hide services or make them unstoppable. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_sdset_deny_service_access.yml | Windows: Deny Service Access Using Security Descriptor Tampering Via Sc.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\sc\.exe"" OR srcFileName=""sc.exe"") AND (command REGEXP "".*sdset.*"" AND command REGEXP "".*D;.*"") AND command REGEXP "".*;BA.*|.*;IU.*|.*;SU.*|.*;SY.*|.*;WD.*"" |
| Windows: DotNet CLR DLL Loaded By Scripting Applications | Security | Detects .NET CLR DLLs being loaded by scripting applications such as wscript or cscript. This could be an indication of potential suspicious execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_susp_script_dotnet_clr_dll_load.yml | Windows: DotNet CLR DLL Loaded By Scripting Applications | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\cmstp\.exe|.*\\cscript\.exe|.*\\mshta\.exe|.*\\msxsl\.exe|.*\\regsvr32\.exe|.*\\wmic\.exe|.*\\wscript\.exe"" AND loadedProcName REGEXP "".*\\clr\.dll|.*\\mscoree\.dll|.*\\mscorlib\.dll"" |
| Windows: Code Integrity Attempted DLL Load | Security | Detects attempted DLL load events that didn't meet anti-malware or Windows signing level requirements. It often means the file's signature is revoked or expired. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/code_integrity/win_codeintegrity_attempted_dll_load.yml | Windows: Code Integrity Attempted DLL Load | eventType = ""Win-CodeIntegrity-Operational-3033"" AND ((fileName NOT REGEXP "".*\\Program Files\\DTrace\\dtrace\.dll"" OR procName NOT REGEXP "".*\\Windows\\System32\\svchost\.exe"" OR policyIdentity!=""12"" OR recipientPolicyId!=""1"") AND (fileName NOT REGEXP "".*\\Windows\\System32\\DriverStore\\FileRepository\\.*"" OR fileName NOT REGEXP "".*\\igd10iumd64\.dll"" OR policyIdentity!=""7"" OR recipientPolicyId!=""1"") AND (fileName NOT REGEXP "".*\\Windows\\System32\\nvspcap64\.dll"" OR procName NOT REGEXP "".*\\AppData\\Local\\Keybase\\Gui\\Keybase\.exe|.*\\Microsoft\\Teams\\stage\\Teams\.exe"" OR policyIdentity!=""8"" OR recipientPolicyId!=""1"") AND (fileName NOT REGEXP "".*\\Program Files\\Bonjour\\mdnsNSP\.dll"" OR procName NOT REGEXP "".*\\Windows\\System32\\SIHClient\.exe|.*\\Windows\\System32\\svchost\.exe"" OR policyIdentity NOT IN (""12"",""8"") OR recipientPolicyId!=""1"") AND (fileName NOT REGEXP "".*\\Microsoft Office\\root\\vfs\\ProgramFilesCommonX64\\Microsoft Shared\\OFFICE.*"" OR fileName NOT REGEXP "".*\\MSOXMLMF\.DLL"" OR policyIdentity!=""7"" OR recipientPolicyId!=""1"") AND (fileName NOT REGEXP "".*\\Windows\\System32\\nvspcap64\.dll"" OR procName NOT REGEXP "".*\\AppData\\Local\\slack\\app-.*"" OR procName NOT REGEXP "".*\\slack\.exe"" OR policyIdentity!=""8"" OR recipientPolicyId!=""1"") AND (fileName NOT REGEXP "".*\\Mozilla Firefox\\mozavcodec\.dll|.*\\Mozilla Firefox\\mozavutil\.dll"" OR procName NOT REGEXP "".*\\Mozilla Firefox\\firefox\.exe"" OR policyIdentity!=""8"") AND (fileName NOT REGEXP "".*\\Program Files \(x86\)\\Avast Software\\Avast\\aswAMSI\.dll|.*\\Program Files\\Avast Software\\Avast\\aswAMSI\.dll"" OR policyIdentity NOT IN (""12"",""8"") OR recipientPolicyId!=""1"") AND (fileName NOT REGEXP "".*\\Windows\\assembly\\GAC\\.*"" OR procName NOT REGEXP "".*\\mscorsvw\.exe"" OR procName NOT REGEXP "".*\\Windows\\Microsoft\.NET\\.*"" OR policyIdentity!=""8"" OR recipientPolicyId NOT IN (""1"",""2"")) AND (fileName NOT REGEXP "".*\\Program Files\\Google\\Drive File Stream\\.*"" OR fileName NOT REGEXP "".*\\crashpad_handler\.exe"" OR procName NOT REGEXP "".*\\Windows\\ImmersiveControlPanel\\SystemSettings\.exe"" OR policyIdentity!=""8"" OR recipientPolicyId!=""1"")) |
| Windows: Devtoolslauncher.exe Executes Specified Binary | Security | The Devtoolslauncher.exe executes other binary. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_devtoolslauncher.yml | Windows: Devtoolslauncher.exe Executes Specified Binary | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\devtoolslauncher\.exe"" AND command REGEXP "".*LaunchForDeploy.*"" |
| Windows: Creation of a Local Hidden User Account by Registry | Security | Sysmon registry detection of a local hidden user account. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_add_local_hidden_user.yml | Windows: Creation of a Local Hidden User Account by Registry | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*\\SAM\\SAM\\Domains\\Account\\Users\\Names\\.*"" AND regKeyPath REGEXP "".*\$"" AND procName REGEXP "".*\\lsass\.exe"" |
| Windows: CVE-2021-44077 POC Default Dropped File | Security | Detects the creation of ""msiexec.exe"" in the ""bin"" directory of the ManageEngine SupportCenter Plus (Related to CVE-2021-44077) and public POC available (See references section). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_cve_2021_44077_poc_default_files.yml | Windows: CVE-2021-44077 POC Default Dropped File | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\ManageEngine\\SupportCenterPlus\\bin\\msiexec\.exe"" |
| Windows: DeviceCredentialDeployment Execution | Security | Detects the execution of DeviceCredentialDeployment to hide a process from view. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_device_credential_deployment.yml | Windows: DeviceCredentialDeployment Execution | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\DeviceCredentialDeployment\.exe"" |
| Windows: DriverQuery.EXE Execution | Security | Detect usage of the ""driverquery"" utility. Which can be used to perform reconnaissance on installed drivers. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_driverquery_usage.yml | Windows: DriverQuery.EXE Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*driverquery\.exe"" OR srcFileName=""drvqry.exe"") |
| Windows: Creation Exe for Service with Unquoted Path | Security | Adversaries may execute their own malicious payloads by hijacking vulnerable file path references. Adversaries can take advantage of paths that lack surrounding quotations by placing an executable in a higher level directory within the path, so that Windows will choose the adversary's executable to launch. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_creation_unquoted_service_path.yml | Windows: Creation Exe for Service with Unquoted Path | eventType=""Win-Sysmon-11-FileCreate"" AND fileName=""C:\\program.exe"" |
| Windows: Code Integrity Blocked Driver Load | Security | Detects blocked load events that did not meet the authenticode signing level requirements or violated code integrity policy. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/code_integrity/win_codeintegrity_blocked_driver_load.yml | Windows: Code Integrity Blocked Driver Load | eventType =""Win-CodeIntegrity-Operational-3077"" |
| Windows: Change Default File Association Via Assoc | Security | Detects file association changes using the builtin ""assoc"" command. When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility. Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_assoc_execution.yml | Windows: Change Default File Association Via Assoc | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe"" OR srcFileName=""Cmd.Exe"") AND command REGEXP "".*assoc.*"" |
| Windows: Email Exifiltration Via Powershell | Security | Detects email exfiltration via powershell cmdlets. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_email_exfil.yml | Windows: Email Exifiltration Via Powershell | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND command REGEXP "".*Add-PSSnapin.*"" AND command REGEXP "".*Get-Recipient.*"" AND command REGEXP "".*-ExpandProperty.*"" AND command REGEXP "".*EmailAddresses.*"" AND command REGEXP "".*SmtpAddress.*"" AND command REGEXP "".*-hidetableheaders.*"" |
| Windows: CL-Mutexverifiers.ps1 Proxy Execution | Security | Detects the use of a Micorsoft signed script to execute commands. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_cl_mutexverifiers.yml | Windows: CL-Mutexverifiers.ps1 Proxy Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\CL_Mutexverifiers\.ps1.*"" AND command REGEXP "".*runAfterCancelProcess .*"" |
| Windows: Change Default File Association To Executable Via Assoc | Security | Detects when a program changes the default file association of any extension to an executable. When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility. Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_assoc_tamper_exe_file_association.yml | Windows: Change Default File Association To Executable Via Assoc | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\cmd\.exe"" OR srcFileName=""Cmd.Exe"") AND (command REGEXP "".*assoc .*"" AND command REGEXP "".*exefile.*"")) AND (command NOT REGEXP "".*\.exe=exefile.*"") |
| Windows: Chafer Activity: System Log | Security | Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/win_apt_chafer_mar18_system.yml | Windows: Chafer Activity: System Log | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceName IN (""SC Scheduled Scan"",""UpdatMachine"") |
| Windows: Fsutil Suspicious Invocation | Security | Detects suspicious parameters of fsutil (deleting USN journal, configuring it with small size, etc). Might be used by ransomwares during the attack (seen by NotPetya and others). . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_fsutil_usage.yml | Windows: Fsutil Suspicious Invocation | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\fsutil\.exe"" OR srcFileName=""fsutil.exe"") AND command REGEXP "".*createjournal.*|.*deletejournal.*"" |
| Windows: HackTool - SILENTTRINITY Stager Execution | Security | Detects SILENTTRINITY stager use via PE metadata. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_silenttrinity_stager.yml | Windows: HackTool - SILENTTRINITY Stager Execution | eventType=""Win-Sysmon-1-Create-Process"" AND description REGEXP "".*st2stager.*"" |
| Windows: HackTool - PCHunter Execution | Security | Detects suspicious use of PCHunter, a tool like Process Hacker to view and manipulate processes, kernel options and other low level stuff. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_pchunter.yml | Windows: HackTool - PCHunter Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\PCHunter32\.exe|.*\\PCHunter64\.exe"" OR srcFileName=""PCHunter.exe"" OR description=""Epoolsoft Windows Information View Tools"" OR hashCode REGEXP "".*IMPHASH=0479F44DF47CFA2EF1CCC4416A538663.*|.*IMPHASH=444D210CEA1FF8112F256A4997EED7FF.*|.*MD5=228DD0C2E6287547E26FFBD973A40F14.*|.*MD5=987B65CD9B9F4E9A1AFD8F8B48CF64A7.*|.*SHA1=3FB89787CB97D902780DA080545584D97FB1C2EB.*|.*SHA1=5F1CBC3D99558307BC1250D084FA968521482025.*|.*SHA256=2B214BDDAAB130C274DE6204AF6DBA5AEEC7433DA99AA950022FA306421A6D32.*|.*SHA256=55F041BF4E78E9BFA6D4EE68BE40E496CE3A1353E1CA4306598589E19802522C.*"" OR hashMD5 IN (""228dd0c2e6287547e26ffbd973a40f14"",""987b65cd9b9f4e9a1afd8f8b48cf64a7"") OR hashSHA1 IN (""3fb89787cb97d902780da080545584d97fb1c2eb"",""5f1cbc3d99558307bc1250d084fa968521482025"") OR hashSHA256 IN (""2b214bddaab130c274de6204af6dba5aeec7433da99aa950022fa306421a6d32"",""55f041bf4e78e9bfa6d4ee68be40e496ce3a1353e1ca4306598589e19802522c"") OR hashIMP IN (""0479f44df47cfa2ef1ccc4416a538663"",""444d210cea1ff8112f256a4997eed7ff"")) |
| Windows: HackTool - SILENTTRINITY Stager DLL Load | Security | Detects SILENTTRINITY stager dll loading activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_hktl_silenttrinity_stager.yml | Windows: HackTool - SILENTTRINITY Stager DLL Load | eventType=""Win-Sysmon-7-Image-Loaded"" AND description REGEXP "".*st2stager.*"" |
| Windows: Execution of Suspicious File Type Extension | Security | Checks whether the image specified in a process creation event doesn't refer to an .exe file (caused by process ghosting or other unorthodox methods to start a process). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_non_exe_image.yml | Windows: Execution of Suspicious File Type Extension | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName NOT REGEXP "".*\.exe|.*\.scr|.*\.tmp"") AND ((procName NOT IN (""MemCompression"",""Registry"",""System"",""vmmem"")) AND (procName NOT REGEXP ""C:\\Windows\\Installer\\MSI.*"") AND (procName NOT REGEXP ""C:\\Windows\\System32\\DriverStore\\FileRepository\\.*"") AND (procName NOT REGEXP ""C:\\Config\.Msi\\.*"" OR procName NOT REGEXP "".*\.rbf|.*\.rbs"") AND (parentProcName NOT REGEXP ""C:\\Windows\\Temp\\.*"" OR procName NOT REGEXP ""C:\\Windows\\Temp\\Helper\\.*"") AND (procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*"" OR procName NOT REGEXP "".*\.com""))) AND ((procName NOT IN ("""",""-"")) AND (procName IS NOT NULL) AND (parentProcName NOT REGEXP ""C:\\ProgramData\\Avira\\.*"") AND (procName NOT REGEXP "".*NVIDIA\\NvBackend\\.*"" OR procName NOT REGEXP "".*\.dat"") AND (procName NOT REGEXP "".*\\WinSCP\.com"") AND (procName NOT REGEXP "".*C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\.*"" OR procName NOT REGEXP "".*\.tmp.*"" OR procName NOT REGEXP "".*CodeSetup.*"") AND (procName NOT REGEXP "".*\\program\\soffice\.bin"") AND (procName NOT IN (""C:\\Program Files (x86)\\EMC NetWorker\\Management\\GST\\apache\\cgi-bin\\update_jnlp.cgi"",""C:\\Program Files\\EMC NetWorker\\Management\\GST\\apache\\cgi-bin\\update_jnlp.cgi"")) AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\WINPAKPRO\\.*|C:\\Program Files\\WINPAKPRO\\.*"" OR procName NOT REGEXP "".*\.ngn"") AND (procName NOT IN (""C:\\Program Files (x86)\\MyQ\\Server\\pcltool.dll"",""C:\\Program Files\\MyQ\\Server\\pcltool.dll"")) AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft Visual Studio.*|C:\\Program Files\\Microsoft Visual Studio\\.*"" OR procName NOT REGEXP "".*\.com"") AND (procName NOT REGEXP "".*\\AppData\\Local\\Packages\\.*"" OR procName NOT REGEXP "".*\\LocalState\\rootfs\\.*"") AND (procName NOT REGEXP "".*\\LZMA_EXE"") AND (parentProcName NOT REGEXP ""C:\\Windows\\Temp\\.*"" OR parentProcName NOT REGEXP "".*\\TBT_Dock_Firmware\\GetDockVer32W\.exe"") AND (procName NOT REGEXP ""C:\\Program Files\\Mozilla Firefox\\tobedeleted\\.*"") AND (parentProcName!=""C:\\Windows\\UUS\\amd64\\MoUsoCoreWorker.exe"" OR procName NOT REGEXP ""C:\\\$Extend\\\$Deleted\\.*"" OR command NOT REGEXP "".*C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\OfficeC2RClient\.exe.*"" OR command NOT REGEXP "".*/update UPDATEORCHESTRATOR displaylevel=False.*"")) |
| Windows: HackTool - Htran/NATBypass Execution | Security | Detects exeuctable names or flags used by Htran or Htran-like tools (e.g. NATBypass). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_htran_or_natbypass.yml | Windows: HackTool - Htran/NATBypass Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\htran\.exe|.*\\lcx\.exe"" OR command REGEXP "".*\.exe -slave .*|.*\.exe -tran .*"") |
| Windows: HackTool - SharPersist Execution | Security | Detects the execution of the hacktool SharPersist - used to deploy various different kinds of persistence mechanisms. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_sharpersist.yml | Windows: HackTool - SharPersist Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\SharPersist\.exe"" OR product=""SharPersist"") OR command REGEXP "".* -t schtask -c .*|.* -t startupfolder -c .*"" OR (command REGEXP "".* -t reg -c .*"" AND command REGEXP "".* -m add.*"") OR (command REGEXP "".* -t service -c .*"" AND command REGEXP "".* -m add.*"") OR (command REGEXP "".* -t schtask -c .*"" AND command REGEXP "".* -m add.*"")) |
| Windows: HackTool - DInjector PowerShell Cradle Execution | Security | Detects the use of the Dinject PowerShell cradle based on the specific flags. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_dinjector.yml | Windows: HackTool - DInjector PowerShell Cradle Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* /am51.*"" AND command REGEXP "".* /password.*"" |
| Windows: Failed MSExchange Transport Agent Installation | Security | Detects a failed installation of a Exchange Transport Agent. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/msexchange/win_exchange_transportagent_failed.yml | Windows: Failed MSExchange Transport Agent Installation | eventType = ""Win-MSExchange-Management-6"" AND lineContent REGEXP "".*Install-TransportAgent.*"" |
| Windows: HybridConnectionManager Service Installation | Security | Rule to detect the Hybrid Connection Manager service installation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_hybridconnectionmgr_svc_installation.yml | Windows: HybridConnectionManager Service Installation | eventType=""Win-Security-4697"" AND serviceName=""HybridConnectionManager"" AND serviceFileName REGEXP "".*HybridConnectionManager.*"" |
| Windows: Execute Pcwrun.EXE To Leverage Follina | Security | Detects indirect command execution via Program Compatibility Assistant ""pcwrun.exe"" leveraging the follina (CVE-2022-30190) vulnerability. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_pcwrun_follina.yml | Windows: Execute Pcwrun.EXE To Leverage Follina | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\pcwrun\.exe"" AND command REGEXP "".*\.\./.*"" |
| Windows: GALLIUM Artefacts - Builtin | Security | Detects artefacts associated with activity group GALLIUM - Microsoft Threat Intelligence Center indicators released in December 2019. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/dns_server_analytic/win_dns_analytic_apt_gallium.yml | Windows: GALLIUM Artefacts - Builtin | eventType REGEXP ""Win-.*-257[^\d]*"" AND destName IN (""asyspy256.ddns.net"",""cvdfhjh1231.ddns.net"",""cvdfhjh1231.myftp.biz"",""dffwescwer4325.myftp.biz"",""hotkillmail9sddcc.ddns.net"",""rosaf112.ddns.net"",""sz2016rose.ddns.net"") |
| Windows: Gpresult Display Group Policy Information | Security | Detects cases in which a user uses the built-in Windows utility gpresult to display the Resultant Set of Policy (RSoP) information. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_gpresult_execution.yml | Windows: Gpresult Display Group Policy Information | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\gpresult\.exe"" AND command REGEXP "".*/v.*|.*/z.*"" |
| Windows: File Download Using ProtocolHandler.exe | Security | Detects usage of ""ProtocolHandler"" to download files. Downloaded files will be located in the cache folder (for example - %LOCALAPPDATA%\Microsoft\Windows\INetCache\IE). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_protocolhandler_download.yml | Windows: File Download Using ProtocolHandler.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\protocolhandler\.exe"" OR srcFileName=""ProtocolHandler.exe"") AND ((command REGEXP "".*\""ms-word.*"" AND command REGEXP "".*\.docx\"".*"") OR command REGEXP "".* http.*"") |
| Windows: Format.com FileSystem LOLBIN | Security | Detects the execution of format.com with a suspicious filesystem selection that could indicate a defense evasion activity in which format.com is used to load malicious DLL files or other programs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_format.yml | Windows: Format.com FileSystem LOLBIN | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\format\.com"" AND command REGEXP "".*/fs:.*"") AND ((command NOT REGEXP "".*/fs:FAT.*|.*/fs:NTFS.*|.*/fs:ReFS.*|.*/fs:UDF.*|.*/fs:exFAT.*"")) |
| Windows: HackTool - CrackMapExec Execution | Security | This rule detect common flag combinations used by CrackMapExec in order to detect its use even if the binary has been replaced. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_execution.yml | Windows: HackTool - CrackMapExec Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\crackmapexec\.exe"" OR command REGEXP "".* -M pe_inject .*"" OR (command REGEXP "".* --local-auth.*"" AND command REGEXP "".* -u .*"" AND command REGEXP "".* -x .*"") OR (command REGEXP "".* --local-auth.*"" AND command REGEXP "".* -u .*"" AND command REGEXP "".* -p .*"" AND command REGEXP "".* -H 'NTHASH'.*"") OR (command REGEXP "".* mssql .*"" AND command REGEXP "".* -u .*"" AND command REGEXP "".* -p .*"" AND command REGEXP "".* -M .*"" AND command REGEXP "".* -d .*"") OR (command REGEXP "".* smb .*"" AND command REGEXP "".* -u .*"" AND command REGEXP "".* -H .*"" AND command REGEXP "".* -M .*"" AND command REGEXP "".* -o .*"") OR (command REGEXP "".* smb .*"" AND command REGEXP "".* -u .*"" AND command REGEXP "".* -p .*"" AND command REGEXP "".* --local-auth.*"")) OR (command REGEXP "".* --local-auth.*"" AND command REGEXP "".* -u .*"" AND command REGEXP "".* -p .*"" AND command REGEXP "".* 10\..*"" AND command REGEXP "".* 192\.168\..*"" AND command REGEXP "".*/24 .*"")) |
| Windows: Execute MSDT Via Answer File | Security | Detects execution of ""msdt.exe"" using an answer file which is simulating the legitimate way of calling msdt via ""pcwrun.exe"" (For example from the compatibility tab). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_msdt_answer_file.yml | Windows: Execute MSDT Via Answer File | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\msdt\.exe"" AND command REGEXP "".*\\WINDOWS\\diagnostics\\index\\PCWDiagnostic\.xml.*"" AND command REGEXP "".* -af .*|.* /af .*"") AND (parentProcName NOT REGEXP "".*\\pcwrun\.exe"") |
| Windows: HackTool - SecurityXploded Execution | Security | Detects the execution of SecurityXploded Tools. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_secutyxploded.yml | Windows: HackTool - SecurityXploded Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (company=""SecurityXploded"" OR procName REGEXP "".*PasswordDump\.exe"" OR srcFileName REGEXP "".*PasswordDump\.exe"") |
| Windows: Execution via WorkFolders.exe | Security | Detects using WorkFolders.exe to execute an arbitrary control.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_workfolders.yml | Windows: Execution via WorkFolders.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\control\.exe"" AND parentProcName REGEXP "".*\\WorkFolders\.exe"") AND (procName!=""C:\\Windows\\System32\\control.exe"") |
| Windows: File Creation In Suspicious Directory By Msdt.EXE | Security | Detects msdt.exe creating files in suspicious directories which could be a sign of exploitation of either Follina or Dogwalk vulnerabilities. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_msdt_susp_directories.yml | Windows: File Creation In Suspicious Directory By Msdt.EXE | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\msdt\.exe"" AND fileName REGEXP "".*C:\\PerfLogs\\.*|.*C:\\ProgramData\\.*|.*C:\\Users\\Public\\.*|.*\\Desktop\\.*|.*\\Start Menu\\Programs\\Startup\\.*"" |
| Windows: Execution of Powershell Script in Public Folder | Security | This rule detects execution of PowerShell scripts located in the ""C:\Users\Public"" folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_public_folder.yml | Windows: Execution of Powershell Script in Public Folder | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND command REGEXP "".*-f %Public%.*|.*-f C:\\Users\\Public.*|.*-f \""C:\\Users\\Public.*|.*-fi %Public%.*|.*-fi C:\\Users\\Public.*|.*-fi \""C:\\Users\\Public.*|.*-fil %Public%.*|.*-fil C:\\Users\\Public.*|.*-fil \""C:\\Users\\Public.*|.*-file %Public%.*|.*-file C:\\Users\\Public.*|.*-file \""C:\\Users\\Public.*"" |
| Windows: FoggyWeb Backdoor DLL Loading | Security | Detects DLL hijacking technique used by NOBELIUM in their FoggyWeb backdoor. Which loads a malicious version of the expected ""version.dll"" dll. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_malware_foggyweb_nobelium.yml | Windows: FoggyWeb Backdoor DLL Loading | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName=""C:\\Windows\\ADFS\\version.dll"" |
| Windows: HackTool - Certify Execution | Security | Detects Certify a tool for Active Directory certificate abuse based on PE metadata characteristics and common command line arguments. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_certify.yml | Windows: HackTool - Certify Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\Certify\.exe"" OR srcFileName=""Certify.exe"" OR description REGEXP "".*Certify.*"") OR (command REGEXP "".*\.exe cas .*|.*\.exe download .*|.*\.exe find .*|.*\.exe pkiobjects .*|.*\.exe request .*"" AND command REGEXP "".* /altname:.*|.* /ca:.*|.* /domain:.*|.* /path:.*|.* /template:.*|.* /vulnerable.*"")) |
| Windows: Execute Files with Msdeploy.exe | Security | Detects file execution using the msdeploy.exe lolbin. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_msdeploy.yml | Windows: Execute Files with Msdeploy.exe | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*verb:sync.*"" AND command REGEXP "".*-source:RunCommand.*"" AND command REGEXP "".*-dest:runCommand.*"" AND procName REGEXP "".*\\msdeploy\.exe"" |
| Windows: GatherNetworkInfo.VBS Reconnaissance Script Output | Security | Detects creation of files which are the results of executing the built-in reconnaissance script ""C:\Windows\System32\gatherNetworkInfo.vbs"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_lolbin_gather_network_info_script_output.yml | Windows: GatherNetworkInfo.VBS Reconnaissance Script Output | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP ""C:\\Windows\\System32\\config.*"" AND fileName REGEXP "".*\\Hotfixinfo\.txt|.*\\VmSwitchLog\.evtx|.*\\netiostate\.txt|.*\\sysportslog\.txt"" |
| Windows: HackTool - Wmiexec Default Powershell Command | Security | Detects the execution of PowerShell with a specific flag sequence that is used by the Wmiexec script. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_wmiexec_default_powershell.yml | Windows: HackTool - Wmiexec Default Powershell Command | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*-NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc.*"" |
| Windows: Fsutil Behavior Set SymlinkEvaluation | Security | A symbolic link is a type of file that contains a reference to another file. This is probably done to make sure that the ransomware is able to follow shortcuts on the machine in order to find the original file to encrypt . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_fsutil_symlinkevaluation.yml | Windows: Fsutil Behavior Set SymlinkEvaluation | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\fsutil\.exe"" OR srcFileName=""fsutil.exe"") AND (command REGEXP "".*behavior .*"" AND command REGEXP "".*set .*"" AND command REGEXP "".*SymlinkEvaluation.*"") |
| Windows: HackTool - PurpleSharp Execution | Security | Detects the execution of the PurpleSharp adversary simulation tool. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_purplesharp_indicators.yml | Windows: HackTool - PurpleSharp Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\purplesharp.*"" OR srcFileName=""PurpleSharp.exe"" OR command REGEXP "".*PurpleSharp.*|.*xyz123456\.exe.*"") |
| Windows: HackTool - LocalPotato Execution | Security | Detects the execution of the LocalPotato POC based on basic PE metadata information and default CLI examples. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_localpotato.yml | Windows: HackTool - LocalPotato Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\LocalPotato\.exe"" OR (command REGEXP "".*\.exe -i C:\\.*"" AND command REGEXP "".*-o Windows\\.*"") OR hashCode REGEXP "".*IMPHASH=DD82066EFBA94D7556EF582F247C8BB5.*|.*IMPHASH=E1742EE971D6549E8D4D81115F88F1FC.*"" OR hashIMP IN (""DD82066EFBA94D7556EF582F247C8BB5"",""E1742EE971D6549E8D4D81115F88F1FC"")) |
| Windows: HackTool - Certipy Execution | Security | Detects Certipy a tool for Active Directory Certificate Services enumeration and abuse based on PE metadata characteristics and common command line arguments. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_certipy.yml | Windows: HackTool - Certipy Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\Certipy\.exe"" OR srcFileName=""Certipy.exe"" OR description REGEXP "".*Certipy.*"") OR (command REGEXP "".* auth .*|.* find .*|.* forge .*|.* relay .*|.* req .*|.* shadow .*"" AND command REGEXP "".* -bloodhound.*|.* -ca-pfx .*|.* -dc-ip .*|.* -kirbi.*|.* -old-bloodhound.*|.* -pfx .*|.* -target.*|.* -username .*|.* -vulnerable.*|.*auth -pfx.*|.*shadow auto.*|.*shadow list.*"")) |
| Windows: Execution via stordiag.exe | Security | Detects the use of stordiag.exe to execute schtasks.exe systeminfo.exe and fltmc.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_stordiag_susp_child_process.yml | Windows: Execution via stordiag.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\stordiag\.exe"" AND procName REGEXP "".*\\fltmc\.exe|.*\\schtasks\.exe|.*\\systeminfo\.exe"") AND (parentProcName NOT REGEXP ""c:\\windows\\system32\\.*|c:\\windows\\syswow64\\.*"") |
| Windows: Firewall Rule Modified In The Windows Firewall Exception List | Security | Detects when a rule has been modified in the windows firewall exception list. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/firewall_as/win_firewall_as_change_rule.yml | Windows: Firewall Rule Modified In The Windows Firewall Exception List | eventType REGEXP ""Win-.*-2005[^\d]*|Win-.*-2073[^\d]*"" AND ((appName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"")) |
| Windows: Execution via CL-Invocation.ps1 | Security | Detects Execution via SyncInvoke in CL_Invocation.ps1 module. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_cl_invocation.yml | Windows: Execution via CL-Invocation.ps1 | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*CL_Invocation\.ps1.*"" AND command REGEXP "".*SyncInvoke.*"" |
| Windows: Execution in Webserver Root Folder | Security | Detects a suspicious program execution in a web service root folder (filter out false positives). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_execution_path_webserver.yml | Windows: Execution in Webserver Root Folder | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\htdocs\\.*|.*\\wmpub\\.*|.*\\wwwroot\\.*"" AND (procName NOT REGEXP "".*\\SMSComponent\\.*|.*\\Tools\\.*|.*bin\\.*"" OR parentProcName NOT REGEXP "".*\\services\.exe"") |
| Windows: HackTool - SharpLDAPmonitor Execution | Security | Detects execution of the SharpLDAPmonitor. Which can monitor the creation, deletion and changes to LDAP objects. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_sharp_ldap_monitor.yml | Windows: HackTool - SharpLDAPmonitor Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\SharpLDAPmonitor\.exe"" OR srcFileName=""SharpLDAPmonitor.exe"") OR (command REGEXP "".*/user:.*"" AND command REGEXP "".*/pass:.*"" AND command REGEXP "".*/dcip:.*"")) |
| Windows: HackTool - GMER Rootkit Detector and Remover Execution | Security | Detects the execution GMER tool based on image and hash fields. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_gmer.yml | Windows: HackTool - GMER Rootkit Detector and Remover Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\gmer\.exe"" OR hashCode REGEXP "".*MD5=E9DC058440D321AA17D0600B3CA0AB04.*|.*SHA1=539C228B6B332F5AA523E5CE358C16647D8BBE57.*|.*SHA256=E8A3E804A96C716A3E9B69195DB6FFB0D33E2433AF871E4D4E1EAB3097237173.*"" OR hashMD5=""e9dc058440d321aa17d0600b3ca0ab04"" OR hashSHA1=""539c228b6b332f5aa523e5ce358c16647d8bbe57"" OR hashSHA256=""e8a3e804a96c716a3e9b69195db6ffb0d33e2433af871e4d4e1eab3097237173"") |
| Windows: Execution via Diskshadow.exe | Security | Detects using Diskshadow.exe to execute arbitrary code in text file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_diskshadow.yml | Windows: Execution via Diskshadow.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\diskshadow\.exe"" AND command REGEXP "".*-s.*|.*/s.*"" |
| Windows: Execution from Suspicious Folder | Security | Detects a suspicious execution from an uncommon folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_execution_path.yml | Windows: Execution from Suspicious Folder | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\Intel\\Logs\\.*|.*\\RSA\\MachineKeys\\.*|.*\\Users\\All Users\\.*|.*\\Users\\Default\\.*|.*\\Users\\NetworkService\\.*|.*\\Users\\Public\\.*|.*\\Windows\\Fonts\\.*|.*\\Windows\\Help\\.*|.*\\Windows\\IME\\.*|.*\\Windows\\Media\\.*|.*\\Windows\\System32\\Tasks\\.*|.*\\Windows\\Tasks\\.*|.*\\Windows\\addins\\.*|.*\\Windows\\debug\\.*|.*\\Windows\\repair\\.*|.*\\Windows\\security\\.*|.*\\\$Recycle\.bin\\.*|.*\\config\\systemprofile\\.*"" OR procName REGEXP ""C:\\Perflogs\\.*"") AND ((procName NOT REGEXP ""C:\\Users\\Public\\IBM\\ClientSolutions\\Start_Programs\\.*"") AND (procName NOT REGEXP ""C:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\.*"" OR procName NOT REGEXP "".*\\CitrixReceiverUpdater\.exe"")) |
| Windows: File Decoded From Base64/Hex Via Certutil.EXE | Security | Detects the execution of certutil with either the ""decode"" or ""decodehex"" flags to decode base64 or hex encoded files. This can be abused by attackers to decode an encoded payload before execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_certutil_decode.yml | Windows: File Decoded From Base64/Hex Via Certutil.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\certutil\.exe"" OR srcFileName=""CertUtil.exe"") AND command REGEXP "".*-decode .*|.*-decodehex .*|.*/decode .*|.*/decodehex .*"" |
| Windows: HackTool - Sliver C2 Implant Activity Pattern | Security | Detects process activity patterns as seen being used by Sliver C2 framework implants. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_sliver_c2_execution_pattern.yml | Windows: HackTool - Sliver C2 Implant Activity Pattern | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*-NoExit -Command \[Console\]::OutputEncoding=\[Text\.UTF8Encoding\]::UTF8.*"" |
| Windows: Execution Of Non-Existing File | Security | Checks whether the image specified in a process creation event is not a full, absolute path (caused by process ghosting or other unorthodox methods to start a process). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_image_missing.yml | Windows: Execution Of Non-Existing File | eventType=""Win-Sysmon-1-Create-Process"" AND (procName NOT REGEXP "".*\\.*"") AND ((procName IS NOT NULL) AND (procName NOT IN ("""",""-"")) AND (procName NOT IN (""MemCompression"",""Registry"",""System"",""vmmem"") AND command NOT IN (""MemCompression"",""Registry"",""vmmem""))) |
| Windows: Hidden Local User Creation | Security | Detects the creation of a local hidden user account which should not happen for event ID 4720. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_hidden_user_creation.yml | Windows: Hidden Local User Creation | eventType=""Win-Security-4720"" AND user REGEXP "".*\$"" AND isLocalUser = ""yes"" |
| Windows: Gpscript Execution | Security | Detects the execution of the LOLBIN gpscript, which executes logon or startup scripts configured in Group Policy. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_gpscript.yml | Windows: Gpscript Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\gpscript\.exe"" OR srcFileName=""GPSCRIPT.EXE"") AND command REGEXP "".* /logon.*|.* /startup.*"" |
| Windows: File Encoded To Base64 Via Certutil.EXE | Security | Detects the execution of certutil with the ""encode"" flag to encode a file to base64. This can be abused by threat actors and attackers for data exfiltration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_certutil_encode.yml | Windows: File Encoded To Base64 Via Certutil.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\certutil\.exe"" OR srcFileName=""CertUtil.exe"") AND command REGEXP "".*-encode.*|.*/encode.*"" |
| Windows: Gzip Archive Decode Via PowerShell | Security | Detects attempts of decoding encoded Gzip archives via PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_decode_gzip.yml | Windows: Gzip Archive Decode Via PowerShell | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*GZipStream.*"" AND command REGEXP "".*::Decompress.*"" |
| Windows: Explorer Process Tree Break | Security | Detects a command line process that uses explorer.exe to launch arbitrary commands or binaries, which is similar to cmd.exe /c, only it breaks the process tree and makes its parent a new instance of explorer spawning from ""svchost"" . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_explorer_break_process_tree.yml | Windows: Explorer Process Tree Break | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*/factory,\{75dff2b7-6936-4c06-a8bb-676a7b00b24b\}.*"" OR (command REGEXP "".*explorer\.exe.*"" AND command REGEXP "".* /root,.*"")) |
| Windows: KrbRelayUp Service Installation | Security | Detects service creation from KrbRelayUp tool used for privilege escalation in windows domain environments where LDAP signing is not enforced (the default settings). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_krbrelayup_service_installation.yml | Windows: KrbRelayUp Service Installation | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceName=""KrbSCM"" |
| Windows: Lolbin Defaultpack.exe Use As Proxy | Security | Detect usage of the ""defaultpack.exe"" binary as a proxy to launch other programs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_defaultpack.yml | Windows: Lolbin Defaultpack.exe Use As Proxy | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\defaultpack\.exe"" |
| Windows: Legitimate Application Dropped Executable | Security | Detects programs on a Windows system that should not write executables to disk. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_legitimate_app_dropping_exe.yml | Windows: Legitimate Application Dropped Executable | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\AcroRd32\.exe|.*\\CertReq\.exe|.*\\Desktopimgdownldr\.exe|.*\\RdrCEF\.exe|.*\\certoc\.exe|.*\\certutil\.exe|.*\\eqnedt32\.exe|.*\\esentutl\.exe|.*\\excel\.exe|.*\\finger\.exe|.*\\hh\.exe|.*\\msaccess\.exe|.*\\mshta\.exe|.*\\mspub\.exe|.*\\notepad\.exe|.*\\powerpnt\.exe|.*\\visio\.exe|.*\\winword\.exe|.*\\wordpad\.exe|.*\\wordview\.exe"" AND fileName REGEXP "".*\.dll|.*\.exe|.*\.ocx"" |
| Windows: Indirect Command Execution By Program Compatibility Wizard | Security | Detect indirect command execution via Program Compatibility Assistant pcwrun.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_pcwrun.yml | Windows: Indirect Command Execution By Program Compatibility Wizard | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\pcwrun\.exe"" |
| Windows: Logged-On User Password Change Via Ksetup.EXE | Security | Detects password change for the logged-on user's via ""ksetup.exe"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ksetup_password_change_user.yml | Windows: Logged-On User Password Change Via Ksetup.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\ksetup\.exe"" OR srcFileName=""ksetup.exe"") AND command REGEXP "".* /ChangePassword .*"" |
| Windows: JSC Convert Javascript To Executable | Security | Detects the execution of the LOLBIN jsc.exe used by .NET to compile javascript code to .exe or .dll format. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_jsc.yml | Windows: JSC Convert Javascript To Executable | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\jsc\.exe"" AND command REGEXP "".*\.js.*"" |
| Windows: Ilasm Lolbin Use Compile C-Sharp | Security | Detect use of Ilasm.exe to compile c# code into dll or exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_ilasm.yml | Windows: Ilasm Lolbin Use Compile C-Sharp | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\ilasm\.exe"" OR srcFileName=""ilasm.exe"") |
| Windows: IIS Native-Code Module Command Line Installation | Security | Detects suspicious IIS native-code module installations via command line. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_iis_appcmd_susp_module_install.yml | Windows: IIS Native-Code Module Command Line Installation | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\appcmd\.exe"" OR srcFileName=""appcmd.exe"") AND (command REGEXP "".*install.*"" AND command REGEXP "".*module.*"" AND command REGEXP "".*-name:.*|.*/name:.*"")) AND ((parentProcName!=""C:\\Windows\\System32\\inetsrv\\iissetup.exe"")) |
| Windows: Important Windows Service Terminated Unexpectedly | Security | Detects important or interesting windows services that got terminated unexpectedly. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_terminated_unexpectedly.yml | Windows: Important Windows Service Terminated Unexpectedly | (eventType=""Win-System-Service-Control-Manager-7034"") AND (paraName REGEXP "".*Message Queuing.*"" OR code REGEXP "".*4d0053004d005100.*|.*6d0073006d007100.*"") |
| Windows: Local User Creation | Security | Detects local user creation on windows servers, which shouldn't happen in an Active Directory environment. Apply this Sigma Use Case on your windows server logs and not on your DC logs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_user_creation.yml | Windows: Local User Creation | eventType=""Win-Security-4720"" AND isLocalUser = ""yes"" |
| Windows: KrbRelayUp Attack Pattern | Security | Detects logon events that have characteristics of events generated during an attack with KrbRelayUp and the like. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_susp_krbrelayup.yml | Windows: KrbRelayUp Attack Pattern | eventType=""Win-Security-4624"" AND winLogonType=3 AND authenMethod=""Kerberos"" AND srcIpAddr=127.0.0.1 AND userId REGEXP ""S-1-5-21-.*"" AND userId REGEXP "".*-500"" |
| Windows: Install New Package Via Winget Local Manifest | Security | Detects usage of winget to install applications via manifest file. Adversaries can abuse winget to download payloads remotely and execute them. The manifest option enables you to install an application by passing in a YAML file directly to the client. Winget can be used to download and install exe, msi or msix files later. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_winget_local_install_via_manifest.yml | Windows: Install New Package Via Winget Local Manifest | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\winget\.exe"" OR srcFileName=""winget.exe"") AND command REGEXP "".* add .*|.*install.*"" AND command REGEXP "".*--manifest.*|.*-m .*"" |
| Windows: LOLBAS Data Exfiltration by DataSvcUtil.exe | Security | Detects when a user performs data exfiltration by using DataSvcUtil.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_data_exfiltration_by_using_datasvcutil.yml | Windows: LOLBAS Data Exfiltration by DataSvcUtil.exe | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*/in:.*|.*/out:.*|.*/uri:.*"" AND (procName REGEXP "".*\\DataSvcUtil\.exe"" OR srcFileName=""DataSvcUtil.exe"") |
| Windows: ISO or Image Mount Indicator in Recent Files | Security | Detects the creation of recent element file that points to an .ISO, .IMG, .VHD or .VHDX file as often used in phishing attacks. This can be a false positive on server systems but on workstations users should rarely mount .iso or .img files. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_iso_file_recent.yml | Windows: ISO or Image Mount Indicator in Recent Files | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\.img\.lnk|.*\.iso\.lnk|.*\.vhd\.lnk|.*\.vhdx\.lnk"" AND fileName REGEXP "".*\\Microsoft\\Windows\\Recent\\.*"" |
| Windows: Malicious Windows Script Components File Execution by TAEF Detection | Security | Windows Test Authoring and Execution Framework (TAEF) framework allows you to run automation by executing tests files written on different languages (C, C#, Microsoft COM Scripting interfaces). Adversaries may execute malicious code (such as WSC file with VBScript, dll and so on) directly by running te.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_use_of_te_bin.yml | Windows: Malicious Windows Script Components File Execution by TAEF Detection | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\te\.exe"" OR parentProcName REGEXP "".*\\te\.exe"" OR srcFileName=""\\te.exe"") |
| Windows: Invoke-Obfuscation Obfuscated IEX Invocation: Security Log | Security | Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the code block linked in the references. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_invoke_obfuscation_obfuscated_iex_services_security.yml | Windows: Invoke-Obfuscation Obfuscated IEX Invocation: Security Log | eventType=""Win-Security-4697"" AND (serviceFileName REGEXP ""\$PSHome\[\s*\d{1,3}\s*\]\s*\+\s*\$PSHome\[|\$ShellId\[\s*\d{1,3}\s*\]\s*\+\s*\$ShellId\[|\$VerbosePreference\.ToString\(|\$env:ComSpec\[(\s*\d{1,3}\s*,){2}|\$env:Public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:Public\[|\String\]\s*\$VerbosePreference|\\*mdr\*\W\s*\)\.Name"") |
| Windows: Legitimate Application Dropped Archive | Security | Detects programs on a Windows system that should not write an archive to disk. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_legitimate_app_dropping_archive.yml | Windows: Legitimate Application Dropped Archive | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\AcroRd32\.exe|.*\\CertReq\.exe|.*\\Desktopimgdownldr\.exe|.*\\RdrCEF\.exe|.*\\certoc\.exe|.*\\certutil\.exe|.*\\eqnedt32\.exe|.*\\esentutl\.exe|.*\\excel\.exe|.*\\finger\.exe|.*\\hh\.exe|.*\\msaccess\.exe|.*\\mshta\.exe|.*\\mspub\.exe|.*\\notepad\.exe|.*\\powerpnt\.exe|.*\\visio\.exe|.*\\winword\.exe|.*\\wordpad\.exe|.*\\wordview\.exe"" AND fileName REGEXP "".*\.7z|.*\.appx|.*\.diagcab|.*\.rar|.*\.zip"" |
| Windows: Invoke-Obfuscation Obfuscated IEX Invocation: System Log | Security | Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the code block linked in the references. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_obfuscated_iex_services.yml | Windows: Invoke-Obfuscation Obfuscated IEX Invocation: System Log | eventType=""Win-System-Service-Control-Manager-7045"" AND (serviceFileName REGEXP ""\$PSHome\[\s*\d{1,3}\s*\]\s*\+\s*\$PSHome\[|\$ShellId\[\s*\d{1,3}\s*\]\s*\+\s*\$ShellId\[|\$VerbosePreference\.ToString\(|\$env:ComSpec\[(\s*\d{1,3}\s*,){2}|\$env:Public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:Public\[|\String\]\s*\$VerbosePreference|\\*mdr\*\W\s*\)\.Name"") |
| Windows: Locked Workstation | Security | Automatically lock workstation sessions after a standard period of inactivity. The case is not applicable for Unix OS. Supported OS - Windows 2008 R2 and 7, Windows 2012 R2 and 8.1, Windows 2016 and 10 Windows Server 2019. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_workstation_was_locked.yml | Windows: Locked Workstation | eventType=""Win-Security-4800"" |
| Windows: Leviathan Registry Key Activity | Security | Detects registry key used by Leviathan APT in Malaysian focused campaign. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_apt_leviathan.yml | Windows: Leviathan Registry Key Activity | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath=""HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ntkd"" |
| Windows: Malicious PE Execution by Microsoft Visual Studio Debugger | Security | There is an option for a MS VS Just-In-Time Debugger ""vsjitdebugger.exe"" to launch specified executable and attach a debugger. This option may be used adversaries to execute malicious code by signed verified binary. The debugger is installed alongside with Microsoft Visual Studio package. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_use_of_vsjitdebugger_bin.yml | Windows: Malicious PE Execution by Microsoft Visual Studio Debugger | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\vsjitdebugger\.exe"" AND ((procName NOT REGEXP "".*\\vsimmersiveactivatehelper.*\.exe"" AND procName NOT REGEXP "".*\\devenv\.exe"")) |
| Windows: InfDefaultInstall.exe .inf Execution | Security | Executes SCT script using scrobj.dll from a command in entered into a specially prepared INF file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_infdefaultinstall_execute_sct_scripts.yml | Windows: InfDefaultInstall.exe .inf Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*InfDefaultInstall\.exe .*"" AND command REGEXP "".*\.inf.*"" |
| Windows: Important Windows Service Terminated With Error | Security | Detects important or interesting windows services that got terminated for whatever reason. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_terminated_error_important.yml | Windows: Important Windows Service Terminated With Error | (eventType=""Win-System-Service-Control-Manager-7023"") AND (paraName REGEXP "".* Antivirus.*|.* Firewall.*|.*Application Guard.*|.*BitLocker Drive Encryption Service.*|.*Encrypting File System.*|.*Microsoft Defender.*|.*Threat Protection.*|.*Windows Event Log.*"" OR code REGEXP "".*420044004500530056004300.*|.*450046005300.*|.*4500760065006e0074004c006f006700.*|.*530065006e0073006500.*|.*6d0070007300730076006300.*|.*770069006e0064006500660065006e006400.*"") |
| Windows: Ie4uinit Lolbin Use From Invalid Path | Security | Detect use of ie4uinit.exe to execute commands from a specially prepared ie4uinit.inf file from a directory other than the usual directories. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_ie4uinit.yml | Windows: Ie4uinit Lolbin Use From Invalid Path | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\ie4uinit\.exe"" OR srcFileName=""IE4UINIT.EXE"") AND ((dirName NOT IN (""c:\\windows\\sysWOW64\\"",""c:\\windows\\system32\\"")) AND (dirName IS NOT NULL)) |
| Windows: Lolbin Runexehelper Use As Proxy | Security | Detect usage of the ""runexehelper.exe"" binary as a proxy to launch other programs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_runexehelper.yml | Windows: Lolbin Runexehelper Use As Proxy | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\runexehelper\.exe"" |
| Windows: LOLBIN From Abnormal Drive | Security | Detects LOLBINs executing from an abnormal drive such as a mounted ISO. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_not_from_c_drive.yml | Windows: LOLBIN From Abnormal Drive | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\calc\.exe|.*\\cmstp\.exe|.*\\cscript\.exe|.*\\installutil\.exe|.*\\mshta\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wscript\.exe"" OR srcFileName IN (""CALC.EXE"",""CMSTP.EXE"",""MSHTA.EXE"",""REGSVR32.EXE"",""RUNDLL32.EXE"",""cscript.exe"",""installutil.exe"",""wscript.exe"")) AND ((dirName NOT REGEXP "".*C:\\.*"") AND (dirName IS NOT NULL) AND (dirName IS NOT NULL)) |
| Windows: Logon Scripts UserInitMprLogonScript | Security | Detects creation or execution of UserInitMprLogonScript persistence method. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_persistence_userinitmprlogonscript.yml | Windows: Logon Scripts UserInitMprLogonScript | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*UserInitMprLogonScript.*"" OR (parentProcName REGEXP "".*\\userinit\.exe"" AND (command NOT REGEXP "".*C:\\WINDOWS\\Explorer\.EXE.*|.*UsrLogon\.cmd.*|.*netlogon.*\.bat.*"" AND procName NOT REGEXP "".*\\Citrix\\System32\\icast\.exe|.*\\explorer\.exe|.*\\proquota\.exe""))) |
| Windows: KDC RC4-HMAC Downgrade CVE-2022-37966 | Security | Detects the exploitation of a security bypass and elevation of privilege vulnerability with Authentication Negotiation by using weak RC4-HMAC negotiation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/microsoft_windows_kerberos_key_distribution_center/win_system_kdcsvc_rc4_downgrade.yml | Windows: KDC RC4-HMAC Downgrade CVE-2022-37966 | eventType=""Win-System-Kerberos-Key-Distribution-Center-42"" AND permissionLevelType=""2"" |
| Windows: Kavremover Dropped Binary LOLBIN Usage | Security | Detects the execution of a signed binary dropped by Kaspersky Lab Products Remover (kavremover) which can be abused as a LOLBIN to execute arbitrary commands and binaries. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_kavremover.yml | Windows: Kavremover Dropped Binary LOLBIN Usage | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* run run-cmd .*"" AND (parentProcName NOT REGEXP "".*\\cleanapi\.exe|.*\\kavremover\.exe"") |
| Windows: Legitimate Application Dropped Script | Security | Detects programs on a Windows system that should not write scripts to disk. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_legitimate_app_dropping_script.yml | Windows: Legitimate Application Dropped Script | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\AcroRd32\.exe|.*\\CertReq\.exe|.*\\Desktopimgdownldr\.exe|.*\\RdrCEF\.exe|.*\\certoc\.exe|.*\\certutil\.exe|.*\\eqnedt32\.exe|.*\\esentutl\.exe|.*\\excel\.exe|.*\\finger\.exe|.*\\hh\.exe|.*\\msaccess\.exe|.*\\mshta\.exe|.*\\mspub\.exe|.*\\powerpnt\.exe|.*\\visio\.exe|.*\\winword\.exe|.*\\wordpad\.exe|.*\\wordview\.exe"" AND fileName REGEXP "".*\.bat|.*\.ps1|.*\.scf|.*\.vbs|.*\.wsf|.*\.wsh"" |
| Windows: LSA PPL Protection Disabled Via Reg.EXE | Security | Detects the usage of the ""reg.exe"" utility to disable PPL protection on the LSA process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_lsa_ppl_protection_disabled.yml | Windows: LSA PPL Protection Disabled Via Reg.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\reg\.exe"" OR srcFileName=""reg.exe"") AND (command REGEXP "".*SYSTEM\\CurrentControlSet\\Control\\Lsa.*"" AND command REGEXP "".* add .*"" AND command REGEXP "".* /d 0.*"" AND command REGEXP "".* /v RunAsPPL .*"") |
| Windows: Malware Shellcode in Verclsid Target Process | Security | Detects a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_malware_verclsid_shellcode.yml | Windows: Malware Shellcode in Verclsid Target Process | eventType=""Win-Sysmon-10-ProcessAccess"" AND (targetProcName REGEXP "".*\\verclsid\.exe"" AND accessKeyId=""0x1FFFFF"") AND ((procPath REGEXP "".*\|UNKNOWN\(.*"" AND procPath REGEXP "".*VBE7\.DLL.*"") OR (procName REGEXP "".*\\Microsoft Office\\.*"" AND procPath REGEXP "".*\|UNKNOWN.*"")) |
| Windows: ImagingDevices Unusual Parent/Child Processes | Security | Detects unusual parent or children of the ImagingDevices.exe (Windows Contacts) process as seen being used with Bumblebee activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_imagingdevices_unusual_parents.yml | Windows: ImagingDevices Unusual Parent/Child Processes | eventType=""Win-Sysmon-1-Create-Process"" AND ((parentProcName REGEXP "".*\\WmiPrvSE\.exe|.*\\dllhost\.exe|.*\\svchost\.exe"" AND procName REGEXP "".*\\ImagingDevices\.exe"") OR parentProcName REGEXP "".*\\ImagingDevices\.exe"") |
| Windows: Loading Diagcab Package From Remote Path | Security | Detects loading of diagcab packages from a remote path, as seen in DogWalk vulnerability. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/diagnosis/scripted/win_diagnosis_scripted_load_remote_diagcab.yml | Windows: Loading Diagcab Package From Remote Path | eventType =""Win-Diagnostics-Scripted-101"" AND procPath REGEXP "".*\\\.*"" |
| Windows: HybridConnectionManager Service Installation: Sysmon | Security | Detects the installation of the Azure Hybrid Connection Manager service to allow remote code execution from Azure function. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_hybridconnectionmgr_svc_installation.yml | Windows: HybridConnectionManager Service Installation: Sysmon | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND (regKeyPath REGEXP "".*\\Services\\HybridConnectionManager.*"" OR (osObjAction=""SetValue"" AND details REGEXP "".*Microsoft\.HybridConnectionManager\.Listener\.exe.*"")) |
| Windows: Lolbin Unregmp2.exe Use As Proxy | Security | Detect usage of the ""unregmp2.exe"" binary as a proxy to launch a custom version of ""wmpnscfg.exe"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_unregmp2.yml | Windows: Lolbin Unregmp2.exe Use As Proxy | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\unregmp2\.exe"" OR srcFileName=""unregmp2.exe"") AND command REGEXP "".* /HideWMP.*"" |
| Windows: Mimikatz Kirbi File Creation | Security | Detects the creation of files created by mimikatz such as "".kirbi"", ""mimilsa.log"", etc. Mimikatz is a open source malware program that is commonly used by hackers and security professionals to extract sensitive information, such as passwords and credentials, from a system's memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_hktl_mimikatz_files.yml | Windows: Mimikatz Kirbi File Creation | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\.kirbi|.*mimilsa\.log"" |
| Windows: Mstsc.EXE Execution From Uncommon Parent | Security | Detects potential RDP connection via Mstsc using a local "".rdp"" file located in suspicious locations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mstsc_run_local_rpd_file_susp_parent.yml | Windows: Mstsc.EXE Execution From Uncommon Parent | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\CCleanerBrowser\.exe|.*\\brave\.exe|.*\\chrome\.exe|.*\\chromium\.exe|.*\\firefox\.exe|.*\\iexplore\.exe|.*\\microsoftedge\.exe|.*\\msedge\.exe|.*\\opera\.exe|.*\\outlook\.exe|.*\\vivaldi\.exe|.*\\whale\.exe"" AND (procName REGEXP "".*\\mstsc\.exe"" OR srcFileName=""mstsc.exe"") |
| Windows: New Port Forwarding Rule Added Via Netsh.EXX | Security | Detects the execution of netsh commands that configure a new port forwarding (PortProxy) rule. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_port_forwarding.yml | Windows: New Port Forwarding Rule Added Via Netsh.EXX | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\netsh\.exe"" OR srcFileName=""netsh.exe"") AND ((command REGEXP "".*interface.*"" AND command REGEXP "".*portproxy.*"" AND command REGEXP "".*add.*"" AND command REGEXP "".*v4tov4.*"") OR (command REGEXP "".*i .*"" AND command REGEXP "".*p .*"" AND command REGEXP "".*a .*"" AND command REGEXP "".*v .*"") OR (command REGEXP "".*connectp.*"" AND command REGEXP "".*listena.*"" AND command REGEXP "".*c=.*"")) |
| Windows: MSSQL SPProcoption Set | Security | Detects when the a stored procedure is set or cleared for automatic execution in MSSQL. A stored procedure that is set to automatic execution runs every time an instance of SQL Server is started. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/mssqlserver/win_mssql_sp_procoption_set.yml | Windows: MSSQL SPProcoption Set | eventType=""Win-App-MSSQLSERVER-33205"" AND lineContent REGEXP "".*object_name:sp_procoption.*"" AND lineContent REGEXP "".*statement:EXEC.*"" |
| Windows: MSSQL XPCmdshell Suspicious Execution | Security | Detects when the MSSQL ""xp_cmdshell"" stored procedure is used to execute commands. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/mssqlserver/win_mssql_xp_cmdshell_audit_log.yml | Windows: MSSQL XPCmdshell Suspicious Execution | eventType=""Win-App-MSSQLSERVER-33205"" AND lineContent REGEXP "".*object_name:xp_cmdshell.*"" AND lineContent REGEXP "".*statement:EXEC.*"" |
| Windows: New Service Creation Using PowerShell | Security | Detects the creation of a new service using powershell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_create_service.yml | Windows: New Service Creation Using PowerShell | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*New-Service.*"" AND command REGEXP "".*-BinaryPathName.*"" |
| Windows: MSMQ Corrupted Packet Encountered | Security | Detects corrupted packets sent to the MSMQ service. Could potentially be a sign of CVE-2023-21554 exploitation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/msmq/win_msmq_corrupted_packet.yml | Windows: MSMQ Corrupted Packet Encountered | eventType=""Win-App-MSMQ-2027"" AND permissionLevelType=""2"" |
| Windows: Microsoft Sync Center Suspicious Network Connections | Security | Detects suspicious connections from Microsoft Sync Center to non-private IPs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_susp_outbound_mobsync_connection.yml | Windows: Microsoft Sync Center Suspicious Network Connections | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND procName REGEXP "".*\\mobsync\.exe"" AND (destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR isIpv6!=""false"") |
| Windows: Moriya Rootkit: System Log | Security | Detects the use of Moriya rootkit as described in the securelist's Operation TunnelSnake report. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_moriya_rootkit.yml | Windows: Moriya Rootkit: System Log | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceName=""ZzNetSvc"" |
| Windows: New Service Creation Using Sc.EXE | Security | Detects the creation of a new service using the ""sc.exe"" utility. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_create_service.yml | Windows: New Service Creation Using Sc.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\sc\.exe"" AND command REGEXP "".*create.*"" AND command REGEXP "".*binPath.*"" |
| Windows: Microsoft IIS Connection Strings Decryption | Security | Detects use of aspnet_regiis to decrypt Microsoft IIS connection strings. An attacker with Microsoft IIS web server access via a webshell or alike can decrypt and dump any hardcoded connection strings, such as the MSSQL service account password using aspnet_regiis command. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_iis_connection_strings_decryption.yml | Windows: Microsoft IIS Connection Strings Decryption | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\aspnet_regiis\.exe"" OR srcFileName=""aspnet_regiis.exe"") AND (command REGEXP "".*connectionStrings.*"" AND command REGEXP "".* -pdf.*"") |
| Windows: MSSQL Extended Stored Procedure Backdoor Maggie | Security | This rule detects the execution of the extended storage procedure backdoor named Maggie in the context of Microsoft SQL server. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/mssqlserver/win_mssql_sp_maggie.yml | Windows: MSSQL Extended Stored Procedure Backdoor Maggie | eventType=""Win-App-MSSQLSERVER-8128"" AND msg REGEXP "".*maggie.*"" |
| Windows: Microsoft Workflow Compiler Execution | Security | Detects invocation of Microsoft Workflow Compiler, which may permit the execution of arbitrary unsigned code. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_workflow_compiler.yml | Windows: Microsoft Workflow Compiler Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\Microsoft\.Workflow\.Compiler\.exe"" OR srcFileName=""Microsoft.Workflow.Compiler.exe"") |
| Windows: MpiExec Lolbin | Security | Detects a certain command line flag combination used by mpiexec.exe LOLBIN from HPC pack that can be used to execute any other binary. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_mpiexec.yml | Windows: MpiExec Lolbin | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\mpiexec\.exe"" OR hashIMP=""d8b52ef6aaa3a81501bdfff9dbb96217"" OR hashCode REGEXP "".*IMPHASH=d8b52ef6aaa3a81501bdfff9dbb96217.*"") AND command REGEXP "".* -n 1 .*|.* /n 1 .*"" |
| Windows: Narrator s Feedback-Hub Persistence | Security | Detects abusing Windows 10 Narrator's Feedback-Hub. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_narrator_feedback_persistance.yml | Windows: Narrator s Feedback-Hub Persistence | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND ((osObjAction=""DeleteValue"" AND regKeyPath REGEXP "".*\\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\DelegateExecute"") OR regKeyPath REGEXP "".*\\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\\(Default\)"") |
| Windows: NetSupport Manager Service Install | Security | Detects NetSupport Manager service installation on the target system. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_install_netsupport_manager.yml | Windows: NetSupport Manager Service Install | (eventType=""Win-System-Service-Control-Manager-7045"") AND (serviceFileName REGEXP "".*\\NetSupport Manager\\client32\.exe.*"" OR serviceName=""Client32"") |
| Windows: New Kernel Driver Via SC.EXE | Security | Detects creation of a new service (kernel driver) with the type ""kernel"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_new_kernel_driver.yml | Windows: New Kernel Driver Via SC.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\sc\.exe"" AND command REGEXP "".*config.*|.*create.*"" AND command REGEXP "".*binPath.*"" AND command REGEXP "".*type.*"" AND command REGEXP "".*kernel.*"" |
| Windows: MSSQL XPCmdshell Option Change | Security | Detects when the MSSQL ""xp_cmdshell"" stored procedure setting is changed. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/mssqlserver/win_mssql_xp_cmdshell_change.yml | Windows: MSSQL XPCmdshell Option Change | eventType=""Win-App-MSSQLSERVER-15457"" AND lineContent REGEXP "".*xp_cmdshell.*"" |
| Windows: MSSQL Add Account To Sysadmin Role | Security | Detects when an attacker tries to backdoor the MSSQL server by adding a backdoor account to the sysadmin fixed server role. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/mssqlserver/win_mssql_add_sysadmin_account.yml | Windows: MSSQL Add Account To Sysadmin Role | eventType=""Win-App-MSSQLSERVER-33205"" AND lineContent REGEXP "".*object_name:sysadmin.*"" AND lineContent REGEXP "".*statement:alter server role \[sysadmin\] add member .*"" |
| Windows: New Firewall Exception Rule Added For A Suspicious Folder | Security | Detects the addition of a rule to the Windows Firewall exception list where the application resides in a suspicious folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/firewall_as/win_firewall_as_add_rule_susp_folder.yml | Windows: New Firewall Exception Rule Added For A Suspicious Folder | ((eventType IN (""Win-Firewall-AS-2004"",""Win-Firewall-AS-2071"") AND procPath REGEXP "".*\\AppData\\.*|.*\\Temp\\.*"") AND ((eventAction!=2))) AND ((procPath NOT REGEXP "".*\\AppData\\local\\microsoft\\teams\\current\\teams\.exe"") AND (procPath NOT REGEXP "".*\\AppData\\Local\\Keybase\\keybase\.exe"") AND (procPath NOT REGEXP "".*\\AppData\\Local\\Programs\\Messenger\\Messenger\.exe"")) |
| Windows: New DLL Added to AppInit-DLLs Registry Key | Security | DLLs that are specified in the AppInit_DLLs value in the Registry key HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows are loaded by user32.dll into every process that loads user32.dll. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_new_dll_added_to_appinit_dlls_registry_key.yml | Windows: New DLL Added to AppInit-DLLs Registry Key | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND (regKeyPath REGEXP "".*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_Dlls|.*\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_Dlls"" OR newObjValue REGEXP "".*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_Dlls|.*\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_Dlls"") AND (details!=""(Empty)"") |
| Windows: New or Renamed User Account with $ in Attribute SamAccountName | Security | Detects possible bypass EDR and SIEM via abnormal user account name. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_new_or_renamed_user_account_with_dollar_sign.yml | Windows: New or Renamed User Account with $ in Attribute SamAccountName | (eventType=""Win-Security-4720"" AND oldTargetUser REGEXP "".*\$.*"") OR (eventType=""Win-Security-4781"" AND targetUser REGEXP "".*\$.*"") |
| Windows: Mshtml DLL RunHTMLApplication Abuse | Security | Detects suspicious command line using the ""mshtml.dll"" RunHTMLApplication export to run arbitrary code via different protocol handlers (vbscript, javascript, file, htpp...). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_mshtml_runhtmlapplication.yml | Windows: Mshtml DLL RunHTMLApplication Abuse | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\\.\.\\.*"" AND command REGEXP "".*mshtml.*"" AND command REGEXP "".*RunHTMLApplication.*"" |
| Windows: New Service Uses Double Ampersand in Path | Security | Detects a service installation that uses a suspicious double ampersand used in the image path value. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_install_susp_double_ampersand.yml | Windows: New Service Uses Double Ampersand in Path | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".*&&.*"" |
| Windows: New Firewall Rule Added In Windows Firewall Exception List | Security | Detects when a rule has been added to the Windows Firewall exception list. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/firewall_as/win_firewall_as_add_rule.yml | Windows: New Firewall Rule Added In Windows Firewall Exception List | (eventType REGEXP ""Win-.*-2004[^\d]*|Win-.*-2071[^\d]*"" AND ((eventAction!=2) AND (procPath NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"" AND appName!=""C:\\Windows\\System32\\oobe\\Setup.exe"" AND appName NOT REGEXP ""C:\\Windows\\WinSxS\\.*"" AND appName NOT IN (""C:\\Program Files\\Windows Defender\\MsMpEng.exe"",""C:\\Windows\\SysWOW64\\msiexec.exe"",""C:\\Windows\\System32\\dllhost.exe"",""C:\\Windows\\System32\\svchost.exe"")))) AND ((appName NOT REGEXP ""C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\.*"" OR appName NOT REGEXP "".*\\MsMpEng\.exe"")) |
| Windows: MSSQL Disable Audit Settings | Security | Detects when an attacker calls the ""ALTER SERVER AUDIT"" or ""DROP SERVER AUDIT"" transaction in order to delete or disable audit logs on the server. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/mssqlserver/win_mssql_disable_audit_settings.yml | Windows: MSSQL Disable Audit Settings | eventType=""Win-App-MSSQLSERVER-33205"" AND lineContent REGEXP "".*statement:ALTER SERVER AUDIT.*|.*statement:DROP SERVER AUDIT.*"" |
| Windows: MSExchange Transport Agent Installation | Security | Detects the Installation of a Exchange Transport Agent. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_msexchange_transport_agent.yml | Windows: MSExchange Transport Agent Installation | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Install-TransportAgent.*"" |
| Windows: Manage Engine Java Suspicious Sub Process | Security | Detects suspicious sub processes started by the Manage Engine ServiceDesk Plus Java web service process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_manageengine_pattern.yml | Windows: Manage Engine Java Suspicious Sub Process | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\ManageEngine\\ServiceDesk\\.*"" AND parentProcName REGEXP "".*\\java\.exe.*"" AND procName REGEXP "".*\\AppVLP\.exe|.*\\bash\.exe|.*\\bitsadmin\.exe|.*\\certutil\.exe|.*\\cscript\.exe|.*\\curl\.exe|.*\\forfiles\.exe|.*\\mftrace\.exe|.*\\mshta\.exe|.*\\net1\.exe|.*\\net\.exe|.*\\notepad\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\query\.exe|.*\\reg\.exe|.*\\schtasks\.exe|.*\\scrcons\.exe|.*\\sh\.exe|.*\\systeminfo\.exe|.*\\whoami\.exe|.*\\wmic\.exe|.*\\wscript\.exe"") AND ((procName NOT REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR command NOT REGEXP "".* stop.*"")) |
| Windows: New PDQDeploy Service - Server Side | Security | Detects a PDQDeploy service installation which indicates that PDQDeploy was installed on the machines. PDQDeploy can be abused by attackers to remotely install packages or execute commands on target machines . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_install_pdqdeploy.yml | Windows: New PDQDeploy Service - Server Side | (eventType=""Win-System-Service-Control-Manager-7045"") AND (serviceFileName REGEXP "".*PDQDeployService\.exe.*"" OR serviceName IN (""PDQ Deploy"",""PDQDeploy"")) |
| Windows: New ActiveScriptEventConsumer Created Via Wmic.EXE | Security | Detects WMIC executions in which an event consumer gets created. This could be used to establish persistence. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_eventconsumer_creation.yml | Windows: New ActiveScriptEventConsumer Created Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*ActiveScriptEventConsumer.*"" AND command REGEXP "".* CREATE .*"" |
| Windows: New PDQDeploy Service - Client Side | Security | Detects PDQDeploy service installation on the target system. When a package is deployed via PDQDeploy it installs a remote service on the target machine with the name ""PDQDeployRunner-X"" where ""X"" is an integer starting from 1 . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_install_pdqdeploy_runner.yml | Windows: New PDQDeploy Service - Client Side | (eventType=""Win-System-Service-Control-Manager-7045"") AND (serviceFileName REGEXP "".*PDQDeployRunner-.*"" OR serviceName REGEXP ""PDQDeployRunner-.*"") |
| Windows: MSI Installation From Suspicious Locations | Security | Detects MSI package installation from suspicious locations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/msiinstaller/win_msi_install_from_susp_locations.yml | Windows: MSI Installation From Suspicious Locations | (eventType IN (""Win-App-MsiInstaller-1040"",""Win-App-MsiInstaller-1042"") AND lineContent REGEXP "".*C:\\Windows\\TEMP\\.*|.*\\Desktop\\.*|.*\\PerfLogs\\.*|.*\\Users\\Public\\.*|.*\\\\\.*"") AND ((lineContent NOT REGEXP "".*\\AppData\\Local\\Temp\\WinGet\\.*"") AND (lineContent NOT REGEXP "".*C:\\Windows\\TEMP\\UpdHealthTools\.msi.*"")) |
| Windows: New DLL Added to AppCertDlls Registry Key | Security | Dynamic-link libraries (DLLs) that are specified in the AppCertDLLs value in the Registry key can be abused to obtain persistence and privilege escalation by causing a malicious DLL to be loaded and run in the context of separate processes on the computer. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_new_dll_added_to_appcertdlls_registry_key.yml | Windows: New DLL Added to AppCertDlls Registry Key | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND (regKeyPath=""HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls"" OR newObjValue=""HKLM\\SYSTEM\\CurentControlSet\\Control\\Session Manager\\AppCertDlls"") |
| Windows: Microsoft IIS Service Account Password Dumped | Security | Detects the Internet Information Services (IIS) command-line tool, AppCmd, being used to list passwords. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_iis_appcmd_service_account_password_dumped.yml | Windows: Microsoft IIS Service Account Password Dumped | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\appcmd\.exe"" OR srcFileName=""appcmd.exe"") AND command REGEXP "".*list .*"") AND (command REGEXP "".* -config.*|.* -xml.*|.* /config.*|.* /xml.*"" OR (command REGEXP "".* -@t.*|.* -show.*|.* -text.*|.* /@t.*|.* /show.*|.* /text.*"" AND command REGEXP "".*:\.*|.*password.*"")) |
| Windows: OpenWith.exe Executes Specified Binary | Security | The OpenWith.exe executes other binary. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_openwith.yml | Windows: OpenWith.exe Executes Specified Binary | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\OpenWith\.exe"" AND command REGEXP "".*/c.*"" |
| Windows: PCRE.NET Package Temp Files | Security | Detects processes creating temp files related to PCRE.NET package. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_pcre_net_temp_file.yml | Windows: PCRE.NET Package Temp Files | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\AppData\\Local\\Temp\\ba9ea7344a4a5f591d6e5dc32a13494b\\.*"" |
| Windows: Ngrok Usage with Remote Desktop Service | Security | Detects cases in which ngrok, a reverse proxy tool, forwards events to the local RDP port, which could be a sign of malicious behaviour. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/terminalservices/win_terminalservices_rdp_ngrok.yml | Windows: Ngrok Usage with Remote Desktop Service | eventType REGEXP ""Win-.*-21-.*"" AND remoteAddress REGEXP "".*16777216.*"" |
| Windows: Obfuscated Command Line Using Special Unicode Characters | Security | Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_char_in_cmd.yml | Windows: Obfuscated Command Line Using Special Unicode Characters | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP ( "".*Â£.*|.*Â®.*|.*Â¯.*|.*Âµ.*|.*Â¶.*|.*Ã¢.*|.*â‚¬.*"" ) |
| Windows: Obfuscated IP Via CLI | Security | Detects usage of an encoded/obfuscated version of an IP address (hex, octal...) via commandline. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_obfuscated_ip_via_cli.yml | Windows: Obfuscated IP Via CLI | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\arp\.exe|.*\\ping\.exe"" AND (command REGEXP "".* 0x.*"" OR command REGEXP "" [0-9]{7,13}"") |
| Windows: NPPSpy Hacktool Usage | Security | Detects the use of NPPSpy hacktool that stores cleartext passwords of users that logged in to a local file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_hktl_nppspy.yml | Windows: NPPSpy Hacktool Usage | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\NPPSpy\.dll|.*\\NPPSpy\.txt"" |
| Windows: OilRig APT Registry Persistence | Security | Detects OilRig registry persistence as reported by Nyotron in their March 2018 report. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_apt_oilrig_mar18.yml | Windows: OilRig APT Registry Persistence | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\UMe|.*SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\UT"" |
| Windows: Perl Inline Command Execution | Security | Detects execution of perl using the ""-e""/""-E"" flags. This is could be used as a way to launch a reverse shell or execute live perl code. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_perl_inline_command_execution.yml | Windows: Perl Inline Command Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\perl\.exe"" OR srcFileName=""perl.exe"") AND command REGEXP "".* -e.*"" |
| Windows: Password Protected ZIP File Opened Suspicious Filenames | Security | Detects the extraction of password protected ZIP archives with suspicious file names. See the filename variable for more details on which file has been opened. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_opened_encrypted_zip_filename.yml | Windows: Password Protected ZIP File Opened Suspicious Filenames | eventType=""Win-Security-5379"" AND targetName REGEXP "".*Microsoft_Windows_Shell_ZipFolder:filename.*"" AND targetName REGEXP "".*delivery.*|.*factura.*|.*invoice.*|.*new order.*|.*order.*|.*payment.*|.*purchase.*|.*rechnung.*"" |
| Windows: OneNote Attachment File Dropped In Suspicious Location | Security | Detects creation of files with the "".one""/"".onepkg"" extension in suspicious or uncommon locations. This could be a sign of attackers abusing OneNote attachments. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_onenote_files_in_susp_locations.yml | Windows: OneNote Attachment File Dropped In Suspicious Location | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*C:\\Temp\\.*|.*\\AppData\\Local\\Temp\\.*|.*\\Users\\Public\\.*|.*\\Windows\\Temp\\.*"" AND fileName REGEXP "".*\.one|.*\.onepkg"" |
| Windows: Php Inline Command Execution | Security | Detects execution of php using the ""-r"" flag. This is could be used as a way to launch a reverse shell or execute live php code. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_php_inline_command_execution.yml | Windows: Php Inline Command Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\php\.exe"" OR srcFileName=""php.exe"") AND command REGEXP "".* -r.*"" |
| Windows: Nslookup PowerShell Download Cradle - ProcessCreation | Security | Detects suspicious powershell download cradle using nslookup. This cradle uses nslookup to extract payloads from DNS records. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_nslookup_poweshell_download.yml | Windows: Nslookup PowerShell Download Cradle - ProcessCreation | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\nslookup\.exe.*"" OR srcFileName=""\\nslookup.exe"") AND (parentProcName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND command REGEXP "".* -q=txt .*|.* -querytype=txt .*"") |
| Windows: Office Application Startup - Office Test | Security | Detects the addition of office test registry that allows a user to specify an arbitrary DLL that will be executed every time an Office application is started. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_office_test_regadd.yml | Windows: Office Application Startup - Office Test | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath IN (""HKCU\\Software\\Microsoft\\Office test\\Special\\Perf"",""HKLM\\Software\\Microsoft\\Office test\\Special\\Perf"") |
| Windows: Office Template Creation | Security | Detects creation of template files for Microsoft Office from outside Office. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_word_template_creation.yml | Windows: Office Template Creation | eventType=""Win-Sysmon-11-FileCreate"" AND ((fileName REGEXP "".*\.doc|.*\.docm|.*\.docx|.*\.dot|.*\.dotm|.*\.rtf"" AND fileName REGEXP "".*\\Microsoft\\Word\\Startup.*"") OR (fileName REGEXP "".*\.xls|.*\.xlsm|.*\.xlsx|.*\.xlt|.*\.xltm"" AND fileName REGEXP "".*\\Microsoft\\Excel\\Startup.*"")) AND (procName NOT REGEXP "".*\\EXCEL\.exe|.*\\WINWORD\.exe"") |
| Windows: New User Created Via Net.EXE | Security | Identifies the creation of local users via the net.exe command. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_user_add.yml | Windows: New User Created Via Net.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR srcFileName IN (""net.exe"",""net1.exe"")) AND (command REGEXP "".*user.*"" AND command REGEXP "".*add.*"") |
| Windows: PCRE.NET Package Image Load | Security | Detects processes loading modules related to PCRE.NET package. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_pcre_net_load.yml | Windows: PCRE.NET Package Image Load | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\AppData\\Local\\Temp\\ba9ea7344a4a5f591d6e5dc32a13494b\\.*"" |
| Windows: Possible Shim Database Persistence via sdbinst.exe | Security | Detects installation of a new shim using sdbinst.exe. A shim can be used to load malicious DLLs into applications. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sdbinst_shim_persistence.yml | Windows: Possible Shim Database Persistence via sdbinst.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\sdbinst\.exe"" AND command REGEXP "".*\.sdb.*"") AND (command NOT REGEXP "".*iisexpressshim\.sdb.*"") |
| Windows: Persistence Via TypedPaths - CommandLine | Security | Detects modification addition to the 'TypedPaths' key in the user or admin registry via the commandline. Which might indicate persistence attempt. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_registry_typed_paths_persistence.yml | Windows: Persistence Via TypedPaths - CommandLine | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths.*"" |
| Windows: Password Change on Directory Service Restore Mode DSRM Account | Security | The Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers. Attackers may change the password to gain persistence. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_dsrm_password_change.yml | Windows: Password Change on Directory Service Restore Mode DSRM Account | eventType=""Win-Security-4794"" |
| Windows: Password Provided In Command Line Of Net.EXE | Security | Detects a when net.exe is called with a password in the command line. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_use_password_plaintext.yml | Windows: Password Provided In Command Line Of Net.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR srcFileName IN (""net.exe"",""net1.exe"")) AND (command REGEXP "".* use .*"" AND command REGEXP "".*:.*\\\.*"" AND command REGEXP "".*/USER:.* .*"")) AND ((command NOT REGEXP "".* "")) |
| Windows: New User Created Via Net.EXE With Never Expire Option | Security | Detects creation of local users via the net.exe command with the option ""never expire"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_user_add_never_expire.yml | Windows: New User Created Via Net.EXE With Never Expire Option | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR srcFileName IN (""net.exe"",""net1.exe"")) AND (command REGEXP "".*user.*"" AND command REGEXP "".*add.*"" AND command REGEXP "".*expires:never.*"") |
| Windows: Obfuscated IP Download | Security | Detects use of an encoded/obfuscated version of an IP address (hex, octal...) in an URL combined with a download command. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_obfuscated_ip_download.yml | Windows: Obfuscated IP Download | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*DownloadFile.*|.*DownloadString.*|.*Invoke-WebRequest.*|.*curl .*|.*iwr .*|.*wget .*"" AND (command REGEXP "".*//0x.*|.*\.00x.*|.*\.0x.*"" OR (command REGEXP "".*http://%.*"" AND command REGEXP "".*%2e.*"")) |
| Windows: Persistence Via Sticky Key Backdoor | Security | By replacing the sticky keys executable with the local admins CMD executable, an attacker is able to access a privileged windows console session without authenticating to the system. When the sticky keys are ""activated"" the privilleged shell is launched. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_sticky_keys_replace.yml | Windows: Persistence Via Sticky Key Backdoor | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*copy .*"" AND command REGEXP "".*/y .*"" AND command REGEXP "".*C:\\windows\\system32\\cmd\.exe C:\\windows\\system32\\sethc\.exe.*"" |
| Windows: Password Protected ZIP File Opened | Security | Detects the extraction of password protected ZIP archives. See the filename variable for more details on which file has been opened. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_opened_encrypted_zip.yml | Windows: Password Protected ZIP File Opened | (eventType=""Win-Security-5379"" AND targetName REGEXP "".*Microsoft_Windows_Shell_ZipFolder:filename.*"") AND (targetName NOT REGEXP "".*\\Temporary Internet Files\\Content\.Outlook.*"") |
| Windows: Ntdsutil Abuse | Security | Detects potential abuse of ntdsutil to dump ntds.dit database. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/esent/win_esent_ntdsutil_abuse.yml | Windows: Ntdsutil Abuse | eventType IN (""Win-PrintService-Setup-Succeeded"",""Win-PrintService-Remove-Printer-Failed"") AND lineContent REGEXP "".*ntds\.dit.*"" |
| Windows: Path To Screensaver Binary Modified | Security | Detects value modification of registry key containing path to binary used as screensaver. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_modify_screensaver_binary_path.yml | Windows: Path To Screensaver Binary Modified | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*\\Control Panel\\Desktop\\SCRNSAVE\.EXE"" AND (procName NOT REGEXP "".*\\explorer\.exe|.*\\rundll32\.exe"") |
| Windows: Outgoing Logon with New Credentials | Security | Detects logon events that specify new credentials. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_susp_logon_newcredentials.yml | Windows: Outgoing Logon with New Credentials | eventType=""Win-Security-4624"" AND winLogonType=9 |
| Windows: New Shim Database Created in the Default Directory | Security | Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims. The Microsoft Windows Application Compatibility Infrastructure/Framework (Application Shim) was created to allow for backward compatibility of software as the operating system codebase changes over time. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_creation_new_shim_database.yml | Windows: New Shim Database Created in the Default Directory | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\.sdb"" AND fileName REGEXP "".*\\Windows\\apppatch\\Custom\\.*"" |
| Windows: Possible Shadow Credentials Added | Security | Detects possible addition of shadow credentials to an active directory object. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_possible_shadow_credentials_added.yml | Windows: Possible Shadow Credentials Added | eventType=""Win-Security-5136"" AND propName=""msDS-KeyCredentialLink"" |
| Windows: Parent in Public Folder Suspicious Process | Security | This rule detects suspicious processes with parent images located in the C:\Users\Public folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_execution_from_public_folder_as_parent.yml | Windows: Parent in Public Folder Suspicious Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP ""C:\\Users\\Public\\.*"" AND command REGEXP "".*bitsadmin.*|.*certutil.*|.*cmd /c .*|.*cmd /k .*|.*cmd /r .*|.*cmd\.exe /c .*|.*cmd\.exe /k .*|.*cmd\.exe /r .*|.*cscript\.exe.*|.*mshta\.exe.*|.*powershell.*|.*wscript\.exe.*"" |
| Windows: PortProxy Registry Key | Security | Detects the modification of PortProxy registry key which is used for port forwarding. For command execution see rule win_netsh_port_fwd.yml. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_portproxy_registry_key.yml | Windows: PortProxy Registry Key | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath=""HKLM\\SYSTEM\\CurrentControlSet\\Services\\PortProxy\\v4tov4\\tcp"" |
| Windows: Password Protected ZIP File Opened Email Attachment | Security | Detects the extraction of password protected ZIP archives. See the filename variable for more details on which file has been opened. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_opened_encrypted_zip_outlook.yml | Windows: Password Protected ZIP File Opened Email Attachment | eventType=""Win-Security-5379"" AND targetName REGEXP "".*Microsoft_Windows_Shell_ZipFolder:filename.*"" AND targetName REGEXP "".*\\Temporary Internet Files\\Content\.Outlook.*"" |
| Windows: Phishing Pattern ISO in Archive | Security | Detects cases in which an ISO files is opend within an archiver like 7Zip or Winrar, which is a sign of phishing as threat actors put small ISO files in archives as email attachments to bypass certain filters and protective measures (mark of web). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_archiver_iso_phishing.yml | Windows: Phishing Pattern ISO in Archive | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\7zFM\.exe|.*\\Winrar\.exe|.*\\peazip\.exe"" AND procName REGEXP "".*\\ImgBurn\.exe|.*\\PowerISO\.exe|.*\\isoburn\.exe"" |
| Windows: Potential Remote Desktop Tunneling | Security | Detects potential use of an SSH utility to establish RDP over a reverse SSH Tunnel. This can be used by attackers to enable routing of network packets that would otherwise not reach their intended destination. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_remote_desktop_tunneling.yml | Windows: Potential Remote Desktop Tunneling | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*:3389.*"" AND command REGEXP "".* -L .*|.* -P .*|.* -R .*|.* -pw .*|.* -ssh .*"" |
| Windows: Potential Recon Activity Using DriverQuery.EXE | Security | Detect usage of the ""driverquery"" utility to perform reconnaissance on installed drivers. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_driverquery_recon.yml | Windows: Potential Recon Activity Using DriverQuery.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*driverquery\.exe"" OR srcFileName=""drvqry.exe"") AND (parentProcName REGEXP "".*\\cmd\.exe|.*\\cscript\.exe|.*\\mshta\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\wscript\.exe"" OR parentProcName REGEXP "".*\\AppData\\Local\\.*|.*\\Users\\Public\\.*|.*\\Windows\\Temp\\.*"") |
| Windows: Potential Cobalt Strike Process Patterns | Security | Detects potential process patterns related to Cobalt Strike beacon activity. Cobalt Strike (https://www.cobaltstrike.com/) is an adversary simulation tool with a post-exploitation agent and covert channels to emulate a quiet long-term embedded actor in your network. It uses Process injection, a defense evasion technique that runs custom code within the address space of another process, thereby avoiding detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_process_patterns.yml | Windows: Potential Cobalt Strike Process Patterns | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*cmd\.exe /C whoami"" AND parentProcName REGEXP ""C:\\Temp\\.*"") OR (parentProcName REGEXP "".*\\dllhost\.exe|.*\\runonce\.exe"" AND command REGEXP "".*cmd\.exe /c echo.*"" AND command REGEXP "".*> \\\\\.\\pipe.*"") OR (parentCommand REGEXP "".*cmd\.exe /C echo.*"" AND parentCommand REGEXP "".* > \\\\\.\\pipe.*"" AND command REGEXP "".*conhost\.exe 0xffffffff -ForceV1"") OR (parentCommand REGEXP "".*/C whoami"" AND command REGEXP "".*conhost\.exe 0xffffffff -ForceV1"")) |
| Windows: Potential Remote Credential Dumping Activity | Security | Detects default filenames output from the execution of CrackMapExec and Impacket-secretsdump against an endpoint. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_hktl_remote_cred_dump.yml | Windows: Potential Remote Credential Dumping Activity | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\svchost\.exe"" |
| Windows: Potential Shellcode Injection | Security | Detects potential shellcode injection used by tools such as Metasploit's migrate and Empire's psinject. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_shellcode_inject_msf_empire.yml | Windows: Potential Shellcode Injection | eventType=""Win-Sysmon-10-ProcessAccess"" AND (accessKeyId IN (""0x147a"",""0x1f3fff"") AND procPath REGEXP "".*UNKNOWN.*"") AND ((procName NOT REGEXP ""C:\\Program Files \(x86\)\\Dell\\.*|C:\\Program Files\\Dell\\.*"" OR targetProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Dell\\.*|C:\\Program Files\\Dell\\.*"" OR accessKeyId!=""0x1F3FFF"" OR procPath NOT REGEXP ""C:\\Windows\\System32\\ntdll\.dll.*"") AND (procName!=""C:\\Program Files (x86)\\Dell\\UpdateService\\ServiceShell.exe"" OR targetProcName!=""C:\\Windows\\Explorer.EXE"" OR accessKeyId!=""0x1F3FFF"" OR procPath NOT REGEXP ""C:\\Windows\\System32\\ntdll\.dll.*"") AND (procName NOT IN (""C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\IDE\\PerfWatson2.exe"",""C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\PerfWatson2.exe"") OR targetProcName NOT IN (""C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\IDE\\devenv.exe"",""C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\devenv.exe"") OR procPath NOT REGEXP ""C:\\Windows\\System32\\ntdll\.dll.*"") AND (procName NOT REGEXP ""C:\\Program Files\\Microsoft Visual Studio\\.*"" OR procName NOT REGEXP "".*\\MSBuild\\Current\\Bin\\MSBuild\.exe"" OR targetProcName!=""C:\\Program Files\\Dell\\DellDataVault\\DDVDataCollector.exe"") AND (procName!=""C:\\Windows\\System32\\Wbem\\Wmiprvse.exe"" OR targetProcName!=""C:\\Windows\\system32\\lsass.exe"" OR procPath NOT REGEXP ""C:\\Windows\\SYSTEM32\\ntdll\.dll.*"" OR procPath NOT REGEXP "".*\\System\.ni\.dll\+.*"")) |
| Windows: Potential Privilege Escalation Using Symlink Between Osk and Cmd | Security | Detects the creation of a symbolic link between ""cmd.exe"" and the accessibility on-screen keyboard binary (osk.exe) using ""mklink"". This technique provides an elevated command prompt to the user from the login screen without the need to log in. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_mklink_osk_cmd.yml | Windows: Potential Privilege Escalation Using Symlink Between Osk and Cmd | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe"" OR srcFileName=""Cmd.Exe"") AND (command REGEXP "".*mklink.*"" AND command REGEXP "".*\\osk\.exe.*"" AND command REGEXP "".*\\cmd\.exe.*"") |
| Windows: Potential DLL Sideloading Using Coregen.exe | Security | Detect usage of DLL ""coregen.exe"" (Microsoft CoreCLR Native Image Generator) binary to sideload arbitrary DLLs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_coregen.yml | Windows: Potential DLL Sideloading Using Coregen.exe | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\coregen\.exe"" AND (loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft Silverlight\\.*|C:\\Program Files\\Microsoft Silverlight\\.*|C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*"") |
| Windows: Potential RipZip Attack on Startup Folder | Security | Detects a phishing attack which expands a ZIP file containing a malicious shortcut. If the victim expands the ZIP file via the explorer process, then the explorer process expands the malicious ZIP file and drops a malicious shortcut redirected to a backdoor into the Startup folder. Additionally, the file name of the malicious shortcut in Startup folder contains {0AFACED1-E828-11D1-9187-B532F1E9575D} meaning the folder shortcut operation. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_ripzip_attack.yml | Windows: Potential RipZip Attack on Startup Folder | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Microsoft\\Windows\\Start Menu\\Programs\\Startup.*"" AND fileName REGEXP "".*\.lnk\.\{0AFACED1-E828-11D1-9187-B532F1E9575D\}.*"" AND procName REGEXP "".*\\explorer\.exe"" |
| Windows: Potential Arbitrary Code Execution Via Node.EXE | Security | Detects the execution node.exe which is shipped with multiple software such as VMware, Adobe...etc. In order to execute arbitrary code. For example to establish reverse shell as seen in Log4j attacks...etc. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_node_abuse.yml | Windows: Potential Arbitrary Code Execution Via Node.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\node\.exe"" AND command REGEXP "".* --eval .*|.* -e .*"" AND command REGEXP "".*\.exec\(.*"" AND command REGEXP "".*net\.socket.*"" AND command REGEXP "".*\.connect.*"" AND command REGEXP "".*child_process.*"" |
| Windows: Potential Active Directory Enumeration Using AD Module - ProcCreation | Security | Detects usage of the ""Import-Module"" cmdlet to load the ""Microsoft.ActiveDirectory.Management.dl"" DLL. Which is often used by attackers to perform AD enumeration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_active_directory_module_dll_import.yml | Windows: Potential Active Directory Enumeration Using AD Module - ProcCreation | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".*Import-Module .*|.*ipmo .*"" AND command REGEXP "".*Microsoft\.ActiveDirectory\.Management\.dll.*"" |
| Windows: Potential RDP Session Hijacking Activity | Security | Detects potential RDP Session Hijacking activity on Windows systems. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_tscon_rdp_session_hijacking.yml | Windows: Potential RDP Session Hijacking Activity | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\tscon\.exe"" OR srcFileName=""tscon.exe"") AND integrityLevel=""SYSTEM"" |
| Windows: Potential Renamed Rundll32 Execution | Security | Detects when 'DllRegisterServer' is called in the commandline and the image is not rundll32. This could mean that the 'rundll32' utility has been renamed in order to avoid detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_rundll32_dllregisterserver.yml | Windows: Potential Renamed Rundll32 Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*DllRegisterServer.*"" AND (procName NOT REGEXP "".*\\rundll32\.exe"") |
| Windows: Potential COM Objects Download Cradles Usage - Process Creation | Security | Detects usage of COM objects that can be abused to download files in PowerShell by CLSID. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_download_com_cradles.yml | Windows: Potential COM Objects Download Cradles Usage - Process Creation | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\[Type\]::GetTypeFromCLSID\(.*"" AND command REGEXP "".*000209FF-0000-0000-C000-000000000046.*|.*00024500-0000-0000-C000-000000000046.*|.*0002DF01-0000-0000-C000-000000000046.*|.*2087c2f4-2cef-4953-a8ab-66779b670495.*|.*88d96a0a-f192-11d4-a65f-0040963251e5.*|.*88d96a0b-f192-11d4-a65f-0040963251e5.*|.*AFB40FFD-B609-40A3-9828-F88BBE11E4E3.*|.*AFBA6B42-5692-48EA-8141-DC517DCF0EF1.*|.*F5078F35-C551-11D3-89B9-0000F81FE221.*|.*F6D90F16-9C73-11D3-B32E-00C04F990BB4.*"" |
| Windows: Potential Process Injection Via Msra.EXE | Security | Detects potential process injection via Microsoft Remote Asssistance (Msra.exe) by looking at suspicious child processes spawned from the aforementioned process. It has been a target used by many threat actors and used for discovery and persistence tactics. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msra_process_injection.yml | Windows: Potential Process Injection Via Msra.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\msra\.exe"" AND parentCommand REGEXP "".*msra\.exe"" AND procName REGEXP "".*\\arp\.exe|.*\\cmd\.exe|.*\\net\.exe|.*\\netstat\.exe|.*\\nslookup\.exe|.*\\route\.exe|.*\\schtasks\.exe|.*\\whoami\.exe"" |
| Windows: Potential NTLM Coercion Via Certutil.EXE | Security | Detects possible NTLM coercion via certutil using the 'syncwithWU' flag. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_certutil_ntlm_coercion.yml | Windows: Potential NTLM Coercion Via Certutil.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\certutil\.exe"" OR srcFileName=""CertUtil.exe"") AND (command REGEXP "".* -syncwithWU .*"" AND command REGEXP "".* \\\\\.*"") |
| Windows: Potential Binary Or Script Dropper Via PowerShell | Security | Detects PowerShell creating a binary executable or a script file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_powershell_drop_binary_or_script.yml | Windows: Potential Binary Or Script Dropper Via PowerShell | eventType=""Win-Sysmon-11-FileCreate"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND fileName REGEXP "".*\.bat|.*\.chm|.*\.cmd|.*\.com|.*\.dll|.*\.exe|.*\.hta|.*\.jar|.*\.js|.*\.ocx|.*\.scr|.*\.sys|.*\.vbe|.*\.vbs|.*\.wsf"") AND ((fileName NOT REGEXP ""C:\\Users\\.*"" OR fileName NOT REGEXP "".*\\AppData\\Local\\Temp\\.*"" OR fileName NOT REGEXP "".*\.dll|.*\.exe"") AND (fileName NOT REGEXP ""C:\\Windows\\Temp\\.*"" OR fileName NOT REGEXP "".*\.dll|.*\.exe"")) |
| Windows: Potential Persistence Via Outlook Form | Security | Detects the creation of a new Outlook form which can contain malicious code. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_outlook_newform.yml | Windows: Potential Persistence Via Outlook Form | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\outlook\.exe"" AND fileName REGEXP "".*\\AppData\\Local\\Microsoft\\FORMS\\IPM.*|.*\\Local Settings\\Application Data\\Microsoft\\Forms.*"" |
| Windows: Potential Persistence Via Netsh Helper DLL | Security | Detects the execution of netsh with ""add helper"" flag in order to add a custom helper DLL. This technique can be abused to add a malicious helper DLL that can be used as a persistence proxy that gets called when netsh.exe is executed. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_helper_dll_persistence.yml | Windows: Potential Persistence Via Netsh Helper DLL | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\netsh\.exe"" AND command REGEXP "".*add.*"" AND command REGEXP "".*helper.*"" |
| Windows: Potential Credential Dumping Attempt Using New NetworkProvider - CLI | Security | Detects when an attacker tries to add a new network provider in order to dump clear text credentials, similar to how the NPPSpy tool does it. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_registry_new_network_provider.yml | Windows: Potential Credential Dumping Attempt Using New NetworkProvider - CLI | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\System\\CurrentControlSet\\Services\\.*"" AND command REGEXP "".*\\NetworkProvider.*"" |
| Windows: Potential DLL File Download Via PowerShell Invoke-WebRequest | Security | Detects potential DLL files being downloaded using the PowerShell Invoke-WebRequest cmdlet. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_download_dll.yml | Windows: Potential DLL File Download Via PowerShell Invoke-WebRequest | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*IWR .*|.*Invoke-WebRequest .*"" AND command REGEXP "".*http.*"" AND command REGEXP "".*OutFile.*"" AND command REGEXP "".*\.dll.*"" |
| Windows: Potential Recon Activity Using Wevtutil | Security | Detects usage of the wevtutil utility to perform reconnaissance. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wevtutil_recon.yml | Windows: Potential Recon Activity Using Wevtutil | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\wevtutil\.exe"" AND command REGEXP "".* qe .*|.* query-events .*"" AND command REGEXP "".*Microsoft-Windows-Terminal-Services-RemoteConnectionManager/Operational.*|.*Microsoft-Windows-TerminalServices-LocalSessionManager/Operational.*|.*Security.*"" |
| Windows: Potential Command Line Path Traversal Evasion Attempt | Security | Detects potential evasion or obfuscation attempts using bogus path traversal via the commandline. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_commandline_path_traversal_evasion.yml | Windows: Potential Command Line Path Traversal Evasion Attempt | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\Windows\\.*"" AND command REGEXP "".*\\\.\.\\System32\\.*|.*\\\.\.\\Windows\\.*|.*\\\.\.\\\.\.\\.*"") OR command REGEXP "".*\.exe\\\.\.\\.*"") AND ((command NOT REGEXP "".*\\Google\\Drive\\googledrivesync\.exe\\\.\.\\.*"") AND (command NOT REGEXP "".*\\Citrix\\Virtual Smart Card\\Citrix\.Authentication\.VirtualSmartcard\.Launcher\.exe\\\.\.\\.*"")) |
| Windows: Potential Signing Bypass Via Windows Developer Features | Security | Detects when a user enable developer features such as ""Developer Mode"" or ""Application Sideloading"". Which allows the user to install untrusted packages. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_systemsettingsadminflows_turn_on_dev_features.yml | Windows: Potential Signing Bypass Via Windows Developer Features | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\SystemSettingsAdminFlows\.exe"" OR srcFileName=""SystemSettingsAdminFlows.EXE"") AND command REGEXP "".*TurnOnDeveloperFeatures.*"" AND command REGEXP "".*DeveloperUnlock.*|.*EnableSideloading.*"" |
| Windows: Potential Password Spraying Attempt Using Dsacls.EXE | Security | Detects possible password spraying attempts using Dsacls. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dsacls_password_spray.yml | Windows: Potential Password Spraying Attempt Using Dsacls.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\dsacls\.exe"" OR srcFileName=""DSACLS.EXE"") AND (command REGEXP "".*/user:.*"" AND command REGEXP "".*/passwd:.*"") |
| Windows: Potential Manage-bde.wsf Abuse To Proxy Execution | Security | Detects potential abuse of the ""manage-bde.wsf"" script as a LOLBIN to proxy execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_manage_bde.yml | Windows: Potential Manage-bde.wsf Abuse To Proxy Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\wscript\.exe"" OR srcFileName=""wscript.exe"") AND command REGEXP "".*manage-bde\.wsf.*"") OR ((parentProcName REGEXP "".*\\cscript\.exe|.*\\wscript\.exe"" AND parentCommand REGEXP "".*manage-bde\.wsf.*"") AND (procName NOT REGEXP "".*\\cmd\.exe""))) |
| Windows: Potential Persistence Attempt Via ErrorHandler.Cmd | Security | Detects creation of a file named ""ErrorHandler.cmd"" in the ""C:\WINDOWS\Setup\Scripts\"" directory which could be used as a method of persistence The content of C:\WINDOWS\Setup\Scripts\ErrorHandler.cmd is read whenever some tools under C:\WINDOWS\System32\oobe\ (e.g. Setup.exe) fail to run for any reason. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_errorhandler_persistence.yml | Windows: Potential Persistence Attempt Via ErrorHandler.Cmd | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\WINDOWS\\Setup\\Scripts\\ErrorHandler\.cmd"" |
| Windows: Potential Discovery Activity Via Dnscmd.EXE | Security | Detects an attempt to leverage dnscmd.exe to enumerate the DNS zones of a domain. DNS zones used to host the DNS records for a particular domain. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dnscmd_discovery.yml | Windows: Potential Discovery Activity Via Dnscmd.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\dnscmd\.exe"" AND command REGEXP "".*/ZonePrint.*|.*/enumrecords.*|.*/enumzones.*|.*/info.*"" |
| Windows: Potential PowerShell Execution Policy Tampering - ProcCreation | Security | Detects changes to the PowerShell execution policy registry key in order to bypass signing requirements for script execution from the CommandLine. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_registry_set_unsecure_powershell_policy.yml | Windows: Potential PowerShell Execution Policy Tampering - ProcCreation | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\Policies\\Microsoft\\Windows\\PowerShell\\ExecutionPolicy.*|.*\\ShellIds\\Microsoft\.PowerShell\\ExecutionPolicy.*"" AND command REGEXP "".*Bypass.*|.*RemoteSigned.*|.*Unrestricted.*"" |
| Windows: Potential Persistence Via Microsoft Office Add-In | Security | Detects potential persistence activity via startup add-ins that load when Microsoft Office starts (.wll/.xll are simply .dll fit for Word or Excel). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_addin_persistence.yml | Windows: Potential Persistence Via Microsoft Office Add-In | eventType=""Win-Sysmon-11-FileCreate"" AND ((fileName REGEXP "".*\\Microsoft\\Word\\Startup\\.*"" AND fileName REGEXP "".*\.wll"") OR (fileName REGEXP "".*\\Microsoft\\Excel\\Startup\\.*"" AND fileName REGEXP "".*\.xll"") OR (fileName REGEXP "".*Microsoft\\Excel\\XLSTART\\.*"" AND fileName REGEXP "".*\.xlam"") OR (fileName REGEXP "".*\\Microsoft\\Addins\\.*"" AND fileName REGEXP "".*\.ppam|.*\.xla|.*\.xlam"")) |
| Windows: Potential Malicious AppX Package Installation Attempts | Security | Detects potential installation or installation attempts of known malicious appx packages. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_mal_appx_names.yml | Windows: Potential Malicious AppX Package Installation Attempts | eventType IN (""Win-AppXDeployment-Server-400"", ""Win-AppXDeployment-Server-401"") AND procName REGEXP "".*3669e262-ec02-4e9d-bcb4-3d008b4afac9.*"" |
| Windows: Potential Persistence Via Notepad Plugins | Security | Detects creation of new "".dll"" files inside the plugins directory of a notepad++ installation by a process other than ""gup.exe"". Which could indicates possible persistence. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_notepad_plus_plus_persistence.yml | Windows: Potential Persistence Via Notepad Plugins | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP "".*\\Notepad\+\+\\plugins\\.*"" AND fileName REGEXP "".*\.dll"") AND ((procName NOT REGEXP "".*\\Notepad\+\+\\updater\\gup\.exe"") AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\Temp\\.*"" OR procName NOT REGEXP "".*Installer\.x64\.exe|.*\\target\.exe"")) |
| Windows: Potential Privilege Escalation Attempt Via .Exe.Local Technique | Security | Detects potential privilege escalation attempt via the creation of the ""*.Exe.Local"" folder inside the ""System32"" directory in order to sideload ""comctl32.dll"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_system32_local_folder_privilege_escalation.yml | Windows: Potential Privilege Escalation Attempt Via .Exe.Local Technique | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP ""C:\\Windows\\System32\\consent\.exe\.local.*|C:\\Windows\\System32\\logonUI\.exe\.local.*|C:\\Windows\\System32\\narrator\.exe\.local.*|C:\\Windows\\System32\\werFault\.exe\.local.*|C:\\Windows\\System32\\wermgr\.exe\.local.*"" AND fileName REGEXP "".*\\comctl32\.dll"" |
| Windows: Potential Dosfuscation Activity | Security | Detects possible payload obfuscation via the commandline. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_dosfuscation.yml | Windows: Potential Dosfuscation Activity | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* c\^m\^d.*|.* c\^md.*|.* cm\^d.*|.* s\^e\^t .*|.* s\^et .*|.* se\^t .*|.*%COMSPEC:~.*|.*,;,.*|.*;; ;;.*|.*;;;;.*|.*\(,\(,.*|.*\^\^.*|.*\^\|\^.*|.*\^c\^m\^d.*|.*\^cm\^d.*"" |
| Windows: Psexec Execution | Security | Detects user accept agreement execution in psexec commandline. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_psexec_execution.yml | Windows: Psexec Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\psexec\.exe"" OR srcFileName=""psexec.c"") |
| Windows: PUA - Wsudo Suspicious Execution | Security | Detects usage of wsudo (Windows Sudo Utility). Which is a tool that let the user execute programs with different permissions (System, Trusted Installer, Administrator...etc). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_wsudo_susp_execution.yml | Windows: PUA - Wsudo Suspicious Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\wsudo\.exe"" OR srcFileName=""wsudo.exe"" OR description=""Windows sudo utility"" OR parentProcName REGEXP "".*\\wsudo-bridge\.exe"" OR command REGEXP "".* --ti .*|.*-u System.*|.*-u TrustedInstaller.*|.*-uSystem.*|.*-uTrustedInstaller.*"") |
| Windows: PowerShell Web Download | Security | Detects suspicious ways to download files or content using PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_download_cradles.yml | Windows: PowerShell Web Download | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Invoke-WebRequest .*|.*\.DownloadFile\(.*|.*\.DownloadString\(.*|.*iwr .*"" |
| Windows: Proxy Execution via Wuauclt | Security | Detects the use of the Windows Update Client binary (wuauclt.exe) to proxy execute code. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_wuauclt.yml | Windows: Proxy Execution via Wuauclt | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\wuauclt\.exe"" OR srcFileName=""wuauclt.exe"") AND (command REGEXP "".*UpdateDeploymentProvider.*"" AND command REGEXP "".*\.dll.*"" AND command REGEXP "".*RunHandlerComServer.*"")) AND (command NOT REGEXP "".* /UpdateDeploymentProvider UpdateDeploymentProvider\.dll .*|.* wuaueng\.dll .*"") |
| Windows: Publisher Attachment File Dropped In Suspicious Location | Security | Detects creation of files with the "".pub"" extension in suspicious or uncommon locations. This could be a sign of attackers abusing Publisher documents. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_publisher_files_in_susp_locations.yml | Windows: Publisher Attachment File Dropped In Suspicious Location | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*C:\\Temp\\.*|.*\\AppData\\Local\\Temp\\.*|.*\\Users\\Public\\.*|.*\\Windows\\Temp\\.*"" AND fileName REGEXP "".*\.pub"" |
| Windows: PUA - System Informer Execution | Security | Detects the execution of System Informer, a task manager tool to view and manipulate processes, kernel options and other low level operations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_system_informer.yml | Windows: PUA - System Informer Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\SystemInformer\.exe"" OR srcFileName=""SystemInformer.exe"" OR description=""System Informer"" OR product=""System Informer"" OR hashCode REGEXP "".*IMPHASH=B68908ADAEB5D662F87F2528AF318F12.*|.*MD5=19426363A37C03C3ED6FEDF57B6696EC.*|.*SHA1=8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC.*|.*SHA256=8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287.*"" OR hashMD5=""19426363A37C03C3ED6FEDF57B6696EC"" OR hashSHA1=""8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC"" OR hashSHA256=""8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287"" OR hashIMP=""B68908ADAEB5D662F87F2528AF318F12"") |
| Windows: Potentially Suspicious Network Connection To Notion API | Security | Detects a non-browser process communicating with the Notion API. This could indicate potential use of a covert C2 channel such as ""OffensiveNotion C2"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_notion_api_susp_communication.yml | Windows: Potentially Suspicious Network Connection To Notion API | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND destName REGEXP "".*api\.notion\.com.*"" AND ((procName NOT REGEXP "".*\\AppData\\Local\\Programs\\Notion\\Notion\.exe"") AND (procName NOT REGEXP "".*\\brave\.exe"") AND (procName NOT IN (""C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"",""C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"")) AND (procName NOT IN (""C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"",""C:\\Program Files\\Mozilla Firefox\\firefox.exe"")) AND (procName NOT IN (""C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe"",""C:\\Program Files\\Internet Explorer\\iexplore.exe"")) AND (procName NOT REGEXP "".*\\maxthon\.exe"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeWebView\\Application\\.*"" AND procName NOT REGEXP "".*\\WindowsApps\\MicrosoftEdge\.exe"" AND procName NOT IN (""C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe"",""C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"")) AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeCore\\.*|C:\\Program Files\\Microsoft\\EdgeCore\\.*"" OR procName NOT REGEXP "".*\\msedge\.exe|.*\\msedgewebview2\.exe"") AND (procName NOT REGEXP "".*\\opera\.exe"") AND (procName NOT REGEXP "".*\\safari\.exe"") AND (procName NOT REGEXP "".*\\seamonkey\.exe"") AND (procName NOT REGEXP "".*\\vivaldi\.exe"") AND (procName NOT REGEXP "".*\\whale\.exe"")) |
| Windows: Powershell Inline Execution From A File | Security | Detects inline execution of PowerShell code from a file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_exec_data_file.yml | Windows: Powershell Inline Execution From A File | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Invoke-Command .*|.*Invoke-Expression .*|.*icm .*|.*iex .*"" AND command REGEXP "".*cat .*|.*get-content .*|.*type .*"" AND command REGEXP "".* -raw.*"" |
| Windows: Python Inline Command Execution | Security | Detects execution of python using the ""-c"" flag. This is could be used as a way to launch a reverse shell or execute live python code. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_python_inline_command_execution.yml | Windows: Python Inline Command Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((srcFileName=""python.exe"" OR procName REGEXP "".*python2\.exe|.*python3\.exe|.*python\.exe"") AND command REGEXP "".* -c.*"") AND ((parentProcName NOT REGEXP ""C:\\Program Files\\Python.*"" OR parentProcName NOT REGEXP "".*\\python\.exe"" OR parentCommand NOT REGEXP "".*-E -s -m ensurepip -U --default-pip.*"") AND (parentProcName NOT REGEXP "".*\\AppData\\Local\\Programs\\Microsoft VS Code\\Code\.exe"")) |
| Windows: Process Creation Using Sysnative Folder | Security | Detects process creation events that use the Sysnative folder (common for CobaltStrike spawns). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_sysnative.yml | Windows: Process Creation Using Sysnative Folder | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP ""C:\\Windows\\Sysnative\\.*"" |
| Windows: PowerShell Module File Created | Security | Detects the creation of a new PowerShell module "".psm1"", "".psd1"", "".dll"", "".ps1"", etc. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_powershell_module_creation.yml | Windows: PowerShell Module File Created | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND fileName REGEXP "".*\\PowerShell\\7\\Modules\\.*|.*\\WindowsPowerShell\\Modules\\.*"" |
| Windows: Potential Winnti Dropper Activity | Security | Detects files dropped by Winnti as described in RedMimicry Winnti playbook. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_redmimicry_winnti_filedrop.yml | Windows: Potential Winnti Dropper Activity | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Windows\\Temp\\tmp\.bat|.*\\gthread-3\.6\.dll|.*\\sigcmm-2\.4\.dll"" |
| Windows: PUA - AdvancedRun Suspicious Execution | Security | Detects the execution of AdvancedRun utility in the context of the TrustedInstaller, SYSTEM, Local Service or Network Service accounts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_advancedrun_priv_user.yml | Windows: PUA - AdvancedRun Suspicious Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*/CommandLine.*|.*/EXEFilename.*"" AND (command REGEXP "".* /RunAs 10 .*|.* /RunAs 11 .*|.* /RunAs 4 .*|.* /RunAs 8 .*"" OR command REGEXP "".*/RunAs 10|.*/RunAs 11|.*/RunAs 4|.*/RunAs 8"") |
| Windows: PUA- IOX Tunneling Tool Execution | Security | Detects the use of IOX - a tool for port forwarding and intranet proxy purposes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_iox.yml | Windows: PUA- IOX Tunneling Tool Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\iox\.exe"" OR command REGEXP "".*\.exe fwd -l .*|.*\.exe fwd -r .*|.*\.exe proxy -l .*|.*\.exe proxy -r .*"" OR hashCode REGEXP "".*MD5=9DB2D314DD3F704A02051EF5EA210993.*|.*SHA1=039130337E28A6623ECF9A0A3DA7D92C5964D8DD.*|.*SHA256=C6CF82919B809967D9D90EA73772A8AA1C1EB3BC59252D977500F64F1A0D6731.*"" OR hashMD5=""9db2d314dd3f704a02051ef5ea210993"" OR hashSHA1=""039130337e28a6623ecf9a0a3da7d92c5964d8dd"" OR hashSHA256=""c6cf82919b809967d9d90ea73772a8aa1c1eb3bc59252d977500f64f1a0d6731"") |
| Windows: Potential Suspicious Windows Feature Enabled - ProcCreation | Security | Detects usage of the built-in PowerShell cmdlet ""Enable-WindowsOptionalFeature"" used as a Deployment Image Servicing and Management tool. Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_enable_susp_windows_optional_feature.yml | Windows: Potential Suspicious Windows Feature Enabled - ProcCreation | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Enable-WindowsOptionalFeature.*"" AND command REGEXP "".*-Online.*"" AND command REGEXP "".*-FeatureName.*"" AND command REGEXP "".*Client-ProjFS.*|.*Internet-Explorer-Optional-amd64.*|.*Microsoft-Windows-Subsystem-Linux.*|.*SMB1Protocol.*|.*TFTP.*|.*TelnetServer.*"" |
| Windows: PUA - Fast Reverse Proxy FRP Execution | Security | Detects the use of Fast Reverse Proxy. frp is a fast reverse proxy to help you expose a local server behind a NAT or firewall to the Internet. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_frp.yml | Windows: PUA - Fast Reverse Proxy FRP Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\frpc\.exe|.*\\frps\.exe"" OR command REGEXP "".*\\frpc\.ini.*"" OR hashCode REGEXP "".*MD5=7D9C233B8C9E3F0EA290D2B84593C842.*|.*SHA1=06DDC9280E1F1810677935A2477012960905942F.*|.*SHA256=57B0936B8D336D8E981C169466A15A5FD21A7D5A2C7DAF62D5E142EE860E387C.*"" OR hashMD5=""7d9c233b8c9e3f0ea290d2b84593c842"" OR hashSHA1=""06ddc9280e1f1810677935a2477012960905942f"" OR hashSHA256=""57b0936b8d336d8e981c169466a15a5fd21a7d5a2c7daf62d5e142ee860e387c"") |
| Windows: Privilege Escalation via Named Pipe Impersonation | Security | Detects a remote file copy attempt to a hidden network share. This may indicate lateral movement or data staging activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_priv_escalation_via_named_pipe.yml | Windows: Privilege Escalation via Named Pipe Impersonation | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe|.*\\powershell\.exe"" OR srcFileName IN (""Cmd.Exe"",""PowerShell.EXE"")) AND (command REGEXP "".*echo.*"" AND command REGEXP "".*>.*"" AND command REGEXP "".*\\\\\.\\pipe\\\.*"") |
| Windows: PUA - NPS Tunneling Tool Execution | Security | Detects the use of NPS, a port forwarding and intranet penetration proxy server. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_nps.yml | Windows: PUA - NPS Tunneling Tool Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\npc\.exe"" OR (command REGEXP "".* -server=.*"" AND command REGEXP "".* -vkey=.*"" AND command REGEXP "".* -password=.*"") OR command REGEXP "".* -config=npc.*"" OR (hashCode REGEXP "".*MD5=AE8ACF66BFE3A44148964048B826D005.*|.*SHA1=CEA49E9B9B67F3A13AD0BE1C2655293EA3C18181.*|.*SHA256=5A456283392FFCEEEACA3D3426C306EB470304637520D72FED1CC1FEBBBD6856.*"" OR hashMD5=""ae8acf66bfe3a44148964048b826d005"" OR hashSHA1=""cea49e9b9b67f3a13ad0be1c2655293ea3c18181"" OR hashSHA256=""5a456283392ffceeeaca3d3426c306eb470304637520d72fed1cc1febbbd6856"")) |
| Windows: PsExec Service Execution | Security | Detects launch of the PSEXESVC service, which means that this system was the target of a psexec remote execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_psexesvc.yml | Windows: PsExec Service Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName=""C:\\Windows\\PSEXESVC.exe"" OR srcFileName=""psexesvc.exe"") |
| Windows: PUA - AdvancedRun Execution | Security | Detects the execution of AdvancedRun utility. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_advancedrun.yml | Windows: PUA - AdvancedRun Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""AdvancedRun.exe"" OR (command REGEXP "".* /EXEFilename .*"" AND command REGEXP "".* /Run.*"") OR (command REGEXP "".* /WindowState 0.*"" AND command REGEXP "".* /RunAs .*"" AND command REGEXP "".* /CommandLine .*"")) |
| Windows: PUA - System Informer Driver Load | Security | Detects driver load of the System Informer tool. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_pua_system_informer.yml | Windows: PUA - System Informer Driver Load | eventType=""Win-Sysmon-6-Driver-Loaded"" AND (loadedProcName REGEXP "".*\\SystemInformer\.sys"" OR hashCode REGEXP "".*SHA256=047C42E9BBA28366868847C7DAFC1E043FB038C796422D37220493517D68EE89.*|.*SHA256=18931DC81E95D0020466FA091E16869DBE824E543A4C2C8FE644FA71A0F44FEB.*|.*SHA256=251BE949F662C838718F8AA0A5F8211FB90346D02BD63FF91E6B224E0E01B656.*|.*SHA256=3241BC14BEC51CE6A691B9A3562E5C1D52E9D057D27A3D67FD0B245C350B6D34.*|.*SHA256=38EE0A88AF8535A11EFE8D8DA9C6812AA07067B75A64D99705A742589BDD846D.*|.*SHA256=3A9E1D17BEEB514F1B9B3BACAEE7420285DE5CBDCE89C5319A992C6CBD1DE138.*|.*SHA256=4C3B81AC88A987BBDF7D41FA0AECC2CEDF5B9BD2F45E7A21F376D05345FC211D.*|.*SHA256=640954AFC268565F7DAA6E6F81A8EE05311E33E34332B501A3C3FE5B22ADEA97.*|.*SHA256=8B9AD98944AC9886EA4CB07700E71B78BE4A2740934BB7E46CA3B56A7C59AD24.*|.*SHA256=A41348BEC147CA4D9EA2869817527EB5CEA2E20202AF599D2B30625433BCF454.*|.*SHA256=A773891ACF203A7EB0C0D30942FB1347648F1CD918AE2BFD9A4857B4DCF5081B.*|.*SHA256=B4C2EF76C204273132FDE38F0DED641C2C5EE767652E64E4C4071A4A973B6C1B.*|.*SHA256=E2606F272F7BA054DF16BE464FDA57211EF0D14A0D959F9C8DCB0575DF1186E4.*"" OR hashSHA256 IN (""047c42e9bba28366868847c7dafc1e043fb038c796422d37220493517d68ee89"",""18931dc81e95d0020466fa091e16869dbe824e543a4c2c8fe644fa71a0f44feb"",""251be949f662c838718f8aa0a5f8211fb90346d02bd63ff91e6b224e0e01b656"",""3241bc14bec51ce6a691b9a3562e5c1d52e9d057d27a3d67fd0b245c350b6d34"",""38ee0a88af8535a11efe8d8da9c6812aa07067b75a64d99705a742589bdd846d"",""3a9e1d17beeb514f1b9b3bacaee7420285de5cbdce89c5319a992c6cbd1de138"",""4c3b81ac88a987bbdf7d41fa0aecc2cedf5b9bd2f45e7a21f376d05345fc211d"",""640954afc268565f7daa6e6f81a8ee05311e33e34332b501a3c3fe5b22adea97"",""8b9ad98944ac9886ea4cb07700e71b78be4a2740934bb7e46ca3b56a7c59ad24"",""a41348bec147ca4d9ea2869817527eb5cea2e20202af599d2b30625433bcf454"",""a773891acf203a7eb0c0d30942fb1347648f1cd918ae2bfd9a4857b4dcf5081b"",""b4c2ef76c204273132fde38f0ded641c2c5ee767652e64e4c4071a4a973b6c1b"",""e2606f272f7ba054df16be464fda57211ef0d14a0d959f9c8dcb0575df1186e4"")) |
| Windows: Proxy Execution Via Explorer.exe | Security | Attackers can use explorer.exe for evading defense mechanisms. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_explorer_lolbin_execution.yml | Windows: Proxy Execution Via Explorer.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\explorer\.exe"" AND parentProcName REGEXP "".*\\cmd\.exe"" AND command REGEXP "".*explorer\.exe.*"" |
| Windows: Potential Suspicious Mofcomp Execution | Security | Detects execution of the ""mofcomp"" utility as a child of a suspicious shell or script running utility or by having a supsicious path in the commandline. The ""mofcomp"" utility parses a file containing MOF statements and adds the classes and class instances defined in the file to the WMI repository. Attackers abuse this utility to install malicious MOF scripts . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mofcomp_execution.yml | Windows: Potential Suspicious Mofcomp Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\mofcomp\.exe"" OR srcFileName=""mofcomp.exe"") AND (parentProcName REGEXP "".*\\cmd\.exe|.*\\cscript\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\wscript\.exe|.*\\wsl\.exe"" OR command REGEXP "".*%appdata%.*|.*%temp%.*|.*%tmp%.*|.*\\AppData\\Local\\Temp.*|.*\\Users\\Public\\.*|.*\\WINDOWS\\Temp\\.*"")) AND ((parentProcName!=""C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"" OR command NOT REGEXP "".*C:\\Windows\\TEMP\\.*"" OR command NOT REGEXP "".*\.mof""))) AND ((command NOT REGEXP "".*C:\\Windows\\TEMP\\.*"" OR command NOT REGEXP "".*\.mof"")) |
| Windows: PUA - Process Hacker Driver Load | Security | Detects driver load of the Process Hacker tool. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_pua_process_hacker.yml | Windows: PUA - Process Hacker Driver Load | eventType=""Win-Sysmon-6-Driver-Loaded"" AND (loadedProcName REGEXP "".*\\kprocesshacker\.sys"" OR hashCode REGEXP "".*IMPHASH=0A64EEB85419257D0CE32BD5D55C3A18.*|.*IMPHASH=6E7B34DFC017700B1517B230DF6FF0D0.*|.*IMPHASH=821D74031D3F625BCBD0DF08B70F1E77.*|.*IMPHASH=F86759BB4DE4320918615DC06E998A39.*"" OR hashIMP IN (""0A64EEB85419257D0CE32BD5D55C3A18"",""6E7B34DFC017700B1517B230DF6FF0D0"",""821D74031D3F625BCBD0DF08B70F1E77"",""F86759BB4DE4320918615DC06E998A39"")) |
| Windows: PowerShell Writing Startup Shortcuts | Security | Detects PowerShell writing startup shortcuts. Adversaries may use PowerShell to write malicious .lnk files into the startup directory to establish persistence. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_powershell_startup_shortcuts.yml | Windows: PowerShell Writing Startup Shortcuts | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND fileName REGEXP "".*\\start menu\\programs\\startup\\.*"" AND fileName REGEXP "".*\.lnk"" |
| Windows: PowerShell Module File Created By Non-PowerShell Process | Security | Detects the creation of a new PowerShell module "".psm1"", "".psd1"", "".dll"", "".ps1"", etc. by a non-PowerShell process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_powershell_module_uncommon_creation.yml | Windows: PowerShell Module File Created By Non-PowerShell Process | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\PowerShell\\7\\Modules\\.*|.*\\WindowsPowerShell\\Modules\\.*"" AND ((procName NOT REGEXP "".*\\powerShell_ise\.exe|.*\\powershell\.exe|.*\\pwsh\.exe"")) |
| Windows: PUA - Process Hacker Execution | Security | Detects the execution of Process Hacker based on binary metadata information (Image, Hash, Imphash, etc). Process Hacker is a tool to view and manipulate processes, kernel options and other low level options. Threat actors regularly abuse it to manipulate system processes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_process_hacker.yml | Windows: PUA - Process Hacker Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\ProcessHacker_.*"" OR procName REGEXP "".*\\ProcessHacker\.exe"" OR srcFileName IN (""Process Hacker"",""ProcessHacker.exe"") OR description=""Process Hacker"" OR product=""Process Hacker"" OR hashCode REGEXP "".*IMPHASH=04DE0AD9C37EB7BD52043D2ECAC958DF.*|.*IMPHASH=3695333C60DEDECDCAFF1590409AA462.*|.*MD5=68F9B52895F4D34E74112F3129B3B00D.*|.*MD5=B365AF317AE730A67C936F21432B9C71.*|.*SHA1=A0BDFAC3CE1880B32FF9B696458327CE352E3B1D.*|.*SHA1=C5E2018BF7C0F314FED4FD7FE7E69FA2E648359E.*|.*SHA256=BD2C2CF0631D881ED382817AFCCE2B093F4E412FFB170A719E2762F250ABFEA4.*|.*SHA256=D4A0FE56316A2C45B9BA9AC1005363309A3EDC7ACF9E4DF64D326A0FF273E80F.*"" OR hashMD5 IN (""68f9b52895f4d34e74112f3129b3b00d"",""b365af317ae730a67c936f21432b9c71"") OR hashSHA1 IN (""a0bdfac3ce1880b32ff9b696458327ce352e3b1d"",""c5e2018bf7c0f314fed4fd7fe7e69fa2e648359e"") OR hashSHA256 IN (""bd2c2cf0631d881ed382817afcce2b093f4e412ffb170a719e2762f250abfea4"",""d4a0fe56316a2c45b9ba9ac1005363309a3edc7acf9e4df64d326a0ff273e80f"") OR hashIMP IN (""04de0ad9c37eb7bd52043d2ecac958df"",""3695333c60dedecdcaff1590409aa462"")) |
| Windows: PowerShell Profile Modification | Security | Detects the creation or modification of a powershell profile which could indicate suspicious activity as the profile can be used as a mean of persistence. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_powershell_profile.yml | Windows: PowerShell Profile Modification | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Microsoft\.PowerShell_profile\.ps1|.*\\PowerShell\\profile\.ps1|.*\\Program Files\\PowerShell\\7\\profile\.ps1|.*\\WindowsPowerShell\\profile\.ps1|.*\\Windows\\System32\\WindowsPowerShell\\v1\.0\\profile\.ps1"" |
| Windows: Potentially Suspicious GoogleUpdate Child Process | Security | Detects potentially suspicious child processes of ""GoogleUpdate.exe"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_googleupdate_susp_child_process.yml | Windows: Potentially Suspicious GoogleUpdate Child Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\GoogleUpdate\.exe"" AND ((procName NOT REGEXP "".*\\Google.*"" AND procName NOT REGEXP "".*\\setup\.exe|.*chrome_installer\.exe|.*chrome_updater\.exe"")) |
| Windows: PowerShell Download and Execution Cradles | Security | Detects PowerShell download and execution cradles. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_download_iex.yml | Windows: PowerShell Download and Execution Cradles | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Invoke-WebRequest .*|.*\.DownloadFile\(.*|.*\.DownloadString\(.*|.*iwr .*"" AND command REGEXP "".*;iex \$.*|.*IEX \(.*|.*IEX\(.*|.*IE`X.*|.*I`EX.*|.*I`E`X.*|.*Invoke-Expression.*|.*\| IEX.*|.*\|IEX .*|.*iex .*"" |
| Windows: Process Memory Dump Via Dotnet-Dump | Security | Detects the execution of ""dotnet-dump"" with the ""collect"" flag. The execution could indicate potential process dumping of critical processes such as LSASS. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_dotnet_dump.yml | Windows: Process Memory Dump Via Dotnet-Dump | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\dotnet-dump\.exe"" OR srcFileName=""dotnet-dump.dll"") AND command REGEXP "".*collect.*"" |
| Windows: PrinterNightmare Mimimkatz Driver Name | Security | Detects static QMS 810 and mimikatz driver name used by Mimikatz to exploit CVE-2021-1675 and CVE-2021-34527. Mimikatz is a open source malware program that is commonly used by hackers and security professionals to extract sensitive information, such as passwords and credentials, from a system's memory. If the adversaries are using Mimikatz to perform the attack, then a print driver named QMS 810 will be created. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_mimikatz_printernightmare.yml | Windows: PrinterNightmare Mimimkatz Driver Name | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND ((regKeyPath REGEXP "".*\\Control\\Print\\Environments\\Windows x64\\Drivers\\Version-3\\QMS 810\\.*|.*\\Control\\Print\\Environments\\Windows x64\\Drivers\\Version-3\\mimikatz.*"" OR (regKeyPath REGEXP "".*legitprinter.*"" AND regKeyPath REGEXP "".*\\Control\\Print\\Environments\\Windows.*"")) OR (regKeyPath REGEXP "".*\\Control\\Print\\Environments.*|.*\\CurrentVersion\\Print\\Printers.*"" AND regKeyPath REGEXP "".*Gentil Kiwi.*|.*Kiwi Legit Printer.*|.*mimikatz printer.*"")) |
| Windows: Powerview Add-DomainObjectAcl DCSync AD Extend Right | Security | Backdooring domain object to grant the rights associated with DCSync to a regular user or machine account using Powerview\Add-DomainObjectAcl DCSync Extended Right cmdlet, will allow to re-obtain the pwd hashes of any user/computer. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_account_backdoor_dcsync_rights.yml | Windows: Powerview Add-DomainObjectAcl DCSync AD Extend Right | (eventType=""Win-Security-5136"" AND propName=""ntSecurityDescriptor"" AND propValue REGEXP "".*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2.*|.*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2.*|.*89e95b76-444d-4c62-991a-0facbeda640c.*"") AND ((osObjType NOT IN (""dnsNode"",""dnsZone"",""dnsZoneScope""))) |
| Windows: Powershell Token Obfuscation - Process Creation | Security | Detects TOKEN OBFUSCATION technique from Invoke-Obfuscation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_token_obfuscation.yml | Windows: Powershell Token Obfuscation - Process Creation | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP ""\""(\\{\\d\\})+\""\\s*-f|\\$\\{((e|n|v)*`(e|n|v)*)+:path\\}|\\$\\{((e|n|v)*`(e|n|v)*)+:((p|a|t|h)*`(p|a|t|h)*)+\\}|\\$\\{env:((p|a|t|h)*`(p|a|t|h)*)+\\}|\\w+`(\\w+|-|.)`[\\w+|\\s]"") |
| Windows: PsExec Service Child Process Execution as LOCAL SYSTEM | Security | Detects suspicious launch of the PSEXESVC service on this system and a sub process run as LOCAL_SYSTEM (-s), which means that someone remotely started a command on this system running it with highest privileges and not only the privileges of the login user account (e.g. the administrator account). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_psexesvc_as_system.yml | Windows: PsExec Service Child Process Execution as LOCAL SYSTEM | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName=""C:\\Windows\\PSEXESVC.exe"" AND user REGEXP "".*AUTHORI.*|.*AUTORI.*"" |
| Windows: Potential Windows Defender Tampering Via Wmic.EXE | Security | Detects potential tampering with Windows Defender settings such as adding exclusion using wmic. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_namespace_defender.yml | Windows: Potential Windows Defender Tampering Via Wmic.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""wmic.exe"" OR procName REGEXP "".*\\WMIC\.exe"") AND command REGEXP "".*/Namespace:\\\\root\\Microsoft\\Windows\\Defender.*"" |
| Windows: Potential Suspicious PowerShell Module File Created | Security | Detects the creation of a new PowerShell module in the first folder of the module directory structure ""\WindowsPowerShell\Modules\malware\malware.psm1"". This is somewhat an uncommon practice as legitimate modules often includes a version folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_powershell_module_susp_creation.yml | Windows: Potential Suspicious PowerShell Module File Created | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\WindowsPowerShell\\Modules\\.*\\\.dll|.*\\WindowsPowerShell\\Modules\\.*\\\.ps"" |
| Windows: Potentially Over Permissive Permissions Granted Using Dsacls.EXE | Security | Detects usage of Dsacls to grant over permissive permissions. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dsacls_abuse_permissions.yml | Windows: Potentially Over Permissive Permissions Granted Using Dsacls.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\dsacls\.exe"" OR srcFileName=""DSACLS.EXE"") AND command REGEXP "".* /G .*"" AND command REGEXP "".*GA.*|.*GE.*|.*GR.*|.*GW.*|.*WD.*|.*WP.*"" |
| Windows: PowerShell Script Dropped Via PowerShell.EXE | Security | Detects PowerShell creating a PowerShell file (.ps1). While often times this behavior is benign, sometimes it can be a sign of a dropper script trying to achieve persistence. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_powershell_drop_powershell.yml | Windows: PowerShell Script Dropped Via PowerShell.EXE | eventType=""Win-Sysmon-11-FileCreate"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND fileName REGEXP "".*\.ps1"") AND ((fileName NOT REGEXP "".*__PSScriptPolicyTest_.*"") AND (fileName NOT REGEXP ""C:\\Users\\.*"" OR fileName NOT REGEXP "".*\\AppData\\Local\\Temp\\.*"") AND (fileName NOT REGEXP ""C:\\Windows\\Temp\\.*"")) |
| Windows: Renamed MegaSync Execution | Security | Detects the execution of a renamed MegaSync.exe as seen used by ransomware families like Nefilim, Sodinokibi, Pysa, and Conti. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_megasync.yml | Windows: Renamed MegaSync Execution | eventType=""Win-Sysmon-1-Create-Process"" AND srcFileName=""megasync.exe"" AND (procName NOT REGEXP "".*\\megasync\.exe"") |
| Windows: Script Interpreter Execution From Suspicious Folder | Security | Detects a suspicious script executions in temporary folders or folders accessible by environment variables. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_script_exec_from_env_folder.yml | Windows: Script Interpreter Execution From Suspicious Folder | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe|.*\\cscript\.exe|.*\\mshta\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\wscript\.exe"" OR command REGEXP "".* -ep bypass .*|.* -w hidden .*|.*/e:javascript .*|.*/e:vbscript .*"" OR srcFileName IN (""cmd.exe"",""cscript.exe"",""mshta.exe"",""powershell.exe"",""pwsh.dll"",""wscript.exe"")) AND procName REGEXP "".*C:\\Perflogs\\.*|.*C:\\Users\\Public\\.*|.*\\AppData\\Local\\Temp.*|.*\\AppData\\Roaming\\Temp.*|.*\\Temporary Internet.*|.*\\Windows\\Temp.*"" |
| Windows: Run PowerShell Script from Redirected Input Stream | Security | Detects PowerShell script execution via input stream redirect. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_run_script_from_input_stream.yml | Windows: Run PowerShell Script from Redirected Input Stream | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" |
| Windows: Sdiagnhost Calling Suspicious Child Process | Security | Detects sdiagnhost.exe calling a suspicious child process (e.g. used in exploits for Follina / CVE-2022-30190). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sdiagnhost_susp_child.yml | Windows: Sdiagnhost Calling Suspicious Child Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\sdiagnhost\.exe"" AND procName REGEXP "".*\\calc\.exe|.*\\cmd\.exe|.*\\cscript\.exe|.*\\mshta\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\taskkill\.exe|.*\\wscript\.exe"" |
| Windows: Renamed PsExec Service Execution | Security | Detects suspicious launch of a renamed version of the PSEXESVC service with, which is not often used by legitimate administrators. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_sysinternals_psexec_service.yml | Windows: Renamed PsExec Service Execution | eventType=""Win-Sysmon-1-Create-Process"" AND srcFileName=""psexesvc.exe"" AND (procName!=""C:\\Windows\\PSEXESVC.exe"") |
| Windows: Regedit as Trusted Installer | Security | Detects a regedit started with TrustedInstaller privileges or by ProcessHacker.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regedit_trustedinstaller.yml | Windows: Regedit as Trusted Installer | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\regedit\.exe"" AND parentProcName REGEXP "".*\\ProcessHacker\.exe|.*\\TrustedInstaller\.exe"" |
| Windows: Shells Spawned by Web Servers | Security | Detects web servers that spawn shell processes which could be the result of a successfully placed web shell or another attack. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_spawn.yml | Windows: Shells Spawned by Web Servers | eventType=""Win-Sysmon-1-Create-Process"" AND ((parentProcName REGEXP "".*\\UMWorkerProcess\.exe|.*\\caddy\.exe|.*\\httpd\.exe|.*\\nginx\.exe|.*\\php-cgi\.exe|.*\\php\.exe|.*\\tomcat\.exe|.*\\w3wp\.exe|.*\\ws_TomcatService\.exe"" OR (parentProcName REGEXP "".*\\java\.exe|.*\\javaw\.exe"" AND parentProcName REGEXP "".*-tomcat-.*|.*\\tomcat.*"") OR (parentProcName REGEXP "".*\\java\.exe|.*\\javaw\.exe"" AND parentCommand REGEXP "".*CATALINA_HOME.*|.*catalina\.home.*|.*catalina\.jar.*"")) AND procName REGEXP "".*\\arp\.exe|.*\\at\.exe|.*\\bash\.exe|.*\\bitsadmin\.exe|.*\\certutil\.exe|.*\\cmd\.exe|.*\\cscript\.exe|.*\\dsget\.exe|.*\\dsquery\.exe|.*\\find\.exe|.*\\findstr\.exe|.*\\fsutil\.exe|.*\\hostname\.exe|.*\\ipconfig\.exe|.*\\nbtstat\.exe|.*\\net1\.exe|.*\\net\.exe|.*\\netdom\.exe|.*\\netsh\.exe|.*\\netstat\.exe|.*\\nltest\.exe|.*\\nslookup\.exe|.*\\ntdutil\.exe|.*\\pathping\.exe|.*\\ping\.exe|.*\\powershell\.exe|.*\\powershell_ise\.exe|.*\\pwsh\.exe|.*\\qprocess\.exe|.*\\query\.exe|.*\\qwinsta\.exe|.*\\reg\.exe|.*\\rundll32\.exe|.*\\sc\.exe|.*\\schtasks\.exe|.*\\sh\.exe|.*\\systeminfo\.exe|.*\\tasklist\.exe|.*\\tracert\.exe|.*\\ver\.exe|.*\\vssadmin\.exe|.*\\wevtutil\.exe|.*\\whoami\.exe|.*\\wmic\.exe|.*\\wscript\.exe|.*\\wusa\.exe"") AND ((command NOT REGEXP "".*Windows\\system32\\cmd\.exe /c C:\\ManageEngine\\ADManager \""Plus\\ES\\bin\\elasticsearch\.bat -Enode\.name=RMP-NODE1 -pelasticsearch-pid\.txt"") AND (command NOT REGEXP "".*sc query.*"" OR command NOT REGEXP "".*ADManager Plus.*"")) |
| Windows: Python Spawning Pretty TTY on Windows | Security | Detects python spawning a pretty tty. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_python_pty_spawn.yml | Windows: Python Spawning Pretty TTY on Windows | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*python2\.exe|.*python3\.exe|.*python\.exe"" AND ((command REGEXP "".*import pty.*"" AND command REGEXP "".*\.spawn\(.*"") OR command REGEXP "".*from pty import spawn.*"") |
| Windows: SCM Database Privileged Operation | Security | Detects non-system users performing privileged operation os the SCM database. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_scm_database_privileged_operation.yml | Windows: SCM Database Privileged Operation | (eventType=""Win-Security-4674"" AND osObjType=""SC_MANAGER OBJECT"" AND osObjName=""servicesactive"" AND privName=""SeTakeOwnershipPrivilege"") AND (winLogonId!=""0x3e4"" OR procName NOT REGEXP "".*:\\Windows\\System32\\services\.exe"") |
| Windows: Standard User In High Privileged Group | Security | Detect standard users login that are part of high privileged groups such as the Administrator group. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/lsa_server/win_lsa_server_normal_user_admin.yml | Windows: Standard User In High Privileged Group | (eventType REGEXP ""Win-.*-300[^\d]*"" AND userId REGEXP ""S-1-5-21-.*"" AND userId REGEXP "".*-500\}.*|.*-518\}.*|.*-519\}.*|.*S-1-5-32-544.*"") AND (userId NOT REGEXP "".*-500|.*-518|.*-519"") |
| Windows: Service Installation with Suspicious Folder Pattern | Security | Detects service installation with suspicious folder patterns. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_susp_service_installation_folder_pattern.yml | Windows: Service Installation with Suspicious Folder Pattern | (eventType=""Win-System-Service-Control-Manager-7045"") AND (serviceFileName REGEXP ""^[Cc]:\\\\.{1,9}\\.exe|^[Cc]:\\\\[Pp]rogram[Dd]ata\\\\.{1,9}\\.exe"") |
| Windows: Rundll32 Registered COM Objects | Security | load malicious registered COM objects. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_registered_com_objects.yml | Windows: Rundll32 Registered COM Objects | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"") AND (command REGEXP "".*-localserver .*|.*-sta .*"" AND command REGEXP "".*\{.*"" AND command REGEXP "".*\}.*"") |
| Windows: Rundll32 With Suspicious Parent Process | Security | Detects suspicious start of rundll32.exe with a parent process of Explorer.exe. Variant of Raspberry Robin, as first reported by Red Canary. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_parent_explorer.yml | Windows: Rundll32 With Suspicious Parent Process | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"") AND parentProcName REGEXP "".*\\explorer\.exe"") AND (command NOT REGEXP "".* C:\\Windows\\System32\\.*"" AND command NOT REGEXP "".* -localserver 22d8c27b-47a1-48d1-ad08-7da7abd79617"") |
| Windows: Renamed Plink Execution | Security | Detects the execution of a renamed version of the Plink binary. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_plink.yml | Windows: Renamed Plink Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""Plink"" OR (command REGEXP "".* -l forward.*"" AND command REGEXP "".* -P .*"" AND command REGEXP "".* -R .*"")) AND (procName NOT REGEXP "".*\\plink\.exe"") |
| Windows: Service Installation in Suspicious Folder | Security | Detects service installation in suspicious folder appdata. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_susp_service_installation_folder.yml | Windows: Service Installation in Suspicious Folder | (eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".*\\AppData\\.*|.*\\\\127\.0\.0\.1.*|.*\\\\localhost.*"") AND ((serviceName!=""Zoom Sharing Service"" OR serviceFileName NOT REGEXP ""\""C:\\Program Files\\Common Files\\Zoom\\Support\\CptService\.exe.*"")) |
| Windows: REGISTER-APP.VBS Proxy Execution | Security | Detects the use of a Microsoft signed script 'REGISTER_APP.VBS' to register a VSS/VDS Provider as a COM+ application. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_register_app.yml | Windows: REGISTER-APP.VBS Proxy Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\register_app\.vbs.*"" AND command REGEXP "".*-register.*"" |
| Windows: Renamed AutoHotkey.EXE Execution | Security | Detects execution of a renamed autohotkey.exe binary based on PE metadata fields. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_autohotkey.yml | Windows: Renamed AutoHotkey.EXE Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (product REGEXP "".*AutoHotkey.*"" OR description REGEXP "".*AutoHotkey.*"" OR srcFileName IN (""AutoHotkey.exe"",""AutoHotkey.rc"")) AND (procName NOT REGEXP "".*\\AutoHotkey32\.exe|.*\\AutoHotkey32_UIA\.exe|.*\\AutoHotkey64\.exe|.*\\AutoHotkey64_UIA\.exe|.*\\AutoHotkeyA32\.exe|.*\\AutoHotkeyA32_UIA\.exe|.*\\AutoHotkeyU32\.exe|.*\\AutoHotkeyU32_UIA\.exe|.*\\AutoHotkeyU64\.exe|.*\\AutoHotkeyU64_UIA\.exe|.*\\AutoHotkey\.exe"" AND procName NOT REGEXP "".*\\AutoHotkey.*"") |
| Windows: Service Installed By Unusual Client - System | Security | Detects a service installed by a client which has PID 0 or whose parent has PID 0. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_system_service_installation_by_unusal_client.yml | Windows: Service Installed By Unusual Client - System | eventType=""Win-System-Service-Control-Manager-7045"" AND procId IS NULL |
| Windows: Shells Spawned by Java | Security | Detects shell spawned from Java host process, which could be a sign of exploitation (e.g. log4j exploitation). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_java_susp_child_process_2.yml | Windows: Shells Spawned by Java | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\java\.exe"" AND procName REGEXP "".*\\cmd\.exe|.*\\powershell\.exe|.*\\pwsh\.exe"") AND (parentProcName NOT REGEXP "".*build.*"" OR command NOT REGEXP "".*build.*"") |
| Windows: Security Support Provider SSP Added to LSA Configuration | Security | Detects the addition of a SSP to the registry. Upon a reboot or API call, SSP DLLs gain access to encrypted and plaintext passwords stored in Windows. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_ssp_added_lsa_config.yml | Windows: Security Support Provider SSP Added to LSA Configuration | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath IN (""HKLM\\System\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages"",""HKLM\\System\\CurrentControlSet\\Control\\Lsa\\Security Packages"") AND (procName NOT IN (""C:\\Windows\\system32\\msiexec.exe"",""C:\\Windows\\syswow64\\MsiExec.exe"")) |
| Windows: Remote Access Tool - NetSupport Execution From Unusual Location | Security | Detects execution of client32.exe (NetSupport RAT) from an unusual location (outside of 'C:\Program Files'). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remote_access_tools_netsupport_susp_exec.yml | Windows: Remote Access Tool - NetSupport Execution From Unusual Location | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\client32\.exe"" OR product REGEXP "".*NetSupport Remote Control.*"" OR srcFileName REGEXP "".*client32\.exe.*"" OR hashIMP=""a9d50692e95b79723f3e76fcf70d023e"" OR hashCode REGEXP "".*IMPHASH=a9d50692e95b79723f3e76fcf70d023e.*"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"") |
| Windows: Registry Persistence Mechanisms in Recycle Bin | Security | Detects persistence registry keys for Recycle Bin. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_persistence_recycle_bin.yml | Windows: Registry Persistence Mechanisms in Recycle Bin | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND ((osObjAction=""RenameKey"" AND newObjValue REGEXP "".*\\CLSID\\\{645FF040-5081-101B-9F08-00AA002F954E\}\\shell\\open.*"") OR (osObjAction=""SetValue"" AND regKeyPath REGEXP "".*\\CLSID\\\{645FF040-5081-101B-9F08-00AA002F954E\}\\shell\\open\\command\\\(Default\).*"")) |
| Windows: RemoteFXvGPUDisablement Abuse Via AtomicTestHarnesses | Security | Detects calls to the AtomicTestHarnesses ""Invoke-ATHRemoteFXvGPUDisablementCommand"" which is designed to abuse the ""RemoteFXvGPUDisablement.exe"" binary to run custom PowerShell code via module load-order hijacking. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_remotefxvgpudisablement_abuse.yml | Windows: RemoteFXvGPUDisablement Abuse Via AtomicTestHarnesses | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Invoke-ATHRemoteFXvGPUDisableme.*|.*Invoke-ATHRemoteFXvGPUDisablementCommand.*"" |
| Windows: Service Installed By Unusual Client - Security | Security | Detects a service installed by a client which has PID 0 or whose parent has PID 0. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_service_installation_by_unusal_client.yml | Windows: Service Installed By Unusual Client - Security | eventType=""Win-Security-4697"" AND (procId IS NULL OR parentProcId IS NULL) |
| Windows: RTCore Suspicious Service Installation | Security | Detects the installation of RTCore service. Which could be an indication of Micro-Star MSI Afterburner vulnerable driver abuse. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_susp_rtcore64_service_install.yml | Windows: RTCore Suspicious Service Installation | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceName=""RTCore64"" |
| Windows: Remote Access Tool - RURAT Execution From Unusual Location | Security | Detects execution of Remote Utilities RAT (RURAT) from an unusual location (outside of 'C:\Program Files'). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remote_access_tools_rurat_non_default_location.yml | Windows: Remote Access Tool - RURAT Execution From Unusual Location | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rfusclient\.exe|.*\\rutserv\.exe"" OR product=""Remote Utilities"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Remote Utilities.*|C:\\Program Files\\Remote Utilities.*"") |
| Windows: Rundll32 JS RunHTMLApplication Pattern | Security | Detects suspicious command line patterns used when rundll32 is used to run JavaScript code. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_js_runhtmlapplication.yml | Windows: Rundll32 JS RunHTMLApplication Pattern | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*rundll32.*"" AND command REGEXP "".*javascript.*"" AND command REGEXP "".*\.\.\\\.\.\\mshtml,RunHTMLApplication.*"") OR command REGEXP "".*;document\.write\(\);GetObject\(\""script.*"") |
| Windows: Rundll32 Execution Without DLL File | Security | Detects the execution of rundll32 with a command line that doesn't contain a .dll file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_executable_invalid_extension.yml | Windows: Rundll32 Execution Without DLL File | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"") AND ((command IS NOT NULL) AND (command NOT REGEXP "".*\.dll.*"" AND command IS NOT NULL) AND (command NOT REGEXP ""C:\\Windows\\system32\\rundll32\.exe C:\\Windows\\system32\\inetcpl\.cpl,ClearMyTracksByProcess.*"") AND (parentProcName NOT REGEXP "".*:\\Program Files\\Internet Explorer\\iexplore\.exe"" OR command NOT REGEXP "".*\.cpl.*"") AND (parentProcName NOT REGEXP "".*:\\Windows\\SysWOW64\\msiexec\.exe"" OR parentCommand NOT REGEXP ""C:\\Windows\\syswow64\\MsiExec\.exe -Embedding.*"") AND (parentProcName NOT REGEXP "".*:\\Windows\\System32\\msiexec\.exe"" OR parentCommand NOT REGEXP ""C:\\Windows\\system32\\MsiExec\.exe -Embedding.*"") AND (parentProcName NOT REGEXP "".*:\\Windows\\System32\\cmd\.exe"" OR parentCommand NOT REGEXP "".* C:\\Program Files\\SplunkUniversalForwarder\\.*"") AND (command NOT REGEXP "".* -localserver .*"") AND (parentCommand NOT REGEXP ""C:\\Windows\\system32\\rundll32\.exe\"" \""C:\\Program Files\\McAfee\\MSC\\mcmscins\.dll\"",DllUninstallFunction .*"" AND command NOT REGEXP ""C:\\Windows\\system32\\rundll32\.exe\"" /uninstall /longpath \""C:\\Program Files\\McAfee\\MSC\\mscrem\.inf.*"") AND (parentProcName NOT REGEXP ""C:\\Users\\.*"" OR parentProcName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\EdgeUpdate\\Install\\\{.*"" OR parentProcName NOT REGEXP "".*\\setup\.exe"" OR parentCommand NOT REGEXP "".*\\setup\.exe\"" --install-archive=\""C:\\Users\\.*"") AND (command NOT REGEXP "".*C:\\Windows\\Installer\\MSI.*"" OR command NOT REGEXP "".*\.tmp.*"" OR command NOT REGEXP "".*zzzzInvokeManagedCustomActionOutOfProc.*"" OR command NOT REGEXP "".*Avira\.OE\.Setup.*"")) |
| Windows: Replay Attack Detected | Security | Detects possible Kerberos Replay Attack on the domain controllers when ""KRB_AP_ERR_REPEAT"" Kerberos response is sent to the client. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_replay_attack_detected.yml | Windows: Replay Attack Detected | eventType=""Win-Security-4649"" |
| Windows: Renamed Remote Utilities RAT RURAT Execution | Security | Detects execution of renamed Remote Utilities (RURAT) via Product PE header field. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_rurat.yml | Windows: Renamed Remote Utilities RAT RURAT Execution | eventType=""Win-Sysmon-1-Create-Process"" AND product=""Remote Utilities"" AND (procName NOT REGEXP "".*\\rfusclient\.exe|.*\\rutserv\.exe"") |
| Windows: Reg Add RUN Key | Security | Detects suspicious command line reg.exe tool adding key to RUN key in Registry. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_add_run_key.yml | Windows: Reg Add RUN Key | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*reg.*"" AND command REGEXP "".* ADD .*"" AND command REGEXP "".*Software\\Microsoft\\Windows\\CurrentVersion\\Run.*"" |
| Windows: Sideloading Link.EXE | Security | Detects the execution utitilies often found in Visual Studio tools that hardcode the call to the binary ""link.exe"". They can be abused to sideload any binary with the same name. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_sideload_link_binary.yml | Windows: Sideloading Link.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\link\.exe"" AND command REGEXP "".*LINK /.*"") AND ((parentProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft Visual Studio\\.*|C:\\Program Files\\Microsoft Visual Studio\\.*"" OR parentProcName NOT REGEXP "".*\\VC\\Tools\\MSVC\\.*"")) |
| Windows: Remote Code Execute via Winrm.vbs | Security | Detects an attempt to execute code or create service on remote host via winrm.vbs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_winrm_execution_via_scripting_api_winrm_vbs.yml | Windows: Remote Code Execute via Winrm.vbs | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cscript\.exe"" OR srcFileName=""cscript.exe"") AND (command REGEXP "".*winrm.*"" AND command REGEXP "".*invoke Create wmicimv2/Win32_.*"" AND command REGEXP "".*-r:http.*"") |
| Windows: Remote WMI ActiveScriptEventConsumers | Security | Detect potential adversaries leveraging WMI ActiveScriptEventConsumers remotely to move laterally in a network. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_scrcons_remote_wmi_scripteventconsumer.yml | Windows: Remote WMI ActiveScriptEventConsumers | (eventType=""Win-Security-4624"" AND winLogonType=3 AND procName REGEXP "".*scrcons\.exe"") AND (winLogonId!=""0x3e7"") |
| Windows: Remote Utilities Host Service Install | Security | Detects Remote Utilities Host service installation on the target system. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_install_remote_utilities.yml | Windows: Remote Utilities Host Service Install | (eventType=""Win-System-Service-Control-Manager-7045"") AND ((serviceFileName REGEXP "".*\\rutserv\.exe.*"" AND serviceFileName REGEXP "".*-service.*"") OR serviceName=""Remote Utilities - Host"") |
| Windows: RDP File Creation From Suspicious Application | Security | Detects Rclone config file being created. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_rdp_file_susp_creation.yml | Windows: RDP File Creation From Suspicious Application | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\CCleaner Browser\\Application\\CCleanerBrowser\.exe|.*\\Discord\.exe|.*\\Google\\Chrome\\Application\\chrome\.exe|.*\\Keybase\.exe|.*\\Opera\.exe|.*\\Outlook\.exe|.*\\RuntimeBroker\.exe|.*\\Slack\.exe|.*\\Thunderbird\.exe|.*\\Vivaldi\.exe|.*\\Whale\.exe|.*\\brave\.exe|.*\\chromium\.exe|.*\\firefox\.exe|.*\\iexplore\.exe|.*\\microsoftedge\.exe|.*\\msedge\.exe|.*\\msteams\.exe|.*\\teams\.exe"" AND fileName REGEXP "".*\.rdp.*"" |
| Windows: Renamed NetSupport RAT Execution | Security | Detects the execution of a renamed ""client32.exe"" (NetSupport RAT) via Imphash, Product and OriginalFileName strings. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_netsupport_rat.yml | Windows: Renamed NetSupport RAT Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (product REGEXP "".*NetSupport Remote Control.*"" OR srcFileName REGEXP "".*client32\.exe.*"" OR hashIMP=""a9d50692e95b79723f3e76fcf70d023e"" OR hashCode REGEXP "".*IMPHASH=A9D50692E95B79723F3E76FCF70D023E.*"") AND (procName NOT REGEXP "".*\\client32\.exe"") |
| Windows: Ruby Inline Command Execution | Security | Detects execution of ruby using the ""-e"" flag. This is could be used as a way to launch a reverse shell or execute live ruby code. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ruby_inline_command_execution.yml | Windows: Ruby Inline Command Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\ruby\.exe"" OR srcFileName=""ruby.exe"") AND command REGEXP "".* -e.*"" |
| Windows: RDP Port Forwarding Rule Added Via Netsh.EXE | Security | Detects the execution of netsh to configure a port forwarding of port 3389 (RDP) rule. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_port_forwarding_3389.yml | Windows: RDP Port Forwarding Rule Added Via Netsh.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\netsh\.exe"" OR srcFileName=""netsh.exe"") AND (command REGEXP "".* i.*"" AND command REGEXP "".* p.*"" AND command REGEXP "".*=3389.*"" AND command REGEXP "".* c.*"") |
| Windows: Rundll32 Registered COM Objects | Security | load malicious registered COM objects. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_registered_com_objects.yml | Windows: Rundll32 Registered COM Objects | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\rundll32\.exe"" AND command REGEXP "".*-sta .*|.*â€“localserver .*"" AND command REGEXP "".*\{.*"" AND command REGEXP "".*\}.*"" |
| Windows: Renamed Office Binary Execution | Security | Detects the execution of a renamed office binary. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_office_processes.yml | Windows: Renamed Office Binary Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName IN (""Excel.exe"",""MSACCESS.EXE"",""OneNote.exe"",""POWERPNT.EXE"",""WinWord.exe"") OR description IN (""Microsoft Access"",""Microsoft Excel"",""Microsoft OneNote"",""Microsoft PowerPoint"",""Microsoft Word"")) AND (procName NOT REGEXP "".*\\EXCEL\.exe|.*\\MSACCESS\.exe|.*\\ONENOTE\.EXE|.*\\POWERPNT\.EXE|.*\\WINWORD\.exe"") |
| Windows: Regsvr32 Command Line Without DLL | Security | Detects a regsvr.exe execution that doesn't contain a DLL in the command line. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regsvr32_no_dll.yml | Windows: Regsvr32 Command Line Without DLL | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\regsvr32\.exe"" AND (command NOT REGEXP "".*\.ax.*|.*\.bav.*|.*\.cpl.*|.*\.dll.*|.*\.ocx.*|.*\.ppl.*"")) AND (command IS NOT NULL)) AND (command IS NOT NULL) |
| Windows: Query Usage To Exfil Data | Security | Detects usage of ""query.exe"" a system binary to exfil information such as ""sessions"" and ""processes"" for later use. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_query_session_exfil.yml | Windows: Query Usage To Exfil Data | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*:\\Windows\\System32\\query\.exe"" AND command REGEXP "".*process >.*|.*session >.*"" |
| Windows: Sticky Key Like Backdoor Execution | Security | Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_sticky_key_like_backdoor_execution.yml | Windows: Sticky Key Like Backdoor Execution | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\winlogon\.exe"" AND procName REGEXP "".*\\cmd\.exe|.*\\cscript\.exe|.*\\mshta\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wscript\.exe|.*\\wt\.exe"" AND command REGEXP "".*DisplaySwitch\.exe.*|.*Magnify\.exe.*|.*Narrator\.exe.*|.*osk\.exe.*|.*sethc\.exe.*|.*utilman\.exe.*"" |
| Windows: Sticky Key Like Backdoor Usage - Registry | Security | Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_stickykey_like_backdoor.yml | Windows: Sticky Key Like Backdoor Usage - Registry | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DisplaySwitch\.exe\\Debugger|.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\HelpPane\.exe\\Debugger|.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Magnify\.exe\\Debugger|.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Narrator\.exe\\Debugger|.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\atbroker\.exe\\Debugger|.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\osk\.exe\\Debugger|.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc\.exe\\Debugger|.*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\utilman\.exe\\Debugger"" |
| Windows: Suspicious CMD Shell Output Redirect | Security | Detects inline windows shell commands redirecting output via the "">"" symbol to a suspicious location. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_redirection_susp_folder.yml | Windows: Suspicious CMD Shell Output Redirect | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe"" OR srcFileName=""Cmd.Exe"") AND (command REGEXP "".*> %APPDATA%\\.*|.*> %TEMP%\\.*|.*> %TMP%\\.*|.*> %USERPROFILE%\\.*|.*> C:\\Temp\\.*|.*> C:\\Users\\Public\\.*|.*> C:\\Windows\\Temp\\.*|.*> \\Users\\Public\\.*"" OR (command REGEXP "".* > .*|.* >> .*"" AND command REGEXP "".*C:\\Users\\.*"" AND command REGEXP "".*\\AppData\\Local\\.*"")) |
| Windows: Suspicious CodePage Switch Via CHCP | Security | Detects a code page switch in command line or batch scripts to a rare language. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_chcp_codepage_switch.yml | Windows: Suspicious CodePage Switch Via CHCP | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\chcp\.com"" AND command REGEXP "".* 1258|.* 936"" |
| Windows: Suspicious Executable File Creation | Security | Detect creation of suspicious executable file name. Some strings look for suspicious file extensions, others look for filenames that exploit unquoted service paths. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_executable_creation.yml | Windows: Suspicious Executable File Creation | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP "".*\.bat\.exe|.*\.sys\.exe"" OR fileName IN (""C:\\$Recycle.Bin.exe"",""C:\\Documents and Settings.exe"",""C:\\MSOCache.exe"",""C:\\PerfLogs.exe"",""C:\\Recovery.exe"")) |
| Windows: Suspicious Characters in CommandLine | Security | Detects suspicious characters in the command line, which could be a sign of obfuscation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_commandline_chars.yml | Windows: Suspicious Characters in CommandLine | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP ( "".*Ë¢.*|.*Ë£.*|.*Ëª.*"" ) OR command REGEXP ( "".*â„.*|.*âˆ•.*"" ) OR command REGEXP ( "".*â€”.*|.*â€•.*"" )) |
| Windows: Suspicious AgentExecutor PowerShell Execution | Security | Detects execution of the AgentExecutor.exe binary. Which can be abused as a LOLBIN to execute powershell scripts with the ExecutionPolicy ""Bypass"" or any binary named ""powershell.exe"" located in the path provided by 6th positional argument. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_agentexecutor_susp_usage.yml | Windows: Suspicious AgentExecutor PowerShell Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\AgentExecutor\.exe"" OR srcFileName=""AgentExecutor.exe"") AND command REGEXP "".* -powershell.*|.* -remediationScript.*"") AND (command NOT REGEXP "".*C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1\.0\\.*|.*C:\\Windows\\System32\\WindowsPowerShell\\v1\.0\\.*"") |
| Windows: Startup Folder File Write | Security | A General detection for files being created in the Windows startup directory. This could be an indicator of persistence. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_startup_folder_file_write.yml | Windows: Startup Folder File Write | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp.*"" AND (procName!=""C:\\Windows\\System32\\wuauclt.exe"" AND fileName NOT REGEXP ""C:\\\$WINDOWS\.~BT\\NewOS\\.*"") |
| Windows: Suspicious DotNET CLR Usage Log Artifact | Security | Detects the creation of Usage Log files by the CLR (clr.dll). These files are named after the executing process once the assembly is finished executing for the first time in the (user) session context. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_net_cli_artefact.yml | Windows: Suspicious DotNET CLR Usage Log Artifact | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\UsageLogs\\cmstp\.exe\.log|.*\\UsageLogs\\cscript\.exe\.log|.*\\UsageLogs\\mshta\.exe\.log|.*\\UsageLogs\\msxsl\.exe\.log|.*\\UsageLogs\\regsvr32\.exe\.log|.*\\UsageLogs\\rundll32\.exe\.log|.*\\UsageLogs\\svchost\.exe\.log|.*\\UsageLogs\\wmic\.exe\.log|.*\\UsageLogs\\wscript\.exe\.log"" AND ((parentProcName NOT REGEXP "".*\\MsiExec\.exe"" OR parentCommand NOT REGEXP "".* -Embedding.*"" OR procName NOT REGEXP "".*\\rundll32\.exe"" OR command NOT REGEXP "".*Temp.*"" OR command NOT REGEXP "".*zzzzInvokeManagedCustomActionOutOfProc.*"")) |
| Windows: Suspicious ConfigSecurityPolicy Execution | Security | Upload file, credentials or data exfiltration with Binary part of Windows Defender. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_configsecuritypolicy.yml | Windows: Suspicious ConfigSecurityPolicy Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*ConfigSecurityPolicy\.exe.*"" OR procName REGEXP "".*\\ConfigSecurityPolicy\.exe"" OR srcFileName=""ConfigSecurityPolicy.exe"") AND command REGEXP "".*ftp://.*|.*http://.*|.*https://.*"" |
| Windows: Suspicious Dropbox API Usage | Security | Detects an executable that isn't dropbox but communicates with the Dropbox API. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_susp_dropbox_api.yml | Windows: Suspicious Dropbox API Usage | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (initiated=""true"" AND destName REGEXP "".*api\.dropboxapi\.com|.*content\.dropboxapi\.com"") AND (procName NOT REGEXP "".*\\Dropbox.*"") |
| Windows: Suspicious Application Installed | Security | Detects suspicious application installed by looking at the added shortcut to the app resolver cache. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/shell_core/win_shell_core_susp_packages_installed.yml | Windows: Suspicious Application Installed | eventType = ""Win-Shell-Core-28115"" AND (procName REGEXP "".*AnyDesk.*|.*Zenmap.*|.*openvpn.*|.*wireshark.*"" OR appName REGEXP "".*openvpn.*|.*prokzult ad.*|.*wireshark.*|.*zenmap\.exe.*"") |
| Windows: Suspicious Child Process Of Veeam Dabatase | Security | Detects suspicious child processes of the Veeam service process. This could indicate potential RCE or SQL Injection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mssql_veaam_susp_child_processes.yml | Windows: Suspicious Child Process Of Veeam Dabatase | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\sqlservr\.exe"" AND parentCommand REGEXP "".*VEEAMSQL.*"") AND ((procName REGEXP "".*\\cmd\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\wsl\.exe|.*\\wt\.exe"" AND command REGEXP "".*-ex .*|.*DownloadString.*|.*bypass.*|.*copy .*|.*cscript.*|.*http://.*|.*https://.*|.*mshta.*|.*regsvr32.*|.*rundll32.*|.*wscript.*"") OR procName REGEXP "".*\\net1\.exe|.*\\net\.exe|.*\\netstat\.exe|.*\\nltest\.exe|.*\\ping\.exe|.*\\tasklist\.exe|.*\\whoami\.exe"") |
| Windows: Suspicious Epmap Connection | Security | Detects suspicious ""epmap"" connection to a remote computer via remote procedure call (RPC). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_susp_epmap.yml | Windows: Suspicious Epmap Connection | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (srcProto=""tcp"" AND initiated=""true"" AND destIpPort=135) AND (procName NOT REGEXP ""C:\\ProgramData\\Amazon\\SSM\\Update\\amazon-ssm-agent-updater.*|C:\\Windows\\.*"") |
| Windows: Suspicious Download from Office Domain | Security | Detects suspicious ways to download files from Microsoft domains that are used to store attachments in Emails or OneNote documents. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_download_office_domain.yml | Windows: Suspicious Download from Office Domain | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\curl\.exe|.*\\wget\.exe"" OR command REGEXP "".*Invoke-WebRequest.*|.*Start-BitsTransfer.*|.*\.DownloadFile\(.*|.*\.DownloadString\(.*|.*curl .*|.*iwr .*|.*wget .*"") AND command REGEXP "".*https://attachment\.outlook\.live\.net/owa/.*|.*https://onenoteonlinesync\.onenote\.com/onenoteonlinesync/.*"" |
| Windows: Suspicious Add User to Remote Desktop Users Group | Security | Detects suspicious command line in which a user gets added to the local Remote Desktop Users group. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_add_user_remote_desktop_group.yml | Windows: Suspicious Add User to Remote Desktop Users Group | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*localgroup .*"" AND command REGEXP "".* /add.*"") OR (command REGEXP "".*Add-LocalGroupMember .*"" AND command REGEXP "".* -Group .*"")) AND command REGEXP "".*Remote Desktop Users.*|.*Usuarios de escritorio remoto.*|.*Utilisateurs du Bureau . distance.*"" |
| Windows: StoneDrill Service Install | Security | This method detects a service install of the malicious Microsoft Network Realtime Inspection Service service described in StoneDrill report by Kaspersky. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_apt_stonedrill.yml | Windows: StoneDrill Service Install | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceName=""NtsSrv"" AND serviceFileName REGEXP "".* LocalService"" |
| Windows: Suspect Svchost Activity | Security | It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns the process and injects code into the process memory space. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_svchost_execution_with_no_cli_flags.yml | Windows: Suspect Svchost Activity | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*svchost\.exe"" AND procName REGEXP "".*\\svchost\.exe"") AND (parentProcName NOT REGEXP "".*\\rpcnet\.exe|.*\\rpcnetp\.exe"" AND command IS NOT NULL) |
| Windows: Suspicious Child Process Of SQL Server | Security | Detects suspicious child processes of the SQLServer process. This could indicate potential RCE or SQL Injection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mssql_susp_child_process.yml | Windows: Suspicious Child Process Of SQL Server | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\sqlservr\.exe"" AND procName REGEXP "".*\\bash\.exe|.*\\bitsadmin\.exe|.*\\cmd\.exe|.*\\netstat\.exe|.*\\nltest\.exe|.*\\ping\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\sh\.exe|.*\\systeminfo\.exe|.*\\tasklist\.exe|.*\\wsl\.exe"") AND ((parentProcName NOT REGEXP ""C:\\Program Files\\Microsoft SQL Server\\.*"" OR parentProcName NOT REGEXP "".*DATEV_DBENGINE\\MSSQL\\Binn\\sqlservr\.exe"" OR procName!=""C:\\Windows\\System32\\cmd.exe"" OR command NOT REGEXP ""\""C:\\Windows\\system32\\cmd\.exe\"" .*"")) |
| Windows: Suspicious Double Extension Files | Security | Detects dropped files with double extensions, which is often used by malware as a method to abuse the fact that windows hide default extensions by default. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_double_extension.yml | Windows: Suspicious Double Extension Files | eventType=""Win-Sysmon-11-FileCreate"" AND ((fileName REGEXP "".*\.exe|.*\.iso|.*\.rar|.*\.zip"" AND fileName REGEXP "".*\.doc\..*|.*\.docx\..*|.*\.jpg\..*|.*\.pdf\..*|.*\.ppt\..*|.*\.pptx\..*|.*\.xls\..*|.*\.xlsx\..*"") OR fileName REGEXP "".*\.rar\.exe|.*\.zip\.exe"") |
| Windows: Suspicious Cabinet File Expansion | Security | Adversaries can use the built-in expand utility to decompress cab files as seen in recent Iranian MeteorExpress attack. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_expand_cabinet_files.yml | Windows: Suspicious Cabinet File Expansion | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\expand\.exe"" AND command REGEXP "".*-F:.*|.*/F:.*|.*C:\\ProgramData\\.*|.*C:\\Public\\.*|.*\.cab.*|.*\\AppData\\Local\\Temp\\.*|.*\\AppData\\Roaming\\Temp\\.*"") AND ((parentProcName!=""C:\\Program Files (x86)\\Dell\\UpdateService\\ServiceShell.exe"" OR command NOT REGEXP "".*C:\\ProgramData\\Dell\\UpdateService\\Temp\\.*"")) |
| Windows: Start of NT Virtual DOS Machine | Security | Ntvdm.exe allows the execution of 16-bit Windows applications on 32-bit Windows operating systems, as well as the execution of both 16-bit and 32-bit DOS applications. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_16bit_application.yml | Windows: Start of NT Virtual DOS Machine | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\csrstub\.exe|.*\\ntvdm\.exe"" |
| Windows: Suspicious Driver Load from Temp | Security | Detects a driver load from a temporary directory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_susp_temp_use.yml | Windows: Suspicious Driver Load from Temp | eventType=""Win-Sysmon-6-Driver-Loaded"" AND loadedProcName REGEXP "".*\\Temp\\.*"" |
| Windows: Suspicious Download Via Certutil.EXE | Security | Detects the execution of certutil with certain flags that allow the utility to download files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_certutil_download.yml | Windows: Suspicious Download Via Certutil.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\certutil\.exe"" OR srcFileName=""CertUtil.exe"") AND command REGEXP "".*urlcache .*|.*verifyctl .*"" AND command REGEXP "".*http.*"" |
| Windows: Suspicious AppX Package Locations | Security | Detects an appx package added the pipeline of the ""to be processed"" packages which is located in suspicious locations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_susp_package_locations.yml | Windows: Suspicious AppX Package Locations | eventType =""Win-AppXDeployment-Server-854"" AND procPath REGEXP "".*/AppdData/Local/Temp/.*|.*/Downloads/.*|.*/desktop/.*|.*/users/public/.*|.*C:/Windows/Temp/.*|.*C:/perflogs/.*|.*C:\\PerfLogs\\.*|.*C:\\Users\\Public\\.*|.*C:\\Windows\\Temp\\.*|.*\\AppdData\\Local\\Temp\\.*|.*\\Desktop\\.*|.*\\Downloads\\.*"" |
| Windows: Suspicious Driver Install by pnputil.exe | Security | Detects when a possible suspicious driver is being installed via pnputil.exe lolbin. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_susp_driver_installed_by_pnputil.yml | Windows: Suspicious Driver Install by pnputil.exe | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*-a.*|.*-i.*|.*/add-driver.*|.*/install.*|.*\.inf.*"" AND procName REGEXP "".*\\pnputil\.exe"" |
| Windows: Suspicious Atbroker Execution | Security | Atbroker executing non-deafualt Assistive Technology applications. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_susp_atbroker.yml | Windows: Suspicious Atbroker Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*AtBroker\.exe"" AND command REGEXP "".*start.*"") AND (command NOT REGEXP "".*Narrator.*|.*animations.*|.*audiodescription.*|.*caretbrowsing.*|.*caretwidth.*|.*colorfiltering.*|.*cursorscheme.*|.*filterkeys.*|.*focusborderheight.*|.*focusborderwidth.*|.*highcontrast.*|.*keyboardcues.*|.*keyboardpref.*|.*magnifierpane.*|.*messageduration.*|.*minimumhitradius.*|.*mousekeys.*|.*osk.*|.*overlappedcontent.*|.*showsounds.*|.*soundsentry.*|.*stickykeys.*|.*togglekeys.*|.*windowarranging.*|.*windowtracking.*|.*windowtrackingtimeout.*|.*windowtrackingzorder.*"") |
| Windows: Suspicious CustomShellHost Execution | Security | Detects the execution of CustomShellHost binary where the child isn't located in 'C:\Windows\explorer.exe'. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_customshellhost.yml | Windows: Suspicious CustomShellHost Execution | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\CustomShellHost\.exe"" AND (procName!=""C:\\Windows\\explorer.exe"") |
| Windows: Suspicious aspnet-compiler.exe Execution | Security | Execute C# code with the Build Provider and proper folder structure in place. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_aspnet_compiler.yml | Windows: Suspicious aspnet-compiler.exe Execution | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*C:\\Windows\\Microsoft\.NET\\Framework.*"" AND procName REGEXP "".*aspnet_compiler\.exe.*"" |
| Windows: Suspicious ASPX File Drop by Exchange | Security | Detects suspicious file type dropped by an Exchange component in IIS into a suspicious folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_exchange_webshell_drop.yml | Windows: Suspicious ASPX File Drop by Exchange | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\w3wp\.exe"" AND command REGEXP "".*MSExchange.*"" AND fileName REGEXP "".*FrontEnd\\HttpProxy\\.*|.*\\inetpub\\wwwroot\\aspnet_client\\.*"" AND fileName REGEXP "".*\.ashx|.*\.asp|.*\.aspx"" |
| Windows: Suspicious DNS Query for IP Lookup Service APIs | Security | Detects DNS queries for IP lookup services such as ""api.ipify.org"" originating from a non browser process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_susp_ipify.yml | Windows: Suspicious DNS Query for IP Lookup Service APIs | eventType=""Win-Sysmon-22-DNS-Query"" AND queryId REGEXP "".*api\.2ip\.ua.*|.*api\.ipify\.org.*|.*bot\.whatismyipaddress\.com.*|.*canireachthe\.net.*|.*checkip\.amazonaws\.com.*|.*checkip\.dyndns\.org.*|.*curlmyip\.com.*|.*edns\.ip-api\.com.*|.*eth0\.me.*|.*freegeoip\.app.*|.*geoipy\.com.*|.*getip\.pro.*|.*icanhazip\.com.*|.*ident\.me.*|.*ifconfig\.io.*|.*ifconfig\.me.*|.*ip-api\.com.*|.*ip\.anysrc\.net.*|.*ip\.tyk\.nu.*|.*ipaddressworld\.com.*|.*ipecho\.net.*|.*ipinfo\.io.*|.*ipof\.in.*|.*ipv4\.icanhazip\.com.*|.*ipv4bot\.whatismyipaddress\.com.*|.*ipwho\.is.*|.*l2\.io.*|.*myexternalip\.com.*|.*wgetip\.com.*|.*whatismyip\.akamai\.com.*|.*wtfismyip\.com.*"" AND ((procName NOT REGEXP "".*\\brave\.exe"") AND (procName NOT IN (""C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"",""C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"")) AND (procName NOT IN (""C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"",""C:\\Program Files\\Mozilla Firefox\\firefox.exe"")) AND (procName NOT IN (""C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe"",""C:\\Program Files\\Internet Explorer\\iexplore.exe"")) AND (procName NOT REGEXP "".*\\maxthon\.exe"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeWebView\\Application\\.*"" AND procName NOT REGEXP "".*\\WindowsApps\\MicrosoftEdge\.exe"" AND procName NOT IN (""C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe"",""C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"")) AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeCore\\.*|C:\\Program Files\\Microsoft\\EdgeCore\\.*"" OR procName NOT REGEXP "".*\\msedge\.exe|.*\\msedgewebview2\.exe"") AND (procName NOT REGEXP "".*\\opera\.exe"") AND (procName NOT REGEXP "".*\\safari\.exe"") AND (procName NOT REGEXP "".*\\seamonkey\.exe"") AND (procName NOT REGEXP "".*\\vivaldi\.exe"") AND (procName NOT REGEXP "".*\\whale\.exe"")) |
| Windows: Suspicious Chromium Browser Instance Executed With Custom Extensions | Security | Detects a suspicious process spawning a Chromium based browser process with the 'load-extension' flag to start a instance with custom extensions. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_browsers_chromium_susp_load_extension.yml | Windows: Suspicious Chromium Browser Instance Executed With Custom Extensions | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\cmd\.exe|.*\\cscript\.exe|.*\\mshta\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wscript\.exe"" AND procName REGEXP "".*\\brave\.exe|.*\\chrome\.exe|.*\\msedge\.exe|.*\\opera\.exe|.*\\vivaldi\.exe"" AND command REGEXP "".*--load-extension=.*"" AND command REGEXP "".*\\AppData\\Local\\.*"" |
| Windows: Suspicious Digital Signature Of AppX Package | Security | Detects execution of AppX packages with known suspicious or malicious signature. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/appxpackaging_om/win_appxpackaging_om_sups_appx_signature.yml | Windows: Suspicious Digital Signature Of AppX Package | eventType =""Win-AppXDeployment-Server-157"" AND subjectContainsWords=""CN=Foresee Consulting Inc., O=Foresee Consulting Inc., L=North York, S=Ontario, C=CA, SERIALNUMBER=1004913-1, OID.1.3.6.1.4.1.311.60.2.1.3=CA, OID.2.5.4.15=Private Organization"" |
| Windows: Suspicious Debugger Registration Cmdline | Security | Detects the registration of a debugger for a program that is available in the logon screen (sticky key backdoor). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_registry_install_reg_debugger_backdoor.yml | Windows: Suspicious Debugger Registration Cmdline | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\CurrentVersion\\Image File Execution Options\\.*"" AND command REGEXP "".*HelpPane\.exe.*|.*atbroker\.exe.*|.*displayswitch\.exe.*|.*magnify\.exe.*|.*narrator\.exe.*|.*osk\.exe.*|.*sethc\.exe.*|.*utilman\.exe.*"" |
| Windows: Suspicious desktop.ini Action | Security | Detects unusual processes accessing desktop.ini, which can be leveraged to alter how Explorer displays a folder's content (i.e. renaming files) without changing them on disk. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_desktop_ini.yml | Windows: Suspicious desktop.ini Action | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\desktop\.ini"" AND ((procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*|C:\\Windows\\.*"") AND (procName NOT REGEXP "".*\\AppData\\Local\\JetBrains\\Toolbox\\bin\\7z\.exe"" OR fileName NOT REGEXP "".*\\JetBrains\\apps\\.*"") AND (fileName NOT REGEXP ""C:\\\$WINDOWS\.~BT\\NewOS\\.*"")) |
| Windows: Suspicious Calculator Usage | Security | Detects suspicious use of 'calc.exe' with command line parameters or in a suspicious directory, which is likely caused by some PoC or detection evasion. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_calc.yml | Windows: Suspicious Calculator Usage | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*\\calc\.exe .*"" OR (procName REGEXP "".*\\calc\.exe"" AND (procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\WinSxS\\.*""))) |
| Windows: Suspicious Electron Application Child Processes | Security | Detects suspicious child processes of electron apps (teams, discord, slack...). This could be a potential sign of "".asar"" file tampering (See reference section for more information) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_electron_app_children.yml | Windows: Suspicious Electron Application Child Processes | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\Teams\.exe|.*\\discord\.exe|.*\\slack\.exe"" AND procName REGEXP "".*\\cmd\.exe|.*\\cscript\.exe|.*\\mshta\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\wscript\.exe"") AND (parentProcName NOT REGEXP "".*\\Discord\.exe"" OR command NOT REGEXP "".*\\NVSMI\\nvidia-smi\.exe.*"") |
| Windows: Suspicious AppX Package Installation Attempt | Security | Detects an appx package installation with the error code ""0x80073cff"" which indicates that the package didn't meet the signing requirements and could be suspicious. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_susp_appx_package_installation.yml | Windows: Suspicious AppX Package Installation Attempt | eventType =""Win-AppXDeployment-Server-401"" AND errorCode=""0x80073cff"" |
| Windows: Suspicious Execution From GUID Like Folder Names | Security | Detects potential suspicious execution of a GUID like folder name located in a suspicious location such as %TEMP% as seen being used in IcedID attacks. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_execution_from_guid_folder_names.yml | Windows: Suspicious Execution From GUID Like Folder Names | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*\\AppData\\Local\\Temp\\.*|.*\\AppData\\Roaming\\.*"" AND command REGEXP "".*\\\{.*"" AND command REGEXP "".*\}\\.*"") AND ((procName NOT REGEXP "".*\\\{.*"" OR procName NOT REGEXP "".*\}\\.*"") AND (procName IS NOT NULL) AND (procName!=""C:\\Windows\\System32\\drvinst.exe"")) |
| Windows: Suspicious Creation with Colorcpl | Security | Once executed, colorcpl.exe will copy the arbitrary file to c:\windows\system32\spool\drivers\color\. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_colorcpl.yml | Windows: Suspicious Creation with Colorcpl | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\colorcpl\.exe"" AND ((fileName NOT REGEXP "".*\.camp|.*\.cdmp|.*\.gmmp|.*\.icm"")) |
| Windows: Suspicious DLL Loaded via CertOC.EXE | Security | Detects when a user installs certificates by using CertOC.exe to load the target DLL file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_certoc_load_dll_susp_locations.yml | Windows: Suspicious DLL Loaded via CertOC.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\certoc\.exe"" OR srcFileName=""CertOC.exe"") AND command REGEXP "".* -LoadDLL .*|.* /LoadDLL .*"" AND command REGEXP "".*C:\\Windows\\Tasks\\.*|.*C:\\Windows\\Temp\\.*|.*\\Appdata\\Local\\Temp\\.*|.*\\Desktop\\.*|.*\\Downloads\\.*|.*\\Users\\Public\\.*"" |
| Windows: Suspicious Elevated System Shell | Security | Detects when a shell program such as the windows Command Prompt or PowerShell is launched with system privileges. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_elevated_system_shell.yml | Windows: Suspicious Elevated System Shell | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\cmd\.exe|.*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""Cmd.Exe"",""PowerShell.EXE"",""pwsh.dll"")) AND (user REGEXP "".*AUTHORI.*|.*AUTORI.*"" AND winLogonId=""0x3e7"")) AND ((parentProcName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*|C:\\Windows\\System32\\.*"" OR procName NOT REGEXP "".*\\cmd\.exe|.*\\powershell\.exe"") AND (parentProcName!=""C:\\ManageEngine\\ADManager Plus\\pgsql\\bin\\postgres.exe"" OR procName NOT REGEXP "".*\\cmd\.exe"") AND (parentProcName NOT REGEXP ""C:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\.*"" OR parentProcName NOT REGEXP "".*\\CitrixReceiverUpdater\.exe"" OR procName NOT REGEXP "".*\\cmd\.exe"") AND (command NOT REGEXP ""C:\\WINDOWS\\system32\\cmd\.exe /c \"".*"" OR dirName NOT REGEXP "".*C:\\WINDOWS\\Temp\\asgard2-agent\\.*"") AND (parentProcName NOT REGEXP ""C:\\Windows\\Temp.*"" OR parentProcName NOT REGEXP "".*\\invcol\.exe"" OR parentCommand NOT REGEXP "".*C:\\ProgramData\\Dell\\UpdateService\\.*"" OR procName NOT REGEXP "".*\\cmd\.exe"") AND (parentProcName NOT REGEXP ""C:\\Windows\\WinSxS\\.*"" OR parentProcName NOT REGEXP "".*\\CompatTelRunner\.exe"" OR parentCommand NOT REGEXP ""C:\\Windows\\system32\\CompatTelRunner\.exe -m:appraiser\.dll -f:DoScheduledTelemetryRun.*"") AND (parentProcName NOT REGEXP ""C:\\IBM\\SpectrumProtect\\webserver\\scripts\\.*"" OR command NOT REGEXP "".*C:\\IBM\\SpectrumProtect\\webserver\\scripts\\.*"") AND (command!=""powershell.exe -ExecutionPolicy Restricted -Command Write-Host 'Final result: 1';"") AND (procName NOT REGEXP "".*\\cmd\.exe"" OR command NOT REGEXP "".*/d /c C:\\Windows\\system32\\silcollector\.cmd.*"") AND (procName NOT REGEXP "".*\\cmd\.exe"" OR command NOT REGEXP "".*cmd\.exe /c btool server list general --no-log|.*cmd\.exe /c btool server list replication_port --no-log"") AND (procName NOT REGEXP "".*\\cmd\.exe"" OR command NOT REGEXP "".*C:\\Windows\\system32\\reg\.exe query hklm\\software\\microsoft\\windows\\softwareinventorylogging /v collectionstate /reg:64.*"") AND (procName!=""C:\\Windows\\System32\\cmd.exe"" OR command!=""C:\\Windows\\system32\\cmd.exe /c PAUSE"")) |
| Windows: Suspicious File Downloaded From Direct IP Via Certutil.EXE | Security | Detects the execution of certutil with certain flags that allow the utility to download files from direct IPs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_certutil_download_direct_ip.yml | Windows: Suspicious File Downloaded From Direct IP Via Certutil.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\certutil\.exe"" OR srcFileName=""CertUtil.exe"") AND command REGEXP "".*urlcache .*|.*verifyctl .*"" AND command REGEXP "".*://1.*|.*://2.*|.*://3.*|.*://4.*|.*://5.*|.*://6.*|.*://7.*|.*://8.*|.*://9.*"") AND ((command NOT REGEXP "".*://7-.*"")) |
| Windows: Suspicious FromBase64String Usage On Gzip Archive - Process Creation | Security | Detects attempts of decoding a base64 Gzip archive via PowerShell. This technique is often used as a method to load malicious content into memory afterward. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_frombase64string_archive.yml | Windows: Suspicious FromBase64String Usage On Gzip Archive - Process Creation | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*FromBase64String.*"" AND command REGEXP "".*MemoryStream.*"" AND command REGEXP "".*H4sI.*"" |
| Windows: Suspicious Execution of InstallUtil To Download | Security | Detects the use the .NET InstallUtil.exe application in order to download arbitrary files. The files will be written to %LOCALAPPDATA%\Microsoft\Windows\INetCache\IE\. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_installutil_download.yml | Windows: Suspicious Execution of InstallUtil To Download | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\InstallUtil\.exe"" OR srcFileName=""InstallUtil.exe"") AND command REGEXP "".*ftp://.*|.*http://.*|.*https://.*"" |
| Windows: Suspicious Execution Of PDQDeployRunner | Security | Detects suspicious execution of ""PDQDeployRunner"" which is part of the PDQDeploy service stack that is responsible for executing commands and packages on a remote machines. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pdqdeploy_runner_susp_children.yml | Windows: Suspicious Execution Of PDQDeployRunner | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*PDQDeployRunner-.*"" AND (procName REGEXP "".*\\bash\.exe|.*\\certutil\.exe|.*\\csc\.exe|.*\\cscript\.exe|.*\\dllhost\.exe|.*\\mshta\.exe|.*\\msiexec\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\scriptrunner\.exe|.*\\wmic\.exe|.*\\wscript\.exe|.*\\wsl\.exe"" OR procName REGEXP "".*C:\\ProgramData\\.*|.*C:\\Users\\Public\\.*|.*C:\\Windows\\TEMP\\.*|.*\\AppData\\Local\\Temp.*"" OR command REGEXP "".* -decode .*|.* -enc .*|.* -encodedcommand .*|.* -w hidden.*|.*DownloadString.*|.*FromBase64String.*|.*Invoke-.*|.*http.*|.*iex .*"") |
| Windows: Suspicious Ntdll Pipe Redirection | Security | Detects command that type the content of ntdll.dll to a different file or a pipe in order to evade AV / EDR detection. As seen being used in the POC NtdllPipe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_ntdllpipe_redirect.yml | Windows: Suspicious Ntdll Pipe Redirection | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\ntdll\.dll > \\\\\.\\pipe\\\.*|.*type %systemroot%\\system32\\ntdll\.dll.*|.*type %windir%\\system32\\ntdll\.dll.*|.*type c:\\windows\\system32\\ntdll\.dll.*"" |
| Windows: Suspicious PowerShell Mailbox Export to Share | Security | Detects usage of the powerShell New-MailboxExportRequest Cmdlet to exports a mailbox to a remote or local share, as used in ProxyShell exploitations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_mailboxexport_share.yml | Windows: Suspicious PowerShell Mailbox Export to Share | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*New-MailboxExportRequest.*"" AND command REGEXP "".* -Mailbox .*"" AND command REGEXP "".* -FilePath \\\\\.*"" |
| Windows: Suspicious LOLBIN AccCheckConsole | Security | Detects suspicious LOLBIN AccCheckConsole execution with parameters as used to load an arbitrary DLL. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_susp_acccheckconsole.yml | Windows: Suspicious LOLBIN AccCheckConsole | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\AccCheckConsole\.exe"" OR srcFileName=""AccCheckConsole.exe"") AND (command REGEXP "".* -window .*"" AND command REGEXP "".*\.dll.*"") |
| Windows: Suspicious Interactive PowerShell as SYSTEM | Security | Detects the creation of files that indicator an interactive use of PowerShell in the SYSTEM user context. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_system_interactive_powershell.yml | Windows: Suspicious Interactive PowerShell as SYSTEM | eventType=""Win-Sysmon-11-FileCreate"" AND fileName IN (""C:\\Windows\\System32\\config\\systemprofile\\AppData\\Local\\Microsoft\\Windows\\PowerShell\\StartupProfileData-Interactive"",""C:\\Windows\\System32\\config\\systemprofile\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt"") |
| Windows: Suspicious MSExchangeMailboxReplication ASPX Write | Security | Detects suspicious activity in which the MSExchangeMailboxReplication process writes .asp and .apsx files to disk, which could be a sign of ProxyShell exploitation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_exchange_aspx_write.yml | Windows: Suspicious MSExchangeMailboxReplication ASPX Write | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\MSExchangeMailboxReplication\.exe"" AND fileName REGEXP "".*\.asp|.*\.aspx"" |
| Windows: Suspicious Powercfg Execution To Change Lock Screen Timeout | Security | Detects suspicious execution of 'Powercfg.exe' to change lock screen timeout. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powercfg_execution.yml | Windows: Suspicious Powercfg Execution To Change Lock Screen Timeout | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powercfg\.exe"" OR srcFileName=""PowerCfg.exe"") AND ((command REGEXP "".*/setacvalueindex .*"" AND command REGEXP "".*SCHEME_CURRENT.*"" AND command REGEXP "".*SUB_VIDEO.*"" AND command REGEXP "".*VIDEOCONLOCK.*"") OR (command REGEXP "".*-change .*"" AND command REGEXP "".*-standby-timeout-.*"")) |
| Windows: Suspicious Get-Variable.exe Creation | Security | Get-Variable is a valid PowerShell cmdlet WindowsApps is by default in the path where PowerShell is executed. So when the Get-Variable command is issued on PowerShell execution, the system first looks for the Get-Variable executable in the path and executes the malicious binary instead of looking for the PowerShell cmdlet. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_get_variable.yml | Windows: Suspicious Get-Variable.exe Creation | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*Local\\Microsoft\\WindowsApps\\Get-Variable\.exe"" |
| Windows: Suspicious File Created Via OneNote Application | Security | Detects suspicious files created via the OneNote application. This could indicate a potential malicious "".one""/"".onepkg"" file was executed as seen being used in malware activity in the wild. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_onenote_susp_dropped_files.yml | Windows: Suspicious File Created Via OneNote Application | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\onenote\.exe|.*\\onenoteim\.exe|.*\\onenotem\.exe"" AND fileName REGEXP "".*\\AppData\\Local\\Temp\\OneNote\\.*"" AND fileName REGEXP "".*\.bat|.*\.chm|.*\.cmd|.*\.dll|.*\.exe|.*\.hta|.*\.htm|.*\.html|.*\.js|.*\.lnk|.*\.ps1|.*\.vbe|.*\.vbs|.*\.wsf"" |
| Windows: Suspicious OfflineScannerShell.exe Execution From Another Folder | Security | Use OfflineScannerShell.exe to execute mpclient.dll library in the current working directory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_offlinescannershell.yml | Windows: Suspicious OfflineScannerShell.exe Execution From Another Folder | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\OfflineScannerShell\.exe"" AND ((dirName!=""C:\\Program Files\\Windows Defender\\Offline\\"") AND (dirName IS NOT NULL)) |
| Windows: Suspicious PowerShell Child Processes | Security | Detects suspicious child processes spawned by PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_susp_child_processes.yml | Windows: Suspicious PowerShell Child Processes | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\powershell\.exe|.*\\powershell_ise\.exe|.*\\pwsh\.exe"" AND procName REGEXP "".*\\bash\.exe|.*\\bitsadmin\.exe|.*\\certutil\.exe|.*\\cscript\.exe|.*\\forfiles\.exe|.*\\hh\.exe|.*\\mshta\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\schtasks\.exe|.*\\scrcons\.exe|.*\\scriptrunner\.exe|.*\\sh\.exe|.*\\wmic\.exe|.*\\wscript\.exe"") AND ((parentCommand NOT REGEXP "".*\\Program Files\\Amazon\\WorkspacesConfig\\Scripts\\.*"" OR command NOT REGEXP "".*\\Program Files\\Amazon\\WorkspacesConfig\\Scripts\\.*"")) |
| Windows: Suspicious New Instance Of An Office COM Object | Security | Detects an svchost process spawning an instance of an office application. This happens when the initial word application creates an instance of one of the Office COM objects such as 'Word.Application', 'Excel.Application', etc. This can be used by malicious actors to create malicious Office documents with macros on the fly. (See vba2clr project in the references) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_svchost_parent.yml | Windows: Suspicious New Instance Of An Office COM Object | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\svchost\.exe"" AND procName REGEXP "".*\\eqnedt32\.exe|.*\\excel\.exe|.*\\msaccess\.exe|.*\\mspub\.exe|.*\\powerpnt\.exe|.*\\visio\.exe|.*\\winword\.exe"" |
| Windows: Suspicious LNK Double Extension File | Security | Detects the creation of files with an ""LNK"" as a second extension. This is sometimes used by malware as a method to abuse the fact that Windows hides the ""LNK"" extension by default. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_lnk_double_extension.yml | Windows: Suspicious LNK Double Extension File | eventType=""Win-Sysmon-11-FileCreate"" AND ((fileName REGEXP "".*\.lnk"" AND fileName REGEXP "".*\.doc\..*|.*\.docx\..*|.*\.jpg\..*|.*\.pdf\..*|.*\.ppt\..*|.*\.pptx\..*|.*\.xls\..*|.*\.xlsx\..*"") AND ((fileName NOT REGEXP "".*\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\.*""))) AND ((procName NOT REGEXP "".*\\excel\.exe|.*\\powerpnt\.exe|.*\\winword\.exe"" OR fileName NOT REGEXP "".*\\AppData\\Roaming\\Microsoft\\Office\\Recent\\.*"") AND (procName NOT REGEXP "".*\\excel\.exe"" OR fileName NOT REGEXP "".*\\AppData\\Roaming\\Microsoft\\Excel.*"") AND (procName NOT REGEXP "".*\\powerpnt\.exe"" OR fileName NOT REGEXP "".*\\AppData\\Roaming\\Microsoft\\PowerPoint.*"") AND (procName NOT REGEXP "".*\\winword\.exe"" OR fileName NOT REGEXP "".*\\AppData\\Roaming\\Microsoft\\Word.*"")) |
| Windows: Suspicious MSDT Parent Process | Security | Detects msdt.exe executed by a suspicious parent as seen in CVE-2022-30190 / Follina exploitation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msdt_susp_parent.yml | Windows: Suspicious MSDT Parent Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\cmd\.exe|.*\\cscript\.exe|.*\\mshta\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\schtasks\.exe|.*\\wmic\.exe|.*\\wscript\.exe|.*\\wsl\.exe"" AND (procName REGEXP "".*\\msdt\.exe"" OR srcFileName=""msdt.exe"") |
| Windows: Suspicious File Downloaded From File-Sharing Website Via Certutil.EXE | Security | Detects the execution of certutil with certain flags that allow the utility to download files from file-sharing websites. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_certutil_download_file_sharing_domains.yml | Windows: Suspicious File Downloaded From File-Sharing Website Via Certutil.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\certutil\.exe"" OR srcFileName=""CertUtil.exe"") AND command REGEXP "".*urlcache .*|.*verifyctl .*"" AND command REGEXP "".*\.ghostbin\.co/.*|.*\.hastebin\.com.*|.*\.paste\.ee.*|.*anonfiles\.com.*|.*cdn\.discordapp\.com/attachments/.*|.*ddns\.net.*|.*gist\.githubusercontent\.com.*|.*mediafire\.com.*|.*mega\.nz.*|.*paste\.ee.*|.*pastebin\.com.*|.*pastebin\.pl.*|.*pastetext\.net.*|.*privatlab\.com.*|.*privatlab\.net.*|.*raw\.githubusercontent\.com.*|.*send\.exploit\.in.*|.*sendspace\.com.*|.*storage\.googleapis\.com.*|.*transfer\.sh.*|.*ufile\.io.*"" |
| Windows: Suspicious Process Start Locations | Security | Detects suspicious process run from unusual locations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_run_locations.yml | Windows: Suspicious Process Start Locations | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*:\\RECYCLER\\.*|.*:\\SystemVolumeInformation\\.*"" OR procName REGEXP ""C:\\Windows\\Tasks\\.*|C:\\Windows\\addins\\.*|C:\\Windows\\cursors\\.*|C:\\Windows\\debug\\.*|C:\\Windows\\drivers\\.*|C:\\Windows\\fonts\\.*|C:\\Windows\\help\\.*|C:\\Windows\\system32\\tasks\\.*"") |
| Windows: Suspicious New Service Creation | Security | Detects creation of a new service via ""sc"" command or the powershell ""new-service"" cmdlet with suspicious binary paths. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_service_creation.yml | Windows: Suspicious New Service Creation | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\sc\.exe"" AND command REGEXP "".*create.*"" AND command REGEXP "".*binPath=.*"") OR (command REGEXP "".*New-Service.*"" AND command REGEXP "".*-BinaryPathName.*"")) AND command REGEXP "".*C:\\Users\\Public.*|.*C:\\Windows\\TEMP\\.*|.*\\AppData\\Local\\Temp.*|.*\\Desktop\\.*|.*\\Downloads\\.*|.*\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\.*|.*cmd .*|.*cmd\.exe /c.*|.*cmd\.exe /k.*|.*cmd\.exe /r.*|.*cscript.*|.*dllhost.*|.*mshta.*|.*powershell.*|.*rundll32.*|.*svchost.*|.*wscript.*"" |
| Windows: Suspicious Hacktool Execution - PE Metadata | Security | Detects the execution of different Windows based hacktools via PE metadata (company, product, etc.) even if the files have been renamed. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_execution_via_pe_metadata.yml | Windows: Suspicious Hacktool Execution - PE Metadata | eventType=""Win-Sysmon-1-Create-Process"" AND company=""Cube0x0"" |
| Windows: Suspicious GrpConv Execution | Security | Detects the suspicious execution of a utility to convert Windows 3.x .grp files or for persistence purposes by malicious software or actors. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_susp_grpconv.yml | Windows: Suspicious GrpConv Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*grpconv -o.*|.*grpconv\.exe -o.*"" |
| Windows: Suspicious IIS Module Registration | Security | Detects a suspicious IIS module registration as described in Microsoft threat report on IIS backdoors. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_iis_susp_module_registration.yml | Windows: Suspicious IIS Module Registration | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\w3wp\.exe"" AND (command REGEXP "".*appcmd\.exe add module.*"" OR (command REGEXP "".* system\.enterpriseservices\.internal\.publish.*"" AND procName REGEXP "".*\\powershell\.exe"") OR (command REGEXP "".*gacutil.*"" AND command REGEXP "".* /I.*"")) |
| Windows: Suspicious File Creation In Uncommon AppData Folder | Security | Detects the creation of suspicious files and folders inside the user's AppData folder but not inside any of the common and well known directories (Local, Romaing, LocalLow). This method could be used as a method to bypass detection who exclude the AppData folder in fear of FPs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_new_files_in_uncommon_appdata_folder.yml | Windows: Suspicious File Creation In Uncommon AppData Folder | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP ""C:\\Users\\.*"" AND fileName REGEXP "".*\\AppData\\.*"" AND fileName REGEXP "".*\.bat|.*\.cmd|.*\.cpl|.*\.dll|.*\.exe|.*\.hta|.*\.iso|.*\.lnk|.*\.msi|.*\.ps1|.*\.psm1|.*\.scr|.*\.vbe|.*\.vbs"") AND (fileName NOT REGEXP ""C:\\Users\\.*"" OR fileName NOT REGEXP "".*\\AppData\\LocalLow\\.*|.*\\AppData\\Local\\.*|.*\\AppData\\Roaming\\.*"") |
| Windows: Suspicious Greedy Compression Using Rar.EXE | Security | Detects RAR usage that creates an archive from a suspicious folder, either a system folder or one of the folders often used by attackers for staging purposes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rar_susp_greedy_compression.yml | Windows: Suspicious Greedy Compression Using Rar.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rar\.exe"" OR description=""Command line RAR"" OR command REGEXP "".* a -m.*|.*\.exe a .*"") AND (command REGEXP "".* -hp.*"" AND command REGEXP "".* -r .*"" AND command REGEXP "".* %public%.*|.* C:\\PerfLogs\\.*|.* C:\\Temp.*|.* C:\\Users\\Public\\.*|.* C:\\Windows\\.*|.* C:\\\$Recycle\.bin\\.*|.* C:\\\.*\..*|.* C:\\\\\.*\..*"") |
| Windows: Suspicious File Drop by Exchange | Security | Detects suspicious file type dropped by an Exchange component in IIS. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_exchange_webshell_drop_suspicious.yml | Windows: Suspicious File Drop by Exchange | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\w3wp\.exe"" AND command REGEXP "".*MSExchange.*"" AND fileName REGEXP "".*\.ashx|.*\.asp|.*\.aspx|.*\.bat|.*\.dll|.*\.exe|.*\.ps1|.*\.vbs"" |
| Windows: Suspicious File Download From File Sharing Domain Via Curl.EXE | Security | Detects file download using curl.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_curl_download_susp_file_sharing_domains.yml | Windows: Suspicious File Download From File Sharing Domain Via Curl.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\curl\.exe"" OR srcFileName=""curl.exe"") AND (command REGEXP "".*anonfiles\.com.*|.*cdn\.discordapp\.com/attachments/.*|.*ddns\.net.*|.*ghostbin\.co/.*|.*gist\.githubusercontent\.com.*|.*hastebin\.com.*|.*mediafire\.com.*|.*mega\.nz.*|.*paste\.ee.*|.*pastebin\.com.*|.*pastebin\.pl.*|.*pastetext\.net.*|.*privatlab\.com.*|.*privatlab\.net.*|.*raw\.githubusercontent\.com.*|.*send\.exploit\.in.*|.*sendspace\.com.*|.*storage\.googleapis\.com.*|.*temp\.sh.*|.*transfer\.sh.*|.*ufile\.io.*"" OR command REGEXP ""://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}"") AND command REGEXP "".*http.*"" AND command REGEXP "".* -O.*|.*--output.*|.*--remote-name.*"" AND command REGEXP "".*\.bat|.*\.bat'|.*\.bat\""|.*\.dll|.*\.dll'|.*\.dll\""|.*\.exe|.*\.exe'|.*\.exe\""|.*\.hta|.*\.hta'|.*\.hta\""|.*\.ps1|.*\.ps1'|.*\.ps1\""|.*\.psm1|.*\.psm1'|.*\.psm1\""|.*\.vbe|.*\.vbe'|.*\.vbe\""|.*\.vbs|.*\.vbs'|.*\.vbs\"""" |
| Windows: Suspicious PowerShell IEX Execution Patterns | Security | Detects suspicious ways to run Invoke-Execution using IEX alias. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_iex_patterns.yml | Windows: Suspicious PowerShell IEX Execution Patterns | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND command REGEXP "".* \| IEX -Error.*|.* \| IEX ;.*|.* \| IEX \(new.*|.* \| iex .*|.* \| iex;.*|.* \| iex\}.*|.*\);IEX .*"" AND command REGEXP "".*::FromBase64String.*|.*\.GetString\(\[System\.Convert\]::.*"") OR command REGEXP "".* \| IEX \| .*|.*\);iex \$.*|.*\);iex\(\$.*|.*\)\|iex;\$.*"") |
| Windows: Suspicious Git Clone | Security | Detects execution of ""git"" in order to clone a remote repository that contain suspicious keywords which might be suspicious. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_git_susp_clone.yml | Windows: Suspicious Git Clone | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\git-remote-https\.exe|.*\\git\.exe"" OR srcFileName=""git.exe"") AND command REGEXP "".* clone .*|.*git-remote-https .*"" AND command REGEXP "".*CVE-.*|.*Invoke-.*|.*MS17-.*|.*ProofOfConcept.*|.*RemoteCodeExecution.*|.*Vulns.*|.*eternal-blue.*|.*eternalblue.*|.*exploit.*|.*log4shell.*|.*poc-.*|.*proxyshell.*|.*vulnerability.*"" |
| Windows: Suspicious Network Command | Security | Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_network_command.yml | Windows: Suspicious Network Command | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*arp -a.*|.*ipconfig /all.*|.*nbtstat -n.*|.*net config.*|.*netsh interface show interface.*|.*route print.*"" |
| Windows: Suspicious Msbuild Execution By Uncommon Parent Process | Security | Detects suspicious execution of 'Msbuild.exe' by a uncommon parent process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msbuild_susp_parent_process.yml | Windows: Suspicious Msbuild Execution By Uncommon Parent Process | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\MSBuild\.exe"" OR srcFileName=""MSBuild.exe"") AND (parentProcName NOT REGEXP "".*\\cmd\.exe|.*\\devenv\.exe|.*\\explorer\.exe|.*\\msbuild\.exe|.*\\nuget\.exe|.*\\python\.exe"") |
| Windows: Suspicious IIS URL GlobalRules Rewrite Via AppCmd | Security | Detects usage of ""appcmd"" to create new global URL rewrite rules. This behaviour has been observed being used by threat actors to add new rules so they can access their webshells. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_iis_appcmd_susp_rewrite_rule.yml | Windows: Suspicious IIS URL GlobalRules Rewrite Via AppCmd | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\appcmd\.exe"" OR srcFileName=""appcmd.exe"") AND (command REGEXP "".*set.*"" AND command REGEXP "".*config.*"" AND command REGEXP "".*section:system\.webServer/rewrite/globalRules.*"" AND command REGEXP "".*commit:.*"") |
| Windows: Suspicious Parent Double Extension File Execution | Security | Detect execution of suspicious double extension files in ParentCommandLine. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_double_extension_parent.yml | Windows: Suspicious Parent Double Extension File Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\.doc\.js|.*\.doc\.lnk|.*\.docx\.js|.*\.docx\.lnk|.*\.pdf\.js|.*\.pdf\.lnk|.*\.ppt\.js|.*\.ppt\.lnk|.*\.pptx\.js|.*\.pptx\.lnk|.*\.rtf\.js|.*\.rtf\.lnk|.*\.txt\.js|.*\.txt\.lnk|.*\.xls\.js|.*\.xls\.lnk|.*\.xlsx\.js|.*\.xlsx\.lnk"" OR parentCommand REGEXP "".*\.doc\.js.*|.*\.doc\.lnk.*|.*\.docx\.js.*|.*\.docx\.lnk.*|.*\.pdf\.js.*|.*\.pdf\.lnk.*|.*\.ppt\.js.*|.*\.ppt\.lnk.*|.*\.pptx\.js.*|.*\.pptx\.lnk.*|.*\.rtf\.js.*|.*\.rtf\.lnk.*|.*\.txt\.js.*|.*\.txt\.lnk.*|.*\.xls\.js.*|.*\.xls\.lnk.*|.*\.xlsx\.js.*|.*\.xlsx\.lnk.*"") |
| Windows: Suspicious Execution of InstallUtil Without Log | Security | Uses the .NET InstallUtil.exe application in order to execute image without log. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_instalutil_no_log_execution.yml | Windows: Suspicious Execution of InstallUtil Without Log | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\InstallUtil\.exe"" AND procName REGEXP "".*Microsoft\.NET\\Framework.*"" AND command REGEXP "".*/logfile= .*"" AND command REGEXP "".*/LogToConsole=false.*"" |
| Windows: Suspicious Extexport Execution | Security | Extexport.exe loads dll and is execute from other folder the original path. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_extexport.yml | Windows: Suspicious Extexport Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*Extexport\.exe.*"" OR procName REGEXP "".*\\Extexport\.exe"" OR srcFileName=""extexport.exe"") |
| Windows: Suspicious Non-Browser Network Communication With Reddit API | Security | Detects an a non-browser process interacting with the Reddit API which could indicate use of a covert C2 such as RedditC2. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_reddit_api_non_browser_access.yml | Windows: Suspicious Non-Browser Network Communication With Reddit API | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND destName REGEXP "".*reddit\.com.*"" AND ((procName NOT REGEXP "".*\\brave\.exe"") AND (procName NOT IN (""C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"",""C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"")) AND (procName NOT IN (""C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"",""C:\\Program Files\\Mozilla Firefox\\firefox.exe"")) AND (procName NOT IN (""C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe"",""C:\\Program Files\\Internet Explorer\\iexplore.exe"")) AND (procName NOT REGEXP "".*\\maxthon\.exe"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeWebView\\Application\\.*"" AND procName NOT REGEXP "".*\\WindowsApps\\MicrosoftEdge\.exe"" AND procName NOT IN (""C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe"",""C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"")) AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeCore\\.*|C:\\Program Files\\Microsoft\\EdgeCore\\.*"" OR procName NOT REGEXP "".*\\msedge\.exe|.*\\msedgewebview2\.exe"") AND (procName NOT REGEXP "".*\\opera\.exe"") AND (procName NOT REGEXP "".*\\safari\.exe"") AND (procName NOT REGEXP "".*\\seamonkey\.exe"") AND (procName NOT REGEXP "".*\\vivaldi\.exe"") AND (procName NOT REGEXP "".*\\whale\.exe"")) |
| Windows: Suspicious Program Names | Security | Detects suspicious patterns in program names or folders that are often found in malicious samples or hacktools. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_progname.yml | Windows: Suspicious Program Names | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\CVE-202.*|.*\\CVE202.*"" OR procName REGEXP "".*\\artifact32\.exe|.*\\artifact32big\.exe|.*\\artifact64\.exe|.*\\artifact\.exe|.*\\artifact_protected\.exe|.*\\meterpreter|.*\\poc\.exe|.*obfusc\.exe|.*obfuscated\.exe"" OR command REGEXP "".*Hound\.ps1.*|.*Invoke-CVE.*|.*MiniDogz\.ps1.*|.*PowerView\.ps1.*|.*\\PowerUp_.*|.*\\Temp\\1\.ps1.*|.*\\Temp\\a\.ps1.*|.*\\Temp\\p\.ps1.*|.*\\av\.ps1.*|.*\\av_test\.ps1.*|.*\\rshell\.ps1.*|.*\\shell\.ps1.*|.*_enc\.ps1.*|.*adrecon\.ps1.*|.*beacon\.ps1.*|.*bypass\.ps1.*|.*encode\.ps1.*|.*evil\.ps1.*|.*inject\.ps1.*|.*mimikatz\.ps1.*|.*obfs\.ps1.*|.*obfus\.ps1.*|.*obfusc\.ps1.*|.*obfuscated\.ps1.*|.*payload\.ps1.*|.*powercat\.ps1.*|.*powerup\.ps1.*|.*pupy\.ps1.*|.*revshell\.ps1.*"") |
| Windows: Suspicious Process Parents | Security | Detects suspicious parent processes that should not have any children or should only have a single possible child program. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_parents.yml | Windows: Suspicious Process Parents | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\bitsadmin\.exe|.*\\minesweeper\.exe|.*\\winver\.exe"" OR (parentProcName REGEXP "".*\\calc\.exe|.*\\certutil\.exe|.*\\csrss\.exe|.*\\eventvwr\.exe|.*\\notepad\.exe"" AND ((procName NOT REGEXP "".*\\WerFault\.exe|.*\\conhost\.exe|.*\\mmc\.exe|.*\\notepad\.exe|.*\\wermgr\.exe|.*\\win32calc\.exe"") AND (procName IS NOT NULL)))) |
| Windows: Suspicious Network Connection Binary No CommandLine | Security | Detects suspicious network connections made by a well-known Windows binary run with no command line parameters. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_susp_binary_no_cmdline.yml | Windows: Suspicious Network Connection Binary No CommandLine | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (initiated=""true"" AND procName REGEXP "".*\\dllhost\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe"" AND command REGEXP "".*\\dllhost\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe"") AND ((command IS NOT NULL) AND (command IS NOT NULL)) |
| Windows: Suspicious File Created In PerfLogs | Security | Detects suspicious file based on their extension being created in ""C:\PerfLogs\"". Note that this directory mostly contains "".etl"" files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_perflogs_susp_files.yml | Windows: Suspicious File Created In PerfLogs | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP ""C:\\PerfLogs\\.*"" AND fileName REGEXP "".*\.7z|.*\.bat|.*\.bin|.*\.chm|.*\.dll|.*\.exe|.*\.hta|.*\.lnk|.*\.ps1|.*\.psm1|.*\.py|.*\.scr|.*\.sys|.*\.vbe|.*\.vbs|.*\.zip"" |
| Windows: Suspicious Network Connection to IP Lookup Service APIs | Security | Detects external IP address lookups by non-browser processes via services such as ""api.ipify.org"". This could be indicative of potential post compromise internet test activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_susp_external_ip_lookup.yml | Windows: Suspicious Network Connection to IP Lookup Service APIs | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND destName REGEXP "".*api\.2ip\.ua.*|.*api\.ipify\.org.*|.*bot\.whatismyipaddress\.com.*|.*canireachthe\.net.*|.*checkip\.amazonaws\.com.*|.*checkip\.dyndns\.org.*|.*curlmyip\.com.*|.*edns\.ip-api\.com.*|.*eth0\.me.*|.*freegeoip\.app.*|.*geoipy\.com.*|.*getip\.pro.*|.*icanhazip\.com.*|.*ident\.me.*|.*ifconfig\.io.*|.*ifconfig\.me.*|.*ip-api\.com.*|.*ip\.anysrc\.net.*|.*ip\.tyk\.nu.*|.*ipaddressworld\.com.*|.*ipecho\.net.*|.*ipinfo\.io.*|.*ipof\.in.*|.*ipv4\.icanhazip\.com.*|.*ipv4bot\.whatismyipaddress\.com.*|.*ipwho\.is.*|.*l2\.io.*|.*myexternalip\.com.*|.*wgetip\.com.*|.*whatismyip\.akamai\.com.*|.*wtfismyip\.com.*"" AND ((procName NOT REGEXP "".*\\brave\.exe"") AND (procName NOT IN (""C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"",""C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"")) AND (procName NOT IN (""C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"",""C:\\Program Files\\Mozilla Firefox\\firefox.exe"")) AND (procName NOT IN (""C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe"",""C:\\Program Files\\Internet Explorer\\iexplore.exe"")) AND (procName NOT REGEXP "".*\\maxthon\.exe"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeWebView\\Application\\.*"" AND procName NOT REGEXP "".*\\WindowsApps\\MicrosoftEdge\.exe"" AND procName NOT IN (""C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe"",""C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"")) AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeCore\\.*|C:\\Program Files\\Microsoft\\EdgeCore\\.*"" OR procName NOT REGEXP "".*\\msedge\.exe|.*\\msedgewebview2\.exe"") AND (procName NOT REGEXP "".*\\opera\.exe"") AND (procName NOT REGEXP "".*\\safari\.exe"") AND (procName NOT REGEXP "".*\\seamonkey\.exe"") AND (procName NOT REGEXP "".*\\vivaldi\.exe"") AND (procName NOT REGEXP "".*\\whale\.exe"")) |
| Windows: Suspicious Non-Browser Network Communication With Google API | Security | Detects a non-browser process interacting with the Google API which could indicate the use of a covert C2 such as Google Sheet C2 (GC2-sheet). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_google_api_non_browser_access.yml | Windows: Suspicious Non-Browser Network Communication With Google API | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND destName REGEXP "".*drive\.googleapis\.com.*|.*oauth2\.googleapis\.com.*|.*sheets\.googleapis\.com.*|.*www\.googleapis\.com.*"" AND ((procName NOT REGEXP "".*\\brave\.exe"") AND (procName NOT IN (""C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"",""C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"")) AND (procName NOT REGEXP ""C:\\Program Files\\Google\\Drive File Stream\.*\\GoogleDriveFS\.exe.*|C:\\Program Files\\Google\\Drive File Stream\\.*"") AND (procName NOT IN (""C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"",""C:\\Program Files\\Mozilla Firefox\\firefox.exe"")) AND (procName NOT IN (""C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe"",""C:\\Program Files\\Internet Explorer\\iexplore.exe"")) AND (procName NOT REGEXP "".*\\maxthon\.exe"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeWebView\\Application\\.*"" AND procName NOT REGEXP "".*\\WindowsApps\\MicrosoftEdge\.exe"" AND procName NOT IN (""C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe"",""C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"")) AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeCore\\.*|C:\\Program Files\\Microsoft\\EdgeCore\\.*"" OR procName NOT REGEXP "".*\\msedge\.exe|.*\\msedgewebview2\.exe"") AND (procName NOT REGEXP "".*\\opera\.exe"") AND (procName NOT REGEXP "".*\\safari\.exe"") AND (procName NOT REGEXP "".*\\seamonkey\.exe"") AND (procName NOT REGEXP "".*\\vivaldi\.exe"") AND (procName NOT REGEXP "".*\\whale\.exe"") AND (procName NOT REGEXP "".*\\GoogleUpdate\.exe"") AND (procName NOT REGEXP "".*\\outlook\.exe"") AND (procName NOT REGEXP "".*\\teams\.exe"")) |
| Windows: Suspicious PowerShell Invocations - Specific - ProcessCreation | Security | Detects suspicious PowerShell invocation command parameters. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_invocation_specific.yml | Windows: Suspicious PowerShell Invocations - Specific - ProcessCreation | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*-nop.*"" AND command REGEXP "".* -w .*"" AND command REGEXP "".*hidden.*"" AND command REGEXP "".* -c .*"" AND command REGEXP "".*\[Convert\]::FromBase64String.*"") OR (command REGEXP "".* -w .*"" AND command REGEXP "".*hidden.*"" AND command REGEXP "".*-noni.*"" AND command REGEXP "".*-nop.*"" AND command REGEXP "".* -c .*"" AND command REGEXP "".*iex.*"" AND command REGEXP "".*New-Object.*"") OR (command REGEXP "".* -w .*"" AND command REGEXP "".*hidden.*"" AND command REGEXP "".*-ep.*"" AND command REGEXP "".*bypass.*"" AND command REGEXP "".*-Enc.*"") OR (command REGEXP "".*powershell.*"" AND command REGEXP "".*reg.*"" AND command REGEXP "".*add.*"" AND command REGEXP "".*\\software\\.*"") OR (command REGEXP "".*bypass.*"" AND command REGEXP "".*-noprofile.*"" AND command REGEXP "".*-windowstyle.*"" AND command REGEXP "".*hidden.*"" AND command REGEXP "".*new-object.*"" AND command REGEXP "".*system\.net\.webclient.*"" AND command REGEXP "".*\.download.*"") OR (command REGEXP "".*iex.*"" AND command REGEXP "".*New-Object.*"" AND command REGEXP "".*Net\.WebClient.*"" AND command REGEXP "".*\.Download.*"")) AND ((command NOT REGEXP "".*Write-ChocolateyWarning.*|.*\(New-Object System\.Net\.WebClient\)\.DownloadString\('https://community\.chocolatey\.org/install\.ps1.*"")) |
| Windows: Suspicious Obfuscated PowerShell Code | Security | Detects suspicious UTF16 and base64 encoded and often obfuscated PowerShell code often used in command lines. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_encoded_obfusc.yml | Windows: Suspicious Obfuscated PowerShell Code | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*AALQBiAHgAbwByACAAMAB4A.*|.*AC4ASQBuAHYAbwBrAGUAKAApACAAfAAg.*|.*AHsAMAB9AHsAMwB9ACIAIAAtAGYAI.*|.*AHsAMAB9AHsAMwB9ACcAIAAtAGYAI.*|.*AHsAMQB9AHsAMAB9ACIAIAAtAGYAI.*|.*AHsAMQB9AHsAMAB9ACcAIAAtAGYAI.*|.*AHsAMgB9AHsAMAB9ACIAIAAtAGYAI.*|.*AHsAMgB9AHsAMAB9ACcAIAAtAGYAI.*|.*ALgBJAG4AdgBvAGsAZQAoACkAIAB8AC.*|.*AewAwAH0AewAzAH0AIgAgAC0AZgAg.*|.*AewAwAH0AewAzAH0AJwAgAC0AZgAg.*|.*AewAxAH0AewAwAH0AIgAgAC0AZgAg.*|.*AewAxAH0AewAwAH0AJwAgAC0AZgAg.*|.*AewAyAH0AewAwAH0AIgAgAC0AZgAg.*|.*AewAyAH0AewAwAH0AJwAgAC0AZgAg.*|.*AuAEkAbgB2AG8AawBlACgAKQAgAHwAI.*|.*B7ADAAfQB7ADMAfQAiACAALQBmAC.*|.*B7ADAAfQB7ADMAfQAnACAALQBmAC.*|.*B7ADEAfQB7ADAAfQAiACAALQBmAC.*|.*B7ADEAfQB7ADAAfQAnACAALQBmAC.*|.*B7ADIAfQB7ADAAfQAiACAALQBmAC.*|.*B7ADIAfQB7ADAAfQAnACAALQBmAC.*|.*IAAtAGIAeABvAHIAIAAwAHgA.*|.*gAC0AYgB4AG8AcgAgADAAeA.*"" |
| Windows: Suspicious Kernel Dump Using Dtrace | Security | Detects suspicious way to dump the kernel on Windows systems using dtrace.exe, which is available on Windows systems since Windows 10 19H1. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dtrace_kernel_dump.yml | Windows: Suspicious Kernel Dump Using Dtrace | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\dtrace\.exe"" AND command REGEXP "".*lkd\(0\).*"") OR (command REGEXP "".*syscall:::return.*"" AND command REGEXP "".*lkd\(.*"")) |
| Windows: Suspicious Remote Logon with Explicit Credentials | Security | Detects suspicious processes logging on with explicit credentials. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_logon_explicit_credentials.yml | Windows: Suspicious Remote Logon with Explicit Credentials | (eventType=""Win-Security-4648"" AND procName REGEXP "".*\\cmd\.exe|.*\\net1\.exe|.*\\net\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\reg\.exe|.*\\winrs\.exe|.*\\wmic\.exe"") AND ((targetName!=""localhost"") AND (user NOT REGEXP "".*\$"" OR user NOT REGEXP "".*\$"")) |
| Windows: Suspicious RASdial Activity | Security | Detects suspicious process related to rasdial.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rasdial_execution.yml | Windows: Suspicious RASdial Activity | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*rasdial\.exe"" |
| Windows: Suspicious X509Enrollment - Process Creation | Security | Detect use of X509Enrollment. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_x509enrollment.yml | Windows: Suspicious X509Enrollment - Process Creation | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*884e2002-217d-11da-b2a4-000e7bbb2b09.*|.*X509Enrollment\.CBinaryConverter.*"" |
| Windows: SyncAppvPublishingServer VBS Execute Arbitrary PowerShell Code | Security | Executes arbitrary PowerShell code using SyncAppvPublishingServer.vbs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_syncappvpublishingserver_vbs_execute_psh.yml | Windows: SyncAppvPublishingServer VBS Execute Arbitrary PowerShell Code | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\SyncAppvPublishingServer\.vbs.*"" AND command REGEXP "".*;.*"" |
| Windows: Suspicious Service Binary Directory | Security | Detects a service binary running in a suspicious directory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_service_dir.yml | Windows: Suspicious Service Binary Directory | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*C:\\Perflogs\\.*|.*\\Users\\All Users\\.*|.*\\Users\\Contacts\\.*|.*\\Users\\Default\\.*|.*\\Users\\Public\\.*|.*\\Users\\Searches\\.*|.*\\Windows\\Fonts\\.*|.*\\Windows\\IME\\.*|.*\\Windows\\addins\\.*|.*\\\$Recycle\.bin.*|.*\\config\\systemprofile\\.*"" AND parentProcName REGEXP "".*\\services\.exe|.*\\svchost\.exe"" |
| Windows: Suspicious SYSTEM User Process Creation | Security | Detects a suspicious process creation as SYSTEM user (suspicious program or command line parameter). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_system_user_anomaly.yml | Windows: Suspicious SYSTEM User Process Creation | eventType=""Win-Sysmon-1-Create-Process"" AND ((integrityLevel=""System"" AND user REGEXP "".*AUTHORI.*|.*AUTORI.*"") AND (procName REGEXP "".*\\calc\.exe|.*\\cscript\.exe|.*\\forfiles\.exe|.*\\hh\.exe|.*\\mshta\.exe|.*\\ping\.exe|.*\\wscript\.exe"" OR command REGEXP "".* -NoP .*|.* -W Hidden .*|.* -decode .*|.* -e.* IAB.*|.* -e.* JAB.*|.* -e.* PAA.*|.* -e.* SQBFAFgA.*|.* -e.* SUVYI.*|.* -e.* aQBlAHgA.*|.* -e.* aWV4I.*|.* -ma .*|.* -urlcache .*|.* /decode .*|.* /ticket:.*|.* /urlcache .*|.* p::d .*|.*;iex\(.*|.*Microsoft\\Windows\\CurrentVersion\\Run.*|.*MiniDump.*|.*\.downloadfile\(.*|.*\.downloadstring\(.*|.*dpapi::.*|.*event::clear.*|.*event::drop.*|.*id::modify.*|.*kerberos::.*|.*lsadump::.*|.*misc::.*|.*net user .*|.*privilege::.*|.*reg SAVE HKLM.*|.*rpc::.*|.*sekurlsa::.*|.*sid::.*|.*token::.*|.*vault::cred.*|.*vault::list.*|.*vssadmin delete shadows.*"")) AND ((command!=""ping 127.0.0.1 -n 5"") AND (procName NOT REGEXP "".*\\PING\.EXE"" OR parentCommand NOT REGEXP "".*\\DismFoDInstall\.cmd.*"") AND (parentProcName NOT REGEXP ""C:\\Packages\\Plugins\\Microsoft\.GuestConfiguration\.ConfigurationforWindows\\.*"") AND (parentProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Java\\.*"" OR parentProcName NOT REGEXP "".*\\bin\\javaws\.exe"" OR procName NOT REGEXP ""C:\\Program Files \(x86\)\\Java\\.*"" OR procName NOT REGEXP "".*\\bin\\jp2launcher\.exe"" OR command NOT REGEXP "".* -ma .*"")) |
| Windows: Suspicious WERMGR Process Patterns | Security | Detects suspicious Windows Error Reporting manager (wermgr.exe) process patterns - suspicious parents / children, execution folders, command lines etc. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wermgr_susp_child_process.yml | Windows: Suspicious WERMGR Process Patterns | eventType=""Win-Sysmon-1-Create-Process"" AND ((parentProcName REGEXP "".*\\wermgr\.exe"" AND procName REGEXP "".*\\cmd\.exe|.*\\ipconfig\.exe|.*\\net1\.exe|.*\\net\.exe|.*\\netstat\.exe|.*\\nslookup\.exe|.*\\powershell\.exe|.*\\systeminfo\.exe|.*\\whoami\.exe"") OR (procName REGEXP "".*\\wermgr\.exe"" AND (procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\WinSxS\\.*""))) |
| Windows: Suspicious Word Cab File Write CVE-2021-40444 | Security | Detects file creation patterns noticeable during the exploitation of CVE-2021-40444. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_winword_cve_2021_40444.yml | Windows: Suspicious Word Cab File Write CVE-2021-40444 | eventType=""Win-Sysmon-11-FileCreate"" AND (procName REGEXP "".*\\winword\.exe"" AND ((fileName REGEXP "".*\.cab"" AND fileName REGEXP "".*\\Windows\\INetCache.*"") OR (fileName REGEXP "".*\\AppData\\Local\\Temp\\.*"" AND fileName REGEXP "".*\.inf.*""))) AND (fileName NOT REGEXP ""C:\\Users\\.*"" OR fileName NOT REGEXP "".*AppData\\Local\\Temp.*"" OR fileName NOT REGEXP "".*\\Content\.inf"") |
| Windows: Suspicious Screensaver Binary File Creation | Security | Adversaries may establish persistence by executing malicious content triggered by user inactivity. Screensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_creation_scr_binary_file.yml | Windows: Suspicious Screensaver Binary File Creation | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\.scr"" AND ((procName NOT REGEXP "".*\\Bin\\ccSvcHst\.exe|.*\\Kindle\.exe"") AND (procName NOT REGEXP "".*\\TiWorker\.exe"" OR fileName NOT REGEXP "".*\\uwfservicingscr\.scr"")) |
| Windows: Suspicious SysAidServer Child | Security | Detects suspicious child processes of SysAidServer (as seen in MERCURY threat actor intrusions). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_java_sysaidserver_susp_child_process.yml | Windows: Suspicious SysAidServer Child | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\java\.exe|.*\\javaw\.exe"" AND parentCommand REGEXP "".*SysAidServer.*"" |
| Windows: Suspicious Service Path Modification | Security | Detects service path modification via the ""sc"" binary to a suspicious command or path. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_service_path_modification.yml | Windows: Suspicious Service Path Modification | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\sc\.exe"" AND command REGEXP "".*config.*"" AND command REGEXP "".*binPath.*"" AND command REGEXP "".*C:\\Users\\Public.*|.*C:\\Windows\\TEMP\\.*|.*\\AppData\\Local\\Temp.*|.*\\Desktop\\.*|.*\\Downloads\\.*|.*\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\.*|.*cmd .*|.*cmd /c.*|.*cmd /k.*|.*cmd /r.*|.*cmd\.exe /c.*|.*cmd\.exe /k.*|.*cmd\.exe /r.*|.*cscript.*|.*dllhost.*|.*mshta.*|.*powershell.*|.*rundll32.*|.*svchost.*|.*wscript.*"" |
| Windows: Suspicious Service Installation Script | Security | Detects suspicious service installation scripts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_susp_service_installation_script.yml | Windows: Suspicious Service Installation Script | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".* /c .*|.* /k .*|.* /r .*"" AND serviceFileName REGEXP "".*cscript.*|.*mshta.*|.*powershell.*|.*pwsh.*|.*regsvr32.*|.*rundll32.*|.*wscript.*"" |
| Windows: Suspicious Windows Update Agent Empty Cmdline | Security | Detects suspicious Windows Update Agent activity in which a wuauclt.exe process command line doesn't contain any command line flags. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wuauclt_no_cli_flags_execution.yml | Windows: Suspicious Windows Update Agent Empty Cmdline | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\Wuauclt\.exe"" OR srcFileName=""Wuauclt.exe"") AND command REGEXP "".*\\Wuauclt\.exe"" |
| Windows: Sysinternals Tools AppX Versions Execution | Security | Detects execution of Sysinternals tools via an AppX package. Attackers could install the Sysinternals Suite to get access to tools such as psexec and procdump to avoid detection based on System paths. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/appmodel_runtime/win_appmodel_runtime_sysinternals_tools_appx_execution.yml | Windows: Sysinternals Tools AppX Versions Execution | eventType REGEXP ""Win-.*-201[^\d]*"" AND procName IN (""ADExplorer.exe"",""livekd.exe"",""procdump.exe"",""psexec.exe"",""psloglist.exe"") |
| Windows: Suspicious Reg Add Open Command | Security | Threat actors performed dumping of SAM, SECURITY and SYSTEM registry hives using DelegateExecute key. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_open_command.yml | Windows: Suspicious Reg Add Open Command | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*reg.*"" AND ((command REGEXP "".*add.*"" AND command REGEXP "".*hkcu\\software\\classes\\ms-settings\\shell\\open\\command.*"" AND command REGEXP "".*/ve .*"" AND command REGEXP "".*/d.*"") OR (command REGEXP "".*add.*"" AND command REGEXP "".*hkcu\\software\\classes\\ms-settings\\shell\\open\\command.*"" AND command REGEXP "".*/v.*"" AND command REGEXP "".*DelegateExecute.*"") OR (command REGEXP "".*delete.*"" AND command REGEXP "".*hkcu\\software\\classes\\ms-settings.*"")) |
| Windows: Suspicious Windows ANONYMOUS LOGON Local Account Created | Security | Detects the creation of suspicious accounts similar to ANONYMOUS LOGON, such as using additional spaces. Created as an covering detection for exclusion of Logon Type 3 from ANONYMOUS LOGON accounts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_local_anon_logon_created.yml | Windows: Suspicious Windows ANONYMOUS LOGON Local Account Created | eventType=""Win-Security-4720"" AND oldTargetUser REGEXP "".*ANONYMOUS.*"" AND oldTargetUser REGEXP "".*LOGON.*"" |
| Windows: Suspicious Use of CSharp Interactive Console | Security | Detects the execution of CSharp interactive console by PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_csi_use_of_csharp_console.yml | Windows: Suspicious Use of CSharp Interactive Console | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\csi\.exe"" AND parentProcName REGEXP "".*\\powershell\.exe|.*\\powershell_ise\.exe|.*\\pwsh\.exe"" AND srcFileName=""csi.exe"" |
| Windows: Suspicious Service Installation | Security | Detects suspicious service installation commands. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_susp_service_installation.yml | Windows: Suspicious Service Installation | ((eventType=""Win-System-Service-Control-Manager-7045"") AND (serviceFileName REGEXP "".* -nop .*|.* -sta .*|.* -w hidden .*|.*C:\\Temp\\.*|.*\.downloadfile\(.*|.*\.downloadstring\(.*|.*\\ADMIN\$\\.*|.*\\Perflogs\\.*|.*\\Users\\Public\\.*|.*\\Windows\\Temp\\.*|.*\\\\\.\\pipe.*"" OR (serviceFileName REGEXP "".* -e.*"" AND serviceFileName REGEXP "".* IAB.*|.* JAB.*|.* PAA.*|.* SQBFAFgA.*|.* SUVYI.*|.* aQBlAHgA.*|.* aWV4I.*""))) AND ((serviceFileName NOT REGEXP ""C:\\WINDOWS\\TEMP\\thor10-remote\\thor64\.exe.*"") AND (serviceFileName NOT REGEXP ""C:\\ProgramData\\Microsoft\\Windows Defender\\Definition Updates\\.*"")) |
| Windows: Suspicious Shells Spawn by Java Utility Keytool | Security | Detects suspicious shell spawn from Java utility keytool process (e.g. adselfservice plus exploitation). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_java_keytool_susp_child_process.yml | Windows: Suspicious Shells Spawn by Java Utility Keytool | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\keytool\.exe"" AND procName REGEXP "".*\\AppVLP\.exe|.*\\bash\.exe|.*\\bitsadmin\.exe|.*\\certutil\.exe|.*\\cmd\.exe|.*\\cscript\.exe|.*\\forfiles\.exe|.*\\hh\.exe|.*\\mftrace\.exe|.*\\mshta\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\query\.exe|.*\\reg\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\schtasks\.exe|.*\\scrcons\.exe|.*\\scriptrunner\.exe|.*\\sh\.exe|.*\\systeminfo\.exe|.*\\whoami\.exe|.*\\wmic\.exe|.*\\wscript\.exe"" |
| Windows: Suspicious Rundll32 Invoking Inline VBScript | Security | Detects suspicious process related to rundll32 based on command line that invokes inline VBScript as seen being used by UNC2452. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_inline_vbs.yml | Windows: Suspicious Rundll32 Invoking Inline VBScript | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*rundll32\.exe.*"" AND command REGEXP "".*Execute.*"" AND command REGEXP "".*RegRead.*"" AND command REGEXP "".*window\.close.*"" |
| Windows: Sysmon Blocked Executable | Security | Triggers on any Sysmon file block executable event. Which should indicates a violation of the block policy set. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/sysmon/sysmon_file_block_exe.yml | Windows: Sysmon Blocked Executable | eventType = ""Win-Sysmon-27-FileBlockExecutable"" |
| Windows: Suspicious WindowsTerminal Child Processes | Security | Detects suspicious children spawned via the Windows Terminal application which could be a sign of persistence via WindowsTerminal (see references section). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_windows_terminal_susp_children.yml | Windows: Suspicious WindowsTerminal Child Processes | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\WindowsTerminal\.exe|.*\\wt\.exe"" AND (procName REGEXP "".*\\certutil\.exe|.*\\csc\.exe|.*\\cscript\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wscript\.exe"" OR procName REGEXP "".*C:\\Users\\Public\\.*|.*\\AppData\\Local\\Temp\\.*|.*\\Desktop\\.*|.*\\Downloads\\.*|.*\\Windows\\TEMP\\.*"" OR command REGEXP "".* /c .*|.* /k .*|.* /r .*|.* icm.*|.* iex .*|.*DownloadString\(.*|.*Import-Module .*|.*Invoke-.*|.*ipmo .*"")) AND ((command NOT REGEXP "".*Import-Module.*"" OR command NOT REGEXP "".*Microsoft\.VisualStudio\.DevShell\.dll.*"" OR command NOT REGEXP "".*Enter-VsDevShell.*"") AND (command NOT REGEXP "".*\\AppData\\Local\\Packages\\Microsoft\.WindowsTerminal_.*"" OR command NOT REGEXP "".*\\LocalState\\settings\.json.*"") AND (command NOT REGEXP "".*C:\\Program Files\\Microsoft Visual Studio\\.*"" OR command NOT REGEXP "".*\\Common7\\Tools\\VsDevCmd\.bat.*"")) |
| Windows: Suspicious RunAs-Like Flag Combination | Security | Detects suspicious command line flags that let the user set a target user and command as e.g. seen in PsExec-like tools. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_privilege_escalation_cli_patterns.yml | Windows: Suspicious RunAs-Like Flag Combination | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* --system .*|.* --user system .*|.* -u 'NT.*|.* -u NT.*|.* -u \""NT.*|.* -u administrator .*|.* -u system .*"" AND command REGEXP "".* --command cmd.*|.* --command powershell.*|.* -c \""cmd.*|.* -c \""powershell.*|.* -c cmd.*|.* -c cscript.*|.* -c powershell.*|.* -c whoami.*|.* -c wscript.*"" |
| Windows: Suspicious Scheduled Task Write to System32 Tasks | Security | Detects the creation of tasks from processes executed from suspicious locations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_task_write.yml | Windows: Suspicious Scheduled Task Write to System32 Tasks | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Windows\\System32\\Tasks.*"" AND procName REGEXP "".*C:\\PerfLogs.*|.*\\AppData\\.*|.*\\Windows\\System32\\config\\systemprofile.*"" |
| Windows: Suspicious Registration via cscript.exe | Security | Detects when the registration of a VSS/VDS Provider as a COM+ application. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regsvr32_registration_via_cscript.yml | Windows: Suspicious Registration via cscript.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\cscript\.exe"" AND command REGEXP "".*-register.*"" AND command REGEXP "".*\\Windows Kits\\10\\bin\\10\.0\.17763\.0\\x64.*|.*\\Windows Kits\\10\\bin\\10\.0\.19041\.0\\x64.*|.*\\Windows Kits\\10\\bin\\10\.0\.22000\.0\\x64.*"" |
| Windows: Suspicious Remote AppX Package Locations | Security | Detects an appx package added the pipeline of the ""to be processed"" packages which is downloaded from a suspicious domain. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_susp_domains.yml | Windows: Suspicious Remote AppX Package Locations | eventType =""Win-AppXDeployment-Server-854"" AND procPath REGEXP "".*\.ghostbin\.co/.*|.*\.hastebin\.com.*|.*\.paste\.ee.*|.*anonfiles\.com.*|.*cdn\.discordapp\.com/attachments/.*|.*ddns\.net.*|.*gist\.githubusercontent\.com.*|.*mediafire\.com.*|.*mega\.nz.*|.*paste\.ee.*|.*pastebin\.com.*|.*pastebin\.pl.*|.*pastetext\.net.*|.*privatlab\.com.*|.*privatlab\.net.*|.*raw\.githubusercontent\.com.*|.*send\.exploit\.in.*|.*sendspace\.com.*|.*storage\.googleapis\.com.*|.*transfer\.sh.*|.*ufile\.io.*"" |
| Windows: Sysmon Crash | Security | Detects application popup reporting a failure of the Sysmon service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/application_popup/win_system_application_sysmon_crash.yml | Windows: Sysmon Crash | eventType=""Win-System-Application-Popup-26"" AND description=""sysmon64.exe - Application Error"" |
| Windows: Suspicious ScreenSave Change by Reg.exe | Security | Adversaries may establish persistence by executing malicious content triggered by user inactivity. Screensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_screensaver.yml | Windows: Suspicious ScreenSave Change by Reg.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\reg\.exe"" AND command REGEXP "".*HKCU\\Control Panel\\Desktop.*|.*HKEY_CURRENT_USER\\Control Panel\\Desktop.*"" AND command REGEXP "".*/t REG_SZ.*"" AND command REGEXP "".*/f.*"" AND ((command REGEXP "".*/v ScreenSaveActive.*"" AND command REGEXP "".*/d 1.*"") OR (command REGEXP "".*/v ScreenSaveTimeout.*"" AND command REGEXP "".*/d .*"") OR (command REGEXP "".*/v ScreenSaverIsSecure.*"" AND command REGEXP "".*/d 0.*"") OR (command REGEXP "".*/v SCRNSAVE\.EXE.*"" AND command REGEXP "".*/d .*"" AND command REGEXP "".*\.scr.*"")) |
| Windows: Suspicious Userinit Child Process | Security | Detects a suspicious child process of userinit. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_userinit_child.yml | Windows: Suspicious Userinit Child Process | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\userinit\.exe"" AND ((command NOT REGEXP "".*\\netlogon\\.*"") AND (procName NOT REGEXP "".*\\explorer\.exe"" AND srcFileName!=""explorer.exe"")) |
| Windows: Suspicious Script Execution From Temp Folder | Security | Detects a suspicious script executions from temporary folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_script_exec_from_temp.yml | Windows: Suspicious Script Execution From Temp Folder | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cscript\.exe|.*\\mshta\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\wscript\.exe"" AND command REGEXP "".*%LocalAppData%\\Temp.*|.*%TEMP%.*|.*%TMP%.*|.*\\AppData\\Local\\Temp.*|.*\\AppData\\Roaming\\Temp.*|.*\\Temporary Internet.*|.*\\Windows\\Temp.*"") AND (command NOT REGEXP "".* >.*|.*-WindowStyle hidden -Verb runAs.*|.*ConvertTo-Json.*|.*Out-File.*|.*\\Windows\\system32\\config\\systemprofile\\AppData\\Local\\Temp\\Amazon\\EC2-Windows\\.*"") |
| Windows: Suspicious Vsls-Agent Command With AgentExtensionPath Load | Security | Detects Microsoft Visual Studio vsls-agent.exe lolbin execution with a suspicious library load using the --agentExtensionPath parameter. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_vslsagent_agentextensionpath_load.yml | Windows: Suspicious Vsls-Agent Command With AgentExtensionPath Load | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\vsls-agent\.exe"" AND command REGEXP "".*--agentExtensionPath.*"") AND (command NOT REGEXP "".*Microsoft\.VisualStudio\.LiveShare\.Agent\..*"") |
| Windows: Suspicious Startup Folder Persistence | Security | Detects when a file with a suspicious extension is created in the startup folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_startup_folder_persistence.yml | Windows: Suspicious Startup Folder Persistence | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Windows\\Start Menu\\Programs\\Startup\\.*"" AND fileName REGEXP "".*\.bat|.*\.cmd|.*\.dll|.*\.hta|.*\.jar|.*\.msi|.*\.ps1|.*\.scr|.*\.vbe|.*\.vbs"" |
| Windows: Suspicious Serv-U Process Pattern | Security | Detects a suspicious process pattern which could be a sign of an exploited Serv-U service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_servu_susp_child_process.yml | Windows: Suspicious Serv-U Process Pattern | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\Serv-U\.exe"" AND procName REGEXP "".*\\bash\.exe|.*\\cmd\.exe|.*\\cscript\.exe|.*\\forfiles\.exe|.*\\mshta\.exe|.*\\msiexec\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\schtasks\.exe|.*\\scriptrunner\.exe|.*\\sh\.exe|.*\\wmic\.exe|.*\\wscript\.exe"" |
| Windows: Suspicious Workstation Locking via Rundll32 | Security | Detects a suspicious call to the user32.dll function that locks the user workstation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_user32_dll.yml | Windows: Suspicious Workstation Locking via Rundll32 | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"") AND parentProcName REGEXP "".*\\cmd\.exe"" AND command REGEXP "".*user32\.dll,.*"" AND command REGEXP "".*LockWorkStation.*"" |
| Windows: Suspicious Run Key from Download | Security | Detects the suspicious RUN keys created by software located in Download or temporary Outlook/Internet Explorer directories. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_susp_download_run_key.yml | Windows: Suspicious Run Key from Download | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND procName REGEXP "".*\\Downloads\\.*|.*\\Local Settings\\Temporary Internet Files\\.*|.*\\Temporary Internet Files\\Content\.Outlook\\.*"" AND regKeyPath REGEXP "".*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\.*"" |
| Windows: Suspicious Usage Of ShellExec-RunDLL | Security | Detects suspicious usage of the ShellExec_RunDLL function to launch other commands as seen in the the raspberry-robin attack. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_susp_shellexec_execution.yml | Windows: Suspicious Usage Of ShellExec-RunDLL | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*ShellExec_RunDLL.*"" AND command REGEXP "".*Invoke-.*|.*\\Desktop\\.*|.*\\Temp\\.*|.*\\Users\\Public\\.*|.*comspec.*|.*iex.*|.*msiexec.*|.*odbcconf.*|.*regsvr32.*"" |
| Windows: Suspicious Sigverif Execution | Security | Detects the execution of sigverif binary as a parent process which could indicate it being used as a LOLBIN to proxy execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_sigverif.yml | Windows: Suspicious Sigverif Execution | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\sigverif\.exe"" |
| Windows: Suspicious Shells Spawned by Java | Security | Detects suspicious shell spawned from Java host process (e.g. log4j exploitation). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_java_susp_child_process.yml | Windows: Suspicious Shells Spawned by Java | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\java\.exe"" AND procName REGEXP "".*\\AppVLP\.exe|.*\\bash\.exe|.*\\bitsadmin\.exe|.*\\certutil\.exe|.*\\cscript\.exe|.*\\curl\.exe|.*\\forfiles\.exe|.*\\hh\.exe|.*\\mftrace\.exe|.*\\mshta\.exe|.*\\net1\.exe|.*\\net\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\query\.exe|.*\\reg\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\schtasks\.exe|.*\\scrcons\.exe|.*\\scriptrunner\.exe|.*\\sh\.exe|.*\\systeminfo\.exe|.*\\whoami\.exe|.*\\wmic\.exe|.*\\wscript\.exe"" |
| Windows: SVCHOST Credential Dump | Security | Detects when a process, such as mimikatz, accesses the memory of svchost to dump credentials. Mimikatz is a open source malware program that is commonly used by hackers and security professionals to extract sensitive information, such as passwords and credentials, from a system's memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_svchost_cred_dump.yml | Windows: SVCHOST Credential Dump | eventType=""Win-Sysmon-10-ProcessAccess"" AND (targetProcName REGEXP "".*\\svchost\.exe"" AND accessKeyId=""0x143a"") AND (procName NOT REGEXP "".*\\msiexec\.exe|.*\\services\.exe"") |
| Windows: Sysmon Configuration Change | Security | Detects a Sysmon configuration change, which could be the result of a legitimate reconfiguration or someone trying manipulate the configuration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/sysmon/sysmon_config_modification.yml | Windows: Sysmon Configuration Change | eventType=""Win-Sysmon-16-Config-State-Changed"" |
| Windows: Suspicious Usage of CVE-2021-34484 or CVE 2022-21919 | Security | During exploitation of this vulnerability, two logs (Provider_Name:Microsoft-Windows-User Profiles Service) with EventID 1511 and 1515 (maybe lot of false positives with this event) are created. Moreover, it appears the directory \Users\TEMP is created may be created during the exploitation. Viewed on 2008 Server. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/microsoft_windows_user_profiles_service/win_system_susp_vuln_cve_2022_21919_or_cve_2021_34484.yml | Windows: Suspicious Usage of CVE-2021-34484 or CVE 2022-21919 | eventType=""Win-App-Microsoft-Windows-User-Profiles-Service-1511"" |
| Windows: Suspicious Splwow64 Without Params | Security | Detects suspicious Splwow64.exe process without any command line parameters. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_splwow64_cli_anomaly.yml | Windows: Suspicious Splwow64 Without Params | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\splwow64\.exe"" AND command REGEXP "".*splwow64\.exe"" |
| Windows: Suspicious Windows App Activity | Security | Detects suspicious children of application launched from inside the WindowsApps directory. This could be a sign of a rogue "".appx"" package installation/execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_appx_execution.yml | Windows: Suspicious Windows App Activity | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*C:\\Program Files\\WindowsApps\\.*"" AND (procName REGEXP "".*\\cscript\.exe|.*\\mshta\.exe|.*\\poweshell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wscript\.exe"" OR command REGEXP "".*Base64.*|.*Invoke-.*|.*cmd /c.*"") |
| Windows: Sysinternals PsSuspend Execution | Security | Detects usage of Sysinternals PsSuspend which can be abused to suspend critical processes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_pssuspend_execution.yml | Windows: Sysinternals PsSuspend Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""pssuspend.exe"" OR procName REGEXP "".*\\pssuspend64\.exe|.*\\pssuspend\.exe"") |
| Windows: Suspicious Service DACL Modification Via Set-Service Cmdlet | Security | Detects suspicious DACL modifications via the ""Set-Service"" cmdlet using the ""SecurityDescriptorSddl"" flag (Only available with PowerShell 7) that can be used to hide services or make them unstopable. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_service_dacl_modification_set_service.yml | Windows: Suspicious Service DACL Modification Via Set-Service Cmdlet | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\pwsh\.exe"" OR srcFileName=""pwsh.dll"") AND command REGEXP "".*-SecurityDescriptorSddl .*|.*-sd .*"" AND (command REGEXP "".*Set-Service .*"" AND command REGEXP "".*D;;.*"" AND command REGEXP "".*;;;BA.*|.*;;;IU.*|.*;;;SU.*|.*;;;SY.*|.*;;;WD.*"") |
| Windows: SyncAppvPublishingServer Execute Arbitrary PowerShell Code | Security | Executes arbitrary PowerShell code using SyncAppvPublishingServer.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_syncappvpublishingserver_execute_psh.yml | Windows: SyncAppvPublishingServer Execute Arbitrary PowerShell Code | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\SyncAppvPublishingServer\.exe"" OR srcFileName=""syncappvpublishingserver.exe"") AND command REGEXP "".*\""n; .*"" |
| Windows: UAC Bypass Using Event Viewer RecentViews | Security | Detects the pattern of UAC Bypass using Event Viewer RecentViews. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_eventvwr_recentviews.yml | Windows: UAC Bypass Using Event Viewer RecentViews | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\Event Viewer\\RecentViews.*|.*\\EventV~1\\RecentViews.*"" AND command REGEXP "".*>.*"" |
| Windows: User with Privileges Logon | Security | Detects logon with ""Special groups"" and ""Special Privileges"" can be thought of as Administrator groups or privileges. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_admin_logon.yml | Windows: User with Privileges Logon | eventType IN (""Win-Security-4672"",""Win-Security-4964"") AND (securityId!=""S-1-5-18"") |
| Windows: VMToolsd Suspicious Child Process | Security | Detects suspicious child process creations of VMware Tools process which may indicate persistence setup. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_vmware_vmtoolsd_susp_child_process.yml | Windows: VMToolsd Suspicious Child Process | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\vmtoolsd\.exe"" AND (procName REGEXP "".*\\cmd\.exe|.*\\cscript\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wscript\.exe"" OR srcFileName IN (""Cmd.Exe"",""PowerShell.EXE"",""REGSVR32.EXE"",""RUNDLL32.EXE"",""cscript.exe"",""pwsh.dll"",""wscript.exe""))) AND (command NOT REGEXP "".*\\VMware\\VMware Tools\\poweroff-vm-default\.bat.*|.*\\VMware\\VMware Tools\\poweron-vm-default\.bat.*|.*\\VMware\\VMware Tools\\resume-vm-default\.bat.*|.*\\VMware\\VMware Tools\\suspend-vm-default\.bat.*"") |
| Windows: Use of FSharp Interpreters | Security | The FSharp Interpreters, FsiAnyCpu.exe and FSi.exe, can be used for AWL bypass and is listed in Microsoft recommended block rules. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_fsharp_interpreters.yml | Windows: Use of FSharp Interpreters | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\fsianycpu\.exe"" OR srcFileName=""fsianycpu.exe"" OR procName REGEXP "".*\\fsi\.exe"" OR srcFileName=""fsi.exe"") |
| Windows: Using AppVLP To Circumvent ASR File Path Rule | Security | Application Virtualization Utility is included with Microsoft Office. We are able to abuse ""AppVLP"" to execute shell commands. Normally, this binary is used for Application Virtualization, but we can use it as an abuse binary to circumvent the ASR file path rule folder or to mark a file as a system file. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_appvlp.yml | Windows: Using AppVLP To Circumvent ASR File Path Rule | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\appvlp\.exe"" AND (procName NOT REGEXP "".*\\msoasb\.exe|.*\\rundll32\.exe"") |
| Windows: Verclsid.exe Runs COM Object | Security | Detects when verclsid.exe is used to run COM object via GUID. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_verclsid_runs_com.yml | Windows: Verclsid.exe Runs COM Object | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\verclsid\.exe"" OR srcFileName=""verclsid.exe"") AND (command REGEXP "".*/S.*"" AND command REGEXP "".*/C.*"") |
| Windows: Use of Mftrace.exe | Security | The ""Trace log generation tool for Media Foundation Tools"" (Mftrace.exe) can be used to execute arbitrary binaries. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_mftrace.yml | Windows: Use of Mftrace.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\mftrace\.exe"" OR srcFileName=""mftrace.exe"") AND (command REGEXP "".*\.exe .*"" AND command REGEXP "".*\.exe"")) OR parentProcName REGEXP "".*\\mftrace\.exe"") |
| Windows: The Windows Defender Firewall Service Failed To Load Group Policy | Security | Detects activity when The Windows Defender Firewall service failed to load Group Policy. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/firewall_as/win_firewall_as_failed_load_gpo.yml | Windows: The Windows Defender Firewall Service Failed To Load Group Policy | eventType REGEXP ""Win-.*-2009[^\d]*"" |
| Windows: Visual Studio NodejsTools PressAnyKey Renamed Execution | Security | Detects renamed execution of ""Microsoft.NodejsTools.PressAnyKey.exe"", which can be abused as a LOLBIN to execute arbitrary binaries. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_pressanykey.yml | Windows: Visual Studio NodejsTools PressAnyKey Renamed Execution | eventType=""Win-Sysmon-1-Create-Process"" AND srcFileName=""Microsoft.NodejsTools.PressAnyKey.exe"" AND ((procName NOT REGEXP "".*\\Microsoft\.NodejsTools\.PressAnyKey\.exe"")) |
| Windows: Use of Sysinternals PsService | Security | Detects usage of Sysinternals PsService for service reconnaissance or tamper. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_psservice.yml | Windows: Use of Sysinternals PsService | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""psservice.exe"" OR procName REGEXP "".*\\PsService64\.exe|.*\\PsService\.exe"") |
| Windows: System File Execution Location Anomaly | Security | Detects a Windows program executable started from a suspicious folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_system_exe_anomaly.yml | Windows: System File Execution Location Anomaly | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\LsaIso\.exe|.*\\RuntimeBroker\.exe|.*\\Taskmgr\.exe|.*\\atbroker\.exe|.*\\audiodg\.exe|.*\\bcdedit\.exe|.*\\bitsadmin\.exe|.*\\certreq\.exe|.*\\certutil\.exe|.*\\cmstp\.exe|.*\\conhost\.exe|.*\\consent\.exe|.*\\cscript\.exe|.*\\csrss\.exe|.*\\dashost\.exe|.*\\defrag\.exe|.*\\dfrgui\.exe|.*\\dism\.exe|.*\\dllhost\.exe|.*\\dllhst3g\.exe|.*\\dwm\.exe|.*\\eventvwr\.exe|.*\\explorer\.exe|.*\\logonui\.exe|.*\\lsass\.exe|.*\\lsm\.exe|.*\\msiexec\.exe|.*\\ntoskrnl\.exe|.*\\powershell\.exe|.*\\powershell_ise\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\runonce\.exe|.*\\schtasks\.exe|.*\\services\.exe|.*\\sihost\.exe|.*\\smartscreen\.exe|.*\\smss\.exe|.*\\spoolsv\.exe|.*\\svchost\.exe|.*\\taskhost\.exe|.*\\userinit\.exe|.*\\wininit\.exe|.*\\winlogon\.exe|.*\\winver\.exe|.*\\wlanext\.exe|.*\\wscript\.exe|.*\\wsl\.exe|.*\\wsmprovhost\.exe"" AND ((procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\WinSxS\\.*"" AND procName NOT REGEXP "".*\\SystemRoot\\System32\\.*"" AND procName NOT IN (""C:\\Program Files\\PowerShell\\7\\pwsh.exe"",""C:\\Windows\\explorer.exe"")) AND (procName NOT REGEXP ""C:\\Program Files\\WindowsApps\\MicrosoftCorporationII\.WindowsSubsystemForLinux.*"" OR procName NOT REGEXP "".*\\wsl\.exe"")) |
| Windows: Vulnerable Lenovo Driver Load | Security | Detects the load of the vulnerable Lenovo driver as reported in CVE-2022-3699 which can be used to escalate privileges. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_vuln_lenovo_driver.yml | Windows: Vulnerable Lenovo Driver Load | eventType=""Win-Sysmon-6-Driver-Loaded"" AND (hashCode REGEXP "".*MD5=B941C8364308990EE4CC6EADF7214E0F.*|.*SHA1=B89A8EEF5AEAE806AF5BA212A8068845CAFDAB6F.*|.*SHA256=F05B1EE9E2F6AB704B8919D5071BECBCE6F9D0F9D0BA32A460C41D5272134ABE.*"" OR hashSHA256=""f05b1ee9e2f6ab704b8919d5071becbce6f9d0f9d0ba32a460c41d5272134abe"" OR hashSHA1=""b89a8eef5aeae806af5ba212a8068845cafdab6f"" OR hashMD5=""b941c8364308990ee4cc6eadf7214e0f"") |
| Windows: Use of VSIISExeLauncher.exe | Security | The ""VSIISExeLauncher.exe"" binary part of the Visual Studio/VS Code can be used to execute arbitrary binaries. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_vsiisexelauncher.yml | Windows: Use of VSIISExeLauncher.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\VSIISExeLauncher\.exe"" OR srcFileName=""VSIISExeLauncher.exe"") AND command REGEXP "".* -a .*|.* -p .*"" |
| Windows: Taskmgr as LOCAL-SYSTEM | Security | Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_taskmgr_localsystem.yml | Windows: Taskmgr as LOCAL-SYSTEM | eventType=""Win-Sysmon-1-Create-Process"" AND user REGEXP "".*AUTHORI.*|.*AUTORI.*"" AND procName REGEXP "".*\\taskmgr\.exe"" |
| Windows: Vulnerable Netlogon Secure Channel Connection Allowed | Security | Detects that a vulnerable Netlogon secure channel connection was allowed, which could be an indicator of CVE-2020-1472. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/netlogon/win_system_vul_cve_2020_1472.yml | Windows: Vulnerable Netlogon Secure Channel Connection Allowed | eventType=""Win-System-NetLogon-5829"" |
| Windows: Turla PNG Dropper Service | Security | This method detects malicious services mentioned in Turla PNG dropper report by NCC Group in November 2018. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_apt_turla_service_png.yml | Windows: Turla PNG Dropper Service | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceName=""WerFaultSvc"" |
| Windows: UtilityFunctions.ps1 Proxy Dll | Security | Detects the use of a Microsoft signed script executing a managed DLL with PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_utilityfunctions.yml | Windows: UtilityFunctions.ps1 Proxy Dll | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*RegSnapin .*|.*UtilityFunctions\.ps1.*"" |
| Windows: Uncommon One Time Only Scheduled Task At 00:00 | Security | Detects scheduled task creation events that include suspicious actions, and is run once at 00:00. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_one_time_only_midnight_task.yml | Windows: Uncommon One Time Only Scheduled Task At 00:00 | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\schtasks\.exe.*"" OR srcFileName=""schtasks.exe"") AND command REGEXP "".*\\AppData\\.*|.*cscript.*|.*powershell.*|.*regsvr32\.exe.*|.*vbscript.*|.*wmic .*|.*wmic\.exe.*|.*wscript.*"" AND (command REGEXP "".*once.*"" AND command REGEXP "".*00:00.*"") |
| Windows: Use of VisualUiaVerifyNative.exe | Security | VisualUiaVerifyNative.exe is a Windows SDK that can be used for AWL bypass and is listed in Microsoft's recommended block rules. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_visualuiaverifynative.yml | Windows: Use of VisualUiaVerifyNative.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\VisualUiaVerifyNative\.exe"" OR srcFileName=""VisualUiaVerifyNative.exe"") |
| Windows: Unusual Parent Process For Cmd.EXE | Security | Detects suspicious parent process for cmd.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_unusual_parent.yml | Windows: Unusual Parent Process For Cmd.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\cmd\.exe"" AND parentProcName REGEXP "".*\\FlashPlayerUpdateService\.exe|.*\\GoogleUpdate\.exe|.*\\LogonUI\.exe|.*\\SIHClient\.exe|.*\\SearchIndexer\.exe|.*\\SearchProtocolHost\.exe|.*\\WUDFHost\.exe|.*\\WerFault\.exe|.*\\csrss\.exe|.*\\ctfmon\.exe|.*\\dllhost\.exe|.*\\epad\.exe|.*\\jucheck\.exe|.*\\jusched\.exe|.*\\lsass\.exe|.*\\regsvr32\.exe|.*\\sihost\.exe|.*\\slui\.exe|.*\\spoolsv\.exe|.*\\sppsvc\.exe|.*\\taskhostw\.exe|.*\\unsecapp\.exe|.*\\wergmgr\.exe|.*\\wlanext\.exe"" |
| Windows: UAC Bypass Using EventVwr | Security | Detects the pattern of a UAC bypass using Windows Event Viewer. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_uac_bypass_eventvwr.yml | Windows: UAC Bypass Using EventVwr | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Microsoft\\Event Viewer\\RecentViews|.*\\Microsoft\\EventV~1\\RecentViews"" AND (procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*"") |
| Windows: User Added to Local Administrators | Security | This rule triggers on user accounts that are added to the local Administrators group, which could be legitimate activity or a sign of privilege escalation activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_user_added_to_local_administrators.yml | Windows: User Added to Local Administrators | (eventType=""Win-Security-4732"" AND (user REGEXP ""Administr.*"" OR groupID=""S-1-5-32-544"")) AND (user NOT REGEXP "".*\$"") |
| Windows: Use of Forfiles For Execution | Security | Execute commands and binaries from the context of ""forfiles"". This is used as a LOLBIN for example to bypass application whitelisting. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_forfiles.yml | Windows: Use of Forfiles For Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\forfiles\.exe"" OR srcFileName=""forfiles.exe"") AND command REGEXP "".* -p .*|.* /p .*"" AND command REGEXP "".* -m .*|.* /m .*"" AND command REGEXP "".* -c .*|.* /c .*"" |
| Windows: VsCode Powershell Profile Modification | Security | Detects the creation or modification of a vscode related powershell profile which could indicate suspicious activity as the profile can be used as a mean of persistence. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_vscode_powershell_profile.yml | Windows: VsCode Powershell Profile Modification | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Microsoft\.VSCode_profile\.ps1"" |
| Windows: Tap Driver Installation | Security | Well-known TAP software installation. Possible preparation for data exfiltration using tunnelling techniques. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_tap_driver_installation.yml | Windows: Tap Driver Installation | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceFileName REGEXP "".*tap0901.*"" |
| Windows: Use Of The SFTP.EXE Binary As A LOLBIN | Security | Detects the usage of the ""sftp.exe"" binary as a LOLBIN by abusing the ""-D"" flag. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_sftp.yml | Windows: Use Of The SFTP.EXE Binary As A LOLBIN | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\sftp\.exe"" AND command REGEXP "".* -D C:\\.*|.* -D \.\..*"" |
| Windows: Vulnerable HW Driver Load | Security | Detects the load of a legitimate signed driver named HW.sys by often used by threat actors or malware for privilege escalation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_vuln_hw_driver.yml | Windows: Vulnerable HW Driver Load | eventType=""Win-Sysmon-6-Driver-Loaded"" AND (loadedProcName REGEXP "".*\\HW\.sys"" OR hashCode REGEXP "".*MD5=3247014BA35D406475311A2EAB0C4657.*|.*MD5=376B1E8957227A3639EC1482900D9B97.*|.*MD5=45C2D133D41D2732F3653ED615A745C8.*|.*SHA1=18F34A0005E82A9A1556BA40B997B0EAE554D5FD.*|.*SHA1=4E56E0B1D12664C05615C69697A2F5C5D893058A.*|.*SHA1=74E4E3006B644392F5FCEA4A9BAE1D9D84714B57.*|.*SHA256=4880F40F2E557CFF38100620B9AA1A3A753CB693AF16CD3D95841583EDCB57A8.*|.*SHA256=55963284BBD5A3297F39F12F0D8A01ED99FE59D008561E3537BCD4DB4B4268FA.*|.*SHA256=6A4875AE86131A594019DEC4ABD46AC6BA47E57A88287B814D07D929858FE3E5.*"" OR hashSHA256 IN (""4880f40f2e557cff38100620b9aa1a3a753cb693af16cd3d95841583edcb57a8"",""55963284bbd5a3297f39f12f0d8a01ed99fe59d008561e3537bcd4db4b4268fa"",""6a4875ae86131a594019dec4abd46ac6ba47e57a88287b814d07d929858fe3e5"") OR hashSHA1 IN (""18f34a0005e82a9a1556ba40b997b0eae554d5fd"",""4e56e0b1d12664c05615c69697a2f5c5d893058a"",""74e4e3006b644392f5fcea4a9bae1d9d84714b57"") OR hashMD5 IN (""3247014ba35d406475311a2eab0c4657"",""376b1e8957227a3639ec1482900d9b97"",""45c2d133d41d2732f3653ed615a745c8"")) |
| Windows: Visual Studio NodejsTools PressAnyKey Arbitrary Binary Execution | Security | Detects child processes of Microsoft.NodejsTools.PressAnyKey.exe that can be used to execute any other binary. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pressanykey_lolbin_execution.yml | Windows: Visual Studio NodejsTools PressAnyKey Arbitrary Binary Execution | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\Microsoft\.NodejsTools\.PressAnyKey\.exe"" |
| Windows: Turla Service Install | Security | This method detects a service install of malicious services mentioned in Carbon Paper - Turla report by ESET. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_apt_carbonpaper_turla.yml | Windows: Turla Service Install | eventType=""Win-System-Service-Control-Manager-7045"" AND serviceName IN (""hkmsvc"",""ipvpn"",""srservice"") |
| Windows: UAC Bypass via Windows Firewall Snap-In Hijack | Security | Detects attempts to bypass User Account Control (UAC) by hijacking the Microsoft Management Console (MMC) Windows Firewall snap-in. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_hijacking_firwall_snap_in.yml | Windows: UAC Bypass via Windows Firewall Snap-In Hijack | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\mmc\.exe"" AND parentCommand REGEXP "".*WF\.msc.*"") AND (procName NOT REGEXP "".*\\WerFault\.exe"") |
| Windows: Use of Scriptrunner.exe | Security | The ""ScriptRunner.exe"" binary can be abused to proxy execution through it and bypass possible whitelisting. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_scriptrunner.yml | Windows: Use of Scriptrunner.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\ScriptRunner\.exe"" OR srcFileName=""ScriptRunner.exe"") AND command REGEXP "".* -appvscript .*"" |
| Windows: Vulnerable AVAST Anti Rootkit Driver Load | Security | Detects the load of a signed and vulnerable AVAST Anti Rootkit driver often used by threat actors or malware for stopping and disabling AV and EDR products. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_vuln_avast_anti_rootkit_driver.yml | Windows: Vulnerable AVAST Anti Rootkit Driver Load | eventType=""Win-Sysmon-6-Driver-Loaded"" AND ((hashCode REGEXP "".*MD5=a179c4093d05a3e1ee73f6ff07f994aa.*|.*SHA1=5d6b9e80e12bfc595d4d26f6afb099b3cb471dd4.*|.*SHA256=4b5229b3250c8c08b98cb710d6c056144271de099a57ae09f5d2097fc41bd4f1.*"" OR hashMD5=""a179c4093d05a3e1ee73f6ff07f994aa"" OR hashSHA1=""5d6b9e80e12bfc595d4d26f6afb099b3cb471dd4"" OR hashSHA256=""4b5229b3250c8c08b98cb710d6c056144271de099a57ae09f5d2097fc41bd4f1"") OR (loadedProcName REGEXP "".*\\aswArPot\.sys"" AND (authResult=""false"" OR signatureStatus=""Expired""))) |
| Windows: Use of Squirrel.exe | Security | Detects the usage of the ""Squirrel.exe"" binary as a LOLBIN. This binary is part of multiple software installations (Slack, Teams, Discord, etc.). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_squirrel.yml | Windows: Use of Squirrel.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\squirrel\.exe|.*\\update\.exe"" AND ((command REGEXP "".* --download .*|.* --update .*|.* --updateRollback=.*"" AND command REGEXP "".*http.*"") OR command REGEXP "".*--createShortcut.*|.*--processStart.*|.*--processStartAndWait.*"")) AND ((command NOT REGEXP "".*C:\\Users\\.*"" OR command NOT REGEXP "".*\\AppData\\Local\\Discord\\Update\.exe.*"" OR command NOT REGEXP "".* --processStart.*"" OR command NOT REGEXP "".*Discord\.exe.*"") AND (command NOT REGEXP "".*C:\\Users\\.*"" OR command NOT REGEXP "".*\\AppData\\Local\\GitHubDesktop\\Update\.exe.*"" OR command NOT REGEXP "".*GitHubDesktop\.exe.*"" OR command NOT REGEXP "".*--createShortcut.*|.*--processStartAndWait.*"") AND (command NOT REGEXP "".*C:\\Users\\.*"" OR command NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams\\Update\.exe.*"" OR command NOT REGEXP "".*Teams\.exe.*"" OR command NOT REGEXP "".*--createShortcut.*|.*--processStart.*"") AND (command NOT REGEXP "".*C:\\Users\\.*"" OR command NOT REGEXP "".*\\AppData\\Local\\yammerdesktop\\Update\.exe.*"" OR command NOT REGEXP "".*Yammer\.exe.*"" OR command NOT REGEXP "".*--createShortcut.*|.*--processStart.*"")) |
| Windows: Tap Installer Execution | Security | Well-known TAP software installation. Possible preparation for data exfiltration using tunneling techniques. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_tapinstall_execution.yml | Windows: Tap Installer Execution | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\tapinstall\.exe"" AND ((procName NOT IN (""C:\\Program Files (x86)\\Avast Software\\SecureLine VPN\\tapinstall.exe"",""C:\\Program Files\\Avast Software\\SecureLine VPN\\tapinstall.exe"")) AND (procName NOT REGEXP ""C:\\Program Files\\OpenVPN Connect\\drivers\\tap\\.*"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Proton Technologies\\ProtonVPNTap\\installer\\.*"")) |
| Windows: Use of Remote.exe | Security | Remote.exe is part of WinDbg in the Windows SDK and can be used for AWL bypass and running remote files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_remote.yml | Windows: Use of Remote.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\remote\.exe"" OR srcFileName=""remote.exe"") |
| Windows: Use of TTDInject.exe | Security | Detects the executiob of TTDInject.exe, which is used by Windows 10 v1809 and newer to debug time travel (underlying call of tttracer.exe). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_ttdinject.yml | Windows: Use of TTDInject.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*ttdinject\.exe"" OR srcFileName=""TTDInject.EXE"") |
| Windows: Vulnerable GIGABYTE Driver Load | Security | Detects the load of a signed and vulnerable GIGABYTE driver often used by threat actors or malware for privilege escalation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_vuln_gigabyte_driver.yml | Windows: Vulnerable GIGABYTE Driver Load | eventType=""Win-Sysmon-6-Driver-Loaded"" AND (hashCode REGEXP "".*MD5=9AB9F3B75A2EB87FAFB1B7361BE9DFB3.*|.*MD5=C832A4313FF082258240B61B88EFA025.*|.*SHA1=1F1CE28C10453ACBC9D3844B4604C59C0AB0AD46.*|.*SHA1=FE10018AF723986DB50701C8532DF5ED98B17C39.*|.*SHA256=31F4CFB4C71DA44120752721103A16512444C13C2AC2D857A7E6F13CB679B427.*|.*SHA256=CFC5C585DD4E592DD1A08887DED28B92D9A5820587B6F4F8FA4F56D60289259B.*"" OR hashMD5 IN (""9ab9f3b75a2eb87fafb1b7361be9dfb3"",""c832a4313ff082258240b61b88efa025"") OR hashSHA1 IN (""1f1ce28c10453acbc9d3844b4604c59c0ab0ad46"",""fe10018af723986db50701c8532df5ed98b17c39"") OR hashSHA256 IN (""31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427"",""cfc5c585dd4e592dd1a08887ded28b92d9a5820587b6f4f8fa4f56d60289259b"")) |
| Windows: Unsigned AppX Installation Attempt Using Add-AppxPackage | Security | Detects usage of the ""Add-AppxPackage"" or it's alias ""Add-AppPackage"" to install unsigned AppX packages. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_install_unsigned_appx_packages.yml | Windows: Unsigned AppX Installation Attempt Using Add-AppxPackage | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".*Add-AppPackage .*|.*Add-AppxPackage .*"" AND command REGEXP "".* -AllowUnsigned.*"" |
| Windows: Vulnerable HackSys Extreme Vulnerable Driver Load | Security | Detects the load of HackSys Extreme Vulnerable Driver which is an intentionally vulnerable Windows driver developed for security enthusiasts to learn and polish their exploitation skills at Kernel level and often abused by threat actors. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_vuln_hevd_driver.yml | Windows: Vulnerable HackSys Extreme Vulnerable Driver Load | eventType=""Win-Sysmon-6-Driver-Loaded"" AND (loadedProcName REGEXP "".*\\HEVD\.sys"" OR hashCode REGEXP "".*IMPHASH=c46ea2e651fd5f7f716c8867c6d13594.*|.*IMPHASH=f26d0b110873a1c7d8c4f08fbeab89c5.*"" OR hashIMP IN (""c46ea2e651fd5f7f716c8867c6d13594"",""f26d0b110873a1c7d8c4f08fbeab89c5"")) |
| Windows: Uncommon AppX Package Locations | Security | Detects an appx package added the pipeline of the ""to be processed"" packages which is located in uncommon locations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_uncommon_package_locations.yml | Windows: Uncommon AppX Package Locations | eventType =""Win-AppXDeployment-Server-854"" AND ((procPath NOT REGEXP "".*C:\\Program Files \(x86\)\\.*|.*C:\\Program Files\\WindowsApps\\.*|.*C:\\Windows\\ImmersiveControlPanel\\.*|.*C:\\Windows\\PrintDialog\\.*|.*C:\\Windows\\SystemApps\\.*|.*file:///C:/Program%20Files.*|.*x-windowsupdate://.*"") AND (procPath NOT REGEXP "".*https://statics\.teams\.cdn\.office\.net/.*|.*microsoft\.com.*"")) |
| Windows: Taskmgr as Parent | Security | Detects the creation of a process from Windows task manager. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_taskmgr_susp_child_process.yml | Windows: Taskmgr as Parent | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\taskmgr\.exe"" AND (procName NOT REGEXP "".*\\mmc\.exe|.*\\resmon\.exe|.*\\taskmgr\.exe"") |
| Windows: Use of OpenConsole | Security | Detects usage of OpenConsole binary as a LOLBIN to launch other binaries to bypass application Whitelisting. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_openconsole.yml | Windows: Use of OpenConsole | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""OpenConsole.exe"" OR procName REGEXP "".*\\OpenConsole\.exe"") AND (procName NOT REGEXP ""C:\\Program Files\\WindowsApps\\Microsoft\.WindowsTerminal.*"") |
| Windows: Use of Wfc.exe | Security | The Workflow Command-line Compiler can be used for AWL bypass and is listed in Microsoft's recommended block rules. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_wfc.yml | Windows: Use of Wfc.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\wfc\.exe"" OR srcFileName=""wfc.exe"") |
| Windows: Use of Pcalua For Execution | Security | Execute commands and binaries from the context of The program compatibility assistant (Pcalua.exe). This is used as a LOLBIN for example to bypass application whitelisting. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_pcalua.yml | Windows: Use of Pcalua For Execution | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\pcalua\.exe"" AND command REGEXP "".* -a.*"" |
| Windows: Sysprep on AppData Folder | Security | Detects suspicious sysprep process start with AppData folder as target (as used by Trojan Syndicasec in Thrip report by Symantec). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysprep_appdata.yml | Windows: Sysprep on AppData Folder | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\sysprep\.exe"" AND command REGEXP "".*\\AppData\\.*"" |
| ICS Alert: Modify Program | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0889 - Modify Program. Adversaries may modify or add a program on a controller to affect how it interacts with the physical process, peripheral devices and other hosts on the network. | ICS Alert: Modify Program | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0889(,T\d+)*$"" |
| Windows: Wab Execution From Non Default Location | Security | Detects execution of wab.exe (Windows Contacts) and Wabmig.exe (Microsoft Address Book Import Tool) from non default locations as seen with bumblebee activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wab_execution_from_non_default_location.yml | Windows: Wab Execution From Non Default Location | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\wab\.exe|.*\\wabmig\.exe"" AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Windows Mail\\.*|C:\\Program Files\\Windows Mail\\.*|C:\\Windows\\WinSxS\\.*"") |
| Windows: WMI Persistence - Script Event Consumer | Security | Detects WMI script event consumers. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmi_persistence_script_event_consumer.yml | Windows: WMI Persistence - Script Event Consumer | eventType=""Win-Sysmon-1-Create-Process"" AND procName=""C:\\WINDOWS\\system32\\wbem\\scrcons.exe"" AND parentProcName=""C:\\Windows\\System32\\svchost.exe"" |
| Windows: Vulnerable WinRing0 Driver Load | Security | Detects the load of a signed WinRing0 driver often used by threat actors, crypto miners (XMRIG) or malware for privilege escalation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_vuln_winring0_driver.yml | Windows: Vulnerable WinRing0 Driver Load | eventType=""Win-Sysmon-6-Driver-Loaded"" AND (loadedProcName REGEXP "".*\\WinRing0\.dll|.*\\WinRing0\.sys|.*\\WinRing0x64\.dll|.*\\WinRing0x64\.sys|.*\\winring00x64\.sys"" OR hashCode REGEXP "".*IMPHASH=D41FA95D4642DC981F10DE36F4DC8CD7.*"" OR hashIMP=""d41fa95d4642dc981f10de36f4dc8cd7"") |
| Difference between Running and Startup Config | Change | Detects that the startup and running configurations of a network device (router or firewall) are different. This is achieved via logging in. | Difference between Running and Startup Config | hostIpAddr IN (Group@PH_SYS_DEVICE_ROUTER_SWITCH,Group@PH_SYS_DEVICE_FIREWALL) AND eventType = ""PH_DEV_MON_DELTA_CONFIG"" |
| Denied Blacklisted Destination | Security | Detects that a blacklisted destination of moderate or higher severity is permitted into the network by Cisco ASA Firewall Botnet filter | Denied Blacklisted Destination | eventType IN (""ASA-338006"",""ASA-338008"",""ASA-338204"") AND threatLevel IN (""moderate"", ""high"", ""very-high"") |
| Windows: WScript or CScript Dropper: Sysmon V1 | Security | Detects a file ending in jse, vbe, js, vba, vbs written by cscript.exe or wscript.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_cscript_wscript_dropper.yml | Windows: WScript or CScript Dropper: Sysmon V1 | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\cscript\.exe|.*\\wscript\.exe"" AND fileName REGEXP ""C:\\ProgramData.*|C:\\Users\\.*"" AND fileName REGEXP "".*\.js|.*\.jse|.*\.vba|.*\.vbe|.*\.vbs"" |
| Windows: Wuauclt Network Connection | Security | Detects the use of the Windows Update Client binary (wuauclt.exe) to proxy execute code and making a network connections. One could easily make the DLL spawn a new process and inject to it to proxy the network connection and bypass this rule. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_wuauclt_network_connection.yml | Windows: Wuauclt Network Connection | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND procName REGEXP "".*wuauclt.*"" AND command NOT REGEXP "".*\\UpdateDeploy\.dll /ClassId .*"" |
| Denied Blacklisted Source | Security | Detects that a blacklisted source of moderate or higher severity is permitted into the network by Cisco ASA Firewall Botnet filter | Denied Blacklisted Source | eventType IN (""ASA-338005"",""ASA-338007"",""ASA-338203"") AND threatLevel IN (""moderate"", ""high"", ""very-high"") |
| ICS Alert: Project File Infection | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0873 - Project File Infection. Adversaries may attempt to infect project files with malicious code. T | ICS Alert: Project File Infection | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0873(,T\d+)*$"" |
| Windows: WMI Script Host Process Image Loaded | Security | Detects signs of the WMI script host process ""scrcons.exe"" loading scripting DLLs which could indciates WMI ActiveScriptEventConsumers EventConsumers activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_scrcons_wmi_scripteventconsumer.yml | Windows: WMI Script Host Process Image Loaded | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\scrcons\.exe"" AND loadedProcName REGEXP "".*\\scrrun\.dll|.*\\vbscript\.dll|.*\\wbemdisp\.dll|.*\\wshom\.ocx"" |
| Windows: Windows Binaries Write Suspicious Extensions | Security | Detects windows executables that writes files with suspicious extensions. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_shell_write_susp_files_extensions.yml | Windows: Windows Binaries Write Suspicious Extensions | eventType=""Win-Sysmon-11-FileCreate"" AND ((procName REGEXP "".*\\RuntimeBroker\.exe|.*\\csrss\.exe|.*\\lsass\.exe|.*\\sihost\.exe|.*\\smss\.exe|.*\\wininit\.exe|.*\\winlogon\.exe"" AND fileName REGEXP "".*\.bat|.*\.dll|.*\.exe|.*\.hta|.*\.iso|.*\.ps1|.*\.txt|.*\.vbe|.*\.vbs"") OR (procName REGEXP "".*\\dllhost\.exe|.*\\rundll32\.exe|.*\\svchost\.exe"" AND fileName REGEXP "".*\.bat|.*\.hta|.*\.iso|.*\.ps1|.*\.vbe|.*\.vbs"")) |
| Windows: WMI Backdoor Exchange Transport Agent | Security | Detects a WMI backdoor in Exchange Transport Agents via WMI event filters. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmi_backdoor_exchange_transport_agent.yml | Windows: WMI Backdoor Exchange Transport Agent | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\EdgeTransport\.exe"" AND ((procName!=""C:\\Windows\\System32\\conhost.exe"") AND (procName NOT REGEXP ""C:\\Program Files\\Microsoft\\Exchange Server\\.*"" OR procName NOT REGEXP "".*\\Bin\\OleConverter\.exe"")) |
| Windows: Wab/Wabmig Unusual Parent Or Child Processes | Security | Detects unusual parent or children of the wab.exe (Windows Contacts) and Wabmig.exe (Microsoft Address Book Import Tool) processes as seen being used with bumblebee activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wab_unusual_parents.yml | Windows: Wab/Wabmig Unusual Parent Or Child Processes | eventType=""Win-Sysmon-1-Create-Process"" AND ((parentProcName REGEXP "".*\\WmiPrvSE\.exe|.*\\dllhost\.exe|.*\\svchost\.exe"" AND procName REGEXP "".*\\wab\.exe|.*\\wabmig\.exe"") OR parentProcName REGEXP "".*\\wab\.exe|.*\\wabmig\.exe"") |
| Windows: Wscript Execution from Non C Drive | Security | Detects Wscript or Cscript executing from a drive other than C. This has been observed with Qakbot executing from within a mounted ISO file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_lolbin_non_c_drive.yml | Windows: Wscript Execution from Non C Drive | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cscript\.exe|.*\\wscript\.exe"" AND command REGEXP "".*\.js.*|.*\.vbe.*|.*\.vbs.*"" AND command REGEXP "".*:\\.*"") AND ((command NOT REGEXP "".* 'C:\\.*|.* C:\\\.*|.* \""C:\\\.*"") AND (command NOT REGEXP "".*%.*"") AND (command NOT REGEXP "".* \\\\\.*"")) |
| Windows: WinSxS Executable File Creation By Non-System Process | Security | Detects the creation of binaries in the WinSxS folder by non-system processes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_winsxs_binary_creation.yml | Windows: WinSxS Executable File Creation By Non-System Process | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP ""C:\\Windows\\WinSxS\\.*"" AND fileName REGEXP "".*\.exe"") AND ((procName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\Systems32\\.*|C:\\Windows\\WinSxS\\.*"")) |
| Windows: Weak or Abused Passwords In CLI | Security | Detects weak passwords or often abused passwords (seen used by threat actors) via the CLI. An example would be a threat actor creating a new user via the net command and providing the password inline. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_weak_or_abused_passwords.yml | Windows: Weak or Abused Passwords In CLI | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*123456789.*|.*Asd123\.aaaa.*|.*P@ssw0rd\!.*|.*password123.*"" |
| Windows: Windows Update Error | Security | Windows Update get some error Check if need a 0-days KB. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/microsoft_windows_windows_update_client/win_system_susp_system_update_error.yml | Windows: Windows Update Error | eventType IN (""Win-System-Microsoft-Windows-WindowsUpdateClient-16"",""Win-System-Microsoft-Windows-WindowsUpdateClient-20"",""Win-System-Microsoft-Windows-WindowsUpdateClient-213"",""Win-System-Microsoft-Windows-WindowsUpdateClient-217"",""Win-System-Microsoft-Windows-WindowsUpdateClient-24"") |
| Windows: Windows Spooler Service Suspicious Binary Load | Security | Detect DLL Load from Spooler Service backup folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_spoolsv_dll_load.yml | Windows: Windows Spooler Service Suspicious Binary Load | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\spoolsv\.exe"" AND loadedProcName REGEXP "".*\\Windows\\System32\\spool\\drivers\\x64\\3\\.*|.*\\Windows\\System32\\spool\\drivers\\x64\\4\\.*"" AND loadedProcName REGEXP "".*\.dll"" |
| Windows: WINEKEY Registry Modification | Security | Detects potential malicious modification of run keys by winekey or team9 backdoor. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_runkey_winekey.yml | Windows: WINEKEY Registry Modification | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Backup Mgr"" |
| Windows: WMI Persistence - Script Event Consumer File Write | Security | Detects file writes of WMI script event consumer. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_wmi_persistence_script_event_consumer_write.yml | Windows: WMI Persistence - Script Event Consumer File Write | eventType=""Win-Sysmon-11-FileCreate"" AND procName=""C:\\WINDOWS\\system32\\wbem\\scrcons.exe"" |
| Default Password Detected by System | Security | Detects a device is discovered with a default credentials | Default Password Detected by System | eventType = ""PH_AUDIT_DEFAULT_PWD_MATCH"" |
| Machine Learning Anomaly Detected | Security | Detects a machine learning based anomaly | Machine Learning Anomaly Detected | eventType = ""PH_ML_ANOMALY_DETECTED"" |
| Windows: Windows Shell/Scripting Application File Write to Suspicious Folder | Security | Detects Windows shells and scripting applications that write files to suspicious folders. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_shell_write_susp_directory.yml | Windows: Windows Shell/Scripting Application File Write to Suspicious Folder | eventType=""Win-Sysmon-11-FileCreate"" AND ((procName REGEXP "".*\\bash\.exe|.*\\cmd\.exe|.*\\cscript\.exe|.*\\msbuild\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\sh\.exe|.*\\wscript\.exe"" AND fileName REGEXP ""C:\\PerfLogs\\.*|C:\\Users\\Public\\.*"") OR (procName REGEXP "".*\\certutil\.exe|.*\\forfiles\.exe|.*\\mshta\.exe|.*\\schtasks\.exe|.*\\scriptrunner\.exe|.*\\wmic\.exe"" AND fileName REGEXP "".*C:\\PerfLogs\\.*|.*C:\\Users\\Public\\.*|.*C:\\Windows\\Temp\\.*"")) |
| Windows: WMI Persistence - Command Line Event Consumer | Security | Detects WMI command line event consumers. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_wmi_persistence_commandline_event_consumer.yml | Windows: WMI Persistence - Command Line Event Consumer | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName=""C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"" AND loadedProcName REGEXP "".*\\wbemcons\.dll"" |
| Windows: Windows Network Access Suspicious desktop.ini Action | Security | Detects unusual processes accessing desktop.ini remotely over network share, which can be leveraged to alter how Explorer displays a folder's content (i.e. renaming files) without changing them on disk. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_net_share_obj_susp_desktop_ini.yml | Windows: Windows Network Access Suspicious desktop.ini Action | eventType=""Win-Security-5145"" AND osObjType=""File"" AND targetName REGEXP "".*\\desktop\.ini"" AND fileAccess REGEXP "".*AddSubdirectory.*|.*AppendData.*|.*DELETE.*|.*WriteDAC.*|.*WriteData.*"" |
| Windows: Webshell Recon Detection Via CommandLine Processes | Security | Detects processes spawned from web servers (php, tomcat, iis...etc) that perform reconnaissance looking for the existence of popular scripting tools (perl, python, wget) on the system via the help commands. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_recon_detection.yml | Windows: Webshell Recon Detection Via CommandLine Processes | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\caddy\.exe|.*\\httpd\.exe|.*\\nginx\.exe|.*\\php-cgi\.exe|.*\\w3wp\.exe|.*\\ws_tomcatservice\.exe"" OR (parentProcName REGEXP "".*\\java\.exe|.*\\javaw\.exe"" AND parentProcName REGEXP "".*-tomcat-.*|.*\\tomcat.*"") OR (parentProcName REGEXP "".*\\java\.exe|.*\\javaw\.exe"" AND command REGEXP "".*CATALINA_HOME.*|.*catalina\.jar.*"")) AND command REGEXP "".*perl --help.*|.*perl -h.*|.*python --help.*|.*python -h.*|.*python3 --help.*|.*python3 -h.*|.*wget --help.*"" |
| Windows: Windows Firewall Disabled via PowerShell | Security | Detects attempts to disable the Windows Firewall using PowerShell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_disable_firewall.yml | Windows: Windows Firewall Disabled via PowerShell | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\powershell_ise\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND (command REGEXP "".*Set-NetFirewallProfile .*"" AND command REGEXP "".* -Enabled .*"" AND command REGEXP "".* False.*"") AND command REGEXP "".* -All .*|.*Domain.*|.*Private.*|.*Public.*"" |
| Windows: Windows Service Terminated With Error | Security | Detects windows services that got terminated for whatever reason. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_terminated_error_generic.yml | Windows: Windows Service Terminated With Error | eventType=""Win-System-Service-Control-Manager-7023"" |
| Windows: Windows Defender Firewall Has Been Reset To Its Default Configuration | Security | Detects activity when Windows Defender Firewall has been reset to its default configuration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/firewall_as/win_firewall_as_reset_config.yml | Windows: Windows Defender Firewall Has Been Reset To Its Default Configuration | eventType REGEXP ""Win-.*-2032[^\d]*|Win-.*-2060[^\d]*"" |
| Windows: Wlrmdr Lolbin Use as Launcher | Security | Detects use of Wlrmdr.exe in which the -u parameter is passed to ShellExecute. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_wlrmdr.yml | Windows: Wlrmdr Lolbin Use as Launcher | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\wlrmdr\.exe"" OR (((procName REGEXP "".*\\wlrmdr\.exe"" OR srcFileName=""WLRMNDR.EXE"") AND (command REGEXP "".*-s .*"" AND command REGEXP "".*-f .*"" AND command REGEXP "".*-t .*"" AND command REGEXP "".*-m .*"" AND command REGEXP "".*-a .*"" AND command REGEXP "".*-u .*"")) AND ((parentProcName!=""C:\\Windows\\System32\\winlogon.exe"") AND (parentProcName IS NOT NULL)))) |
| Windows: Write Protect For Storage Disabled | Security | Looks for changes to registry to disable any write-protect property for storage devices. This could be a precursor to a ransomware attack and has been an observed technique used by cypherpunk group. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_write_protect_for_storage_disabled.yml | Windows: Write Protect For Storage Disabled | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*reg add.*"" AND command REGEXP "".*\\system\\currentcontrolset\\control.*"" AND command REGEXP "".*write protection.*"" AND command REGEXP "".*0.*"" AND command REGEXP "".*storage.*|.*storagedevicepolicies.*"" |
| Windows: WMI Event Subscription | Security | Detects creation of WMI event subscription persistence method. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/wmi_event/sysmon_wmi_event_subscription.yml | Windows: WMI Event Subscription | eventType IN (""Win-Sysmon-19-WMI-Event-Filter-Activity"",""Win-Sysmon-20-WMI-Event-Consumer-Activity"",""Win-Sysmon-21-WMI-Event-ConsumerToFilter-Activity"") |
| ICS Alert: Module Firmware | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0839 - Module Firmware. Adversaries may install malicious or vulnerable firmware onto modular hardware devices. | ICS Alert: Module Firmware | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0839(,T\d+)*$"" |
| Windows: Wusa Extracting Cab Files | Security | Detects usage of the ""wusa.exe"" (Windows Update Standalone Installer) utility to extract cab using the ""/extract"" argument which is not longer supported. This could indicate an attacker using an old technique. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wusa_cab_files_extraction.yml | Windows: Wusa Extracting Cab Files | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\wusa\.exe"" AND command REGEXP "".*/extract:.*"" |
| Windows: Writing Local Admin Share | Security | Aversaries may use to interact with a remote network share using Server Message Block (SMB). This technique is used by post-exploitation frameworks. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_writing_local_admin_share.yml | Windows: Writing Local Admin Share | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\\\127\.0\.0.*"" AND fileName REGEXP "".*\\ADMIN\$\\.*"" |
| Meraki Foreign AP Detected | Security | Meraki detects a foreign Access Point | Meraki Foreign AP Detected | eventType = ""Cisco-Meraki-foreignAPDetected"" |
| Windows: Wscript Shell Run In CommandLine | Security | Detects the presence of the keywords ""Wscript"", ""Shell"" and ""Run"" in the command, which could indicate a suspicious activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_script_wscript_shell_cli.yml | Windows: Wscript Shell Run In CommandLine | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Wscript\..*"" AND command REGEXP "".*\.Shell.*"" AND command REGEXP "".*\.Run.*"" |
| IRC traffic detected | Security | Network IPS detects IRC traffic | IRC traffic detected | (reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) OR (reptDevIpAddr IN (Group@PH_SYS_APP_NETWORK_IPS) AND eventType CONTAIN ""Snort-"")) AND eventType IN (Group@PH_SYS_EVENT_IRCTraffic) |
| Windows: Windows Firewall Settings Have Been Changed | Security | Detects activity when the settings of the Windows firewall have been changed. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/firewall_as/win_firewall_as_setting_change.yml | Windows: Windows Firewall Settings Have Been Changed | eventType REGEXP ""Win-.*-2002[^\d]*|Win-.*-2003[^\d]*|Win-.*-2008[^\d]*|Win-.*-2082[^\d]*|Win-.*-2083[^\d]*"" |
| Windows: WMI Persistence - Security | Security | Detects suspicious WMI event filter and command line event consumer based on WMI and Security Logs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_wmi_persistence.yml | Windows: WMI Persistence - Security | eventType=""Win-Security-4662"" AND osObjType=""WMI Namespace"" AND osObjName REGEXP "".*subscription.*"" |
| Windows: Wusa Extracting Cab Files From Suspicious Paths | Security | Detects usage of the ""wusa.exe"" (Windows Update Standalone Installer) utility to extract cab using the ""/extract"" argument from suspicious paths. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wusa_cab_files_extraction_from_susp_paths.yml | Windows: Wusa Extracting Cab Files From Suspicious Paths | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\wusa\.exe"" AND command REGEXP "".*/extract:.*"" AND command REGEXP "".*C:\\Users\\Public\\.*|.*\\Appdata\\Local\\Temp\\.*|.*\\Desktop\\.*|.*\\Downloads\\.*|.*\\PerfLogs\\.*|.*\\Windows\\Temp\\.*"" |
| Host Quarantined by FortiGate | Security | Detects hosts quarantined by FortiGate | Host Quarantined by FortiGate | eventType IN (""FortiGate-event-NAC-quarantined-ban-ip"") |
| ICS Alert: Valid Accounts | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0859 - Valid Accounts. Adversaries may steal the credentials of a specific user or service account using credential access techniques. | ICS Alert: Valid Accounts | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0859(,T\d+)*$"" |
| Windows: Webshell Detection With Command Line Keywords | Security | Detects certain command line parameters often used during reconnaissance activity via web shells. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_detection.yml | Windows: Webshell Detection With Command Line Keywords | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\caddy\.exe|.*\\httpd\.exe|.*\\nginx\.exe|.*\\php-cgi\.exe|.*\\w3wp\.exe|.*\\ws_tomcatservice\.exe"" OR (parentProcName REGEXP "".*\\java\.exe|.*\\javaw\.exe"" AND parentProcName REGEXP "".*-tomcat-.*|.*\\tomcat.*"") OR (parentProcName REGEXP "".*\\java\.exe|.*\\javaw\.exe"" AND command REGEXP "".*CATALINA_HOME.*|.*catalina\.jar.*"")) AND ((srcFileName IN (""net.exe"",""net1.exe"") AND command REGEXP "".* group .*|.* use .*|.* user .*"") OR (srcFileName=""ping.exe"" AND command REGEXP "".* -n .*"") OR command REGEXP "".*&cd&echo.*|.*cd /d .*"" OR (srcFileName=""wmic.exe"" AND command REGEXP "".* /node:.*"") OR (procName REGEXP "".*\\ipconfig\.exe|.*\\netstat\.exe|.*\\pathping\.exe|.*\\quser\.exe|.*\\schtasks\.exe|.*\\systeminfo\.exe|.*\\tasklist\.exe|.*\\tracert\.exe|.*\\vssadmin\.exe|.*\\wevtutil\.exe|.*\\whoami\.exe"" OR srcFileName IN (""VSSADMIN.EXE"",""ipconfig.exe"",""netstat.exe"",""pathping.exe"",""quser.exe"",""schtasks.exe"",""sysinfo.exe"",""tasklist.exe"",""tracert.exe"",""wevtutil.exe"",""whoami.exe"")) OR command REGEXP "".* Test-NetConnection .*|.*dir \\.*"") |
| Windows: Webshell Hacking Activity Patterns | Security | Detects certain parent child patterns found in cases in which a webshell is used to perform certain credential dumping or exfiltration activities on a compromised system. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_hacking.yml | Windows: Webshell Hacking Activity Patterns | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\caddy\.exe|.*\\httpd\.exe|.*\\nginx\.exe|.*\\php-cgi\.exe|.*\\w3wp\.exe|.*\\ws_tomcatservice\.exe"" OR (parentProcName REGEXP "".*\\java\.exe|.*\\javaw\.exe"" AND parentProcName REGEXP "".*-tomcat-.*|.*\\tomcat.*"") OR (parentProcName REGEXP "".*\\java\.exe|.*\\javaw\.exe"" AND command REGEXP "".*CATALINA_HOME.*|.*catalina\.jar.*"")) AND ((command REGEXP "".*rundll32.*"" AND command REGEXP "".*comsvcs.*"") OR (command REGEXP "".* -hp.*"" AND command REGEXP "".* a .*"" AND command REGEXP "".* -m.*"") OR (command REGEXP "".*net.*"" AND command REGEXP "".* user .*"" AND command REGEXP "".* /add.*"") OR (command REGEXP "".*net.*"" AND command REGEXP "".* localgroup .*"" AND command REGEXP "".* administrators .*"" AND command REGEXP "".*/add.*"") OR procName REGEXP "".*\\Nanodump\.exe|.*\\adfind\.exe|.*\\fsutil\.exe|.*\\ldifde\.exe|.*\\ntdsutil\.exe|.*\\procdump\.exe|.*\\vssadmin\.exe"" OR command REGEXP "".* -NoP .*|.* -W Hidden .*|.* -decode .*|.* /decode .*|.* /ticket:.*|.* sekurlsa.*|.*FromBase64String.*|.*\.dmp full.*|.*\.downloadfile\(.*|.*\.downloadstring\(.*|.*process call create.*|.*reg save .*|.*whoami /priv.*"") |
| ICS Alert: System Firmware | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0857 - System Firmware. System firmware on modern assets is often designed with an update feature. Older device firmware may be factory installed and require special reprograming equipment. | ICS Alert: System Firmware | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0857(,T\d+)*$"" |
| Website access policy violation | Security | Network IPS or Security Gateway or Firewall detects inappropriate website access | Website access policy violation | eventType IN (Group@PH_SYS_EVENT_WebsiteCategoryViolation) |
| Linux: Trap Signals Usage | Security | Detects attempts to run the trap command that allows programs and shells to specify commands that will be executed upon receiving interrupt signals. | Linux: Trap Signals Usage | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""trap"" AND swParam CONTAIN "" signals"" |
| Wireless Host Blacklisted | Security | Detects that a wireless host is blacklisted by WLAN system. It would not be able to communicate until it is removed from the blocklist. | Wireless Host Blacklisted | eventType IN (""Cisco-WLC-52-bsnDot11StationBlacklisted"",""Aruba-1044-wlsxNStationAddedToBlackList"") |
| Website access policy violation: High volume | Security | Detects excessive inappropriate website access from the same source IP address - excessive is defined by (more than 10 attempts in 1 hour | Website access policy violation: High volume | eventType = ""PH_RULE_INAPPROPRIATE_WEB_TRAFFIC"" |
| P2P traffic consuming high network bandwidth | Security | Network IPS detected P2P traffic and the source IP is also sending/receiving excessive traffic exceeding 5MB over a 10 minute window | P2P traffic consuming high network bandwidth | eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| P2P traffic consuming high network bandwidth | Security | Network IPS detected P2P traffic and the source IP is also sending/receiving excessive traffic exceeding 5MB over a 10 minute window | P2P traffic consuming high network bandwidth | (reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) OR (reptDevIpAddr IN (Group@PH_SYS_APP_NETWORK_IPS) AND eventType CONTAIN ""Snort-"")) AND eventType IN (Group@PH_SYS_EVENT_P2PTraffic) |
| Privilege Escalation Exploits | Security | Detects privilege escalation attempts | Privilege Escalation Exploits | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_PrivEscalationExploit) |
| Outbreak: Win32k Elevation of Privilege Vulnerability Detected on Network | Security | A Fortinet product has detected an exploit related to CVE-2022-21882 on network | Outbreak: Win32k Elevation of Privilege Vulnerability Detected on Network | eventType IN (""FortiGate-ips-signature-51068"",""FortiProxy-ips-signature-51068"") |
| Outbreak: VMware ESXi Server Ransomware Attack Detected on Network | Security | VMware ESXi server ransomware attack detected (CVE-2021-21974, CVE-2020-3992) on network. Details: https://www.fortiguard.com/outbreak-alert/esxiargs-ransomware | Outbreak: VMware ESXi Server Ransomware Attack Detected on Network | eventType IN (Group@PH_SYS_EVENT_FortiGate_AV_Detected,""FortiGate-ips-signature-50017"",""FortiGate-ips-signature-50440"",""FortiProxy-ips-signature-50017"",""FortiProxy-ips-signature-50440"") AND ipsSignatureId IN (50017,50440,10123322,10123319,162242795) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Website access policy violation: Multiple categories | Security | Detects excessive inappropriate website access from the same source IP address - excessive is defined by (more than 5 distinct categories in 1 hour | Website access policy violation: Multiple categories | eventType = ""PH_RULE_INAPPROPRIATE_WEB_TRAFFIC"" |
| Windows: Process Monitor Driver Creation By Non-Sysinternals Binary | Security | Detects creation of the Process Monitor driver by processes other than Process Monitor (procmon) itself. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_sysinternals_procmon_driver_susp_creation.yml | Windows: Process Monitor Driver Creation By Non-Sysinternals Binary | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP "".*\\procmon.*"" AND fileName REGEXP "".*\.sys"") AND ((procName NOT REGEXP "".*\\procmon64\.exe|.*\\procmon\.exe"")) |
| Privileged Command Execution Failure | Security | Detects excessive privileged command execution (e.g. sudo exec) failure at a server | Privileged Command Execution Failure | eventType IN (Group@PH_SYS_EVENT_HostPrivExecFailure) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Meraki Rogue DHCP Server | Security | Meraki detects a rogue DHCP Server | Meraki Rogue DHCP Server | eventType = ""Cisco-Meraki-rogueDhcpServer"" |
| FortiNDR Cloud: Moderate Severity Detection triggered for a Host | Security | FortiNDR Cloud triggered a detection for a host. The details are dependent on the FortiNDR Cloud rule detection that triggered based on traffic to or from the given host. This rule only triggers for moderate detections. | FortiNDR Cloud: Moderate Severity Detection triggered for a Host | eventType CONTAIN ""FortiNDRCloud_detections"" AND eventSeverity>=5 AND eventSeverity<=8 |
| Windows: Bypass UAC via Fodhelper.exe | Security | Detects use of Fodhelper.exe to bypass User Account Control. Fodhelper is a trusted binary in Windows operating systems, to manage features in Windows settings. If the attackers have limited shell or normal user access to the victim system, they can make use of fodhelper.exe to bypass the User Access Control and execute privileged processes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_fodhelper.yml | Windows: Bypass UAC via Fodhelper.exe | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\fodhelper\.exe"" |
| Permitted Blacklisted Destination | Security | Detects that a blacklisted destination of moderate or higher severity is permitted into the network by Cisco ASA firewall Botnet filter | Permitted Blacklisted Destination | eventType IN (""ASA-338002"",""ASA-338004"",""ASA-338202"") AND threatLevel IN (""moderate"", ""high"", ""very-high"") |
| ICS Alert: Exploitation for Privilege Escalation | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0890 - Exploitation for Privilege Escalation. Adversaries may exploit software vulnerabilities in an attempt to elevate privileges. | ICS Alert: Exploitation for Privilege Escalation | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0890(,T\d+)*$"" |
| AWS SecHub: Tactics: Privilege Escalation Detected | Security | AWS Security Hub detected Privilege Escalation tactics. Adversary is trying to gain privileges. | AWS SecHub: Tactics: Privilege Escalation Detected | eventType = ""AWS-Hub-TTPs-Privilege_Escalation"" |
| Linux: Setuid Bit Set via chmod | Security | Detects setuid bit to a file or directory - this allows adversary to do operations on the file with the privileges of the owning user. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setuid bit to get code running in a different user context. Additionally, adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future. This requires process monitoring via FortiSIEM Linux agent. | Linux: Setuid Bit Set via chmod | eventType = ""LINUX_PROCESS_EXEC"" AND procName =""chmod"" AND user != ""root"" AND (swParam CONTAIN ""u+s"" OR swParam REGEXP ("".*4[0-9]{3}.*"")) |
| Linux: Setgid Bit Set via chmod | Security | Detects setgid bit to a file or directory - this allows adversary to do operations on the file with the privileges of the owning group. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setgid bit to get code running in a different user context. Additionally, adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future. This requires process monitoring via FortiSIEM Linux agent. | Linux: Setgid Bit Set via chmod | eventType = ""LINUX_PROCESS_EXEC"" AND procName =""chmod"" AND user != ""root"" AND (swParam CONTAIN ""g+s"" OR swParam REGEXP ("".*2[0-9]{3}.*"")) |
| Website access policy violation | Security | Network IPS or Security Gateway or Firewall detects inappropriate website access | Website access policy violation | eventType IN (""FortiGate-webfilter-url-firewall-deny"",""FortiGate-webfilter-url-firewall-allow"") AND webCategory IN (""Malicious Websites"") |
| P2P traffic detected | Security | Network IPS detects P2P traffic | P2P traffic detected | (reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) OR (reptDevIpAddr IN (Group@PH_SYS_APP_NETWORK_IPS) AND eventType CONTAIN ""Snort-"")) AND eventType IN (Group@PH_SYS_EVENT_P2PTraffic) |
| Outbreak: Zimbra Collaboration Mboximport Vulnerability on Host | Security | Zimbra Collaboration Mboximport Vulnerability (CVE-2022-27925, CVE-2022-37042) detected on a host | Outbreak: Zimbra Collaboration Mboximport Vulnerability on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND (ipsSignatureId IN (10101477,10101326,10101454) OR virusName = ""Python/Zimbra\\.E6FB!tr"") |
| Linux: Sudoers File Modification | Security | Detects changes to Sudoers file. A sudoers file specifies the commands that users or groups can run and from which terminals. Adversaries can take advantage of these configurations to execute commands as other users or spawn processes with higher privileges. This requires process monitoring via FortiSIEM Linux agent. | Linux: Sudoers File Modification | eventType = ""FSM_LINUX_FILE_MODIFY"" AND targetOsObjType = ""File"" AND targetOsObjName = ""/etc/sudoers"" |
| Windows: HackTool - SysmonEOP Execution | Security | Detects the execution of the PoC that can be used to exploit Sysmon CVE-2022-41120. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_sysmoneop.yml | Windows: HackTool - SysmonEOP Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\SysmonEOP\.exe"" OR hashCode IN (""IMPHASH=22F4089EB8ABA31E1BB162C6D9BF72E5"",""IMPHASH=5123FA4C4384D431CD0D893EEB49BBEC"") OR hashIMP IN (""22f4089eb8aba31e1bb162c6d9bf72e5"",""5123fa4c4384d431cd0d893eeb49bbec"")) |
| Crowdstrike: Privilege Escalation | Security | Crowdstrike agent detected privilege escalation on a host | Crowdstrike: Privilege Escalation | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Privilege-Escalation"" |
| FortiNDR Cloud: High Severity Detection triggered for a Host | Security | FortiNDR Cloud triggered a detection for a host. The details are dependent on the FortiNDR Cloud rule detection that triggered based on traffic to or from the given host. This rule only triggers for high detections. | FortiNDR Cloud: High Severity Detection triggered for a Host | eventType CONTAIN ""FortiNDRCloud_detections"" AND eventSeverity>=9 |
| Windows: Notepad Making Network Connection | Security | Detects suspicious network connection by Notepad. Cobalt Strike and Metasploit Framework or a malicious program can spawn notepad.exe and inject a malicious macro into notepad.exe, a good candidate as it exists on x86 and x64 systems. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_notepad_network_connection.yml | Windows: Notepad Making Network Connection | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND procName REGEXP "".*\\notepad\.exe"" AND (destIpPort != 9100) |
| Otorio RAM2 Vulnerability Discovered | Security | RAM2 has discovered a high or critical vulnerability on a host | Otorio RAM2 Vulnerability Discovered | eventType = ""Otorio-RAM2-vulnerabilities_discovered"" AND eventSeverity >= 9 |
| Windows: Process Explorer Driver Creation By Non-Sysinternals Binary | Security | Detects creation of the Process Explorer drivers by processes other than Process Explorer (procexp) itself. Hack tools or malware may use the Process Explorer driver to elevate privileges, drops it to disk for a few moments, runs a service using that driver and removes it afterwards. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_sysinternals_procexp_driver_susp_creation.yml | Windows: Process Explorer Driver Creation By Non-Sysinternals Binary | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP "".*\\PROCEXP.*"" AND fileName REGEXP "".*\.sys"") AND ((procName NOT REGEXP "".*\\procexp64\.exe|.*\\procexp\.exe"")) |
| FortiNDR Cloud: Low Severity Detection triggered for a Host | Security | FortiNDR Cloud triggered a detection for a host. The details are dependent on the FortiNDR Cloud rule detection that triggered based on traffic to or from the given host. This rule only triggers for low detections. | FortiNDR Cloud: Low Severity Detection triggered for a Host | eventType CONTAIN ""FortiNDRCloud_detections"" AND eventSeverity<=4 |
| Windows Debugger registry key for common Windows accessibility tools | Security | Detects the presence of the 'Debugger' registry key for common Windows accessibility tools. This Accessibility Tool Backdoor allows a user to assign a program of their choice (e.g. Notepad2.exe) to be the debugger to another program (e.g. Notepad.exe), so that the debugger program Notepad2.exe is automatically started when the program Notepad.exe is launched. | Windows Debugger registry key for common Windows accessibility tools | eventType = ""PH_OSQUERY_WIN_DEBUGGER_REGKEY"" AND totalNum >= 1 |
| Linux Buffer overflow | Security | Detects buffer overflow in linux syslog | Linux Buffer overflow | eventType CONTAIN ""Generic_Unix_"" AND (rawEventMsg CONTAIN ""attempt to execute code on stack by"" OR rawEventMsg REGEXP "".*FTP LOGIN FROM .* 0bin0sh"" OR rawEventMsg REGEXP "".*rpc.statd\[\d+\]: gethostbyname error for"" OR rawEventMsg CONTAIN ""AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"") AND phEventCategory = 0 |
| Outbreak: Router Malware Attack Detected on Network | Security | Router malware attack using various older router vulns still being exploited in the wild detected (CVE-2019-10891, CVE-2018-10562, CVE-2018-10561, CVE-2015-2051) on network. Details: https://www.fortiguard.com/outbreak-alert/router-malware-attack | Outbreak: Router Malware Attack Detected on Network | eventType IN (Group@PH_SYS_EVENT_FortiGate_AV_Detected,""FortiGate-ips-signature-40772"",""FortiGate-ips-signature-46083"",""FortiGate-ips-signature-44738"",""FortiGate-ips-signature-52148"",""FortiGate-ips-signature-50501"",""FortiProxy-ips-signature-40772"",""FortiProxy-ips-signature-46083"",""FortiProxy-ips-signature-44738"",""FortiProxy-ips-signature-52148"",""FortiProxy-ips-signature-50501"") AND ipsSignatureId IN (40772,46083,44738,52148,50501,10085987,10117488,7194143,10102081,10077186) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Windows: Usage Of Malicious POORTRY Signed Driver | Security | Detects the load of the signed poortry driver used by UNC3944 as reported by Mandiant and Sentinel One. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_mal_poortry_driver.yml | Windows: Usage Of Malicious POORTRY Signed Driver | eventType=""Win-Sysmon-6-Driver-Loaded"" AND (loadedProcName REGEXP "".*\\KApcHelper_x64\.sys.*|.*\\LcTkA\.sys.*|.*\\NodeDriver\.sys.*|.*\\gftkyj64\.sys.*|.*\\prokiller64\.sys.*"" OR hashCode REGEXP "".*MD5=04a88f5974caa621cee18f34300fc08a.*|.*MD5=0f16a43f7989034641fd2de3eb268bf1.*|.*MD5=10f3679384a03cb487bda9621ceb5f90.*|.*MD5=6fcf56f6ca3210ec397e55f727353c4a.*|.*MD5=909f3fc221acbe999483c87d9ead024a.*|.*MD5=ee6b1a79cb6641aa44c762ee90786fe0.*|.*SHA1=31cc8718894d6e6ce8c132f68b8caaba39b5ba7a.*|.*SHA1=3ef30c95e40a854cc4ded94fc503d0c3dc3e620e.*|.*SHA1=6debce728bcff73d9d1d334df0c6b1c3735e295c.*|.*SHA1=a804ebec7e341b4d98d9e94f6e4860a55ea1638d.*|.*SHA1=b2f955b3e6107f831ebe67997f8586d4fe9f3e98.*|.*SHA1=cc65bf60600b64feece5575f21ab89e03a728332.*|.*SHA256=0440ef40c46fdd2b5d86e7feef8577a8591de862cfd7928cdbcc8f47b8fa3ffc.*|.*SHA256=05b146a48a69dd62a02759487e769bd30d39f16374bc76c86453b4ae59e7ffa4.*|.*SHA256=8e035beb02a411f8a9e92d4cf184ad34f52bbd0a81a50c222cdd4706e4e45104.*|.*SHA256=9b1b15a3aacb0e786a608726c3abfc94968915cedcbd239ddf903c4a54bfcf0c.*|.*SHA256=c8f9e1ad7b8cce62fba349a00bc168c849d42cfb2ca5b2c6cc4b51d054e0c497.*|.*SHA256=d7c81b0f3c14844f6424e8bdd31a128e773cb96cccef6d05cbff473f0ccb9f9c.*"" OR hashSHA256 IN (""0440ef40c46fdd2b5d86e7feef8577a8591de862cfd7928cdbcc8f47b8fa3ffc"",""05b146a48a69dd62a02759487e769bd30d39f16374bc76c86453b4ae59e7ffa4"",""8e035beb02a411f8a9e92d4cf184ad34f52bbd0a81a50c222cdd4706e4e45104"",""9b1b15a3aacb0e786a608726c3abfc94968915cedcbd239ddf903c4a54bfcf0c"",""c8f9e1ad7b8cce62fba349a00bc168c849d42cfb2ca5b2c6cc4b51d054e0c497"",""d7c81b0f3c14844f6424e8bdd31a128e773cb96cccef6d05cbff473f0ccb9f9c"") OR hashSHA1 IN (""31cc8718894d6e6ce8c132f68b8caaba39b5ba7a"",""3ef30c95e40a854cc4ded94fc503d0c3dc3e620e"",""6debce728bcff73d9d1d334df0c6b1c3735e295c"",""a804ebec7e341b4d98d9e94f6e4860a55ea1638d"",""b2f955b3e6107f831ebe67997f8586d4fe9f3e98"",""cc65bf60600b64feece5575f21ab89e03a728332"") OR hashMD5 IN (""04a88f5974caa621cee18f34300fc08a"",""0f16a43f7989034641fd2de3eb268bf1"",""10f3679384a03cb487bda9621ceb5f90"",""6fcf56f6ca3210ec397e55f727353c4a"",""909f3fc221acbe999483c87d9ead024a"",""ee6b1a79cb6641aa44c762ee90786fe0"")) |
| Outbreak: Router Malware Attack Detected on Host | Security | Router malware attack using various older router vulns still being exploited in the wild detected (CVE-2019-10891, CVE-2018-10562, CVE-2018-10561, CVE-2015-2051) on host. Details: https://www.fortiguard.com/outbreak-alert/router-malware-attack | Outbreak: Router Malware Attack Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND ipsSignatureId IN (10085987,10117488,7194143,10102081,10077186) |
| Outbreak: Win32k Elevation of Privilege Vulnerability Detected on Host | Security | A Fortinet product has detected an exploit related to CVE-2022-21882 on a host | Outbreak: Win32k Elevation of Privilege Vulnerability Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId = 70134 |
| Outbound Traffic to Unapproved Public DNS Servers | Security | Detects DNS name resolution via uncommon public DNS servers - Google DNS server is excluded - this is a typical violation of corporate policies. To prevent this rule from creating false positives, make sure that the CMDB Group: Approved Public DNS Server is populated according to corporate policies. | Outbound Traffic to Unapproved Public DNS Servers | destIpPort = 53 AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_PUBLIC_DNS,Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET,Group@PH_SYS_APP_DNS_SERVER) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic,Group@PH_SYS_EVENT_CommonDNSTraffic,Group@PH_SYS_EVENT_UncommonDNSTraffic) |
| Otorio RAM2 Alert has Triggered | Security | RAM2 has triggered a high or critical severity alert, excludes vulnerabilities discovered and generic events | Otorio RAM2 Alert has Triggered | reptVendor = ""Otorio"" AND eventType != ""Otorio-RAM2-Generic"" AND eventType != ""Otorio-RAM2-vulnerabilities_discovered"" AND eventSeverity >= 9 |
| Outbreak: Zimbra Collaboration Mboximport Vulnerability on Network | Security | Zimbra Collaboration Mboximport Vulnerability (CVE-2022-27925, CVE-2022-37042) detected on network | Outbreak: Zimbra Collaboration Mboximport Vulnerability on Network | eventType IN (""FortiGate-ips-signature-51994"",""FortiProxy-ips-signature-51994"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (51994,10101477,10101326,10101454) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Permitted Blacklisted Source | Security | Detects that a blacklisted source of moderate or higher severity is permitted into the network by Cisco ASA firewall Botnet filter | Permitted Blacklisted Source | eventType IN (""ASA-338001"",""ASA-338003"",""ASA-338201"") AND threatLevel IN (""moderate"", ""high"", ""very-high"") |
| Windows: InstallerFileTakeOver LPE CVE-2021-41379 File Create Event | Security | Detects signs of the exploitation of LPE CVE-2021-41379 that include an msiexec process that creates an elevation_service.exe file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_cve_2021_41379_msi_lpe.yml | Windows: InstallerFileTakeOver LPE CVE-2021-41379 File Create Event | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\msiexec\.exe"" AND fileName REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\Edge\\Application.*"" AND fileName REGEXP "".*\\elevation_service\.exe"" |
| Windows: Vulnerable Dell BIOS Update Driver Load | Security | Detects the load of the vulnerable Dell BIOS update driver as reported in CVE-2021-21551. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_win_vuln_dell_driver.yml | Windows: Vulnerable Dell BIOS Update Driver Load | eventType=""Win-Sysmon-6-Driver-Loaded"" AND (loadedProcName REGEXP "".*\\DBUtil_2_3\.Sys.*"" OR hashCode REGEXP "".*MD5=C996D7971C49252C582171D9380360F2.*|.*MD5=D2FD132AB7BBC6BBB87A84F026FA0244.*|.*SHA1=10B30BDEE43B3A2EC4AA63375577ADE650269D25.*|.*SHA1=C948AE14761095E4D76B55D9DE86412258BE7AFD.*|.*SHA256=0296E2CE999E67C76352613A718E11516FE1B0EFC3FFDB8918FC999DD76A73A5.*|.*SHA256=DDBF5ECCA5C8086AFDE1FB4F551E9E6400E94F4428FE7FB5559DA5CFFA654CC1.*"" OR hashSHA256 IN (""0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5"",""ddbf5ecca5c8086afde1fb4f551e9e6400e94f4428fe7fb5559da5cffa654cc1"") OR hashSHA1 IN (""10b30bdee43b3a2ec4aa63375577ade650269d25"",""c948ae14761095e4d76b55d9de86412258be7afd"") OR hashMD5 IN (""c996d7971c49252c582171d9380360f2"",""d2fd132ab7bbc6bbb87a84f026fa0244"")) |
| Windows: Addition of SID History to Active Directory Object | Security | An attacker can use the SID history attribute to gain additional privileges. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_add_sid_history.yml | Windows: Addition of SID History to Active Directory Object | eventType IN (""Win-Security-4765"",""Win-Security-4766"") OR ((eventType=""Win-Security-4738"" AND (essId NOT IN (""%%1793"",""-""))) AND (essId IS NOT NULL)) |
| Crowdstrike: Authentication Bypass | Security | Crowdstrike agent detected authentication bypass attempt | Crowdstrike: Authentication Bypass | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Authentication-Bypass"" |
| Outbreak: Active Directory Privilege Escalation Exploit Detected on Network | Security | A Fortinet product has detected an exploit related to CVE-2021-42287 or CVE-2021-42278 on network | Outbreak: Active Directory Privilege Escalation Exploit Detected on Network | eventType IN (""FortiGate-ips-signature-51057"",""FortiProxy-ips-signature-51057"") |
| Outbreak: Prestige Ransomware Detected on Network | Security | Prestige Ransomware detected on Network | Outbreak: Prestige Ransomware Detected on Network | eventType IN (Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND (ipsSignatureId = 10108353 OR virusName = ""W32/Filecoder\\.OMM!tr\\.ransom"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Microsoft Office Follina Vuln Detected on Host | Security | A Fortinet product has detected Microsoft Office Follina (CVE-2022-30190) Vuln on a host | Outbreak: Microsoft Office Follina Vuln Detected on Host | eventType IN (""FortiClient-vulnerabilityscan-vulnerability-record"",Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND (vulnId = 4402 OR ipsSignatureId IN (51578,10092097) OR virusName = ""MSWord/Agent.2E52!tr.dldr"") |
| Outbreak: Microsoft Exchange Autodiscover RCE ProxyNotShell Detected on Host | Security | Microsoft Exchange Autodiscover RCE (CVE-2022-41040, CVE-2022-41082) detected on a host | Outbreak: Microsoft Exchange Autodiscover RCE ProxyNotShell Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId = 4575 |
| Windows Disk controller problem | Disponibilidade | Detects windows disk controller issues | Windows Disk controller problem | eventType IN (""Win-System-Disk-11"",""Win-System-Disk-51"",""Win-System-Disk-57"") AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Warning NetApp Trap: can be auto cleared | Disponibilidade | Detects a medium severity trap from NetApp Filers. This trap can be cleared by a corresponding event. | Warning NetApp Trap: can be auto cleared | eventType CONTAIN ""NetApp-"" AND eventSeverityCat = ""Medium"" AND errorNo IS NOT NULL |
| Office365: Identity Protection Detected a Risky User or SignIn Activity | Security | Office365: Identity Protection Detected a Risky User or SignIn Activity. The possible values of Risk Name are unlikelyTravel, anonymizedIPAddress, maliciousIPAddress, unfamiliarFeatures, malwareInfectedIPAddress, suspiciousIPAddress, leakedCredentials, investigationsThreatIntelligence, generic, adminConfirmedUserCompromised, mcasImpossibleTravel, mcasSuspiciousInboxManipulationRules, investigationsThreatIntelligenceSigninLinked, maliciousIPAddressValidCredentialsBlockedIP, and unknownFutureValue. If the risk detection is a premium detection, will show generic | Office365: Identity Protection Detected a Risky User or SignIn Activity | eventType IN (""MS_OFFICE365_IdentityProtection_AtRisk_signin"",""MS_OFFICE365_IdentityProtection_AtRisk_user"") AND status IN (""atRisk"",""confirmedCompromised"") |
| Outbreak: Microsoft Exchange Autodiscover RCE ProxyNotShell Detected on Network | Security | Microsoft Exchange Autodiscover RCE (CVE-2022-41040, CVE-2022-41082) detected on Network | Outbreak: Microsoft Exchange Autodiscover RCE ProxyNotShell Detected on Network | eventType IN (""FortiGate-ips-signature-50584"",""FortiProxy-ips-signature-50584"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (50584,1090501428,1090501376) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Cisco ACI Node Health Critical | Performance | Detects that Cisco ACI Node health has reached a critical level | Cisco ACI Node Health Critical | eventType = ""Cisco_ACI_Node_Health"" |
| Unregistered EMC Clariion Host | Disponibilidade | Detects that a host has logged in but not registered | Unregistered EMC Clariion Host | eventType = ""PH_DEV_MON_CLARION_UNREG_HOST"" |
| Critical NetApp Trap | Disponibilidade | Detects a high severity trap from NetApp Filers | Critical NetApp Trap | eventType CONTAIN ""NetApp-"" AND eventSeverityCat = ""High"" AND errorNo IS NULL AND phEventCategory = 0 |
| Outbreak: Prestige Ransomware Detected on Host | Security | Prestige Ransomware detected on a host | Outbreak: Prestige Ransomware Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND (ipsSignatureId = 10108353 OR virusName = ""W32/Filecoder\\.OMM!tr\\.ransom"") |
| Phishing attack found but not remediated | Security | Detects that host anti-virus or content inspection devices found phishing attacks that it failed to remediate | Phishing attack found but not remediated | eventType IN (Group@PH_SYS_EVENT_Phish_Found) AND eventType NOT IN (Group@PH_SYS_EVENT_Phish_Remedy_Success) |
| Manual Service Started | Disponibilidade | Detects that an manual mode service is started. Currently this works for windows servers and is detected via WMI. | Manual Service Started | eventType = ""PH_DEV_MON_MANUAL_SVC_STOP_TO_START"" |
| Windows: PUA - CsExec Execution | Security | Detects the use of the lesser known remote execution tool named CsExec a PsExec alternative. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_csexec.yml | Windows: PUA - CsExec Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\csexec\.exe"" OR description=""csexec"") |
| Cisco ACI Tenant Health Warning | Performance | Detects that Cisco ACI Tenant health has reached a warning level | Cisco ACI Tenant Health Warning | eventType = ""Cisco_ACI_Tenant_Health"" |
| Windows: VHD Image Download Via Browser | Security | Detects creation of "".vhd""/"".vhdx"" files by browser processes. Malware can use mountable Virtual Hard Disk "".vhd"" files to encapsulate payloads and evade security controls. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_vhd_download_via_browsers.yml | Windows: VHD Image Download Via Browser | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\MicrosoftEdge\.exe|.*\\brave\.exe|.*\\chrome\.exe|.*\\firefox\.exe|.*\\iexplore\.exe|.*\\maxthon\.exe|.*\\msedge\.exe|.*\\msedgewebview2\.exe|.*\\opera\.exe|.*\\safari\.exe|.*\\seamonkey\.exe|.*\\vivaldi\.exe|.*\\whale\.exe"" AND fileName REGEXP "".*\.vhd.*"" |
| Windows: Creation In User Word Statup Folder | Security | Detects the creation of an file in user Word Startup. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_winword_startup.yml | Windows: Creation In User Word Statup Folder | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\AppData\\Roaming\\Microsoft\\Word\\STARTUP\\.*"" AND (fileName NOT REGEXP "".*\.docb|.*\.docm|.*\.docx|.*\.dotm|.*\.dotx|.*\.pdf|.*\.wll|.*\.wwl"") |
| Windows: PsExec/PAExec Escalation to LOCAL SYSTEM | Security | Detects suspicious commandline flags used by PsExec and PAExec to escalate a command line to LOCAL_SYSTEM rights. PAExec is a remote administration tool designed as an alternative to Microsoft's PsExec. The tool is a small remote shell that includes functionality for copying files, remote execution, and fully interactive shell sessions with remote Windows machines without the need to install client software. It relies on the SMB protocol. The tool copies an executable to the hidden Admin$ share and then uses the Windows Service Control Manager API to start it as a service. The service uses named pipes, which connect back to the PAExec tool. It can be freely distributed. PAExec is self-contained and doesn't use an installer. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_psexec_paexec_escalate_system.yml | Windows: PsExec/PAExec Escalation to LOCAL SYSTEM | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* -i -s cmd.*|.* -i -s powershell.*|.* -i -s pwsh.*|.* -i /s cmd.*|.* -i /s powershell.*|.* -i /s pwsh.*|.* -s -i cmd.*|.* -s -i powershell.*|.* -s -i pwsh.*|.* -s /i cmd.*|.* -s /i powershell.*|.* -s /i pwsh.*|.* -s cmd.*|.* -s powershell.*|.* -s pwsh.*|.* /i -s cmd.*|.* /i -s powershell.*|.* /i -s pwsh.*|.* /i /s cmd.*|.* /i /s powershell.*|.* /i /s pwsh.*|.* /s -i cmd.*|.* /s -i powershell.*|.* /s -i pwsh.*|.* /s /i cmd.*|.* /s /i powershell.*|.* /s /i pwsh.*|.* /s cmd.*|.* /s powershell.*|.* /s pwsh.*"" AND command REGEXP "".*accepteula.*|.*paexec.*|.*psexec.*"" |
| Warning NetApp Trap | Disponibilidade | Detects a medium severity trap from NetApp Filers | Warning NetApp Trap | eventType CONTAIN ""NetApp-"" AND eventSeverityCat = ""Medium"" AND errorNo IS NULL AND phEventCategory = 0 |
| Outbreak: Apache Commons Text RCE Vulnerability Detected on Network | Security | Apache Commons Text RCE Vulnerability (CVE-2022-42889) detected on Network | Outbreak: Apache Commons Text RCE Vulnerability Detected on Network | eventType IN (""FortiGate-ips-signature-52245"",""FortiProxy-ips-signature-52245"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Cisco ACI System Health Warning | Performance | Detects that Cisco ACI system health has reached a warning level | Cisco ACI System Health Warning | eventType = ""Cisco_ACI_Overall_Health"" |
| Cisco ACI Tenant Health Critical | Performance | Detects that Cisco ACI Tenant health has reached a critical level | Cisco ACI Tenant Health Critical | eventType = ""Cisco_ACI_Tenant_Health"" |
| Windows: Potential Privilege Escalation To LOCAL SYSTEM | Security | Detects unknown program using commandline flags usually used by tools such as PsExec and PAExec to start programs with SYSTEM Privileges. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_susp_psexec_paexec_flags_.yml | Windows: Potential Privilege Escalation To LOCAL SYSTEM | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* -i -s cmd.*|.* -i -s powershell.*|.* -i -s pwsh.*|.* -i /s cmd.*|.* -i /s powershell.*|.* -i /s pwsh.*|.* -s -i cmd.*|.* -s -i powershell.*|.* -s -i pwsh.*|.* -s /i cmd.*|.* -s /i powershell.*|.* -s /i pwsh.*|.* -s cmd.*|.* -s powershell.*|.* -s pwsh.*|.* /i -s cmd.*|.* /i -s powershell.*|.* /i -s pwsh.*|.* /i /s cmd.*|.* /i /s powershell.*|.* /i /s pwsh.*|.* /s -i cmd.*|.* /s -i powershell.*|.* /s -i pwsh.*|.* /s /i cmd.*|.* /s /i powershell.*|.* /s /i pwsh.*|.* /s cmd.*|.* /s powershell.*|.* /s pwsh.*"" AND (command NOT REGEXP "".*PsExec.*|.*accepteula.*|.*paexec.*"") |
| Office365: Abnormal Logon Detected | Security | An Office 365 logon from this user was found to be abnormal based on historic baselines | Office365: Abnormal Logon Detected | eventType = ""MS_OFFICE365_abnormal_o365_logon"" |
| Critical NetApp Trap: can be auto cleared | Disponibilidade | Detects a high severity trap from NetApp Filers. This trap can be cleared by a corresponding event. | Critical NetApp Trap: can be auto cleared | eventType CONTAIN ""NetApp-"" AND eventSeverityCat = ""High"" AND errorNo IS NOT NULL AND phEventCategory = 0 |
| Cisco ACI System Health Critical | Performance | Detects that Cisco ACI System health has reached a critical level | Cisco ACI System Health Critical | eventType = ""Cisco_ACI_Overall_Health"" |
| Linux: Nping Process Activity | Security | Nping Process Activity detected. Nping is part of the Nmap tool suite and has the ability to construct raw packets for a wide variety of security testing applications, including denial of service testing. This requires process monitoring via FortiSIEM Linux agent. | Linux: Nping Process Activity | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""nping"" |
| Outbreak: Sysrv-K Botnet Activity Detected on Host | Security | A Fortinet product has detected Sysrv-K botnet Activity activity on a host | Outbreak: Sysrv-K Botnet Activity Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND (ipsSignatureId = 10090470 OR virusName = ""Python/Sysrv_K.65EA!tr"") |
| Windows: Creation of an Executable by an Executable | Security | Detects the creation of an executable by another executable. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_dropper.yml | Windows: Creation of an Executable by an Executable | eventType=""Win-Sysmon-11-FileCreate"" AND (procName REGEXP "".*\.exe"" AND fileName REGEXP "".*\.exe"") AND ((procName NOT IN (""C:\\WINDOWS\\system32\\Dism.exe"",""C:\\WINDOWS\\system32\\dxgiadaptercache.exe"",""C:\\Windows\\System32\\msiexec.exe"",""C:\\Windows\\System32\\wuauclt.exe"",""C:\\Windows\\explorer.exe"",""C:\\Windows\\system32\\cleanmgr.exe"")) AND (procName!=""C:\\WINDOWS\\system32\\svchost.exe"" OR fileName NOT REGEXP ""C:\\Windows\\SoftwareDistribution\\Download\\.*"") AND (procName!=""C:\\Windows\\system32\\svchost.exe"" OR fileName NOT REGEXP "".*:\\WUDownloadCache\\.*"" OR fileName NOT REGEXP "".*\\WindowsUpdateBox\.exe.*"") AND (procName NOT REGEXP ""C:\\WINDOWS\\SoftwareDistribution\\Download\\.*"" OR procName NOT REGEXP "".*\\WindowsUpdateBox\.Exe"" OR fileName NOT REGEXP ""C:\\\$WINDOWS\.~BT\\Sources\\.*"") AND (procName NOT REGEXP ""C:\\Windows\\WinSxS\\.*"" OR procName NOT REGEXP "".*\\TiWorker\.exe"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"" AND fileName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"") AND (procName NOT REGEXP ""C:\\Program Files\\Windows Defender\\.*|C:\\ProgramData\\Microsoft\\Windows Defender\\.*"") AND (fileName NOT REGEXP "".*\\Microsoft\\WindowsApps\\.*"") AND (procName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams\\Update\.exe"" OR fileName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\SquirrelTemp\\tempb\\|.*\\AppData\\Local\\Microsoft\\Teams\\stage\\Squirrel\.exe|.*\\AppData\\Local\\Microsoft\\Teams\\stage\\Teams\.exe"") AND (procName NOT REGEXP ""C:\\Windows\\Microsoft\.NET\\Framework\\.*"" OR procName NOT REGEXP "".*\\mscorsvw\.exe"" OR fileName NOT REGEXP ""C:\\Windows\\assembly\\NativeImages_.*"") AND (procName NOT REGEXP "".*\\AppData\\Local\\.*"" OR procName NOT REGEXP "".*\\Microsoft VS Code\\Code\.exe"" OR fileName NOT REGEXP "".*\\\.vscode\\extensions\\.*"") AND (procName NOT REGEXP "".*\\AppData\\Local\\GitHubDesktop\\Update\.exe"" OR fileName NOT REGEXP "".*\\AppData\\Local\\SquirrelTemp\\.*"") AND (fileName NOT REGEXP ""C:\\WINDOWS\\TEMP\\.*"")) |
| Windows: Potential Execution of Sysinternals Tools | Security | Detects command lines that contain the 'accepteula' flag which could be a sign of execution of one of the Sysinternals tools. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_eula_accepted.yml | Windows: Potential Execution of Sysinternals Tools | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* -accepteula.*|.* /accepteula.*"" |
| Linux: NMAP Process Activity | Security | NMAP Process Activity detected. NMAP is a tool for network scanning and security testing. It can map and discover networks, and identify listening services and operating systems. It is sometimes used to gather information in support of exploitation, execution or lateral movement. Some normal use of this command may originate from security engineers and network or server administrators. Use of nmap by ordinary users is uncommon. This requires process monitoring via FortiSIEM Linux agent. | Linux: NMAP Process Activity | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""nmap"" |
| Cisco ACI Node Health Warning | Performance | Detects that Cisco ACI Node health has reached a warning level | Cisco ACI Node Health Warning | eventType = ""Cisco_ACI_Node_Health"" |
| Outbreak: Microsoft Office Follina Vuln Detected on Network | Security | A Fortinet product has detected Microsoft Office Follina (CVE-2022-30190) Vuln on network | Outbreak: Microsoft Office Follina Vuln Detected on Network | eventType IN (""FortiGate-ips-signature-51578"",""FortiProxy-ips-signature-51578"",Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND (ipsSignatureId IN (51578,10092097) OR virusName = ""MSWord/Agent.2E52!tr.dldr"") |
| Outbreak: Active Directory Privilege Escalation Exploit Detected on Host | Security | A Fortinet product has detected an exploit related to CVE-2021-42287 or CVE-2021-42278 on a host | Outbreak: Active Directory Privilege Escalation Exploit Detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND ipsSignatureId IN (69583,69598) |
| Cisco Call Manager Active Partition Disk Low | Performance | Percentage of available disk space on the active partition is lower than the configured value | Cisco Call Manager Active Partition Disk Low | eventType = ""Cisco_UC_RTMT_LowActivePartitionAvailableDiskSpace"" |
| Office365: Strong Authentication Disabled for a User | Security | Office365: Strong Authentication was disabled for a user. This is more commonly known as 2Factor Authentication, which can comprise several methods. | Office365: Strong Authentication Disabled for a User | eventType = ""MS_OFFICE365_EntraID_Disable_Strong_Authentication"" |
| Windows: Renamed SysInternals DebugView Execution | Security | Detects suspicious renamed SysInternals DebugView execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_sysinternals_debugview.yml | Windows: Renamed SysInternals DebugView Execution | eventType=""Win-Sysmon-1-Create-Process"" AND product=""Sysinternals DebugView"" AND (srcFileName!=""Dbgview.exe"" OR procName NOT REGEXP "".*\\Dbgview\.exe"") |
| Windows: PUA - Crassus Execution | Security | Detects Crassus a windows privilege escalation discovery tool based on PE metadata characteristics. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_crassus.yml | Windows: PUA - Crassus Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\Crassus\.exe"" OR srcFileName=""Crassus.exe"" OR description REGEXP "".*Crassus.*"") |
| Database Server Disk Latency Critical | Performance | Detects that database server disk I/O latency has reached a critical level (greater than 50 msec) based on 2 successive readings in a 10 minute interval | Database Server Disk Latency Critical | eventType = ""PH_DEV_MON_DISK_IO_UTIL"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND diskName NOT IN (""/boot"") AND hostIpAddr IN (Group@PH_SYS_APP_DATABASE_SERVER) |
| Windows: Potential PsExec Remote Execution | Security | Detects potential psexec command that initiate execution on a remote systems via common commandline flags used by the utility. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_psexec_remote_execution.yml | Windows: Potential PsExec Remote Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*accepteula.*"" AND command REGEXP "".* -u .*"" AND command REGEXP "".* -p .*"" AND command REGEXP "".* \\\\\.*"" |
| Oracle OCI: User SMTP Credentials Created | Security | Oracle OCI User SMTP Credential was created. Admin users can create keys, tokens, and credentials for other users, and some users are allowed to create these themselves. So the user and target user id may not always refer to the same account. | Oracle OCI: User SMTP Credentials Created | eventType = ""Oracle-OCI-identitycontrolplane-createsmtpcredential"" |
| Outbreak: Sysrv-K Botnet Activity Detected on Network | Security | A Fortinet product has detected Sysrv-K botnet activity on network | Outbreak: Sysrv-K Botnet Activity Detected on Network | eventType IN (""FortiGate-ips-signature-51275"",""FortiProxy-ips-signature-51275"") AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Cisco ACI Cluster Unavailable | Performance | Detects that Cisco ACI Cluster is not fully available | Cisco ACI Cluster Unavailable | eventType = ""Cisco_ACI_Cluster_Health"" AND (adminState != ""in-service"" OR operationalState != ""available"" OR healthState != ""fully-fit"") |
| Office365: Suspicious File Type Uploaded | Security | Office365 Detected A Supicious File Type was uploaded of type exe, cmd, bat, sh | Office365: Suspicious File Type Uploaded | eventType CONTAIN ""MS_OFFICE365"" AND opName = ""FileUploaded"" AND srcFileExt IN (""exe"",""cmd"",""bat"",""sh"") AND targetOsObjType = ""File"" |
| Cisco ACI Critical Fault | Disponibilidade | Detects a critical Cisco ACI fault | Cisco ACI Critical Fault | eventType =""Cisco_ACI_Fault_Record"" AND eventSeverity > 8 |
| Transient Windows Account Usage | Security | Detects that an account was created, used and then deleted within a short period of time. This is highly unusual activity and must be thoroughly investigated. | Transient Windows Account Usage | eventType IN (Group@PH_SYS_EVENT_HostLogonSuccess,Group@PH_SYS_EVENT_DomainLogonSuccess) |
| Transient Windows Account Usage | Security | Detects that an account was created, used and then deleted within a short period of time. This is highly unusual activity and must be thoroughly investigated. | Transient Windows Account Usage | eventType IN (Group@PH_SYS_EVENT_AccountDeleted) |
| UEBA AI detects unusual file download | Security | FortiSIEM UEBA AI module detects high confidence unusual file download by a user | UEBA AI detects unusual file download | eventType = ""FortiInsight-AiAlert-filedownloaded"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA AI detects unusual file writing | Security | FortiSIEM UEBA AI module detects high confidence unusual file writing by a user | UEBA AI detects unusual file writing | eventType = ""FortiInsight-AiAlert-filewritten"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects antivirus stopped | Security | FortiSIEM UEBA Policy detects antivirus stopped and no machine off following user will replace ccsvchst.exe | UEBA Policy detects antivirus stopped | eventType IN (""FINS-Windows-new-process-created"", ""FINS-Windows-machine-off"", ""FINS-Windows-user-logged-off"") AND (procName IS NULL OR procName = ""ccsvchst.exe"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco CallManager CDR High Disk Usage | Performance | CDR files disk usage exceeds the high water mark for disk allocation - some undelivered files got deleted | Cisco CallManager CDR High Disk Usage | eventType = ""Cisco_UC_RTMT_CDRHighWaterMarkExceeded"" |
| UEBA AI detects unusual process started | Security | FortiSIEM UEBA AI module detects high confidence unusual process started by a user | UEBA AI detects unusual process started | eventType = ""FortiInsight-AiAlert-processstarted"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA AI detects unusual file upload | Security | FortiSIEM UEBA AI module detects high confidence unusual file upload by a user | UEBA AI detects unusual file upload | eventType = ""FortiInsight-AiAlert-fileuploaded"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| MS 365 Defender: Generic Alert | Security | MS 365 Defender Alert - Generic | MS 365 Defender: Generic Alert | (eventType CONTAIN ""MS-Defender-Endpoint-Alert"" OR eventType CONTAIN ""M365Defender-Alert"") AND attackTechniqueId NOT IN (""T1055"",""T1036"",""T1105"",""T1003"",""T1003.001"",""T1007"",""T1016"",""T1053"",""T1057"",""T1059.001"") |
| MS 365 Defender: Incident Triggered | Security | Microsoft 365 Defender portal triggered an incident of severity medium, high, or unknown | MS 365 Defender: Incident Triggered | eventType CONTAIN ""M365Defender-Incident"" AND eventSeverityCat IN (""medium"",""high"",""unknown"") |
| LogonFailure | Other |  | LogonFailure | eventType IN (Group@PH_SYS_EVENT_LogonFailure) |
| Transient Windows Account Usage | Security | Detects that an account was created, used and then deleted within a short period of time. This is highly unusual activity and must be thoroughly investigated. | Transient Windows Account Usage | eventType IN (Group@PH_SYS_EVENT_AccountCreated) |
| Cisco Call Manager Spare Partition Disk Usage Warning | Performance | Percentage of available disk space on the spare partition is lower than the configured low water mark value | Cisco Call Manager Spare Partition Disk Usage Warning | eventType = ""Cisco_UC_RTMT_SparePartitionLowWaterMarkExceeded"" |
| Cisco Call Manager Spare Partition Disk Usage Critical | Performance | Percentage of available disk space on the spare partition is lower than the configured high water mark value | Cisco Call Manager Spare Partition Disk Usage Critical | eventType = ""Cisco_UC_RTMT_SparePartitionHighWaterMarkExceeded"" |
| UEBA AI detects unusual file creation | Security | FortiSIEM UEBA AI module detects high confidence unusual file Creation by a user | UEBA AI detects unusual file creation | eventType = ""FortiInsight-AiAlert-filecreated"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA AI detects unusual file printed | Security | FortiSIEM UEBA AI module detects high confidence unusual file printed by a user | UEBA AI detects unusual file printed | eventType = ""FortiInsight-AiAlert-fileprinted"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco Call Manager DDR Block Prevention | Disponibilidade | IDSReplicationFailure alarm with alarm number 31 occurs, which invokes a proactive procedure to avoid denial of service | Cisco Call Manager DDR Block Prevention | eventType = ""Cisco_UC_RTMT_DDRBlockPrevention"" |
| Multiple Logon Failures: Windows | Other | Detects occurrences of multiple logon failures at Windows Systems | Multiple Logon Failures: Windows | eventType IN (Group@PH_SYS_EVENT_LogonFailure) AND reptDevIpAddr = Group@PH_SYS_DEVICE_WINDOWS_SERVER |
| UEBA Policy detects antivirus stopped | Security | FortiSIEM UEBA Policy detects antivirus stopped and no machine off following user will replace ccsvchst.exe | UEBA Policy detects antivirus stopped | eventType = ""FINS-Windows-process-stopped"" AND procName = ""ccsvchst.exe"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA AI detects unusual file movement | Security | FortiSIEM UEBA AI module detects high confidence unusual file movement by a user | UEBA AI detects unusual file movement | eventType = ""FortiInsight-AiAlert-filemoved"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Layer 2 Switch Port Security Violation | Security | Detects that more than configured number of MAC addresses attempted to connect to the switch port. | Layer 2 Switch Port Security Violation | eventType IN (""IOS-PORT_SECURITY-SP-PSECURE_VIOLATION"",""Cisco-NxOS-PORT_SECURITY-PSECURE_VIOLATION"") |
| Cisco Call Manager Swap Disk Low | Performance | Percentage of available disk space on the swap partition is lower than the configured value | Cisco Call Manager Swap Disk Low | eventType = ""Cisco_UC_RTMT_LowSwapPartitionAvailableDiskSpace"" |
| UEBA AI detects unusual process created | Security | FortiSIEM UEBA AI module detects high confidence unusual process started by a user | UEBA AI detects unusual process created | eventType = ""FortiInsight-AiAlert-newprocesscreated"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco Unity Connection Disk utilization Warning | Performance | Cisco Unity Connection server disk utilization reaches 10 percent below the percentage limit set | Cisco Unity Connection Disk utilization Warning | eventType = ""Cisco_UC_RTMT_DiskConsumptionCloseToCapacityThreshold"" |
| UEBA AI detects unusual file deletion | Security | FortiSIEM UEBA AI module detects high confidence unusual file deletion by a user | UEBA AI detects unusual file deletion | eventType = ""FortiInsight-AiAlert-filedeleted"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Demo | Other | Demo1 | Demo | eventType IN (Group@PH_SYS_EVENT_PermitTraffic) |
| Cisco Unity Connection Disk utilization Critical | Performance | Cisco Unity Connection server disk utilization above the percentage limit set | Cisco Unity Connection Disk utilization Critical | eventType = ""Cisco_UC_RTMT_DiskConsumptionExceedsCapacityThreshold"" |
| Cisco CallManager Malicious Call Trace | Performance | Malicious call exists in Cisco Unified Communications Manager - the malicious call identification (MCID) feature gets invoked | Cisco CallManager Malicious Call Trace | eventType = ""Cisco_UC_RTMT_MaliciousCallTrace"" |
| UEBA AI detects unusual host logon | Security | FortiSIEM UEBA AI module detects high confidence unusual windows logon | UEBA AI detects unusual host logon | eventType = ""FortiInsight-AiAlert-userloggedon"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA AI detects unusual process stopped | Security | FortiSIEM UEBA AI module detects high confidence unusual process stoppage by a user | UEBA AI detects unusual process stopped | eventType = ""FortiInsight-AiAlert-processstopped"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA AI detects unusual user logoff | Security | FortiSIEM UEBA AI module detects high confidence unusual user logoff | UEBA AI detects unusual user logoff | eventType = ""FortiInsight-AiAlert-userloggedoff"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco Call Manager Certificate Mismatch | Disponibilidade | Certficate Mismatch between Cisco Unified Communications Manager and Enterprise License Manager | Cisco Call Manager Certificate Mismatch | eventType = ""Cisco_UC_JAVAAPPLICATIONS-CiscoSystemSecurityMismatch"" |
| UEBA AI detects unusual process not restarted | Security | FortiSIEM UEBA AI module detects high confidence unusual process not restarted by a user | UEBA AI detects unusual process not restarted | eventType = ""FortiInsight-AiAlert-processnotrestarted"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA AI detects unusual new drive mounted | Security | FortiSIEM UEBA AI module detects high confidence unusual new drive mounted by a user | UEBA AI detects unusual new drive mounted | eventType = ""FortiInsight-AiAlert-newdrivemounted"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA AI detects unusual drive unmounted | Security | FortiSIEM UEBA AI module detects high confidence unusual drive unmounted by a user | UEBA AI detects unusual drive unmounted | eventType = ""FortiInsight-AiAlert-driveunmounted"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects antivirus not started | Security | FortiSIEM UEBA Policy detects antivirus not started when machine switched on user will replace ccsvchst.exe | UEBA Policy detects antivirus not started | eventType IN (""FINS-Windows-new-process-created"", ""FINS-Windows-machine-off"") AND (procName IS NULL OR procName = ""ccsvchst.exe"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA AI detects unusual machine off | Security | FortiSIEM UEBA AI module detects high confidence unusual machine off behavior | UEBA AI detects unusual machine off | eventType = ""FortiInsight-AiAlert-machineoff"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco Call Manager Call Attempt Blocked By Policy | Security | A call was rejected or blocked because it violated the enterprise policy as defined in a policy decision point (PDP) that was configured in Unified CM | Cisco Call Manager Call Attempt Blocked By Policy | eventType = ""Cisco_UC_RTMT_CallAttemptBlockedByPolicy"" |
| Cisco Call Manager Inactive Partition Disk Low | Performance | Percentage of available disk space on the inactive partition is lower than the configured value | Cisco Call Manager Inactive Partition Disk Low | eventType = ""Cisco_UC_RTMT_LowInactivePartitionAvailableDiskSpace"" |
| UEBA AI detects unusual file renamed | Security | FortiSIEM UEBA AI module detects high confidence unusual file renamed by a user | UEBA AI detects unusual file renamed | eventType = ""FortiInsight-AiAlert-filerenamed"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco CallManager CDR Max Disk Usage Exceeded | Performance | CDR files disk usage exceeds the maximum disk allocation - some undelivered files got deleted | Cisco CallManager CDR Max Disk Usage Exceeded | eventType = ""Cisco_UC_RTMT_CDRMaximumDiskSpaceExceeded"" |
| UEBA AI detects unusual file reading | Security | FortiSIEM UEBA AI module detects high confidence unusual file reading by a user | UEBA AI detects unusual file reading | eventType = ""FortiInsight-AiAlert-fileread"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Windows Login Failures | Other | Suspicious Windows Login Events | Windows Login Failures | eventType IN (Group@PH_SYS_EVENT_LogonFailure) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) |
| Login Failures | Other | Login Failure | Login Failures | eventType IN (Group@PH_SYS_EVENT_LogonFailure) |
| UEBA Policy detects antivirus not started | Security | FortiSIEM UEBA Policy detects antivirus not started when machine switched on user will replace ccsvchst.exe | UEBA Policy detects antivirus not started | eventType = ""FINS-Windows-machine-on"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects backup applications | Security | FortiSIEM UEBA Policy detects backup applications | UEBA Policy detects backup applications | eventType = ""FINS-Windows-new-process-created"" AND procName IN (""applephotostreams.exe"", ""bbackup.exe"", ""box"", ""box.exe"", ""crashplandesktop.exe"", ""crashplanservice.exe"", ""crashplantray.exe"", ""dropbox"", ""dropbox.exe"", ""dropboxd"", ""filezilla"", ""filezilla.exe"", ""gdrive"", ""google drive"", ""googledrivesync.exe"", ""iclouddrive.exe"", ""onedrive.exe"", ""syncplicity.exe"", ""winscp.exe"") AND resourceName NOT REGEXP ""/applications/dropbox\.app/.*"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA AI detects unusual machine on | Security | FortiSIEM UEBA AI module detects high confidence unusual machine on behavior | UEBA AI detects unusual machine on | eventType = ""FortiInsight-AiAlert-machineon"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects ransomware | Security | FortiSIEM UEBA Policy detects ransomware | UEBA Policy detects ransomware | eventType = ""FINS-Windows-new-process-created"" AND fileName IN (""!dmalock"", "".31342e30362e32303136"", "".31392e30362e32303136_"", "".crypted_pony_test_build"", "".crypto"", "".cryptotorlocker"", "".cryptx"", "".delphimorix"", "".encrypted"", "".helppme@india.com."", "".hydracrypt"", "".hydracrypt_id"", "".hydracrypt_id_"", "".jundmd@cock.li"", "".king_ouroboros"", "".lanran"", "".locked-"", "".messenger-"", "".okean"", "".pc-funhacked"", "".personal_id"", "".qq_com"", "".r16m"", "".realfs0ciety"", "".ucftz"", "".ukr.net"", "".unbrecrypt_id_"", "".zypto"", "".~hl"", ""0nl1ne"", ""@adsoleware.com"", ""@gmail_com_"", ""@india.com"", ""[cryptservice@inbox.ru]"", ""[cryptsvc@mail.ru]."", ""_nullbyte"", ""blockbax"", ""decipher"", ""drakosho_new@aol.com"", ""files_are_encrypted."", ""fuga139gh@dr.com"", ""keemail.me"", ""king_ouroboros"", ""qq_com"", ""simmyware"", ""snowpicnic"", ""ukr.net"", ""want your files back."", ""want%syour%sfiles%sback."") |
| UEBA Policy detects snipping tool | Security | FortiSIEM UEBA Policy detects snipping tool | UEBA Policy detects snipping tool | eventType IN (""FINS-Windows-file-created"", ""FINS-Windows-file-renamed"", ""FINS-Windows-file-written"") AND procName IN (""grab"", ""screencapture"", ""snagit.exe"", ""snagpriv.exe"", ""snippingtool.exe"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects encryption tools | Security | FortiSIEM UEBA Policy detects encryption tools | UEBA Policy detects encryption tools | eventType = ""FINS-Windows-new-process-created"" AND procName IN (""bcrypt"", ""ccdecrypt"", ""ccrypt"", ""gpg"", ""gpg.exe"", ""openssl"", ""pgp"", ""pgp.exe"", ""truecrypt"", ""truecrypt.exe"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco Call Manager Not Connected To Enterprise License Manager | Disponibilidade | The system has not synchronized successfully to the Enterprise License Manager | Cisco Call Manager Not Connected To Enterprise License Manager | eventType = ""Cisco_UC_JAVAAPPLICATIONS-CiscoElmNotConnected"" |
| Cisco Call Manager System Version Mismatch | Disponibilidade | Detected a mismatch in system version | Cisco Call Manager System Version Mismatch | eventType = ""Cisco_UC_RTMT_SystemVersionMismatched"" |
| Radvision Hardware Removed/Swapped | Disponibilidade | Detects a card removed from/inserted into chassis under power, or when the gateway enters maintenance mode | Radvision Hardware Removed/Swapped | eventType = ""RV-cardExtractHotSwap"" AND eventAction = 0 |
| UEBA Policy detects gaming application | Security | FortiSIEM UEBA Policy detects gaming application | UEBA Policy detects gaming application | eventType = ""FINS-Windows-new-process-created"" AND procName IN (""hl2.exe"", ""minesweeper.exe"", ""origin.exe"", ""steam.exe"", ""uplay.exe"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UPS Battery Metrics Critical | Disponibilidade | Detects that key UPS operational metrics are outside of normal operational range | UPS Battery Metrics Critical | eventType = ""PH_DEV_MON_UPS_METRIC"" AND upsAdvOutputFreq IS NOT NULL AND upsAdvOutputVoltage IS NOT NULL |
| Cisco CallManager CDR File Delivery Failed | Disponibilidade | FTP delivery of CDR files to the outside billing server fails | Cisco CallManager CDR File Delivery Failed | eventType = ""Cisco_UC_RTMT_CDRFileDeliveryFailed"" |
| Cisco Call Manager Excessive Voice Quality Reports | Performance | Number of voice quality reports exceeds the configured threshold | Cisco Call Manager Excessive Voice Quality Reports | eventType = ""Cisco_UC_RTMT_ExcessiveVoiceQualityReports"" |
| UEBA Policy detects hacking tool usage | Security | FortiSIEM UEBA Policy detects hacking tool usage | UEBA Policy detects hacking tool usage | eventType = ""FINS-Windows-new-process-created"" AND procName IN (""metasploit"", ""metasploit.exe"", ""mimikatz.exe"", ""nc"", ""nc.exe"", ""ncat"", ""nmap"", ""nmap.exe"", ""oclhashcat"", ""psexec.exe"", ""psexecsvc.exe"", ""runas.exe"", ""tor browser"", ""tor browser.exe"", ""tor"", ""tor.exe"", ""tor.real"", ""wireshark"", ""wireshark.exe"", ""zenmap"", ""zenmap.exe"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco Call Manager System In Overage | Disponibilidade | The system is operating with an insufficient number of licenses. You will no longer be able to provision users and devices | Cisco Call Manager System In Overage | eventType = ""Cisco_UC_JAVAAPPLICATIONS-CiscoSystemInOverage"" |
| Radvision Corrupt video packets | Disponibilidade | Detects Corrupt or empty video packets present in the gateway | Radvision Corrupt video packets | eventType = ""RV-badVideo"" AND eventAction = 0 |
| UEBA Policy detects uncommon VPN client | Security | FortiSIEM UEBA Policy detects uncommon VPN usage | UEBA Policy detects uncommon VPN client | eventType CONTAIN ""FINS-Windows-"" AND procName IN (""cmw_srv.exe"", ""cyberghost.exe"", ""expressvpn.exe"", ""hola.exe"", ""hotspotshield.exe"", ""ipvanish.exe"", ""ipvanish.openvpn.exe"", ""main_vpn.exe"", ""nordvpn-service.exe"", ""open-vpn.exe"", ""openvpn.exe"", ""outlineservice.exe"", ""protonvpnservice.exe"", ""psiphon.exe"", ""psiphon3.exe"", ""purevpn.exe"", ""tbear.client.exe"", ""tor.exe"", ""vpn-unlimited.exe"", ""vpnclient.exe"", ""vyprvpn.exe"", ""windscribe.exe"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Radvision call setup issues | Disponibilidade | Detects call setup problems with peer gateways | Radvision call setup issues | eventType IN (""RV-peerCallRejected"",""RV-peerCallRejectedCapacity"",""RV-peerCallRejectedByAll"",""RV-peerCallFailedNoPeers"", ""RV-peerCallRejectedNonPeer"",""RV-maxHighLevelResMeter"") |
| UPS Battery Status Critical | Disponibilidade | Detects that key UPS battery status are reflecting critical state | UPS Battery Status Critical | eventType = ""PH_DEV_MON_UPS_METRIC"" AND (upsBatteryStatus = 3 OR upsBatteryStatus = 4 OR upsRemainBatteryChargePct < 50 OR upsTimeOnBattery >= 120 OR upsBasicOutputStatus != 2 OR upsReplaceBatteryIndicator = 2) |
| UEBA Policy detects cloud upload | Security | FortiSIEM UEBA Policy detects cloud upload | UEBA Policy detects cloud upload | eventType = ""FINS-Windows-file-read"" AND resourceName REGEXP ""[a-z]+:\\users\\.+\\(Dropbox|OneDrive|Google Drive)\\.+"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects NFS read | Security | FortiSIEM UEBA Policy detects NFS read | UEBA Policy detects NFS read | eventType = ""FINS-Windows-file-read"" AND resourceName REGEXP ""nfs:.*"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects file printed | Security | FortiSIEM UEBA Policy detects file printed | UEBA Policy detects file printed | eventType CONTAIN ""FINS-Windows-"" AND procName IN (""splwow64.exe"", ""spoolsv.exe"") AND resourceName CONTAIN ""spoolss"" AND resourceName NOT REGEXP ""c:/temp/.+\.tmp"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco CallManager CDR Agent Send Failed | Disponibilidade | CDR Agent cannot send CDR files from a CUCM node to a CDR repository node within the cluster. | Cisco CallManager CDR Agent Send Failed | eventType = ""Cisco_UC_RTMT_CDRAgentSendFileFailed"" |
| Cisco Call Manager Syslog Pattern Match | Disponibilidade | Found a syslog message with the matching string pattern | Cisco Call Manager Syslog Pattern Match | eventType = ""Cisco_UC_RTMT_SyslogStringMatchFound"" |
| UEBA Policy detects MTP read | Security | FortiSIEM UEBA Policy detects MTP read | UEBA Policy detects MTP read | eventType = ""FINS-Windows-file-read"" AND resourceName REGEXP ""(MTP|mtp):.*"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects nfs write | Security | FortiSIEM UEBA Policy detects nfs write | UEBA Policy detects nfs write | eventType CONTAIN ""FINS-Windows-file-"" AND activityName IN (""file deleted"", ""file moved"", ""file renamed"", ""file written"") AND resourceName REGEXP ""nfs:.*"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects ransomware file types | Security | FortiSIEM UEBA Policy detects ransomware file types | UEBA Policy detects ransomware file types | eventType = ""FINS-Windows-file-created"" AND fileExt IS NOT NULL AND fileExt IN ("".!emc"", ""#"", ""##___policja!!!___ten_plik_zosta"", ""##encrypted_by_pablukl0cker##"", ""#__encrypted_by_dzikussst3am_ransomware!__#"", ""#locky"", ""0000"", ""010001"", ""0402"", ""0wn3dyou"", ""0x0"", ""0x004867"", ""0x009d8a"", ""101"", ""1999"", ""1btc"", ""1txt"", ""24h"", ""2cxpcihgsvxb3"", ""2lwnpp2b"", ""2xx9"", ""3301"", ""3ncry"", ""3ncrypt3d"", ""3p7m"", ""3rnu"", ""449o43"", ""490"", ""491"", ""492"", ""4rwcry4w"", ""4x82n"", ""63vc4"", ""666"", ""6db8"", ""6fkr8d"", ""707"", ""725"", ""726"", ""73i87a"", ""777"", ""7h9r"", ""7zipper"", ""8637"", ""888"", ""8lock8"", ""911"", ""96e2"", ""@decrypt2017"", ""@decrypt_2017"", ""[id62133703]"", ""[papillon9275]"", ""__dilmav1"", ""_airacropencrypted!"", ""_ryp"", ""a19"", ""a5zfn"", ""a604af9070"", ""a990"", ""a9v9ahu4"", ""aaa"", ""aajf"", ""abc"", ""acc"", ""actum"", ""adam"", ""adk"", ""adobe"", ""adobee"", ""adolfhitler"", ""adr"", ""aes!"", ""aes"", ""aes-ni"", ""aes256"", ""aes_ni"", ""aes_ni_0day"", ""aesir"", ""afd"", ""aga"", ""airacropencrypted!"", ""akaibvn"", ""akira"", ""alcatraz"", ""aleta"", ""alfablock"", ""alien"", ""alkohol"", ""allcry"", ""alosia"", ""am"", ""amba"", ""amber"", ""amnesia"", ""anami"", ""andonio"", ""android"", ""andymarvin"", ""angelamerkel"", ""angleware"", ""animus"", ""annabelle"", ""annabelle2"", ""anon"", ""anonymous"", ""antihacker2017"", ""anubi"", ""ap19"", ""aqva"", ""area"", ""arena"", ""areyoulovemyrans"", ""areyoulovemyransfile"", ""armadilo1"", ""armage"", ""arpt"", ""arrow"", ""artemy"", ""asasin"", ""asdasdasd"", ""atlas"", ""atom"", ""au1crypt"", ""audit"", ""auf"", ""aurora"", ""axx"", ""azer"", ""b0ff"", ""b10cked"", ""b29"", ""b5c6"", ""b89b"", ""backup"", ""badnews"", ""bagi"", ""balozin"", ""bam!"", ""bananacrypt"", ""barracuda"", ""barrax"", ""bart"", ""basslock"", ""bawsuooxe"", ""bbqb"", ""bdkr"", ""bear"", ""beef"", ""beep"", ""beer"", ""beethoven"", ""belgian_cocoa"", ""betta"", ""better_call_saul"", ""bgtx"", ""big1"", ""big4+"", ""bill_clinton@derpymailorg"", ""billingsupp"", ""bip"", ""birbb"", ""bit"", ""bitconnect"", ""bitkangoroo"", ""bitstak"", ""bizer"", ""bkp"", ""black007"", ""blackhat"", ""blackpink"", ""blackrouter"", ""blackruby"", ""blank"", ""bleep"", ""bleepyourfiles"", ""blind"", ""blind2"", ""bloc"", ""blocatto"", ""bloccato"", ""block"", ""block_file12"", ""blocked"", ""blocked2"", ""bloked"", ""blower"", ""bmcode"", ""bomber"", ""bonum"", ""booknish"", ""boost"", ""boris"", ""braincrypt"", ""brcrypt"", ""breaking bad"", ""breaking_bad"", ""breeding123"", ""brickr"", ""bript"", ""brrr"", ""brt92"", ""btc -help-you"", ""btc"", ""btc-help-you"", ""btcbtcbtc"", ""btcking"", ""btcware"", ""bugware"", ""bunny"", ""bush"", ""bvjznsjlo"", ""c0rp0r@c@0xr@"", ""cammora"", ""canihelpyou"", ""cassetto"", ""cawwcca"", ""cbf"", ""cbu1"", ""ccc"", ""cccmn"", ""cccrrrppp"", ""cdrpt"", ""ceber3"", ""cekisan"", ""cerber"", ""cerber2"", ""cerber3"", ""cerber6"", ""cerbersyslocked0009881"", ""cesar"", ""cezar"", ""cfk"", ""cfm"", ""chak"", ""charck"", ""charcl"", ""charm"", ""chartogy"", ""che808"", ""chech"", ""checkdiskenced"", ""chifrator@qq_com"", ""chip"", ""choda"", ""christmas"", ""cifgksaffsfyghd"", ""ciop"", ""ck"", ""clf"", ""clinton"", ""clop"", ""cloud"", ""cmb"", ""cmsnwned"", ""cnc"", ""cobra"", ""cockista"", ""code"", ""coded"", ""coin"", ""combo"", ""commonransom"", ""comrade"", ""conficker"", ""contactus"", ""corrupted"", ""country82000"", ""coverton"", ""cqxgpmknr"", ""cr020801"", ""crab"", ""crabs"", ""cradle"", ""crash"", ""crashed"", ""crazy"", ""creeper"", ""crh8"", ""crime"", ""crinf"", ""cripted"", ""criptiko"", ""criptokod"", ""cripton"", ""cripttt"", ""crjocker"", ""crjoker"", ""crptd"", ""crptrgr"", ""crptxxx"", ""crrrt"", ""cry"", ""cry128"", ""cry36"", ""cry9"", ""crybrazil"", ""crying"", ""cryp1"", ""crypt"", ""crypt1"", ""crypt12"", ""crypt2019"", ""crypt38"", ""crypt888"", ""crypte"", ""crypted"", ""crypted000007"", ""crypted034"", ""crypted_bizarrio@pay4me_in"", ""crypted_file"", ""crypted_marztoneb@tutanota_de"", ""crypted_pony_test_build_xxx_xxx_xxx_xxx_xxx"", ""cryptedopps"", ""cryptes"", ""cryptfile"", ""cryptgh0st"", ""crypto"", ""cryptoboss"", ""cryptobyte"", ""cryptojoker"", ""cryptolocker"", ""crypton"", ""cryptonar"", ""cryptoshiel"", ""cryptoshield"", ""cryptotorlocker2015!"", ""cryptowall"", ""cryptowin"", ""cryptr"", ""crypttt"", ""cryptwalker"", ""cryptz"", ""crypz"", ""crysis"", ""cspider"", ""ctb2"", ""ctbl"", ""ctbl2"", ""cyberdrill"", ""cybergod"", ""cybersccp"", ""cybersoldiersst"", ""cyclone"", ""cypher"", ""cyron"", ""czvxce"", ""d2550a49bf52dfc23f2c013c5"", ""d3g1d5"", ""d4nk"", ""da_vinci_code"", ""dale"", ""damage"", ""damoclis"", ""danger"", ""darkcry"", ""darkness"", ""data_is_safe_you_need_to_make_the_payment_in_maxim_24_hours_or_all_your_files_will_be_lost_forever_please_be_rezonable_is_not_a_joke_time_is_limited"", ""datastop"", ""datawait"", ""david"", ""dcry"", ""dcrypt"", ""ddpcbi"", ""decodeme666@tutanota_com"", ""decodeme666tutanota_com"", ""decrypt2017"", ""decryptgarranty"", ""decryptional"", ""ded"", ""dedo"", ""deep"", ""defender"", ""delphimorix!@@@@_@@_@_2018_@@@_@_@_@@@"", ""demonslay335_you_cannot_decrypt_me!"", ""deria"", ""desu"", ""desync"", ""deuscrypt"", ""dexter"", ""dfjhsalfhsakljfhsljkahfdjklashfdjklh"", ""dg"", ""dharma"", ""dhdr4"", ""diablo6"", ""dian"", ""die"", ""diskdoctor"", ""disposed2017"", ""divine"", ""djuvq"", ""djvup"", ""djvuq"", ""djvur"", ""djvus"", ""djvut"", ""djvuu"", ""dlenggrl"", ""dolphin"", ""domino"", ""donut"", ""doomed"", ""doples"", ""doubleoffset"", ""doxes"", ""dqxoo"", ""dragnea"", ""dream"", ""ds335"", ""ducueyuav"", ""duhust"", ""dviide"", ""dwbiwty"", ""dxjay"", ""dxxd"", ""dy8wud"", ""dyaaghemy"", ""dyatel@qq_com"", ""e4m"", ""ebay"", ""ecc"", ""eclr"", ""eddldzor"", ""edgel"", ""egg"", ""eky"", ""elpvd"", ""eman"", ""eman50"", ""embrace"", ""emilysupp"", ""empty"", ""enc"", ""encedrsa"", ""encencenc"", ""enciphered"", ""encmywork"", ""encoderpass"", ""encr"", ""encrptd"", ""encrypt"", ""encrypted"", ""encrypted5"", ""encryptedaes"", ""encryptedped"", ""encryptedrsa"", ""encryptedyourfiles"", ""encryptile"", ""enigma"", ""enjey"", ""enter"", ""enybenied"", ""eoeo"", ""epic"", ""epoblockl"", ""eqtz"", ""error"", ""eternity"", ""ev"", ""evil"", ""evillock"", ""evolution"", ""evopro"", ""excuses"", ""executioner"", ""exotic"", ""exploit"", ""explorer"", ""exte"", ""exx"", ""ezz"", ""ezzyl"", ""facebook"", ""failedaccess"", ""fairytail"", ""fake"", ""fantom"", ""fartplz"", ""fast"", ""fastbob"", ""fat32"", ""fbuvkngy"", ""fcrypt"", ""fff"", ""file"", ""file0locked"", ""filegofprencrp"", ""fileiscryptedhard"", ""filesfucked"", ""fileslack"", ""filgzmsp"", ""filock"", ""fire"", ""firecrypt"", ""firmabilgileri"", ""fix"", ""fixt"", ""fj7qvar9vumi"", ""flat"", ""flux"", ""flyper"", ""fmoon"", ""fox"", ""freefoam"", ""frend"", ""frendi"", ""frivolity"", ""frmvrlr2017"", ""frs"", ""frtrss"", ""fsdfsdfsdfsdfsdfsfdsfs"", ""fuck"", ""fuck_you"", ""fuck_you_av_we_are_not_globe_fake"", ""fucked"", ""fuckedbyghost"", ""fucku"", ""fuckyourdata"", ""fun"", ""funny"", ""g8xb"", ""g^od"", ""game"", ""gamma"", ""gangbang"", ""ganklocked"", ""garcewa"", ""garrantydecrypt"", ""gblock"", ""gdb"", ""gdcb"", ""gefest"", ""gefest3"", ""gefickt"", ""gembok"", ""gerber5"", ""getrekt"", ""gg"", ""ghost"", ""gigahertz"", ""gillette"", ""globe"", ""gman"", ""gmbn"", ""gmpf"", ""gocr"", ""godra"", ""goforhelp"", ""gommemode"", ""good"", ""gorilla"", ""gotham"", ""gotya"", ""gr3g"", ""granny"", ""granosinsa"", ""grhan"", ""grt"", ""grujars"", ""grux"", ""gruzin@qq_com"", ""gryphon"", ""gsupport3"", ""gui"", ""gws"", ""h3ll"", ""h_f_d_locked"", ""ha3"", ""hac"", ""hacked"", ""hakunamatata"", ""hannah"", ""happ"", ""happenencedfiles"", ""happy"", ""happydayzz"", ""happyness"", ""harzhuangzi"", ""hasp"", ""haters"", ""hb15"", ""hcked"", ""heets"", ""heisenberg"", ""hello"", ""helpdecrypt@ukr_net"", ""helpmeencedfiles"", ""herbst"", ""heroesofthestorm"", ""hhfehiol"", ""hilegofprencrp"", ""hitler"", ""hncdumn"", ""hncrypt"", ""hnumkhotep"", ""hnyear"", ""honor"", ""horros"", ""horsuke"", ""howcanihelpusir"", ""hrm"", ""htrs"", ""hush"", ""hyena"", ""i'want money"", ""iaufkakfhsaraf"", ""id-3044989498_x3m"", ""ifuckedyou"", ""igotyou"", ""igza4c"", ""ihsdj"", ""illnest"", ""iloveworld"", ""impect"", ""improved"", ""imsorry"", ""incanto"", ""incpas"", ""indrik"", ""infected"", ""infileshop@gmail_com_id44"", ""infinite"", ""infowait"", ""insane"", ""insta"", ""invaded"", ""ipcrestore"", ""ipygh"", ""ironhead"", ""isis"", ""ispfv"", ""israbye"", ""itlock"", ""iudgkwv"", ""iwant"", ""iwanthelpuuu"", ""jaff"", ""james"", ""jamper"", ""jcry"", ""jeepers"", ""jes"", ""jewsomware"", ""jey"", ""jezroz"", ""jfcwf"", ""jimm"", ""jkouogvg"", ""jodis"", ""josep"", ""jse"", ""jungle@anonymousspechcom"", ""junked"", ""jupstb"", ""justbtcwillhelpyou"", ""justice"", ""k0stya"", ""k8vfiz"", ""kali"", ""karls"", ""karne"", ""katipuneros"", ""katyusha"", ""kb15"", ""kcwenc"", ""kee"", ""keepcalm"", ""kencf"", ""kernel_complete"", ""kernel_pid"", ""kernel_time"", ""keybtc@inbox"", ""keybtc@inbox_com"", ""keyh0les"", ""keyholes"", ""keypass"", ""keyz"", ""kezoz"", ""kg9ex"", ""kgpvwnr"", ""kilit"", ""kill"", ""killedxxx"", ""kimchenyn"", ""kimcilware"", ""kirked"", ""kitty"", ""kk"", ""kkk"", ""klope"", ""kok"", ""kok08"", ""kok8"", ""korea"", ""koreagame"", ""korrektor"", ""kostya"", ""kr3"", ""krab"", ""kraken"", ""kratos"", ""kraussmfz"", ""kropun"", ""kroput"", ""kroput1"", ""krypted"", ""kryptonite"", ""krzffw"", ""ktuhzxpi"", ""kuajw"", ""kuntzware"", ""kvllyatprotonmaildotch"", ""kwaaklocked"", ""kyra"", ""l0cked"", ""l1ll"", ""lalabitch,"", ""lambda_l0cked"", ""lamo"", ""lckd"", ""lcked"", ""lechiffre"", ""leen"", ""leenapidx"", ""legion"", ""lego"", ""leon"", ""lesli"", ""letmetrydecfiles"", ""lfk"", ""lgawpulm"", ""lightning"", ""like"", ""lime"", ""lin"", ""lock75"", ""lock93"", ""lockd"", ""locked"", ""locked-by-mafia"", ""locked3"", ""locked_by_mr_anonymous(tz_hackers)"", ""locked_by_pablukl0cker"", ""locked_file"", ""lockedfile"", ""lockedgood"", ""lockify"", ""locklock"", ""lockme"", ""lockout"", ""locky"", ""lockymap"", ""lokitus"", ""lol!"", ""lol"", ""loli"", ""lolita"", ""lolsec"", ""loptr"", ""lordofshadow"", ""losers"", ""lost"", ""loveransisgood"", ""lovewindows"", ""loveyou"", ""loveyouisreal"", ""ltml"", ""luceq"", ""luces"", ""lucky"", ""lukitus"", ""madebyadam"", ""mafee"", ""magic"", ""magic_software_syndicate"", ""maktub"", ""malki"", ""malwarehunterteam"", ""mamasitaq"", ""mammon"", ""maniac"", ""mariacbc"", ""master"", ""matrix"", ""maxicrypt"", ""maya"", ""maysomware"", ""mbrcodes"", ""mcafee"", ""mdk4y"", ""mecury"", ""medal"", ""mention9823"", ""mercury"", ""merry"", ""metan"", ""mich"", ""micro"", ""mikoyan"", ""mind"", ""mmm"", ""mole"", ""mole00"", ""mole01"", ""mole02"", ""mole03"", ""mole04"", ""mole66"", ""moments2900"", ""monro"", ""mordor"", ""mouse"", ""mrcr1"", ""msj"", ""mtc"", ""mtk118"", ""mtxlock"", ""mvp"", ""mychemicalromance4ever"", ""myjob"", ""myransext2017"", ""nalog@qq_com"", ""nano"", ""napoleon"", ""nazcrypt"", ""ndpyhss"", ""needdecrypt"", ""needkeys"", ""neitrino"", ""nemesis"", ""neptune"", ""netn6"", ""newrar"", ""news"", ""nigga"", ""nm4"", ""nmcrypt"", ""no_more_ransom"", ""no_more_ransomware"", ""nobad"", ""noblis"", ""nochance"", ""node0"", ""noob"", ""nopasaran"", ""noproblemwedecfiles"", ""nosafe"", ""nostro"", ""not"", ""not_open"", ""notfoundrans"", ""nozelesn"", ""nsmf"", ""nuclear"", ""nuclear55"", ""nuke55"", ""numberdot"", ""nutella"", ""nwcrypt"", ""obfuscated"", ""oblivion"", ""ocean"", ""odcodc"", ""odin"", ""ogonia"", ""ogre"", ""ohno!"", ""okokokokok"", ""olduw"", ""oled"", ""omerta"", ""omg!"", ""one-we_can-help_you"", ""oneway"", ""oni"", ""onion"", ""onlinesupport"", ""only-we_can-help_you"", ""onyon"", ""onyx"", ""oofnik"", ""oops"", ""oor"", ""oplata@qq_com"", ""ordinal"", ""oshit"", ""osiris"", ""osk"", ""oslawcmme"", ""otherinformation"", ""otr"", ""owned"", ""ox4444"", ""oxr"", ""p5tkjw"", ""pa-siem"", ""pablukcrypt"", ""pabluklocker"", ""padcrypt"", ""panda"", ""parrot"", ""pausa"", ""pay"", ""pay2me"", ""pay_in_maxim_24_hours_or_all_your_files_will_be_permanently_deleted_please_be_rezonable_you_have_only_1_single_chance_to_make_the_payment"", ""paybtcs"", ""paycoin"", ""paycyka"", ""payday"", ""payfordecrypt"", ""payforunlock"", ""paym"", ""paymds"", ""paymrss"", ""paymrts"", ""payms"", ""paymst"", ""paymts"", ""payransom"", ""payrms"", ""pays"", ""paytounlock"", ""pdcr"", ""pdff"", ""pedant"", ""pedo"", ""pegs1"", ""pennywise"", ""peosajwqfk"", ""petya"", ""pfanz"", ""phantom"", ""phobos"", ""pico"", ""pirate"", ""pizda@qq_com"", ""pizdec"", ""pizdosik"", ""pky"", ""planetary"", ""plant"", ""plauge17"", ""pleasecallqq"", ""plin"", ""pluto"", ""pnr"", ""poar2w"", ""pohu"", ""poolezoor"", ""porno"", ""pornoransom"", ""poshkoder"", ""potato"", ""powerfuldecrypt"", ""powerfulldecrypt"", ""powned"", ""poyvonm"", ""ppam"", ""pr0tect"", ""prcp"", ""predator"", ""privat66"", ""promock"", ""promorad"", ""promorad2"", ""promos"", ""promoz"", ""prosperous666"", ""protonis"", ""pscrypt"", ""psh"", ""ptgepvekm"", ""pulsar1"", ""puma"", ""pumax"", ""purge"", ""pwned"", ""pzdc"", ""qnbqw"", ""qwerty"", ""qweuirtksd"", ""qwex"", ""qwqd"", ""r16m01d05"", ""r3k7m9"", ""r3store"", ""r4a"", ""r4bb0l0ck"", ""r5a"", ""raas"", ""rad"", ""radamant"", ""raid10"", ""ram"", ""ramen"", ""rand"", ""ranranranran"", ""ranrans"", ""ransed"", ""ransom"", ""ransomaes"", ""ransomcrypt"", ""ransommine"", ""ransomwared"", ""rapid"", ""rare1"", ""rastakhiz"", ""rat"", ""razarac"", ""razy"", ""razy1337"", ""rcrypted"", ""rdm"", ""rdmk"", ""rdwf"", ""readme_txt"", ""reagan"", ""rebus"", ""recme"", ""recoveryourfiles"", ""redeye"", ""rekt"", ""relock@qq_com"", ""remind"", ""rensenware"", ""rent"", ""resurrection"", ""revenge"", ""revolution"", ""reyptson"", ""rip"", ""risk"", ""rjzuna"", ""rmcm1"", ""rnsmwr"", ""rnsmwre"", ""rokku"", ""rontok"", ""rose"", ""rpd"", ""rrk"", ""rsnslocked"", ""rsplited"", ""rsucozxze"", ""rtyrtyrty"", ""rumba"", ""rumblegoodboy"", ""ryk"", ""ryp"", ""ryx"", ""s1crypt"", ""sage"", ""saherblueeagleransomware"", ""salsa222"", ""same"", ""samsung"", ""sanction"", ""santana"", ""satan"", ""satana"", ""saturn"", ""satyr"", ""savefiles"", ""sblock"", ""scarab"", ""scl"", ""scorpio"", ""scorpion"", ""sdk"", ""sdwwbrb"", ""sea"", ""secure"", ""securecrypte"", ""securecrypted"", ""seed"", ""senrus17"", ""sepsis"", ""serp"", ""serpent"", ""server"", ""sevendays"", ""sexy"", ""sf"", ""sgood"", ""shadi"", ""shadow"", ""shark"", ""shifr"", ""shinigami"", ""shino"", ""shit"", ""shrug"", ""shrug2"", ""shutdown57"", ""shutupanddance"", ""sifreli"", ""sigrun"", ""sil3nt5pring"", ""silent"", ""sinta"", ""sjjpu"", ""skjdthghh"", ""skunk"", ""skvtb"", ""sky"", ""skype"", ""slav"", ""slvpawned"", ""snake"", ""snake4444"", ""snatch"", ""solo"", ""son"", ""sophos"", ""sorry"", ""spct"", ""spectre"", ""spider"", ""spora"", ""sport"", ""srpx"", ""sshxkej"", ""stinger"", ""stn"", ""stop"", ""stroman"", ""styver"", ""styx"", ""suffer"", ""supercrypt"", ""supported2017"", ""suppose666"", ""surprise"", ""suspended"", ""sux"", ""svn"", ""switch"", ""symbiom_ransomware_locked"", ""symmyware"", ""sysdown"", ""szesnl"", ""szf"", ""taronis"", ""tastylock"", ""tax"", ""tdelf"", ""technicy"", ""tedcrypt"", ""telebak"", ""tesla"", ""test"", ""tfude"", ""tfudeq"", ""tfudet"", ""tgif"", ""thanatos"", ""thda"", ""thetrumplockerf"", ""thetrumplockerp"", ""theva"", ""theworldisyours"", ""thor"", ""thunder"", ""tornado"", ""toxcrypt"", ""trans"", ""triple_m"", ""trmt"", ""tro"", ""tron"", ""troyancoder@qq_com"", ""true"", ""trump"", ""trun"", ""ttt"", ""tunca"", ""twist"", ""tzu"", ""udjvu"", ""udz2j8mv"", ""uik1j"", ""uiwix"", ""ukcza"", ""ukrain"", ""unavailable"", ""unit09"", ""unlis"", ""uselessfiles"", ""usr0"", ""uudjvu"", ""vaca"", ""vanss"", ""vapor"", ""vault"", ""vbransom"", ""vcrypt1"", ""vdul"", ""velikasrbija"", ""velso"", ""vendetta"", ""vendetta2"", ""venusf"", ""venusp"", ""vforvendetta"", ""via"", ""viiper"", ""viki"", ""vindows"", ""visioncrypt"", ""volcano"", ""vpgvlkb"", ""vrmrkz"", ""vscrypt"", ""vulston"", ""vvv"", ""vxlock"", ""w0yr8"", ""wallet"", ""wamarlocked"", ""wana decrypt0r trojan-syria editi0n"", ""wand"", ""wannacryv2"", ""warn_wallet"", ""wcry"", ""wcryt"", ""wdie"", ""weapologize"", ""weareyourfriends"", ""weencedufiles"", ""wflx"", ""whatthefuck"", ""whereisyourfiles"", ""why"", ""whycry"", ""wincry"", ""windows"", ""windows10"", ""wlu"", ""wmfxdqz"", ""wncry"", ""wncrypt"", ""wncryt"", ""wndie"", ""wnry"", ""wooly"", ""work"", ""wormcrypt0r"", ""wowreadfordecry"", ""wowreadfordecryp"", ""wowwhereismyfiles"", ""write"", ""write_on_email"", ""write_us_on_email"", ""wrny"", ""wsmile"", ""wtdi"", ""wtf"", ""wuciwug"", ""www"", ""wxdrjbgsda"", ""wyvern"", ""x0lzs3c"", ""x1881"", ""x3m"", ""x3mpro"", ""xbtl"", ""xcri"", ""xcry7684"", ""xcrypt"", ""xdata"", ""xero"", ""xfile"", ""xhspythxn"", ""xiaoba"", ""xiaoba1"", ""xiaoba10"", ""xiaoba11"", ""xiaoba12"", ""xiaoba13"", ""xiaoba14"", ""xiaoba15"", ""xiaoba16"", ""xiaoba17"", ""xiaoba18"", ""xiaoba19"", ""xiaoba2"", ""xiaoba20"", ""xiaoba21"", ""xiaoba22"", ""xiaoba23"", ""xiaoba24"", ""xiaoba25"", ""xiaoba26"", ""xiaoba27"", ""xiaoba28"", ""xiaoba29"", ""xiaoba3"", ""xiaoba30"", ""xiaoba31"", ""xiaoba32"", ""xiaoba33"", ""xiaoba34"", ""xiaoba4"", ""xiaoba5"", ""xiaoba6"", ""xiaoba7"", ""xiaoba8"", ""xiaoba9"", ""xmdxtazx"", ""xncrypt"", ""xolzsec"", ""xorist"", ""xort"", ""xrnt"", ""xrtn"", ""xtbl"", ""xuy"", ""xvnaw"", ""xwz"", ""xxx"", ""xxxxx"", ""xy6lr"", ""xyz"", ""xz"", ""xzzx"", ""yakes"", ""yatron"", ""yaya"", ""yiaqdg"", ""ykcol"", ""yl"", ""yoewy"", ""yolo"", ""you-are-fucked-by-baliluware-(coded-by-heropoint)"", ""youransom"", ""yourransom"", ""ytbl"", ""yyto"", ""z3r0"", ""z81928819"", ""zablokowane"", ""zayka"", ""zbt"", ""zc3791"", ""zcrypt"", ""zendr4"", ""zepto"", ""zilla"", ""zimbra"", ""zino"", ""ziqzqzdi"", ""zlpzdel"", ""zorro"", ""zuzya"", ""zw"", ""zxz"", ""zycrypt"", ""zyklon"", ""zzz"", ""zzz12"", ""zzzz"", ""zzzzz"", ""zzzzzzzz"", ""{cryptendblackdc}"", ""~xdata~"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects browser upload | Security | FortiSIEM UEBA Policy detects browser upload | UEBA Policy detects browser upload | eventType = ""FINS-Windows-file-read"" AND procName IN (""chrome"", ""chrome.exe"", ""chromium"", ""chromium.exe"", ""firefox"", ""firefox.exe"", ""flashutil_activex.exe"", ""google chrome"", ""iexplore.exe"", ""microsoftedge.exe"", ""opera.exe"", ""safari"", ""safari.exe"", ""webkit2webprocess.exe"") AND (fileExt IS NULL or fileExt NOT IN (""lnk"", ""url"", ""website"")) AND fileName NOT CONTAIN ""download"" AND fileName NOT REGEXP "".*(:favicon|:zone\.identifier)"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco Call Manager DRF Failed | Disponibilidade | DRF backup or restore process encounters errors | Cisco Call Manager DRF Failed | eventType = ""Cisco_UC_RTMT_CiscoDRFFailure"" |
| Cisco Call Manager Syslog Severity Match | Disponibilidade | Found a syslog message with the matching severity level | Cisco Call Manager Syslog Severity Match | eventType = ""Cisco_UC_RTMT_SyslogSeverityMatchFound"" |
| UEBA Policy detects potential leaver editing a CV at work | Security | FortiSIEM UEBA Policy detects potential leaver editing a CV at work | UEBA Policy detects potential leaver editing a CV at work | eventType CONTAIN ""FINS-Windows-file-"" AND fileName REGEXP "".+ (cv|resume).*\.(pdf|docx?)"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects software installation | Security | FortiSIEM UEBA Policy detects software installation | UEBA Policy detects software installation | eventType = ""FINS-Windows-new-process-created"" AND procName REGEXP "".*(install|msiexec|setup|update).*\.exe"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco Call Manager Excessive Active BLF subscriptions | Performance | Active BLF subscriptions exceeds the configured limit | Cisco Call Manager Excessive Active BLF subscriptions | eventType = ""Cisco_UC_RTMT_BeginThrottlingCallListBLFSubscriptions"" |
| UEBA Policy detects removable media read | Security | FortiSIEM UEBA Policy detects removable media read | UEBA Policy detects removable media read | eventType = ""FINS-Windows-file-read"" AND resourceName REGEXP ""(cd|rm):.*"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects hacking tool and footprints | Security | FortiSIEM UEBA Policy detects known hacking tool and footprints accessed by a user using explorer | UEBA Policy detects hacking tool and footprints | eventType CONTAIN ""FINS-Windows-"" AND procName = ""explorer.exe"" AND fileExt = ""exe"" AND resourceName REGEXP "".*(metasploit|mimikatz\.exe|ncat|nmap|oclhashcat|psexec|psexecsvc|tor browser|tor\.exe|tor\.real|wireshark|zenmap).*"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco Call Manager EMCC Failed In Remote Cluster | Disponibilidade | EMCC login failure at a remote Unified CM due to: User does not exist or not enabled for EMCC, no free EMCC base device, EMCC access was prevented by remote cluster, Untrusted certificate received from the remote end | Cisco Call Manager EMCC Failed In Remote Cluster | eventType = ""Cisco_UC_RTMT_EMCCFailedInRemoteCluster"" |
| Cisco Call Manager IME Service TLS Connection Failure | Disponibilidade | A TLS connection to the Cisco IME service could not be established because the certificate presented by the Cisco IME service has expired or is not in the Cisco Unified Communications Manager CTL | Cisco Call Manager IME Service TLS Connection Failure | eventType = ""Cisco_UC_RTMT_TLSConnectionToIMEFailed"" |
| UEBA Policy detects ransomware note | Security | FortiSIEM UEBA Policy detects ransomware note | UEBA Policy detects ransomware note | eventType CONTAIN ""FINS-Windows-"" AND fileName IN (""!! return files !!.txt"", ""!!! how to decrypt files !!!.txt"", ""!!! read this - important !!!.txt"", ""!!!!!save your files!!!!.txt"", ""!!!!restore_files!!!.txt"", ""!!!-warning-!!!.html"", ""!!!-warning-!!!.txt"", ""!!!getbackdata!!!.txt"", ""!!!read_it!!!.txt"", ""!!!read_to_unlock!!!.txt"", ""!!!readmetodecrypt.txt"", ""!!!save your files!.bmp"", ""!## decrypt files ##!.txt"", ""!#_decrypt_#!.inf"", ""!#_how_to_decrypt_files_#!"", ""!#_how_to_decrypt_files_$!.txt"", ""!=how_to_decrypt_files=!.txt"", ""!_!email__ prusa@goat.si __!..payman"", ""!____________deskrypt@tutamail.com________.rar"", ""!_how_recovery_files_!.txt"", ""!_recovery_help_!.txt"", ""!back_files!.html"", ""!gblock_info.rtf"", ""!ooopsyourfileslocked!.rtf"", ""!pedant_info!.rtf"", ""!please read me!.txt"", ""!read.htm"", ""!readme_gman!.rtf"", ""!readme_grhan!.rtf"", ""!satana!.txt"", ""!sblock_info!.rtf"", ""!wannadecryptor!.exe.lnk"", ""!where_are_my_files!.html"", ""# decrypt my files #.html"", ""# decrypt my files #.txt"", ""# decrypt my files #.vbs"", ""# how to decrypt files.txt"", ""# readme.hta"", ""###-read-for-hellpp.html"", ""#_#whatwrongwithmyfiles#_#.rtf"", ""#_decrypt_assistance_#.txt"", ""#_restoring_files_#.txt"", ""#help-decrypt-fcrypt1.1#.txt"", ""#how_decrypt_files#.html"", ""#how_to_unrip#.txt"", ""#newrar_readme#.rtf"", ""#readme_gman#.rtf"", ""#recovery_files#.txt"", ""$%%! note about files -=!-.html"", ""---readme---.txt"", "".[decryptor@cock.li].dcrtr"", ""000-if-you-want-dec-files.html"", ""000-no-problem-we-dec-files.html"", ""000-please-read-we-help.html"", ""0000-sorry-for-files.html"", ""00000000.eky"", ""00000000.pky"", ""00000000.res"", ""001-read-for-decrypt-files.html"", ""005-do-you-want-files.html"", ""009-read-for-decccc-filesss.html"", ""0_help_decrypt_files.htm"", ""131181494299235.bat"", ""170fb7438316.exe"", ""176641494574290.bat"", ""217201494590800.bat"", ""4-14-2016-infection.txt"", ""52036f92.tmp"", ""@decrypt_your_files.txt"", ""@please_read_me@.txt"", ""@wanadecryptor@.exe"", ""@wanadecryptor@.exe.lnk"", ""[amanda_sofost@india.com].wallet"", ""\""!ymayka-email@yahoo.com.cryptotes\"""", ""_adatok_visszaallitasahoz_utasitasok.txt"", ""_crypt"", ""_decrypt_info_szesnl.html"", ""_help_instruction.txt"", ""_help_instructions.bmp"", ""_help_instructions.txt"", ""_help_recover_files_.html"", ""_how_recover.txt"", ""_how_to_decrypt.bmp"", ""_howdo_text.html"", ""_interesting_informacion_for_decrypt.txt"", ""_iwashere.txt"", ""_locky_recover_instructions.bmp"", ""_locky_recover_instructions.txt"", ""_read_me_for_decrypt.txt"", ""_readme_.hta"", ""_recover_instructions.ini"", ""_ryp"", ""_secret_code.txt"", ""_what_is.html"", ""_xiaoba_info_.hta"", ""aari.jpg"", ""about_files.txt"", ""aescrypt.exe"", ""allcry_upx.exe"", ""anatova.exe"", ""anatova.txt"", ""assistance_in_recovery.txt"", ""atlas_files.txt"", ""attention!!!.txt"", ""attention.url"", ""bahij2@india.com"", ""bitcryptorfilelist.txt"", ""blooper.exe"", ""btc_decrypt_files.txt"", ""buyunlockcode"", ""buyunlockcode.txt"", ""callofcthulhu.exe"", ""clopreadme.txt"", ""coin.locker.txt"", ""como descriptografar seus arquivos.txt"", ""como_abrir_arquivos.txt"", ""como_restaurar_archivos.html"", ""como_restaurar_archivos.txt"", ""confirmation.key"", ""crjoker.html"", ""cryptinfo.txt"", ""cryptoransomware.exe"", ""crytp0l0cker.dll"", ""crytp0l0cker.exe"", ""crytp0l0cker.upack.dll"", ""cscc.dat"", ""cversions.2.db"", ""cyber splitter vbs.exe"", ""dale_files.txt"", ""de_crypt_readme.bmp"", ""de_crypt_readme.html"", ""de_crypt_readme.txt"", ""decoding help.hta"", ""decrypt explanations.html"", ""decrypt_info.txt"", ""decrypt_information.html"", ""decrypt_instruction.html"", ""decrypt_instruction.txt"", ""decrypt_instruction.url"", ""decrypt_instructions.html"", ""decrypt_instructions.txt"", ""decrypt_readme.txt"", ""decrypt_readme.txt.readme"", ""decrypt_readme1.txt"", ""decrypt_your_files.html"", ""decrypt_your_files.txt"", ""decryptallfiles.txt"", ""decrypted_files.dat"", ""decryptfile.txt"", ""decryption instructions.txt"", ""decryption.txt"", ""decryption_howto.notepad"", ""decypt_your_files.html"", ""default32643264.bmp"", ""default432643264.jpg"", ""desifrovani_pokyny.html"", ""desktoposiris.htm"", ""dispci.exe"", ""dllhost.dat"", ""ebay-msg.html"", ""ebay_was_here"", ""enc_files.txt"", ""encryptor_raas_readme_liesmich.txt"", ""enigma.hta"", ""enigma_encr.txt"", ""entschlusseln_hinweise.html"", ""exit.hhr.obleep"", ""fe04.tmp"", ""file decrypt help.html"", ""file0locked.js"", ""file_encryption_notice.txt"", ""files encrypted.html"", ""files encrypted.txt"", ""files.txt"", ""files_back.txt"", ""filesaregone.txt"", ""filesinfo.txt"", ""firstransomware.exe"", ""galaperidol.exe"", ""getyoufiles.txt"", ""gjenoppretting_av_filer.html"", ""gjenoppretting_av_filer.txt"", ""hacked_read_me_to_decrypt_files.html"", ""hello there! fellow @kee user!.txt"", ""hellothere.txt"", ""help decrypt.html"", ""help-file-decrypt.enc"", ""help-me-enced-files.html"", ""help_decrypt.html"", ""help_decrypt.lnk"", ""help_decrypt.png"", ""help_decrypt.txt"", ""help_decrypt.url"", ""help_decrypt_your_files.html"", ""help_me_please.txt"", ""help_recover_files.txt"", ""help_restore_files.txt"", ""help_to_decrypt.txt"", ""help_to_decrypt_your_files.txt"", ""help_to_save_files.bmp"", ""help_to_save_files.txt"", ""help_your_files.html"", ""help_your_files.png"", ""help_your_files.txt"", ""help_yourfiles.html"", ""helpdecrypt.txt"", ""helpdecyprt_your_files.html"", ""how decript files.hta"", ""how decrypt files.hta"", ""how decrypt my files.lnk"", ""how to decode files.hta"", ""how to decrypt aes files.lnk"", ""how to decrypt files.html"", ""how to decrypt files.txt"", ""how to decrypt lechiffre files.html"", ""how to decrypt your data.txt"", ""how to decrypt your files.jpg"", ""how to decrypt your files.txt"", ""how to decrypt.txt"", ""how to decrypt[1t0to].txt"", ""how to get back you files.txt"", ""how to get data back.txt"", ""how to get data.txt"", ""how to recover encrypted files-infovip@airmail.cc.txt"", ""how to recover encrypted files.txt"", ""how to restore files.hta"", ""how to restore files.txt"", ""how-to-decrypt-files.html"", ""how-to-restore-files.txt"", ""how_can_i_decrypt_my_files.txt"", ""how_decrypt.gif"", ""how_decrypt.html"", ""how_decrypt.txt"", ""how_decrypt.url"", ""how_decrypt_files#.html"", ""how_decrypt_files.hta"", ""how_decrypt_my_files"", ""how_open_files.hta"", ""how_return_files.txt"", ""how_to_back_files.html"", ""how_to_decrypt.html"", ""how_to_decrypt_files.html"", ""how_to_decrypt_files.txt"", ""how_to_decrypt_my_files.txt"", ""how_to_decrypt_your_files.jpg"", ""how_to_fix_!.txt"", ""how_to_recover_files.txt"", ""how_to_recver_files.txt"", ""how_to_restore_files.hta"", ""how_to_restore_files.html"", ""how_to_restore_files.txt"", ""how_to_restore_your_data.html"", ""howdecrypt.gif"", ""howdecrypt.txt"", ""howto_recover_file.txt"", ""howto_restore_files.html"", ""howto_restore_files.txt"", ""howtodecryptaesfiles.txt"", ""howtodecryptimportant!.txt"", ""howtorestore_files.txt"", ""hur_dekryptera_filer.html"", ""hur_dekryptera_filer.txt"", ""hvordan_du_gendanner_filer.html"", ""hvordan_du_gendanner_filer.txt"", ""hwid lock.exe"", ""iamreadytopay.txt"", ""if you want to get all your files back, please read this.txt"", ""if_want_files_back_pls_read.html"", ""if_you_want_to_get_all_your_files_back_please_read_this.txt"", ""ihaveyoursecret.key"", ""important read me.txt"", ""important!.txt"", ""important.readme"", ""important_read_me.txt"", ""info.hta"", ""infpub.dat"", ""install_tor.url"", ""instrucciones.txt"", ""instrucciones_descifrado.html"", ""instrucciones_descifrado.txt"", ""instruction for file recovery.txt"", ""instruction restore file.txt"", ""instruction_for_helping_file_recovery.txt"", ""instructionaga.txt"", ""instructions_de_decryptage.html"", ""instructions_xxxx.png"", ""istruzioni_decrittazione.html"", ""kryptolocker_readme.txt"", ""last_chance.txt"", ""lblbitcoininfomain.txt"", ""lblfinallytext.txt"", ""lblmain.txt"", ""leer_inmediatamente.txt"", ""leia_me.txt"", ""locked.bmp"", ""lukitus.html"", ""matrix-readme.rtf"", ""maxcrypt.bmp"", ""mensagem.txt"", ""merry_i_love_you_bruce.hta"", ""message.txt"", ""mood-ravishing-hd-wallpaper-142943312215.jpg"", ""note;!!!-odzyskaj-pliki-!!!.txt"", ""oksowathappendtoyourfiles.txt"", ""oku.txt"", ""okubeni.txt"", ""ontsleutelings_instructies.html"", ""ownertrust.txt"", ""padcrypt.exe"", ""padcryptuninstaller.exe"", ""paxynok.html"", ""paycrypt.bmp"", ""payment-instructions.txt"", ""payment_advice.mht"", ""payment_instructions.jpg"", ""perfect.sys"", ""petwrap.exe"", ""please read me!.txt"", ""please-readit-if_you-want.html"", ""popcorn_time.exe"", ""pronk.txt"", ""qeriuwjhrf"", ""qwer.html"", ""qwer2.html"", ""qwerty-pub.key"", ""rans0m_n0te_read_me.txt"", ""ransom.rtf"", ""ransomed.html"", ""read if you want your files back.html"", ""read me (how decrypt) !!!!.txt"", ""read me about decryption.txt"", ""read me for decrypt.txt"", ""read me for help thanks.txt"", ""read-read-read.html"", ""read.txt"", ""read@my.txt"", ""read__it.txt"", ""read_decrypt_files.txt"", ""read_it.txt"", ""read_it_for_get_your_file.txt"", ""read_me.html"", ""read_me_!.txt"", ""read_me_asap.txt"", ""read_me_help.png"", ""read_me_help.txt"", ""read_me_to_decrypt_you_informa.jjj"", ""read_this_file.txt"", ""read_this_file_1.txt"", ""read_this_to_decrypt.html"", ""read_to_decrypt.html"", ""readdecryptfileshere.txt"", ""readme how to decrypt your files.html"", ""readme!!!.txt"", ""readme-matrix.rtf"", ""readme.hta"", ""readme_decryptor.txt"", ""readme_for_decrypt.txt"", ""readme_how_to_unlock.html"", ""readme_how_to_unlock.txt"", ""readme_important.txt"", ""readme_liesmich_encryptor_raas.txt"", ""readme_restore_files.txt"", ""readme_to_recure_your_files.txt"", ""readthisnow!!!.txt"", ""receipt.exe"", ""recover-files.html"", ""recover.bmp"", ""recover.txt"", ""recovery_file.txt"", ""recovery_files.txt"", ""recovery_key.txt"", ""recupere seus arquivos aqui.txt"", ""redchip2.exe"", ""restore files.txt"", ""restore-.-files.txt"", ""restore-12345-files.txt"", ""restore_corupted_files.html"", ""restore_files.html"", ""restore_files.txt"", ""restore_icpicp_files.txt"", ""restore_maysomware_files.html"", ""restore_your_files.txt"", ""restorefiles.txt"", ""rtext.txt"", ""runsome.exe"", ""screenlocker_x86.dll"", ""secret.key"", ""secretidhere.key"", ""security-issue-info.txt"", ""shtodelatvam.txt"", ""sifre_coz_talimat.html"", ""sifre_cozme_talimati.html"", ""sintalocker.exe"", ""sintarun.py"", ""spreader_x86.dll"", ""ssexecutor_x86.exe"", ""strongcrypt.bmp"", ""struttergear.exe"", ""survey locker.exe"", ""svchosd.exe"", ""t.wry"", ""taskdl.exe"", ""taskhsvc.exe"", ""tasksche.exe"", ""taskse.exe"", ""tempimage.jpg"", ""thxforyurtyme.txt"", ""tor.exe"", ""totallylegit.exe"", ""tox.html"", ""trumphead.exe"", ""try-read-me-to-dec.html"", ""tutoriel.bmp"", ""unblockfiles.vbs"", ""unlock_files_instructions.html"", ""unlock_files_instructions.txt"", ""uselessdisk.exe"", ""vape launcher.exe"", ""vault.hta"", ""vault.key"", ""vault.txt"", ""vip72.exe"", ""wannacry.exe"", ""wannacry.txt"", ""wannacrypt 4.0.exe"", ""wcry.exe"", ""wcry.zip"", ""we-must-dec-files.html"", ""what happen to my files.txt"", ""whathappenedwithfiles.rtf"", ""whathappenedwithmyfiles.rtf"", ""where-your-files.html"", ""wie_zum_wiederherstellen_von_dateien.txt"", ""winclwp.jpg"", ""windowsapplication1.exe"", ""xort.txt"", ""you_must_read_me.rtf"", ""yougothacked.txt"", ""your files are locked !!!!.txt"", ""your files are locked !!!.txt"", ""your files are locked !!.txt"", ""your files are locked !.txt"", ""your files are now encrypted.txt"", ""your files encrypted by our friends !!! txt"", ""your files encrypted by our friends !!!.txt"", ""your_files.html"", ""your_files.url"", ""your_files_are_dead.hta"", ""your_files_are_encrypted.html"", ""your_files_are_encrypted.txt"", ""your_files_are_locked.txt"", ""your_key.rsa"", ""yourid.txt"", ""zcrypt.exe"", ""zenis-instructions.html"", ""zino_note.txt"", ""zxz.html"", ""zzzzzzzzzzzzzzzzzyyy"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects browser download | Security | FortiSIEM UEBA Policy detects browser download | UEBA Policy detects browser download | eventType CONTAIN ""FINS-Windows-file-"" AND activityName IN (""file created"", ""file moved"", ""file renamed"", ""file written"") AND procName IN (""chrome"", ""chrome.exe"", ""chromium"", ""chromium.exe"", ""firefox"", ""firefox.exe"", ""flashutil_activex.exe"", ""google chrome"", ""iexplore.exe"", ""microsoftedge.exe"", ""opera.exe"", ""safari"", ""safari.exe"", ""webkit2webprocess.exe"") AND (fileExt IS NULL OR fileExt NOT IN (""lnk"", ""url"")) AND resourceName NOT REGEXP "".*:zone\.identifier"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco Call Manager Core Dump File Found | Disponibilidade | A process likely crashed generating a coredump file | Cisco Call Manager Core Dump File Found | eventType = ""Cisco_UC_RTMT_CoreDumpFileFound"" |
| Cisco Call Manager Location Out Of Bandwidth | Disponibilidade | The Location or Link connecting locations has run out of audio/video/immersive bandwidth and hence no further calls can originate or pass through the location/link | Cisco Call Manager Location Out Of Bandwidth | eventType = ""Cisco_UC_Location Bandwidth Manager-LocationOutOfResource"" |
| Cisco CallManager Call Route List Exhausted | Performance | All available channels that are defined in the route list are busy | Cisco CallManager Call Route List Exhausted | eventType = ""Cisco_UC_RTMT_RouteListExhausted"" |
| UEBA Policy detects MTP write | Security | FortiSIEM UEBA Policy detects MTP write | UEBA Policy detects MTP write | eventType CONTAIN ""FINS-Windows-file-"" AND activityName IN (""file deleted"", ""file moved"", ""file renamed"", ""file written"") AND resourceName REGEXP ""(MTP|mtp):.*"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects malicious powershell execution | Security | FortiSIEM UEBA Policy detects malicious powershell execution | UEBA Policy detects malicious powershell execution | eventType CONTAIN ""FINS-Windows-"" AND procName = ""powershell.exe"" AND (swParam REGEXP "".*-[Ee^]{1,2}[ACDEMNOacdemno^]+ [A-Za-z0-9+\/=]{5,}.*"" OR swParam REGEXP "".*\\-[Ee^]{1,2}[CILNOPTUXYeilnoptuxy^]+ [ABPSYabpsy]{6,}.*"") AND (swParam NOT REGEXP "".*\\windows\\~\d+[a-z]+\.tmp$"") AND (swParam NOT REGEXP "".*\\\.cache.*$"") AND (swParam NOT REGEXP "".*\\windows\\WinSxS\\\S+\.+$"") AND (swParam != ""nfs:\\\\device\\mup\\localhost\\pipe\\eventlog"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects potential pirated media | Security | FortiSIEM UEBA Policy detects potential pirated media | UEBA Policy detects potential pirated media | eventType CONTAIN ""FINS-Windows-"" AND fileName REGEXP "".+((dvd|b([dr]|luray)|cam|hd|web)rip|(dvd|b[dr])scr|hdtv|webdl|ac3|webcap|x(vid|26[45])|yify).+"" AND fileExt IS NOT NULL AND fileExt IN (""avi"", ""f4b"", ""f4p"", ""f4v"", ""flv"", ""iso"", ""m2v"", ""m4p"", ""m4v"", ""magnet"", ""mkv"", ""mov"", ""mp4"", ""mpeg"", ""mpg"", ""ogv"", ""torrent"", ""ts"", ""vob"", ""wmv"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects removable media write | Security | FortiSIEM UEBA Policy detects removable media write | UEBA Policy detects removable media write | eventType CONTAIN ""FINS-Windows-file-"" AND activityName IN (""file created"", ""file deleted"", ""file moved"", ""file renamed"", ""file written"") AND resourceName REGEXP ""(cd|rm):.*"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects files copied over remote desktop | Security | FortiSIEM UEBA Policy detects files copied over remote desktop | UEBA Policy detects files copied over remote desktop | eventType CONTAIN ""FINS-Windows-file-"" AND activityName IN (""file created"", ""file moved"", ""file read"", ""file renamed"", ""file written"") AND procName = ""rdpclip.exe"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco Call Manager EMCC Failed In Local Cluster | Disponibilidade | EMCC login failure occurred due to: incompatible devices, Unable to retrieve remote cluster information, EMCC restricted by the local cluster or untrusted certificate received from the remote | Cisco Call Manager EMCC Failed In Local Cluster | eventType = ""Cisco_UC_RTMT_EMCCFailedInLocalCluster"" |
| Cisco Call Manager License Grace Period Expired | Disponibilidade | Grace period for licensing has expired | Cisco Call Manager License Grace Period Expired | eventType = ""Cisco_UC_JAVAAPPLICATIONS-CiscoNoProvisionTimeout"" |
| UEBA Policy detects suspicious applications | Security | FortiSIEM UEBA Policy detects suspicious applications | UEBA Policy detects suspicious applications | eventType = ""FINS-Windows-new-process-created"" AND procName IN (""dsquery.exe"", ""nc"", ""nc.exe"", ""ncat"", ""ncat.exe"", ""nmap"", ""nmap.exe"", ""psexec.exe"", ""sf.exe"", ""tor.exe"", ""tor.real"", ""winexecsvc.exe"", ""wireshark.exe"", ""wscript.exe"", ""zenmap.exe"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Cisco Call Manager User Defined Search String Found In Log | Change | A user defined search string was found in the log file | Cisco Call Manager User Defined Search String Found In Log | eventType = ""Cisco_UC_RTMT_LogFileSearchStringFound"" |
| Cisco Local To Remote Call Manager TCP Connection Failed | Disponibilidade | Local Cisco Unified Communications Manager cannot establish a TCP connection with the remote Cisco Unified Communications Manager | Cisco Local To Remote Call Manager TCP Connection Failed | eventType = ""Cisco_UC_RTMT_TCPSetupToIMEFailed"" |
| Cisco Unity Connection Split Brain Failed | Disponibilidade | The resolution of the split brain condition failed - two servers cannot communicate with each other and both have the Primary status at the same time | Cisco Unity Connection Split Brain Failed | eventType = ""Cisco_UC_RTMT_SbrFailed"" |
| Cisco Unified Contact Center Express Report Server Uncoverable Error | Disponibilidade | Cisco Unified Contact Center Express Report server uncoverable error | Cisco Unified Contact Center Express Report Server Uncoverable Error | eventType = ""Cisco_UC_RTMT_IntelligenceCenterCUIC_UNRECOVERABLE_ERROR"" |
| Cisco CallManager IME Insufficient Fallback Identifiers: No PSTN Fallback | Performance | Too many Cisco IME calls that are currently in progress use the same fallback DID - no more DTMF digit sequences exist to allocate to a new Cisco IME call. Calls cannot fallback to the PSTN if voice-quality deteriorates | Cisco CallManager IME Insufficient Fallback Identifiers: No PSTN Fallback | eventType = ""Cisco_UC_RTMT_InsufficientFallbackIdentifiers"" |
| Riverbed Steelhead System Health Critical | Disponibilidade | Detects Riverbed system health critical | Riverbed Steelhead System Health Critical | eventType = ""PH_DEV_MON_SYS_STATUS"" AND systemStatus = ""Critical"" |
| Cisco Unity Connection Failover Succeeded | Disponibilidade | Cisco Unity Connection cluster automatic failover succeeded | Cisco Unity Connection Failover Succeeded | eventType = ""Cisco_UC_RTMT_AutoFailoverSucceeded"" |
| Cisco CallManager MGCP DChannel is out of service | Disponibilidade | MGCP DChannel is out-of-service. Check with carrier. | Cisco CallManager MGCP DChannel is out of service | eventType = ""Cisco_UC_RTMT_MgcpDChannelOutOfService"" |
| Windows File System Replication Service Communication Error | Disponibilidade | DFS Replication service unable to contact replication peer | Windows File System Replication Service Communication Error | eventType IN (""Win-App-DFSR-5002"",""Win-App-DFSR-5008"",""Win-App-DFSR-5012"",""Win-App-DFSR-5014"",""Win-App-DFSR-6002"",""Win-App-DFSR-1722"",""Win-App-DFSR-6804"") |
| Cisco CallManager DB Replication Failure | Disponibilidade | Cisco CallManager Database Replication Failure | Cisco CallManager DB Replication Failure | eventType = ""Cisco_UC_RTMT_DBReplicationFailure"" |
| Cisco CallManager LogPartition High Water Mark Exceeded | Disponibilidade | Used disk space in the log partition exceeds the configured high water mark. Files will be deleted to avoid running out of disk space | Cisco CallManager LogPartition High Water Mark Exceeded | eventType = ""Cisco_UC_RTMT_LogPartitionHighWaterMarkExceeded"" |
| Cisco CallManager Registered Phone Decreased | Performance | Number of registered phones in a cluster decreased between consecutive polls | Cisco CallManager Registered Phone Decreased | eventType = ""Cisco_UC_RTMT_NumberOfRegisteredPhonesDropped"" |
| Riverbed Steelhead System Health Degraded | Disponibilidade | Detects Riverbed system health degraded | Riverbed Steelhead System Health Degraded | eventType = ""PH_DEV_MON_SYS_STATUS"" AND systemStatus IN (""Degraded"",""Admission Control"") |
| Cisco Unified Contact Center Express Autopurging completed | Disponibilidade | Cisco Unified Contact Center Express Autopurging completed | Cisco Unified Contact Center Express Autopurging completed | eventType = ""Cisco_UC_RTMT_PurgeInvoked"" |
| Cisco Unity No Connection To Peer | Disponibilidade | Servers of a Cisco Unity Connection cluster cannot communicate with each other | Cisco Unity No Connection To Peer | eventType = ""Cisco_UC_RTMT_NoConnectionToPeer"" |
| Cisco Unified Contact Center Express Database Replication Failed | Disponibilidade | Cisco Unified Contact Center Express Database Replication Failed | Cisco Unified Contact Center Express Database Replication Failed | eventType = ""Cisco_UC_RTMT_IntelligenceCenterCUIC_DB_REPLICATION_FAILED"" |
| Cisco Unity Connection License Expired | Disponibilidade | Cisco Unity Connection license expired | Cisco Unity Connection License Expired | eventType = ""Cisco_UC_RTMT_LicenseExpired"" |
| Cisco CallManager Media List Exhausted | Performance | All available media resources that are defined in the media list are busy | Cisco CallManager Media List Exhausted | eventType = ""Cisco_UC_RTMT_MediaListExhausted"" |
| Cisco Unified Contact Center Express Database Unavailable | Disponibilidade | Cisco Unified Contact Center Express Database unavailable | Cisco Unified Contact Center Express Database Unavailable | eventType = ""Cisco_UC_RTMT_IntelligenceCenterCUIC_DATABASE_UNAVAILABLE"" |
| Windows File System Replication Sharing violation | Disponibilidade | Detects that Windows File System Replication service has been repeatedly prevented from replicating a file due to consistent sharing violations encountered on the files or folders | Windows File System Replication Sharing violation | eventType IN (""Win-App-DFSR-4302"",""Win-App-DFSR-4304"") |
| CVE-2017-5689 |  |  |  |  |
| Cisco CallManager IME Distributed Cache Inactive | Performance | Cisco Unified Communications Manager attempts to connect to the Cisco IME server, but the IME distributed cache is not currently active | Cisco CallManager IME Distributed Cache Inactive | eventType = ""Cisco_UC_RTMT_IMEDistributedCacheInactive"" |
| Riverbed Steelhead Service Health Critical | Disponibilidade | Detects Riverbed service health critical | Riverbed Steelhead Service Health Critical | eventType = ""PH_DEV_MON_SYS_STATUS"" AND svcStatus = ""Stopped"" |
| Cisco Unity Connection Failover Failed | Disponibilidade | Cisco Unity Connection cluster automatic failover failed | Cisco Unity Connection Failover Failed | eventType = ""Cisco_UC_RTMT_AutoFailoverSucceeded"" |
| Windows Cluster Service Quorum Error | Disponibilidade | Detects Windows Cluster Service Quorum Error | Windows Cluster Service Quorum Error | eventType IN (Group@PH_SYS_EVENT_WinClusterQuorumErr) |
| Cisco CallManager DB Replication Error | Disponibilidade | Cisco CallManager Database Replication Error | Cisco CallManager DB Replication Error | eventType = ""Cisco_UC_RTMT_DBReplicationTableOutOfSync"" |
| Windows File System Replication Staging quota too small | Disponibilidade | DFS Replication service failed to clean up old staging files for the replicated folder - the replicated folder might get out of sync | Windows File System Replication Staging quota too small | eventType IN (""Win-App-DFSR-4206"",""Win-App-DFSR-4208"") |
| Cisco Unity Connection License About To Expire | Disponibilidade | Cisco Unity Connection license about to expire | Cisco Unity Connection License About To Expire | eventType = ""Cisco_UC_RTMT_LicenseExpirationWarning"" |
| Cisco CallManager Registered Device Count Exceeded | Performance | Number of registered devices exceeded event configured threshold | Cisco CallManager Registered Device Count Exceeded | eventType = ""Cisco_UC_RTMT_NumberOfRegisteredDevicesExceeded"" |
| Cisco CallManager IME Quality Alert | Performance | A substantial number of Cisco IME calls fail back to PSTN or fail to be set up due to IP network quality problems | Cisco CallManager IME Quality Alert | eventType = ""Cisco_UC_RTMT_IMEQualityAlert"" |
| Cisco Unified Contact Center Express Database Update Issue | Disponibilidade | Cisco Unified Contact Center Express Database update issue - historical data written to files but not to the database | Cisco Unified Contact Center Express Database Update Issue | eventType = ""Cisco_UC_RTMT_HistoricalDataWrittenToFiles"" |
| Windows File System Replication Service Fatal Internal Error | Disponibilidade | DFS Replication service unable to contact replication peer | Windows File System Replication Service Fatal Internal Error | eventType IN (""Win-App-DFSR-2104"",""Win-App-DFSR-2212"",""Win-App-DFSR-2213"",""Win-App-DFSR-5014"",""Win-App-DFSR-6002"",""Win-App-DFSR-9110"") |
| Windows Cluster Service Startup Error | Disponibilidade | Detects Windows Cluster Service Startup Error | Windows Cluster Service Startup Error | eventType IN (Group@PH_SYS_EVENT_WinClusterStartupErr) |
| CISA AA22-011A e AA22-047A. |  |  |  |  |
| Cisco Unity Connection Failback Failed | Disponibilidade | Cisco Unity Connection Publisher server is not online and the server with the Primary status fails to automatically change status | Cisco Unity Connection Failback Failed | eventType = ""Cisco_UC_RTMT_AutoFailbackFailed"" |
| Cisco CallManager Registered Device Count Increased | Performance | Number of registered gateways in a cluster increased between consecutive polls | Cisco CallManager Registered Device Count Increased | eventType = ""Cisco_UC_RTMT_NumberOfRegisteredGatewaysIncreased"" |
| Cisco Unified Contact Center Express Report Execution Failed | Disponibilidade | Cisco Unified Contact Center Express Report server failed to run a report | Cisco Unified Contact Center Express Report Execution Failed | eventType = ""Cisco_UC_RTMT_IntelligenceCenterCUIC_REPORT_EXECUTION_FAILED"" |
| Cisco CallManager Registered Media Count Increased | Performance | Number of registered media devices in a cluster increased between consecutive polls | Cisco CallManager Registered Media Count Increased | eventType = ""Cisco_UC_RTMT_NumberOfRegisteredMediaDevicesIncreased"" |
| Cisco CallManager High Call Latency: Code Yellow | Performance | Current average expected delay to handle an incoming message exceeds the value specified in Code Yellow Entry Latency service parameter | Cisco CallManager High Call Latency: Code Yellow | eventType = ""Cisco_UC_RTMT_CodeYellow"" |
| Cisco CallManager LogPartition Low Water Mark Exceeded | Disponibilidade | Used disk space in the log partition exceeds the configured low water mark | Cisco CallManager LogPartition Low Water Mark Exceeded | eventType = ""Cisco_UC_RTMT_LogPartitionLowWaterMarkExceeded"" |
| Cisco Unified Contact Center Express Database Replication Stopped | Disponibilidade | Cisco Contact Center Express Database Replication stopped. This happens when the replication queues become full due to the inability to contact other nodes | Cisco Unified Contact Center Express Database Replication Stopped | eventType = ""Cisco_UC_RTMT_DBReplicationStopped"" |
| Cisco CallManager Node Excessive Process and Thread | Performance | Current total process and thread count exceeds the maximum number of tasks that are configured for the Cisco RIS Data Collector Service Parameter | Cisco CallManager Node Excessive Process and Thread | eventType = ""Cisco_UC_RTMT_TotalProcessesAndThreadsExceededThreshold"" |
| Cisco CallManager IME Over Quota | Performance | Cisco IME service have exceed the quota for published direct inward dialing numbers (DIDs) to the IME distributed cache | Cisco CallManager IME Over Quota | eventType = ""Cisco_UC_RTMT_IMEOverQuota"" |
| Cisco CallManager Database Notification Failure | Disponibilidade | Cisco Database Notification Service experiencing problems and might stop - change notification requests queued in the database got stuck and changes made to the system may not take effect | Cisco CallManager Database Notification Failure | eventType = ""Cisco_UC_RTMT_DBChangeNotifyFailure"" |
| Windows Cluster Service Membership Error | Disponibilidade | Detects Windows Cluster Service Membership Error | Windows Cluster Service Membership Error | eventType IN (Group@PH_SYS_EVENT_WinClusterMembershipErr) |
| Cisco Local To Remote Call Manager Communication Problem | Disponibilidade | Local Cisco Unified Communications Manager cannot communicate with the Remote Cisco Unified Communications Manager | Cisco Local To Remote Call Manager Communication Problem | eventType = ""Cisco_UC_RTMT_SDLLinkOutOfService"" |
| Cisco CallManager Hardware Failure | Disponibilidade | Cisco CallManager Hardware Failure | Cisco CallManager Hardware Failure | eventType = ""Cisco_UC_RTMT_HardwareFailure"" |
| MS17-010 |  |  |  |  |
| Host/User risk increased and crossed Medium threshold | Security | Detects that Host/User risk increased and crossed Medium threshold (50) | Host/User risk increased and crossed Medium threshold | eventType = ""PH_AUDIT_RISK_INCREASE_MED"" |
| OT Permited Traffic not from Purdue Level 3.5 to Level 3 | Security | Detects permitted traffic not from Purdue Level 3.5 to Level 3 | OT Permited Traffic not from Purdue Level 3.5 to Level 3 | eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (BizService@PH_SYS_BizSrvc_OT_L35) AND destIpAddr IN (BizService@PH_SYS_BizSrvc_OT_L3) |
| OT Permited Traffic not from Purdue Level 4 to Level 3.5 | Security | Detects permitted traffic not from Purdue Level 4 to Level 3.5 | OT Permited Traffic not from Purdue Level 4 to Level 3.5 | eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (BizService@PH_SYS_BizSrvc_OT_L4) AND destIpAddr IN (BizService@PH_SYS_BizSrvc_OT_L35) |
| OT Permited Traffic not from Purdue Level 3 to Level 2 | Security | Detects permitted traffic not from Purdue Level 3 to Level 3 | OT Permited Traffic not from Purdue Level 3 to Level 2 | eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (BizService@PH_SYS_BizSrvc_OT_L3) AND destIpAddr IN (BizService@PH_SYS_BizSrvc_OT_L2) |
| CVE-2021-44228 |  |  |  |  |
| CylanceProtect Threat Changed | Change | This rule detects Cylance threat changes | CylanceProtect Threat Changed | eventType = ""CylanceProtect-Threat-threat_changed"" |
| CVE-2017-5753, CVE-2017-5715 e CVE-2017-5754 |  |  |  |  |
| OT Permited Traffic not from Purdue Level 5 to Level 4 | Security | Detects permitted traffic not from Purdue Level 5 to Level 4 | OT Permited Traffic not from Purdue Level 5 to Level 4 | eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (BizService@PH_SYS_BizSrvc_OT_L5) AND destIpAddr IN (BizService@PH_SYS_BizSrvc_OT_L4) |
| CVE-2021-44228 |  |  |  |  |
| Host/User risk increased and crossed High threshold | Security | Detects that Host/User risk increased and crossed High threshold (80) | Host/User risk increased and crossed High threshold | eventType = ""PH_AUDIT_RISK_INCREASE_HIGH"" |
| CVE-2021-44228 |  |  |  |  |
| Self-signed Windows Certificate Added | Change | Detects a self-signed certificate being added to a Windows host. Certificates that are signed by Certificate Authorities are excluded from this rule. | Self-signed Windows Certificate Added | eventType = ""AO-WUA-Certificate-Added"" AND isSelfSigned = 1 AND isCertAuthority = 0 |
| OT Modbus Write Command Initiated outside of Purdue Level 2 | Security | Detects Modbus Write Command from a Source IP not defined in Operational Technology Business Service (Purdue) Level 2 | OT Modbus Write Command Initiated outside of Purdue Level 2 | serviceName = ""MODBUS"" AND eventType = ""FortiGate-appctrl-ips-pass"" AND usrMsg CONTAIN ""Modbus_Write"" AND srcIpAddr NOT IN (BizService@PH_SYS_BizSrvc_OT_L2) |
| CVE-2021-34527 |  |  |  |  |
| CVE-2021-26855, CVE-2021-26857, CVE-2021-26858 e CVE-2021-27065. |  |  |  |  |
| Linux: strace Process Activity | Security | Detects strace on a host. strace is a powerful command line tool for debugging and trouble shooting programs in Unix-like operating systems such as Linux. It captures and records all system calls made by a process and the signals received by the process. This requires process monitoring via FortiSIEM Linux agent. | Linux: strace Process Activity | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""strace"" |

## :dart: New Rule

#### DescriÃ§Ã£o:
Abaixo estÃ£o as regras relacionadas Ã  categoria **New Rule**.

| Nome da Regra | Categoria da Regra | DescriÃ§Ã£o da Regra | Tipo de Evento | CondiÃ§Ã£o de Filtro |
|---------------|--------------------|--------------------|----------------|--------------------|
| Service Down: No Response to STM: Has IP | Disponibilidade | Detects a service suddenly went down from up state and is no longer responding to synthetic transaction monitoring probes. This service has well known IP address. | Service Down: No Response to STM: Has IP | eventType = ""PH_DEV_MON_EUM_FAIL"" AND hostIpAddr IS NOT NULL |
| Service Staying Down: No Response to STM: Has IP | Disponibilidade | Detects a service staying down - that is went from up to down and did not come up and is no longer responding to end user monitoring probes. This service has well known IP address. | Service Staying Down: No Response to STM: Has IP | eventType = ""PH_DEV_MON_EUM_FAIL"" AND hostIpAddr IS NOT NULL |
| Service Staying Down: No Response to STM: Has IP | Disponibilidade | Detects a service staying down - that is went from up to down and did not come up and is no longer responding to end user monitoring probes. This service has well known IP address. | Service Staying Down: No Response to STM: Has IP | eventType = ""PH_DEV_MON_EUM_SUCCESS"" |
| ArubaOS-CX: Config Change Detected | Change | Aruba OS CX Switch Platform Reported a Config Change Event via syslog. | ArubaOS-CX: Config Change Detected | eventType IN ( ""ArubaCx-4603-AuthorizationConfigConflict"",""ArubaCx-4613-ConfigWritten"",""ArubaCx-4614-ConfigCopied"",""ArubaCx-4615-DnsConfigured"",""ArubaCx-4616-AllDnsDeleted"",""ArubaCx-4617-UriCreated"",""ArubaCx-4618-UriDeleted"",""ArubaCx-4619-UriModified"",""ArubaCx-4620-AddedSubscriber"",""ArubaCx-4621-RemovedSubscriber"",""ArubaCx-4622-AddedSubscription"",""ArubaCx-4623-RemovedSubscription"",""ArubaCx-4624-MaxSubscribersReached"",""ArubaCx-4626-ScriptCreated"",""ArubaCx-4627-ScriptDeleted"",""ArubaCx-4628-AgentCreated"",""ArubaCx-4629-AgentUpdated"",""ArubaCx-4630-AgentDeleted"") |
| Database DDL changes | Change | Detects database DDL changes | Database DDL changes | eventType IN (Group@PH_SYS_EVENT_DatabaseChange) AND eventType NOT CONTAIN ""user"" |
| Failed Checkpoint Firewall Policy Install | Change | Detects that an user failed to install a policy on a Checkpoint Firewall | Failed Checkpoint Firewall Policy Install | eventType = ""CheckPoint-InstallPolicy-Failure"" |
| GCP: VPC Network Deleted | Change | Google Cloud Platform: A VPC Network was Deleted | GCP: VPC Network Deleted | eventType = ""GCP_Audit_activity_compute_networks_delete"" |
| GCP: VPC Route Added | Change | Google Cloud Platform: A VPC Route was added | GCP: VPC Route Added | eventType = ""GCP_Audit_activity_compute_routes_insert"" |
| GCP: VPC Route Deleted | Change | Google Cloud Platform: A VPC Route was deleted | GCP: VPC Route Deleted | eventType = ""GCP_Audit_activity_compute_routes_delete"" |
| Google Workspace: 2FA Enforcement Disabled for Organization | Change | Google Workspace: 2FA Enforcement Disabled for Organization. A user has disabled the Enforce 2fa option in Google Admin Security settings. | Google Workspace: 2FA Enforcement Disabled for Organization | eventType = ""Google_Apps_SECURITY_SETTINGS_ENFORCE_STRONG_AUTHENTICATION"" AND newSettingsValue = ""false"" |
| Google Workspace: 2FA Verification Disabled for Organization | Change | Google Workspace: 2FA Verification Disabled for Organization. This means individual users do not have the ability to enable 2FA for their accounts. | Google Workspace: 2FA Verification Disabled for Organization | eventType = ""Google_Apps_SECURITY_SETTINGS_ALLOW_STRONG_AUTHENTICATION"" AND newSettingsValue = ""false"" |
| Google Workspace: Application Added to Domain | Change | Google Workspace: Application Added to Domain | Google Workspace: Application Added to Domain | eventType = ""Google_Apps_DOMAIN_SETTINGS_ADD_APPLICATION"" |
| Google Workspace: Domain added to Trusted Domains List | Change | Google Workspace: Domain added to Trusted Domains List | Google Workspace: Domain added to Trusted Domains List | eventType = ""Google_Apps_DOMAIN_SETTINGS_ADD_TRUSTED_DOMAINS"" |
| Google Workspace: Password Management Policy Changed | Change | Google Workspace: A setting in Password Management Policy has been changed. | Google Workspace: Password Management Policy Changed | eventType = ""Google_Apps_APPLICATION_SETTINGS_CREATE_APPLICATION_SETTING"" AND ( settingsName = ""Password Management - Enable password reuse"" OR settingsName = ""Password Management - Enforce password policy at next login"" OR settingsName = ""Password Management - Enforce strong password"" OR settingsName = ""Password Management - Maximum password length"" OR settingsName = ""Password Management - Minimum password length"" OR settingsName = ""Password Management - Password reset frequency"" ) |
| Google Workspace: Role Deleted by User | Change | Google Workspace: Role Deleted by Admin user. | Google Workspace: Role Deleted by User | eventType = ""Google_Apps_DELEGATED_ADMIN_SETTINGS_DELETE_ROLE"" |
| High throughput VPN session | Security | Detects that a VPN session consistently consuming more than 1 Mbps over a period of 15 minutes | High throughput VPN session | eventType =""PH_DEV_MON_CISCO_RAS_VPN_MET"" |
| Long lasting VPN session | Security | Detects that a VPN lasted for more than 2 days | Long lasting VPN session | eventType =""PH_DEV_MON_CISCO_RAS_VPN_MET"" AND tunnelUpTime > 172800 |
| Oracle OCI: User Activated MFA | Security | Oracle OCI User Activated MFA. Per Oracle cloud, a user can only activate MFA for their own account. An admin cannot activate MFA using their permissions. | Oracle OCI: User Activated MFA | eventType = ""Oracle-OCI-identitycontrolplane-activatemfatotpdevice"" |
| Palo Alto Config Change Failed | Change | Triggers when a PAN OS Config Change event is seen, and the action has Failed. | Palo Alto Config Change Failed | eventType = ""PAN-OS-CONFIG-Failed"" |
| Palo Alto Config Change Succeeded | Change | Triggers when a PAN OS Config Change event is seen, and the action is Succeeded. | Palo Alto Config Change Succeeded | eventType = ""PAN-OS-CONFIG-Succeeded"" |
| Successful Checkpoint Firewall Policy Install | Change | Detects that an user successfully installed a policy on a Checkpoint Firewall | Successful Checkpoint Firewall Policy Install | eventType = ""CheckPoint-InstallPolicy-Success"" |
| Unauthorized Palo Alto Firewall Config Change | Change | Triggers when a PAN OS Config Change event is seen, and the action is Unauthorized. | Unauthorized Palo Alto Firewall Config Change | eventType = ""PAN-OS-CONFIG-Unauthorized"" |
| Cisco CallManager IME Service Authentication Error | Security | Call Manager cannot connect to the Cisco IME server because the username and/or password configured on Cisco Unified Communications Manager do not match those configured on the Cisco IME server | Cisco CallManager IME Service Authentication Error | eventType = ""Cisco_UC_RTMT_InvalidCredentials"" |
| Cisco CallManager IME Service Authentication Error | Security | Call Manager cannot connect to the Cisco IME server because the username and/or password configured on Cisco Unified Communications Manager do not match those configured on the Cisco IME server | Cisco CallManager IME Service Authentication Error | eventType = ""Cisco_UC_RTMT_InvalidCredentials"" |
| Armis Alert Detected | Security | Armis alert has been detected | Armis Alert Detected | eventType CONTAIN ""Armis-Alert"" |
| Cortex XDR Alert Detected | Security | Cortex XDR Triggered an Alert where action was Detected | Cortex XDR Alert Detected | eventType CONTAIN ""CortexXDR-Alert"" AND fwAction=""Detected"" |
| Cortex XDR Alert Prevented | Security | Cortex XDR Triggered an Alert where action was Prevented | Cortex XDR Alert Prevented | eventType CONTAIN ""CortexXDR-Alert"" AND fwAction=""Prevented"" |
| CyberX Detected Malware | Security | CyberX Detected Malware | CyberX Detected Malware | eventType = ""CyberX-Malware"" |
| Microsoft ATA Center: Security Alert Triggered | Security | Microsoft ATA (Advanced Threat Analytics) Medium and High Security Alerts | Microsoft ATA Center: Security Alert Triggered | eventType CONTAIN ""Microsoft-ATA"" AND categoryType = ""Security"" AND eventSeverity >= 5 |
| Sudden Increase in User Login Volume | Security | Detects daily user login volume anomaly against profile. This may indicate suspicious user behaviors. | Sudden Increase in User Login Volume | eventType = ""PH_USER_MON_SUDDEN_LOGIN_VOLUME_CHANGE"" |
| Sudden User Login Pattern Change | Security | Detects daily user login distribution anomaly against profile. This may indicate suspicious user behaviors. | Sudden User Login Pattern Change | eventType = ""PH_USER_MON_SUDDEN_LOGIN_DISTRIBUTION_CHANGE"" |
| UserGate UTM IDPS Alert Detected | Security | UserGate UTM Firewall triggered an IDPS event with action alert. | UserGate UTM IDPS Alert Detected | eventType CONTAIN ""UserGate-"" AND type = ""idps"" AND fwAction = ""alert"" |
| Windows DNS Server: Suspicious DNS Traffic Resolved | Security | This rule detects that the response from DNS server to original DNS client, the destination IP is the originating client that made the DNS resolution request. | Windows DNS Server: Suspicious DNS Traffic Resolved | eventType CONTAIN ""AO-WUA-DNS"" AND eventAction = 0 AND type = ""Response"" AND direction = ""Snd"" AND ( dnsQueryName REGEXP ""^.*\.info$"" OR dnsQueryName IN (Group@PH_SYS_FORTIGUARD_MAL_DOMAIN) ) |
| Agent FIM: Linux File or Directory Created | Change | FortiSIEM Linux Agent FIM detected that a file or a directory was created | Agent FIM: Linux File or Directory Created | eventType = ""FSM_LINUX_FILE_CREATE"" |
| Agent FIM: Windows File or Directory Created | Change | FortiSIEM Windows Agent FIM detected that a file or a directory was created | Agent FIM: Windows File or Directory Created | eventType = ""AO-WUA-FileMon-Added"" |
| Agentless FIM: Audited file or directory created | Change | FortiSIEM agentless file monitoring detected that a file or a directory was created | Agentless FIM: Audited file or directory created | eventType = ""PH_DEV_MON_CUST_FILE_CREATE"" |
| AWS CloudTrail Log Created | Security | Identifies the creation of an AWS log trail that specifies the settings for delivery of log data. | AWS CloudTrail Log Created | eventType CONTAIN ""AWS-CloudTrail-CLOUDTRAIL-CreateTrail"" |
| AWS SecHub: Tactics: Collection Detected | Security | AWS Security Hub detected Collection tactics. Adversary is trying to collect data of their interest. | AWS SecHub: Tactics: Collection Detected | eventType = ""AWS-Hub-TTPs-Collection"" |
| Excessive End User Mail | Security | Detects a scenario where a host, that is itself not an authorized mail gateway, is sending excessive emails (more than 20 emails in 2 minutes). This behavior may indicate malware running on an end host that is trying to send spam or privileged information to its own set of mail servers (which may be compromised). | Excessive End User Mail | ipProto = 6 AND destIpPort = 25 AND srcIpAddr NOT IN (Group@PH_SYS_DEVICE_SEC_GW,Group@PH_SYS_APP_MAIL_SERVER) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic,Group@PH_SYS_EVENT_DenyNetTraffic) |
| Excessive Postfix mail send latency | Performance | Detects excessive Postfix mail send latency - more than 1 minute | Excessive Postfix mail send latency | eventType IN (""Postfix-Mail-Accept-Stat"",""Postfix-Mail-Queued-Stat"") |
| Excessive SNMP Port 161 Traffic from a Source to the same Destination | Security | Detects excessive (> 5000 in 3 minutes) SNMP polling traffic on UDP port 161 traffic from the same source to the same destination | Excessive SNMP Port 161 Traffic from a Source to the same Destination | ipProto = 17 AND destIpPort = 161 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) |
| FortiMail: Malicious Spam File Attachment Found | Security | Fortimail Antispam has found a malicious file in the email attachment | FortiMail: Malicious Spam File Attachment Found | eventType = ""FortiMail-Antispam-malicious-attachment-file"" |
| FortiMail: Malicious URL found | Security | Fortimail Antispam has found a malicious url in an email | FortiMail: Malicious URL found | eventType = ""FortiMail-Antispam-malicious-attachment-url"" |
| FortiRecon: Leaked Credit or Debit Cards Found Online | Security | FortiRecon Adversary Centric Intel found leaked credit/debit card details online. | FortiRecon: Leaked Credit or Debit Cards Found Online | eventType = ""FortiRecon-aci_leaked_cards"" |
| GCP: Pub/Sub Subscription Created | Change | Google Cloud Platform: A Pub/Sub Subscriber has been created for a topic. A subscription enables an application to retrieve data from a Pub/Sub topic. | GCP: Pub/Sub Subscription Created | eventType = ""GCP_Audit_activity_Subscriber_CreateSubscription"" |
| GCP: Pub/Sub Topic Created | Change | Google Cloud Platform: A Pub/Sub Topic has been created. Pub/Sub topics can be used to extract large amounts of audit or arbitrary data from GCP cloud, depending on what data is being published to the topic. | GCP: Pub/Sub Topic Created | eventType = ""GCP_Audit_activity_Publisher_CreateTopic"" AND resourceType = ""pubsub_topic"" |
| GCP: Storage Bucket IAM Permissions Modified | Change | Google Cloud Platform: IAM Permissions on a storage bucket have been modified. | GCP: Storage Bucket IAM Permissions Modified | eventType CONTAIN ""GCP_Audit_activity_storage_setIamPermissions"" |
| GCP: Storage Bucket Updated | Change | Google Cloud Platform: A Storage bucket has been updated. | GCP: Storage Bucket Updated | eventType = ""GCP_Audit_activity_storage_buckets_update"" |
| Linux: Creation of an Archive with Common Archivers | Security | Detects attempt to collect and stage data in a central location or directory in preparation of exfiltration | Linux: Creation of an Archive with Common Archivers | (eventType = ""LINUX_PROCESS_EXEC"" AND procName IN (""gzip"",""hdiutil"",""tar"",""zip"")) OR (eventType REGEXP ""FSM_LINUX_FILE_.*"" AND targetOsObjName REGEXP "".*\.gz|.*\.gzip|.*\.tar|.*\.zip"") |
| Office365: Admin or Delegated User Created Mailbox Forwarding Rule for another User | Security | A Mail Inbox Rule was created by an admin or delegated user that forwards mail from a target users mailbox. | Office365: Admin or Delegated User Created Mailbox Forwarding Rule for another User | eventType IN (""MS_OFFICE365_Exchange_New-InboxRule"",""MS_OFFICE365_Exchange_Set-Mailbox"") AND action = ""on_behalf_of"" AND ( options CONTAIN ""ForwardAsAttachmentTo"" OR options CONTAIN ""ForwardTo"" OR options CONTAIN ""RedirectTo"" OR options CONTAIN ""SendTextMessageNotificationTo"" ) |
| Office365: Delete Message Inbox Rule Created | Security | A Mail Inbox Rule was created that specifies the DeleteMessage parameter. This informs O365 to automatically delete matching messages. | Office365: Delete Message Inbox Rule Created | eventType IN (""MS_OFFICE365_Exchange_New-InboxRule"",""MS_OFFICE365_Exchange_Set-Mailbox"") AND options CONTAIN ""DeleteMessage"" |
| Office365: Mailbox Login from Outside My Country | Security | Office365 analytics reported a mailbox login from a source IP that is outside your home countries list. To set approved countries, go to Resources:Country Groups:My Home and edit with the list of expected countries. | Office365: Mailbox Login from Outside My Country | eventType=""MS_OFFICE365_Exchange_MailboxLogin"" AND srcGeoCountry NOT IN (Group@PH_COUNTRY_GROUP_MYHOME) |
| Office365: Mailbox SendAs or SendOnBehalf has occurred | Security | Detects when a Office365 user sends mail as or on behalf of another mailbox. This can be used to spoof the true sender of the email. Many uses are legitimate, but should be monitored for malicious activity or misconfigurations. | Office365: Mailbox SendAs or SendOnBehalf has occurred | eventType IN (""MS_OFFICE365_Exchange_SendAs"",""MS_OFFICE365_Exchange_SendOnBehalf"") |
| Office365: Move To Folder Inbox Rule Created | Security | A Mail Inbox Rule was created that automatically routes a message to a given folder. Sometimes mail rules can be used to obscure malicious activity. | Office365: Move To Folder Inbox Rule Created | eventType IN (""MS_OFFICE365_Exchange_New-InboxRule"",""MS_OFFICE365_Exchange_Set-Mailbox"") AND moveToFolder IS NOT NULL |
| Office365: Set-Mailbox Forwarding Action Created | Security | An admin changed the properties of a mailbox that is forwarding mail to another destination. | Office365: Set-Mailbox Forwarding Action Created | eventType = ""MS_OFFICE365_Exchange_Set-Mailbox"" AND ( options CONTAIN ""DeliverToMailboxAndForward"" OR options CONTAIN ""ForwardingAddress"" OR options CONTAIN ""ForwardingSmtpAddress"" OR options CONTAIN ""GrantSendOnBehalfTo"" OR options CONTAIN ""MessageCopyForSendOnBehalfEnabled"" OR options CONTAIN ""MessageCopyForSentAsEnabled"" ) |
| Office365: User Mailbox Forwarding Rule Created | Security | A Mail Inbox Rule was created that forwards mail to another user. | Office365: User Mailbox Forwarding Rule Created | eventType IN (""MS_OFFICE365_Exchange_New-InboxRule"",""MS_OFFICE365_Exchange_Set-Mailbox"") AND action != ""on_behalf_of"" AND ( options CONTAIN ""ForwardAsAttachmentTo"" OR options CONTAIN ""ForwardTo"" OR options CONTAIN ""RedirectTo"" OR options CONTAIN ""SendTextMessageNotificationTo"" ) |
| Spam/Malicious Mail Attachment found but not remediated | Security | Detects that host anti-virus or content inspection devices found a Spam/Malicious Mail Attachment but could not remediate it. The sender is sending to 5 or more distinct receiver mail addresses | Spam/Malicious Mail Attachment found but not remediated | eventType IN (Group@PH_SYS_EVENT_MailMalware_Found) |
| UEBA Policy detects email download | Security | FortiSIEM UEBA Policy detects email download | UEBA Policy detects email download | eventType = ""FINS-Windows-file-written"" AND procName = ""outlook.exe"" AND (fileExt IS NULL OR fileExt != ""lnk"") AND resourceName NOT REGEXP ""c:/temp/(.+\.tmp|msohtmlclip[0-9]/\d+/.+\.thmx|exchangeperflog_.+\.dat)"" AND resourceName NOT REGEXP ""nfs:/"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects email upload | Security | FortiSIEM UEBA Policy detects email upload | UEBA Policy detects email upload | eventType = ""FINS-Windows-file-read"" AND procName = ""outlook.exe"" AND resourceName != ""svrsvc"" AND (fileExt IS NULL OR fileExt != ""lnk"") AND resourceName NOT REGEXP ""c:/temp/(.+\.tmp|msohtmlclip[0-9]/\d+/.+\.thmx|exchangeperflog_.+\.dat)"" AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| UEBA Policy detects file archiver application | Security | FortiSIEM UEBA Policy detects file archiver application | UEBA Policy detects file archiver application | eventType = ""FINS-Windows-new-process-created"" AND procName IN (""7z.exe"", ""7za"", ""7za.exe"", ""7zfm.exe"", ""7zg.exe"", ""bunzip"", ""bunzip2"", ""bzip"", ""bzip2"", ""gunzip"", ""gzip"", ""peazip.exe"", ""rar.exe"", ""tar"", ""winrar.exe"", ""winzip.exe"", ""zip.exe"") AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Virus found in mail | Security | Fortimail and other mail gateways found a virus in mail attachment | Virus found in mail | eventType = ""FortiMail-Antivirus-virus-infected"" |
| Windows failed file access | Security | Detects that a user failed to modify either the content or the attributes of a file or directory | Windows failed file access | eventType IN (Group@PH_SYS_EVENT_FileChange) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) AND eventAction = 1 AND user NOT CONTAIN ""$"" |
| Windows Removable Media Inserts | Security | Detects removable media inserts on Windows Servers | Windows Removable Media Inserts | eventType = ""AO-WUA-RemovableMedia-Insert"" |
| Windows successful file access | Security | Detects that a user successfully modified either the content or the attributes of a file or directory | Windows successful file access | eventType IN (Group@PH_SYS_EVENT_FileChange) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) AND eventAction = 0 AND user NOT CONTAIN ""$"" |
| Windows: 7Zip Compressing Dump Files | Security | Detects a suspicious 7zip execution that involves a file with a "".dmp""/"".dump"" extension, which could be a step in a process of dump file exfiltration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_7zip_exfil_dmp_files.yml | Windows: 7Zip Compressing Dump Files | eventType=""Win-Sysmon-1-Create-Process"" AND (description REGEXP "".*7-Zip.*"" OR procName REGEXP "".*\\7z\.exe|.*\\7za\.exe|.*\\7zr\.exe"" OR srcFileName IN (""7z.exe"",""7za.exe"")) AND command REGEXP "".*\.dmp.*|.*\.dump.*"" |
| Windows: Audio Capture via PowerShell | Security | Detects audio capture via PowerShell Cmdlet. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_audio_capture.yml | Windows: Audio Capture via PowerShell | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Get-AudioDevice .*|.*Set-AudioDevice .*|.*Toggle-AudioDevice.*|.*WindowsAudioDevice-Powershell-Cmdlet.*|.*Write-AudioDevice .*"" |
| Windows: Audio Capture via SoundRecorder | Security | Detect attacker collecting audio via SoundRecorder application. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_soundrecorder_audio_capture.yml | Windows: Audio Capture via SoundRecorder | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\SoundRecorder\.exe"" AND command REGEXP "".*/FILE.*"" |
| Windows: Browser Started with Remote Debugging | Security | Detects browsers starting with the remote debugging flags. Which is a technique often used to perform browser injection attacks. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_browsers_remote_debugging.yml | Windows: Browser Started with Remote Debugging | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".* --remote-debugging-.*"" OR (procName REGEXP "".*\\firefox\.exe"" AND command REGEXP "".* -start-debugger-server.*"")) |
| Windows: Compress Data and Lock With Password for Exfiltration With 7-ZIP | Security | Detects 7zip utilities to compress and encrypt data. An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_7zip_password_compression.yml | Windows: Compress Data and Lock With Password for Exfiltration With 7-ZIP | eventType=""Win-Sysmon-1-Create-Process"" AND (description REGEXP "".*7-Zip.*"" OR procName REGEXP "".*\\7z\.exe|.*\\7za\.exe|.*\\7zr\.exe"" OR srcFileName IN (""7z.exe"",""7za.exe"")) AND command REGEXP "".* -p.*"" AND command REGEXP "".* a .*|.* u .*"" |
| Windows: Compress Data and Lock With Password for Exfiltration With WINZIP | Security | An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_winzip_password_compression.yml | Windows: Compress Data and Lock With Password for Exfiltration With WINZIP | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*winzip64\.exe.*|.*winzip\.exe.*"" AND command REGEXP "".*-s\"".*"" AND command REGEXP "".* -a .*|.* -min .*"" |
| Windows: Copy from Admin Share | Security | Detects a suspicious copy command to or from an Admin share or remote. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_lateral_movement.yml | Windows: Copy from Admin Share | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*\\\\\.*"" AND command REGEXP "".*\$.*"") OR command REGEXP "".*\\Sysvol\\.*"") AND (((procName REGEXP "".*\\robocopy\.exe|.*\\xcopy\.exe"" OR srcFileName IN (""XCOPY.EXE"",""robocopy.exe"")) OR ((procName REGEXP "".*\\cmd\.exe"" OR srcFileName=""Cmd.Exe"") AND command REGEXP "".*copy.*"")) OR ((procName REGEXP "".*\\powershell\.exe.*|.*\\pwsh\.exe.*"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".* cp .*|.* mi .*|.* mv .*|.*copy .*|.*copy-item.*|.*cpi .*|.*move .*|.*move-item.*"")) |
| Windows: Data Compressed - Powershell | Security | Detects file compression via powershell commands. An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_data_compressed.yml | Windows: Data Compressed - Powershell | eventType=""Win-PowerShell-4104"" AND msg REGEXP "".*-Recurse.*"" AND msg REGEXP "".*\|.*"" AND msg REGEXP "".*Compress-Archive.*"" |
| Windows: Data Compressed - rar.exe | Security | Detects usage of ""rar"" to add files to an archive for potential compression. An adversary may compress data (e.g. sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rar_compress_data.yml | Windows: Data Compressed - rar.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\rar\.exe"" AND command REGEXP "".* a .*"" |
| Windows: Esentutl Steals Browser Information | Security | One way Qbot steals sensitive information is by extracting browser data from Internet Explorer and Microsoft Edge by using the built-in utility esentutl.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_esentutl_webcache.yml | Windows: Esentutl Steals Browser Information | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\esentutl\.exe"" OR srcFileName=""esentutl.exe"") AND command REGEXP "".*-r.*|.*/r.*"" AND command REGEXP "".*\\Windows\\WebCache.*"" |
| Windows: HackTool - ADCSPwn Execution | Security | Detects command line parameters used by ADCSPwn, a tool to escalate privileges in an active directory network by coercing authenticate from machine accounts and relaying to the certificate service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_adcspwn.yml | Windows: HackTool - ADCSPwn Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* --adcs .*"" AND command REGEXP "".* --port .*"" |
| Windows: Impacket Tool Execution | Security | Detects the execution of different compiled Windows binaries of the impacket toolset (based on names or part of their names - could lead to false positives). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_impacket_tools.yml | Windows: Impacket Tool Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\goldenPac.*|.*\\karmaSMB.*|.*\\kintercept.*|.*\\ntlmrelayx.*|.*\\rpcdump.*|.*\\samrdump.*|.*\\secretsdump.*|.*\\smbexec.*|.*\\smbrelayx.*|.*\\wmiexec.*|.*\\wmipersist.*"" OR procName REGEXP "".*\\GetADUsers_windows\.exe|.*\\GetNPUsers_windows\.exe|.*\\GetUserSPNs_windows\.exe|.*\\atexec_windows\.exe|.*\\dcomexec_windows\.exe|.*\\dpapi_windows\.exe|.*\\findDelegation_windows\.exe|.*\\getPac_windows\.exe|.*\\getST_windows\.exe|.*\\getTGT_windows\.exe|.*\\ifmap_windows\.exe|.*\\mimikatz_windows\.exe|.*\\netview_windows\.exe|.*\\nmapAnswerMachine_windows\.exe|.*\\opdump_windows\.exe|.*\\psexec_windows\.exe|.*\\rdp_check_windows\.exe|.*\\sambaPipe_windows\.exe|.*\\smbclient_windows\.exe|.*\\smbserver_windows\.exe|.*\\sniff_windows\.exe|.*\\sniffer_windows\.exe|.*\\split_windows\.exe|.*\\ticketer_windows\.exe"") |
| Windows: Local Privilege Escalation Indicator TabTip | Security | Detects the invocation of TabTip via CLSID as seen when JuicyPotatoNG is used on a system in brute force mode. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/microsoft_windows_distributed_com/win_system_lpe_indicators_tabtip.yml | Windows: Local Privilege Escalation Indicator TabTip | eventType=""Win-System-Microsoft-Windows-DistributedCOM-10001"" AND paraName=""C:\\Program Files\\Common Files\\microsoft shared\\ink\\TabTip.exe"" AND otherParaName=""2147943140"" AND swParam=""{054AAE20-4BEA-4347-8A35-64A533254A9D}"" |
| Windows: Password Protected Compressed File Extraction Via 7Zip | Security | Detects usage of 7zip utilities (7z.exe, 7za.exe and 7zr.exe) to extract password protected zip files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_7zip_password_extraction.yml | Windows: Password Protected Compressed File Extraction Via 7Zip | eventType=""Win-Sysmon-1-Create-Process"" AND (description REGEXP "".*7-Zip.*"" OR procName REGEXP "".*\\7z\.exe|.*\\7za\.exe|.*\\7zr\.exe"" OR srcFileName IN (""7z.exe"",""7za.exe"")) AND (command REGEXP "".* -p.*"" AND command REGEXP "".* x .*"" AND command REGEXP "".* -o.*"") |
| Windows: Potential Data Stealing Via Chromium Headless Debugging | Security | Detects chromium based browsers starting in headless and debugging mode and pointing to a user profile. This could be a sign of data stealing or remote control. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_browsers_chromium_headless_debugging.yml | Windows: Potential Data Stealing Via Chromium Headless Debugging | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*--remote-debugging-.*"" AND command REGEXP "".*--user-data-dir.*"" AND command REGEXP "".*--headless.*"" |
| Windows: Potential SMB Relay Attack Tool Execution | Security | Detects different hacktools used for relay attacks on Windows for privilege escalation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_relay_attacks_tools.yml | Windows: Potential SMB Relay Attack Tool Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*HotPotato.*|.*Juicy Potato.*|.*JuicyPotato.*|.*PetitPotam.*|.*RottenPotato.*|.*\\LocalPotato.*|.*\\Potato\.exe.*|.*\\Responder\.exe.*|.*\\SpoolSample\.exe.*|.*\\just_dce_.*|.*\\ntlmrelayx.*|.*\\smbrelayx.*|.*\\temp\\rot\.exe.*"" OR command REGEXP "".* /ntlm:NTLMhash .*|.* ntlmrelay.*|.* smbrelay.*|.*Invoke-PetitPotam.*|.*Invoke-Tater.*|.*\.exe -t .* -p .*|.*cme smb .*"" OR (command REGEXP "".*\.exe -c \""\{.*"" AND command REGEXP "".*\}\"" -z"")) AND ((procName NOT REGEXP "".*HotPotatoes .*|.*HotPotatoes6.*|.*HotPotatoes7.*"")) |
| Windows: PowerShell Get-Clipboard Cmdlet Via CLI | Security | Detects usage of the 'Get-Clipboard' cmdlet via CLI. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_get_clipboard.yml | Windows: PowerShell Get-Clipboard Cmdlet Via CLI | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Get-Clipboard.*"" |
| Windows: Processes Accessing the Microphone and Webcam | Security | Potential adversaries accessing the microphone and webcam in an endpoint. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_camera_microphone_access.yml | Windows: Processes Accessing the Microphone and Webcam | eventType IN (""Win-Security-4656"",""Win-Security-4657"",""Win-Security-4663"") AND osObjName REGEXP "".*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\microphone\\NonPackaged.*|.*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\webcam\\NonPackaged.*"" |
| Windows: Psr.exe Capture Screenshots | Security | The psr.exe captures desktop screenshots and saves them on the local machine. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_psr_capture_screenshots.yml | Windows: Psr.exe Capture Screenshots | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\Psr\.exe"" AND command REGEXP "".*/start.*"" |
| Windows: PUA - Mouse Lock Execution | Security | In Kaspersky's 2020 Incident Response Analyst Report they listed legitimate tool ""Mouse Lock"" as being used for both credential access and collection in security incidents. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_mouselock_execution.yml | Windows: PUA - Mouse Lock Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (product REGEXP "".*Mouse Lock.*"" OR company REGEXP "".*Misc314.*"" OR command REGEXP "".*Mouse Lock_.*"") |
| Windows: Rar Usage with Password and Compression Level | Security | Detects the use of rar.exe, on the command line, to create an archive with password protection or with a specific compression level. This is pretty indicative of malicious actions. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rar_compression_with_password.yml | Windows: Rar Usage with Password and Compression Level | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* -hp.*"" AND command REGEXP "".* -m.*|.* a .*"" |
| Windows: Recon Information for Export with Command Prompt | Security | Once established within a system or network, an adversary may use automated techniques for collecting internal data. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_recon.yml | Windows: Recon Information for Export with Command Prompt | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\WMIC\.exe|.*\\doskey\.exe|.*\\sc\.exe|.*\\tree\.com"" OR srcFileName IN (""DOSKEY.EXE"",""sc.exe"",""wmic.exe"")) AND parentCommand REGEXP "".* > %TEMP%\\.*|.* > %TMP%\\.*"" |
| Windows: RottenPotato Like Attack Pattern | Security | Detects logon events that have characteristics of events generated during an attack with RottenPotato and the like. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_susp_rottenpotato.yml | Windows: RottenPotato Like Attack Pattern | eventType=""Win-Security-4624"" AND winLogonType=3 AND user=""ANONYMOUS LOGON"" AND computer IS NULL AND srcIpAddr IN (127.0.0.1,::1) |
| Windows: Suspicious Access to Sensitive File Extensions | Security | Detects known sensitive file extensions accessed on a network share. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_raccess_sensitive_fext.yml | Windows: Suspicious Access to Sensitive File Extensions | eventType=""Win-Security-5145"" AND targetName REGEXP "".*\.bak|.*\.dmp|.*\.edb|.*\.kirbi|.*\.msg|.*\.nsf|.*\.nst|.*\.oab|.*\.ost|.*\.pst|.*\.rdp|.*\\groups\.xml"" |
| Windows: Suspicious Camera and Microphone Access | Security | Detects Processes accessing the camera and microphone from suspicious folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_susp_mic_cam_access.yml | Windows: Suspicious Camera and Microphone Access | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*\\Software\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\.*"" AND regKeyPath REGEXP "".*\\NonPackaged.*"" AND regKeyPath REGEXP "".*microphone.*|.*webcam.*"" AND regKeyPath REGEXP "".*:#Temp#.*|.*:#Users#Default#.*|.*:#Users#Desktop#.*|.*:#Users#Public#.*|.*:#Windows#Temp#.*|.*:#\$Recycle\.bin#.*"" |
| Windows: Suspicious Compression Tool Parameters | Security | Detects suspicious command line arguments of common data compression tools. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_compression_params.yml | Windows: Suspicious Compression Tool Parameters | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName REGEXP "".*Command.*Line.*RAR.*|.*rar\.exe|7z.*\.exe"" AND command REGEXP "".* -dw.*|.* -hp.*|.* -p.*|.* -sdel.*|.* -ta.*|.* -tb.*"") AND (parentProcName NOT REGEXP ""C:\\Program.*"") |
| Windows: Suspicious Manipulation Of Default Accounts Via Net.EXE | Security | Detects suspicious manipulations of default accounts such as 'administrator' and 'guest'. For example 'enable' or 'disable' accounts or change the password...etc. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_default_accounts_manipulation.yml | Windows: Suspicious Manipulation Of Default Accounts Via Net.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\net1\.exe|.*\\net\.exe"" OR srcFileName IN (""net.exe"",""net1.exe"")) AND command REGEXP "".* user .*"" AND command REGEXP "".* 'Administrador' .*|.* 'Administrateur' .*|.* 'Administrator' .*|.* 'DefaultAccount' .*|.* 'Rendszergazda' .*|.* 'guest' .*|.* Administrador .*|.* Administrateur .*|.* Administrator .*|.* DefaultAccount .*|.* Rendszergazda .*|.* \""Administrador\"" .*|.* \""Administrateur\"" .*|.* \""Administrator\"" .*|.* \""DefaultAccount\"" .*|.* \""guest\"" .*|.* guest .*"") AND (command NOT REGEXP "".*guest.*"" OR command NOT REGEXP "".*/active no.*"") |
| Windows: System Drawing DLL Load | Security | Detects processes loading ""System.Drawing.ni.dll"". This could be an indicator of potential Screen Capture. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_dll_system_drawing_load.yml | Windows: System Drawing DLL Load | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\System\.Drawing\.ni\.dll"" |
| Windows: UIPromptForCredentials DLLs | Security | Detects potential use of UIPromptForCredentials functions by looking for some of the DLLs needed for it. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_uipromptforcreds_dlls.yml | Windows: UIPromptForCredentials DLLs | eventType=""Win-Sysmon-7-Image-Loaded"" AND (loadedProcName REGEXP "".*\\credui\.dll|.*\\wincredui\.dll"" OR srcFileName IN (""credui.dll"",""wincredui.dll"")) AND ((procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*|C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*"") AND (procName NOT REGEXP "".*\\opera_autoupdate\.exe|.*\\procexp64\.exe|.*\\procexp\.exe"") AND (procName NOT IN (""C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe"",""C:\\Windows\\explorer.exe"")) AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\Teams\\current\\Teams\.exe|.*\\AppData\\Local\\Microsoft\\Teams\\stage\\Teams\.exe|.*\\AppData\\Roaming\\Spotify\\Spotify\.exe"") AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\OneDrive\\.*"") AND (procName!=""C:\\Windows\\regedit.exe"") AND (command NOT REGEXP "".*C:\\Program Files\\WindowsApps\\SpotifyAB\.SpotifyMusic_.*"")) |
| Windows: Use of CLIP | Security | Detects the execution of clip.exe in order to copy data to the clipboard. Adversaries may collect data stored in the clipboard from users copying information within or between applications. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_clip_execution.yml | Windows: Use of CLIP | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\clip\.exe"" OR srcFileName=""clip.exe"") |
| Windows: Veeam Backup Database Suspicious Query | Security | Detects potentially suspicious SQL queries using SQLCmd targeting the Veeam backup databases in order to steal information. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sqlcmd_veeam_db_recon.yml | Windows: Veeam Backup Database Suspicious Query | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\sqlcmd\.exe"" AND command REGEXP "".*VeeamBackup.*"" AND command REGEXP "".*From .*"" AND command REGEXP "".*BackupRepositories.*|.*Backups.*|.*Credentials.*|.*HostCreds.*|.*SmbFileShares.*|.*Ssh_creds.*|.*VSphereInfo.*"" |
| Windows: VeeamBackup Database Credentials Dump | Security | Detects dump of credentials in VeeamBackup dbo. Backup may contain user credenyials. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sqlcmd_veeam_dump.yml | Windows: VeeamBackup Database Credentials Dump | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\sqlcmd\.exe"" AND command REGEXP "".*SELECT.*"" AND command REGEXP "".*TOP.*"" AND command REGEXP "".*\[VeeamBackup\]\.\[dbo\]\.\[Credentials\].*"" |
| Windows: Winrar Compressing Dump Files | Security | Detects a suspicious winrar execution that involves a file with a "".dmp""/"".dump"" extension, which could be a step in a process of dump file exfiltration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_winrar_dmp.yml | Windows: Winrar Compressing Dump Files | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rar\.exe|.*\\winrar\.exe"" OR description=""Command line RAR"") AND command REGEXP "".*\.dmp.*|.*\.dump.*"" |
| Windows: Winrar Execution in Non-Standard Folder | Security | Detects a suspicious winrar execution in a folder which is not the default installation folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_winrar_execution.yml | Windows: Winrar Execution in Non-Standard Folder | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rar\.exe|.*\\winrar\.exe"" OR description=""Command line RAR"") AND (procName NOT REGEXP "".*C:\\Windows\\Temp.*|.*\\UnRAR\.exe.*|.*\\WinRAR.*"") |
| Windows: Zip A Folder With PowerShell For Staging In Temp | Security | Use living off the land tools to zip a file and stage it in the Windows temporary folder for later exfiltration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_zip_compress.yml | Windows: Zip A Folder With PowerShell For Staging In Temp | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Compress-Archive .*"" AND command REGEXP "".* -Path .*"" AND command REGEXP "".* -DestinationPath .*"" AND command REGEXP "".*\$env:TEMP\\.*"" |
| ICS Alert: Automated Collection | Security | An ICS monitoring system has detected an event containing Mitre ICS Technique ID T0802 - Automated Collection. Adversaries may automate collection of industrial environment information using tools or scripts. This automated collection may leverage native control protocols and tools available in the control systems environment. | ICS Alert: Automated Collection | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0802(,T\d+)*$"" |
| ICS Alert: Data from Information Repositories | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0811 - Data from Information Repositories. This data can include sensitive data such as specifications, schematics, or diagrams of control system layouts, devices, and processes. | ICS Alert: Data from Information Repositories | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0811(,T\d+)*$"" |
| ICS Alert: Detect Operating Mode | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0868 - Detect Operating Mode. Adversaries may gather information about a PLCs or controllers current operating mode. Operating modes dictate what change or maintenance functions can be manipulated and are often controlled by a key switch on the PLC. | ICS Alert: Detect Operating Mode | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0868(,T\d+)*$"" |
| ICS Alert: I/O Image | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0877 - I/O Image. Adversaries may seek to capture process values related to the inputs and outputs of a PLC. During the scan cycle, a PLC reads the status of all inputs and stores them in an image table, where values of inputs/outputs for one scan are stored while it executes the user program. | ICS Alert: I/O Image | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0877(,T\d+)*$"" |
| ICS Alert: Man in the Middle | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0830 - Man in the Middle. Adversaries with privileged network access may seek to modify network traffic in real time using adversary-in-the-middle (AiTM) attacks. | ICS Alert: Man in the Middle | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0830(,T\d+)*$"" |
| ICS Alert: Monitor Process State | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0801 - Monitor Process State. Adversaries may gather information about the physical process state. This information may be used to gain more information about the process itself or used as a trigger for malicious actions. | ICS Alert: Monitor Process State | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0801(,T\d+)*$"" |
| ICS Alert: Point Tag Identification | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0861 - Point Tag Identification. Adversaries may collect point and tag values to gain a more comprehensive understanding of the process environment. Points may be values such as inputs, memory locations, outputs or other process specific variables. Tags are the identifiers given to points for operator convenience. | ICS Alert: Point Tag Identification | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0861(,T\d+)*$"" |
| ICS Alert: Program Upload | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0845 - Program Upload. Adversaries may attempt to upload a program from a PLC to gather information about an industrial process | ICS Alert: Program Upload | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0845(,T\d+)*$"" |
| ICS Alert: Screen Capture | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0852 - Screen Capture. Adversaries may attempt to perform screen capture of devices in the control system environment. These device displays may reveal information regarding the ICS process, layout, control, and related schematics. | ICS Alert: Screen Capture | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0852(,T\d+)*$"" |
| AWS SecHub: Tactics: Command-and-Control Detected | Security | AWS Security Hub detected Command and Control tactics. Adversary is trying to communicate with other compromised systems and receive commands and malware updates. | AWS SecHub: Tactics: Command-and-Control Detected | eventType = ""AWS-Hub-TTPs-Command_and_Control"" |
| Cisco Umbrella: Failed DNS Requests to Malware Domains: Same source and Multiple Destinations | Security | Cisco Umbrella blocked a source from connecting to 2 or more distinct malware domains in a 15 minute interval. | Cisco Umbrella: Failed DNS Requests to Malware Domains: Same source and Multiple Destinations | eventType CONTAIN ""CiscoUmbrella-DNS"" AND fwAction = ""blocked"" AND webCategory CONTAIN ""Malware"" |
| Cisco Umbrella: Intelligent Proxy Blocked a Malware Request by Policy | Security | Cisco Umbrella Intelligent Proxy Blocked a Request by Policy where web site category is type Malware | Cisco Umbrella: Intelligent Proxy Blocked a Malware Request by Policy | eventType = ""CiscoUmbrella-PROXY-blocked"" AND webCategory CONTAIN ""Malware"" |
| Cisco Umbrella: Multiple Failed DNS Requests to a Malware Domain: Same Source and Destination | Security | Cisco Umbrella reported that more than 10 attempts to connect to a malware categorized destination domain was blocked by policy in a 15 minute interval. | Cisco Umbrella: Multiple Failed DNS Requests to a Malware Domain: Same Source and Destination | eventType CONTAIN ""CiscoUmbrella-DNS"" AND fwAction = ""blocked"" AND webCategory CONTAIN ""Malware"" |
| Crowdstrike: User Compromise | Security | Crowdstrike agent detected user compromise | Crowdstrike: User Compromise | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Suspicious-Activity"" |
| Dynamically generated host name: malware likely | Security | Detects algorthmically generated host name in network traffic - malware often use algorithmically generated host names to communicate. | Dynamically generated host name: malware likely | eventType = ""PH_DEV_MON_DGA_DETECTED"" |
| End User DNS Queries to Unauthorized DNS Servers | Security | Detects a scenario where a host, that is itself not a DNS server, is trying to send DNS requests to unauthorized DNS servers. Authorized DNS servers are represented by the ""DNS Server"" group. In a typical scenario, end hosts always send DNS requests to authorized DNS servers which in turn communicate to other DNS servers - so this behavior may indicate malware running on the end host. | End User DNS Queries to Unauthorized DNS Servers | ipProto = 17 AND destIpPort = 53 AND destIpAddr NOT IN (Group@PH_SYS_APP_DNS_SERVER) AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_PUBLIC_DNS) AND srcIpAddr NOT IN (Group@PH_SYS_APP_DNS_SERVER,Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic, Group@PH_SYS_EVENT_DenyNetTraffic) |
| Excessive Denied DNS Queries | Security | Detects a scenario where a host, has a very high frequency of denied DNS traffic. | Excessive Denied DNS Queries | ipProto = 6 AND destIpPort = 53 AND eventType IN (Group@PH_SYS_EVENT_DenyNetTraffic) |
| Excessive End User DNS Queries | Security | Detects a scenario where a host, that is itself not an DNS server, is sending excessive DNS requests. Authorized DNS servers are represented by the ""DNS Server"" group. In a typical scenario, the frequency of end host DNS requests is not high unless, there is a script running - this might indicate the presence of malware on the end host. | Excessive End User DNS Queries | ipProto = 17 AND destIpPort = 53 AND srcIpAddr NOT IN (Group@PH_SYS_APP_DNS_SERVER) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL,Group@PH_SYS_DEVICE_ROUTER_SWITCH) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic, Group@PH_SYS_EVENT_DenyNetTraffic) |
| Excessive End User DNS Queries | Security | Detects a scenario where a host, that is itself not an DNS server, is sending excessive DNS requests. Authorized DNS servers are represented by the ""DNS Server"" group. In a typical scenario, the frequency of end host DNS requests is not high unless, there is a script running - this might indicate the presence of malware on the end host. | Excessive End User DNS Queries | srcIpAddr NOT IN (Group@PH_SYS_APP_DNS_SERVER) AND reptDevIpAddr IN (Group@PH_SYS_APP_DNS_SERVER) AND (eventType CONTAIN ""BIND_DNS"" OR eventType CONTAIN ""MS_DNS"") AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Excessive Repeated DNS Queries To Same Domain | Security | Detects an usually high frequency of DNS name resolution queries from the same host to the same domain name in a short period of time. This is not expected behavior since, in a typical scenario, the domain name resolution is cached at the end point. Repeated queries indicates that a special DNS client is likely running at the end host that is trying to make use of fast flux techniques to get back many infected hosts behind a crafted domain name. | Excessive Repeated DNS Queries To Same Domain | eventType IN (Group@PH_SYS_EVENT_CommonDNSTraffic) |
| FortiGate detects Botnet | Security | FortiGate detected a botnet | FortiGate detects Botnet | eventType IN (""FortiGate-antivirus-botnet"",""FortiGate-antivirus-botnet-notif"") |
| FortiSandbox detects Botnet | Security | FortiSandbox has detected a botnet | FortiSandbox detects Botnet | eventType = ""FortiSandbox-NetAlert-Botnet"" |
| Inbound Traffic from Open Proxies | Security | Detects traffic from open proxies to servers inside the corporate network. Proxies are used for hiding identity and such, is a typical violation of corporate policies | Inbound Traffic from Open Proxies | srcIpAddr IN (Group@PH_SYS_ANON_OPEN_PROXY) AND destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) |
| Inbound Traffic from Tor Network | Security | Detects traffic from Tor network to servers inside the corporate network. Tor network is used for hiding identity and such, is a typical violation of corporate policies | Inbound Traffic from Tor Network | srcIpAddr IN (Group@PH_SYS_ANON_TOR_NODE) AND destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) |
| Invalid TCP/UDP Port Traffic | Security | Detects invalid TCP/UDP traffic with port number 0 (more than 10 in 3 minutes) | Invalid TCP/UDP Port Traffic | (ipProto = 17 OR ipProto = 6) AND destIpPort = 0 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Large Inbound Transfer From Outside My Country | Security | Detects a large inbound transfer (larger than 2MB in 10 minutes) from an external destination that is outside my country. The rule is written for United States and may need to be tuned for other countries. | Large Inbound Transfer From Outside My Country | srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND srcGeoCountry NOT IN (Group@PH_COUNTRY_GROUP_MYHOME) |
| Linux: Deobfuscate/Decode Files or Information via hexdump | Security | Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls. This requires process monitoring via FortiSIEM Linux agent. | Linux: Deobfuscate/Decode Files or Information via hexdump | eventType = ""LINUX_PROCESS_EXEC"" AND procName IN (""hexdump"", ""od"", ""xxd"") |
| Linux: Mknod Process Activity | Security | Mknod Process Activity detected. Linux mknod program is sometimes used in the command payload of a remote command injection and other exploits. It is used to export a command shell when the traditional version of netcat is not available to the payload. Some normal use of this program, at varying levels of frequency, may originate from scripts, automation tools, and frameworks. This requires process monitoring via FortiSIEM Linux agent. | Linux: Mknod Process Activity | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""mknod"" |
| Linux: Potential DNS Tunneling via Iodine | Security | Potential DNS Tunneling via Iodine detected. Iodine is a tool for tunneling Internet protocol version 4 (IPV4) traffic over the DNS protocol to circumvent firewalls, network security groups, and network access lists while evading detection. This requires process monitoring via FortiSIEM Linux agent. | Linux: Potential DNS Tunneling via Iodine | eventType = ""LINUX_PROCESS_EXEC"" AND procName IN (""iodine"", ""iodined"") |
| MS 365 Defender: Ingress Tool Transfer Alert | Security | Ingress Tool Transfer - Execution Alert from MS 365 Defender | MS 365 Defender: Ingress Tool Transfer Alert | (eventType = ""MS-Defender-Endpoint-Alert-Execution"" OR eventType CONTAIN ""M365Defender-Alert"") AND attackTechniqueId = ""T1105"" |
| Outbound Traffic to Open Proxies | Security | Detects traffic from inside the corporate network to open proxies. Proxies are used for hiding identity and such, is a typical violation of corporate policies | Outbound Traffic to Open Proxies | destIpAddr IN (Group@PH_SYS_ANON_OPEN_PROXY) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) |
| Outbound Traffic to Tor Network | Security | Detects traffic from inside the corporate network to Tor network nodes. Tor Network is used for hiding identity and such, is a typical violation of corporate policies | Outbound Traffic to Tor Network | destIpAddr IN (Group@PH_SYS_ANON_TOR_NODE) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) |
| Outbreak: HAFNIUM Exchange OWA Server Authentication Bypass | Security | Detects HAFNIUM Suspicious OWA access in an attempt to bypass authntication via POST to certain directories in Exchange OWA Server. This needs Windows agents to be run on these server to get IIS logs. | Outbreak: HAFNIUM Exchange OWA Server Authentication Bypass | eventType CONTAIN ""AO-WUA-IIS-Web"" AND httpMethod=""POST"" AND ( uriStem CONTAIN ""/owa/auth/Current/themes/resources/"" OR (uriStem CONTAIN ""/owa/auth/Current/"" AND httpUserAgent IN (""DuckDuckBot/1.0;+(+http://duckduckgo.com/duckduckbot.html)"",""Mozilla/5.0+(X11;+Linux+x86_64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/51.0.2704.103+Safari/537.36"",""Mozilla/5.0+(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)"",""Mozilla/5.0+(compatible;+Bingbot/2.0;++http://www.bing.com/bingbot.htm)"",""Mozilla/5.0+(compatible;+Googlebot/2.1;++http://www.google.com/bot.html"",""Mozilla/5.0+(compatible;+Konqueror/3.5;+Linux)+KHTML/3.5.5+(like+Gecko)+(Exabot-Thumbnails)"",""Mozilla/5.0+(compatible;+Yahoo!+Slurp;+http://help.yahoo.com/help/us/ysearch/slurp)"",""Mozilla/5.0+(compatible;+YandexBot/3.0;++http://yandex.com/bots)"",""facebookexternalhit/1.1+(+http://www.facebook.com/externalhit_uatext.php)"")) OR (uriStem CONTAIN ""/ecp/"" AND httpUserAgent IN (""ExchangeServicesClient/0.0.0.0"",""python-requests/2.19.1"",""python-requests/2.25.1"")) OR (uriStem REGEXP "".*/aspnet_client/.*|.*/owa/.*"" AND httpUserAgent IN (""Googlebot/2.1+(+http://www.googlebot.com/bot.html)"",""Mozilla/5.0+(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)"",""antSword/v2.1"")) OR uriStem REGEXP "".*/ecp/default\.flt.*|.*/ecp/main\.css.*|.*/owa/auth/Current/.*"" OR (uriStem REGEXP "".*/ecp/.*"" AND uriStem REGEXP "".*\.js.*"")) |
| Outbreak: HAFNIUM FortiGate Permitted IPS Event | Security | Detects HAFNIUM FortiGate Permitted IPS Events | Outbreak: HAFNIUM FortiGate Permitted IPS Event | ipsSignatureId IN (15996, 49950,49951,49952,49954) AND eventType CONTAIN ""FortiGate-ips-signature-"" |
| Outbreak: HAFNIUM Inbound Network Traffic | Security | Detects inbound network traffic to HAFNIUM command and control servers (CVE-2021-26855) | Outbreak: HAFNIUM Inbound Network Traffic | eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic, Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr IN (103.77.192.219,104.140.114.110,104.250.191.110,108.61.246.56,149.28.14.163,157.230.221.198,167.99.168.251,185.250.151.72,192.81.208.169,203.160.69.66,211.56.98.146,5.254.43.18,5.2.69.14,80.92.205.81,91.192.103.43,165.232.154.116) |
| Outbreak: HAFNIUM Infected File Detected by FortiGate | Security | This Rule detect Malware attributed to HAFNIUM. | Outbreak: HAFNIUM Infected File Detected by FortiGate | eventType = ""FortiGate-antivirus-infected-file-detect"" AND virusName IN (""ASP/WebShell.cl!tr"", ""ASP/Chopper.A!tr"", ""HTML/Agent.A121!t"") AND reptVendor = ""Fortinet"" AND phEventCategory = 0 |
| Outbreak: HAFNIUM Outbound Network Traffic | Security | Detects outbound network traffic to HAFNIUM command and control servers (CVE-2021-26855) | Outbreak: HAFNIUM Outbound Network Traffic | eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic,Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (103.77.192.219,104.140.114.110,104.250.191.110,108.61.246.56,149.28.14.163,157.230.221.198,167.99.168.251,185.250.151.72,192.81.208.169,203.160.69.66,211.56.98.146,5.254.43.18,5.2.69.14,80.92.205.81,91.192.103.43,165.232.154.116) |
| Outbreak: HAFNIUM Suspicious File hash match | Security | Detects HAFNIUM Suspicious File SHA256 hash match (CVE-2021-26855) | Outbreak: HAFNIUM Suspicious File hash match | eventType = ""Win-Sysmon-15-FileCreateStreamHash"" AND hashSHA256 IN (""b75f163ca9b9240bf4b37ad92bc7556b40a17e27c2b8ed5c8991385fe07d17d0"",""097549cf7d0f76f0d99edf8b2d91c60977fd6a96e4b8c3c94b0b1733dc026d3e"",""2b6f1ebb2208e93ade4a6424555d6a8341fd6d9f60c25e44afe11008f5c1aad1"",""65149e036fff06026d80ac9ad4d156332822dc93142cf1a122b1841ec8de34b5"",""511df0e2df9bfa5521b588cc4bb5f8c5a321801b803394ebc493db1ef3c78fa1"",""4edc7770464a14f54d17f36dc9d0fe854f68b346b27b35a6f5839adf1f13f8ea"",""811157f9c7003ba8d17b45eb3cf09bef2cecd2701cedb675274949296a6a183d"",""1631a90eb5395c4e19c7dbcbf611bbe6444ff312eb7937e286e4637cb9e72944"") |
| Outbreak: SUNBURST Domain Traffic | Security | Detects attempts to resolve SUNBURST Domain which indicates communication attempts to SUNBURST command and Control Servers | Outbreak: SUNBURST Domain Traffic | ( eventType IN (Group@PH_SYS_EVENT_CommonDNSTraffic) OR ( destName IS NOT NULL AND eventType REGEXP ""FortiGate-|FortiSandbox-|FortiMail-"" )) AND destName REGEXP ""(.*\.)?(avsvmcloud\.com|databasegalore\.com|deftsecurity\.com|digitalcollege\.org|freescanonline\.com|highdatabase\.com|incomeupdate\.com|panhardware\.com|thedoccloud\.com|virtualdataserver\.com|websitetheme\.com|zupertech\.com)"" |
| Outbreak: SUNBURST Outbound Network Traffic | Security | Detects outbound network traffic to SUNBURST command and Control Servers | Outbreak: SUNBURST Outbound Network Traffic | eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic, Group@PH_SYS_EVENT_DenyNetTraffic) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (98.225.248.37, 8.18.145.36, 8.18.145.33, 8.18.145.3, 8.18.145.21, 8.18.145.181, 8.18.145.157, 8.18.145.150, 8.18.145.139, 8.18.145.136, 8.18.145.134, 8.18.145.131, 8.18.144.9, 8.18.144.62, 8.18.144.44, 8.18.144.40, 8.18.144.20, 8.18.144.188, 8.18.144.180, 8.18.144.170, 8.18.144.165, 8.18.144.158, 8.18.144.156, 8.18.144.149, 8.18.144.136, 8.18.144.135, 8.18.144.130, 8.18.144.12, 8.18.144.11, 34.219.234.134, 3.87.182.149, 3.16.81.254, 20.141.48.154, 196.203.11.89, 184.72.48.22, 184.72.245.1, 184.72.240.3, 184.72.229.1, 184.72.224.3, 184.72.212.52, 184.72.21.54, 184.72.209.33, 184.72.145.34, 13.59.205.66, 54.193.127.66, 54.215.192.52, 34.203.203.23, 139.99.115.204, 5.252.177.25, 5.252.177.21, 204.188.205.176, 51.89.125.18, 167.114.213.199) |
| Outbreak: SUNBURST Suspicious File Created | Security | Detects SUNBURST Suspicious File Created | Outbreak: SUNBURST Suspicious File Created | eventType=""Win-Sysmon-11-FileCreate"" AND procName = ""solarwinds.businesslayerhost.exe"" AND fileName REGEXP "".*\.dll|.*\.exe|.*\.psl|\.*jpg|.*\.png"" |
| Outbreak: SUNBURST Suspicious File Hash Match | Security | Detects SUNBURST Suspicious File Hash match | Outbreak: SUNBURST Suspicious File Hash Match | ( eventType IN (""Win-Sysmon-15-FileCreateStreamHash"",""FortiSandbox-Malware-Detected"",""FortiSandbox-NetAlert-Attack"",""FortiSandbox-NetAlert-Botnet"",""FortiGate-antivirus-file-monitored"",""FortiGate-antivirus-file-intercepted"") OR eventType CONTAIN ""FortiGate-"" ) AND ( hashMD5 IN (""E18A6A21EB44E77CA8D739A72209C370"",""6FFE608A0A43054F850001D4AC31E76F"",""3E329A4C9030B26BA152FB602A1D5893"",""02AF7CEC58B9A5DA1C542B5A32151BA1"",""b91ce2fa41029f6955bff20079468448"",""02af7cec58b9a5da1c542b5a32151ba1"",""2c4a910a1299cdae2a4e55988a2f102e"",""846e27a652a5e1bfbd0ddd38a16dc865"",""4f2eb62fa529c0283b28d05ddd311fae"",""56ceb6d0011d87b6e4d7023d7ef85676"",""B91CE2FA41029F6955BFF20079468448"",""846E27A652A5E1BFBD0DDD38A16DC865"",""56CEB6D0011D87B6E4D7023D7EF85676"",""2C4A910A1299CDAE2A4E55988A2F102E"") OR hashSHA1 IN (""22719783B2469AD312A40C1B200DD24D6A03618D"",""5E643654179E8B4CFE1D3C1906A90A4C8D611CEA"",""1B476F58CA366B54F34D714FFCE3FD73CC30DB1A"",""BCB5A4DCBC60D26A5F619518F2CFC1B4BB4E4387"",""E257236206E99F5A5C62035C9C59C57206728B28"",""6FDD82B7CA1C1F0EC67C05B36D14C9517065353B"",""1ACF3108BF1E376C8848FBB25DC87424F2C2A39C"",""76640508B1E7759E548771A5359EAED353BF1EEC"",""2F1A5A7411D015D01AAEE4535835400191645023"",""D130BD75645C2433F88AC03E73395FBA172EF676"",""76640508B1E7759E548771A5359EAED353BF1EEC"",""2F1A5A7411D015D01AAEE4535835400191645023"") OR hashCode IN (""C20FD967D64E9722D840EC4292645B65896D0EE3EBE31090E15C5312D889C89E"",""AD2FBF4ADD71F61173975989D1A18395AFB8538ED889012B9D2E21C19E98BBD1"",""38385A81664CE562A6777FA4564AE7B93F38F1224E1206550136E2B6B5DBB9DD"",""D0D626DEB3F9484E649294A8DFA814C5568F846D5AA02D4CDAD5D041A29D5600"",""CE77D116A074DAB7A22A0FD4F2C1AB475F16EEC42E1DED3C0B0AA8211FE858D6"",""C15ABAF51E78CA56C0376522D699C978217BF041A3BD3C71D09193EFA5717C71"",""32519B85C0B422E4656DE6E6C41878E95FD95026267DAAB4215EE59C107D6C77"",""292327E5C94AFA352CC5A02CA273DF543F2020D0E76368FF96C84F4E90778712"",""019085A76BA7126FFF22770D71BD901C325FC68AC55AA743327984E89F4B0134"",""80579DF2533D54FE9CBC87AED80884F6A97E1CCDD0443CE2BCB815EF59ED3D65"",""402211700C275A7CB15341BD78DA9ADCD7D514A7EA3D76C067E29A7248A92F91"",""d3c6785e18fba3749fb785bc313cf8346182f532c59172b69adfb31b96a5d0af"",""a25cadd48d70f6ea0c4a241d99c5241269e6faccb4054e62d16784640f8e53bc"",""ac1b2b89e60707a20e9eb1ca480bc3410ead40643b386d624c5d21b47c02917c"",""c09040d35630d75dfef0f804f320f8b3d16a481071076918e9b236a321c1ea77"",""eb6fab5a2964c5817fb239a7a5079cabca0a00464fb3e07155f28b0a57a2c0ed"",""dab758bf98d9b36fa057a66cd0284737abf89857b73ca89280267ee7caf62f3b"",""53F8DFC65169CCDA021B72A62E0C22A4DB7C4077F002FA742717D41B3C40F2C7"",""D0D626DEB3F9484E649294A8DFA814C5568F846D5AA02D4CDAD5D041A29D5600"",""CE77D116A074DAB7A22A0FD4F2C1AB475F16EEC42E1DED3C0B0AA8211FE858D6"",""C15ABAF51E78CA56C0376522D699C978217BF041A3BD3C71D09193EFA5717C71"",""32519B85C0B422E4656DE6E6C41878E95FD95026267DAAB4215EE59C107D6C77"",""292327E5C94AFA352CC5A02CA273DF543F2020D0E76368FF96C84F4E90778712"",""019085A76BA7126FFF22770D71BD901C325FC68AC55AA743327984E89F4B0134"",""80579DF2533D54FE9CBC87AED80884F6A97E1CCDD0443CE2BCB815EF59ED3D65"") OR hashSHA256 IN (""C20FD967D64E9722D840EC4292645B65896D0EE3EBE31090E15C5312D889C89E"",""AD2FBF4ADD71F61173975989D1A18395AFB8538ED889012B9D2E21C19E98BBD1"",""38385A81664CE562A6777FA4564AE7B93F38F1224E1206550136E2B6B5DBB9DD"",""D0D626DEB3F9484E649294A8DFA814C5568F846D5AA02D4CDAD5D041A29D5600"",""CE77D116A074DAB7A22A0FD4F2C1AB475F16EEC42E1DED3C0B0AA8211FE858D6"",""C15ABAF51E78CA56C0376522D699C978217BF041A3BD3C71D09193EFA5717C71"",""32519B85C0B422E4656DE6E6C41878E95FD95026267DAAB4215EE59C107D6C77"",""292327E5C94AFA352CC5A02CA273DF543F2020D0E76368FF96C84F4E90778712"",""019085A76BA7126FFF22770D71BD901C325FC68AC55AA743327984E89F4B0134"",""80579DF2533D54FE9CBC87AED80884F6A97E1CCDD0443CE2BCB815EF59ED3D65"",""402211700C275A7CB15341BD78DA9ADCD7D514A7EA3D76C067E29A7248A92F91"",""d3c6785e18fba3749fb785bc313cf8346182f532c59172b69adfb31b96a5d0af"",""a25cadd48d70f6ea0c4a241d99c5241269e6faccb4054e62d16784640f8e53bc"",""ac1b2b89e60707a20e9eb1ca480bc3410ead40643b386d624c5d21b47c02917c"",""c09040d35630d75dfef0f804f320f8b3d16a481071076918e9b236a321c1ea77"",""eb6fab5a2964c5817fb239a7a5079cabca0a00464fb3e07155f28b0a57a2c0ed"",""dab758bf98d9b36fa057a66cd0284737abf89857b73ca89280267ee7caf62f3b"",""53F8DFC65169CCDA021B72A62E0C22A4DB7C4077F002FA742717D41B3C40F2C7"",""D0D626DEB3F9484E649294A8DFA814C5568F846D5AA02D4CDAD5D041A29D5600"",""CE77D116A074DAB7A22A0FD4F2C1AB475F16EEC42E1DED3C0B0AA8211FE858D6"",""C15ABAF51E78CA56C0376522D699C978217BF041A3BD3C71D09193EFA5717C71"",""32519B85C0B422E4656DE6E6C41878E95FD95026267DAAB4215EE59C107D6C77"",""292327E5C94AFA352CC5A02CA273DF543F2020D0E76368FF96C84F4E90778712"",""019085A76BA7126FFF22770D71BD901C325FC68AC55AA743327984E89F4B0134"",""80579DF2533D54FE9CBC87AED80884F6A97E1CCDD0443CE2BCB815EF59ED3D65"") ) |
| Outbreak: SUNBURST Suspicious File Hash match by Source and Destination | Security | Detects SUNBURST Suspicious File Hash match | Outbreak: SUNBURST Suspicious File Hash match by Source and Destination | ( eventType IN (""Win-Sysmon-15-FileCreateStreamHash"",""FortiSandbox-Malware-Detected"",""FortiSandbox-NetAlert-Attack"",""FortiSandbox-NetAlert-Botnet"",""FortiGate-antivirus-file-monitored"",""FortiGate-antivirus-file-intercepted"") OR eventType CONTAIN ""FortiGate-"" ) AND ( hashMD5 IN (""E18A6A21EB44E77CA8D739A72209C370"",""6FFE608A0A43054F850001D4AC31E76F"",""3E329A4C9030B26BA152FB602A1D5893"",""02AF7CEC58B9A5DA1C542B5A32151BA1"",""b91ce2fa41029f6955bff20079468448"",""02af7cec58b9a5da1c542b5a32151ba1"",""2c4a910a1299cdae2a4e55988a2f102e"",""846e27a652a5e1bfbd0ddd38a16dc865"",""4f2eb62fa529c0283b28d05ddd311fae"",""56ceb6d0011d87b6e4d7023d7ef85676"",""B91CE2FA41029F6955BFF20079468448"",""846E27A652A5E1BFBD0DDD38A16DC865"",""56CEB6D0011D87B6E4D7023D7EF85676"",""2C4A910A1299CDAE2A4E55988A2F102E"") OR hashSHA1 IN (""22719783B2469AD312A40C1B200DD24D6A03618D"",""5E643654179E8B4CFE1D3C1906A90A4C8D611CEA"",""1B476F58CA366B54F34D714FFCE3FD73CC30DB1A"",""BCB5A4DCBC60D26A5F619518F2CFC1B4BB4E4387"",""E257236206E99F5A5C62035C9C59C57206728B28"",""6FDD82B7CA1C1F0EC67C05B36D14C9517065353B"",""1ACF3108BF1E376C8848FBB25DC87424F2C2A39C"",""76640508B1E7759E548771A5359EAED353BF1EEC"",""2F1A5A7411D015D01AAEE4535835400191645023"",""D130BD75645C2433F88AC03E73395FBA172EF676"",""76640508B1E7759E548771A5359EAED353BF1EEC"",""2F1A5A7411D015D01AAEE4535835400191645023"") OR hashCode IN (""C20FD967D64E9722D840EC4292645B65896D0EE3EBE31090E15C5312D889C89E"",""AD2FBF4ADD71F61173975989D1A18395AFB8538ED889012B9D2E21C19E98BBD1"",""38385A81664CE562A6777FA4564AE7B93F38F1224E1206550136E2B6B5DBB9DD"",""D0D626DEB3F9484E649294A8DFA814C5568F846D5AA02D4CDAD5D041A29D5600"",""CE77D116A074DAB7A22A0FD4F2C1AB475F16EEC42E1DED3C0B0AA8211FE858D6"",""C15ABAF51E78CA56C0376522D699C978217BF041A3BD3C71D09193EFA5717C71"",""32519B85C0B422E4656DE6E6C41878E95FD95026267DAAB4215EE59C107D6C77"",""292327E5C94AFA352CC5A02CA273DF543F2020D0E76368FF96C84F4E90778712"",""019085A76BA7126FFF22770D71BD901C325FC68AC55AA743327984E89F4B0134"",""80579DF2533D54FE9CBC87AED80884F6A97E1CCDD0443CE2BCB815EF59ED3D65"",""402211700C275A7CB15341BD78DA9ADCD7D514A7EA3D76C067E29A7248A92F91"",""d3c6785e18fba3749fb785bc313cf8346182f532c59172b69adfb31b96a5d0af"",""a25cadd48d70f6ea0c4a241d99c5241269e6faccb4054e62d16784640f8e53bc"",""ac1b2b89e60707a20e9eb1ca480bc3410ead40643b386d624c5d21b47c02917c"",""c09040d35630d75dfef0f804f320f8b3d16a481071076918e9b236a321c1ea77"",""eb6fab5a2964c5817fb239a7a5079cabca0a00464fb3e07155f28b0a57a2c0ed"",""dab758bf98d9b36fa057a66cd0284737abf89857b73ca89280267ee7caf62f3b"",""53F8DFC65169CCDA021B72A62E0C22A4DB7C4077F002FA742717D41B3C40F2C7"",""D0D626DEB3F9484E649294A8DFA814C5568F846D5AA02D4CDAD5D041A29D5600"",""CE77D116A074DAB7A22A0FD4F2C1AB475F16EEC42E1DED3C0B0AA8211FE858D6"",""C15ABAF51E78CA56C0376522D699C978217BF041A3BD3C71D09193EFA5717C71"",""32519B85C0B422E4656DE6E6C41878E95FD95026267DAAB4215EE59C107D6C77"",""292327E5C94AFA352CC5A02CA273DF543F2020D0E76368FF96C84F4E90778712"",""019085A76BA7126FFF22770D71BD901C325FC68AC55AA743327984E89F4B0134"",""80579DF2533D54FE9CBC87AED80884F6A97E1CCDD0443CE2BCB815EF59ED3D65"") OR hashSHA256 IN (""C20FD967D64E9722D840EC4292645B65896D0EE3EBE31090E15C5312D889C89E"",""AD2FBF4ADD71F61173975989D1A18395AFB8538ED889012B9D2E21C19E98BBD1"",""38385A81664CE562A6777FA4564AE7B93F38F1224E1206550136E2B6B5DBB9DD"",""D0D626DEB3F9484E649294A8DFA814C5568F846D5AA02D4CDAD5D041A29D5600"",""CE77D116A074DAB7A22A0FD4F2C1AB475F16EEC42E1DED3C0B0AA8211FE858D6"",""C15ABAF51E78CA56C0376522D699C978217BF041A3BD3C71D09193EFA5717C71"",""32519B85C0B422E4656DE6E6C41878E95FD95026267DAAB4215EE59C107D6C77"",""292327E5C94AFA352CC5A02CA273DF543F2020D0E76368FF96C84F4E90778712"",""019085A76BA7126FFF22770D71BD901C325FC68AC55AA743327984E89F4B0134"",""80579DF2533D54FE9CBC87AED80884F6A97E1CCDD0443CE2BCB815EF59ED3D65"",""402211700C275A7CB15341BD78DA9ADCD7D514A7EA3D76C067E29A7248A92F91"",""d3c6785e18fba3749fb785bc313cf8346182f532c59172b69adfb31b96a5d0af"",""a25cadd48d70f6ea0c4a241d99c5241269e6faccb4054e62d16784640f8e53bc"",""ac1b2b89e60707a20e9eb1ca480bc3410ead40643b386d624c5d21b47c02917c"",""c09040d35630d75dfef0f804f320f8b3d16a481071076918e9b236a321c1ea77"",""eb6fab5a2964c5817fb239a7a5079cabca0a00464fb3e07155f28b0a57a2c0ed"",""dab758bf98d9b36fa057a66cd0284737abf89857b73ca89280267ee7caf62f3b"",""53F8DFC65169CCDA021B72A62E0C22A4DB7C4077F002FA742717D41B3C40F2C7"",""D0D626DEB3F9484E649294A8DFA814C5568F846D5AA02D4CDAD5D041A29D5600"",""CE77D116A074DAB7A22A0FD4F2C1AB475F16EEC42E1DED3C0B0AA8211FE858D6"",""C15ABAF51E78CA56C0376522D699C978217BF041A3BD3C71D09193EFA5717C71"",""32519B85C0B422E4656DE6E6C41878E95FD95026267DAAB4215EE59C107D6C77"",""292327E5C94AFA352CC5A02CA273DF543F2020D0E76368FF96C84F4E90778712"",""019085A76BA7126FFF22770D71BD901C325FC68AC55AA743327984E89F4B0134"",""80579DF2533D54FE9CBC87AED80884F6A97E1CCDD0443CE2BCB815EF59ED3D65"") ) |
| Permitted Traffic from Emerging Threat IP List | Security | Detects network traffic from emerging threat IP List | Permitted Traffic from Emerging Threat IP List | srcIpAddr IN (Group@PH_SYS_EMER_THREAT) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Sudden Change In DNS Data Transfer Pattern From A Specific Host | Security | Detects sudden change in DNS data transfer pattern from a specific IP - over a 15 minute period, either the sent or received bytes is more than 3 standard deviations away from the mean and more than 1 MB of traffic is exchanged in the corresponding direction. | Sudden Change In DNS Data Transfer Pattern From A Specific Host | destIpPort = 53 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Sudden Increase In DNS Requests From A Specific Host | Security | Detects sudden increase in DNS requests from a specific source IP - over a 15 minute period, a particular source IP is doing excessive DNS requests. Excessive DNS requests is defined as at least 100 requests and current count is 3 standard deviations away from mean for the current hour. Excessive Destination names is defined as 50 distinct name resolutions and current count is more than 3 standard deviations away from the mean for the current hour | Sudden Increase In DNS Requests From A Specific Host | destIpPort = 53 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Suspicious Botnet like End host DNS Behavior | Security | Detects an end host meeting at least 3 requirements for suspicious use of DNS requests - this indicates that a bot is likely running on the end host | Suspicious Botnet like End host DNS Behavior | eventType IN (""PH_RULE_UNAUTH_DNS_QUERY"",""PH_RULE_EXCESS_DNS_QUERY"",""PH_RULE_EXCESS_DENY_DNS_QUERY"", ""PH_RULE_UNCOMMON_DNS_QUERY"") |
| Traffic to bogon networks | Security | Detects outbound permitted traffic to bogon networks. These are IP address spaces not yet allocated by IANA and may indicate that the source host is compromised. Note that these addresses change frequently. | Traffic to bogon networks | srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (Group@PH_SYS_NETWORK_BOGON_NET) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Tunneled traffic detected | Security | Network IPS detects Tunneled traffic | Tunneled traffic detected | (reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) OR (reptDevIpAddr IN (Group@PH_SYS_APP_NETWORK_IPS) AND eventType CONTAIN ""Snort-"")) AND eventType IN (Group@PH_SYS_EVENT_TunnelledTraffic) |
| UEBA Policy detects Tor client usage | Security | FortiSIEM UEBA Policy detects Tor client usage | UEBA Policy detects Tor client usage | eventType CONTAIN ""FINS-Windows-"" AND ( procName IN (""amule.exe"", ""ares.exe"", ""azureus.exe"", ""bearshare.exe"", ""bitcomet.exe"", ""bitlord.exe"", ""bitspirit.exe"", ""bittornado.exe"", ""bittorrent.exe"", ""blubster.exe"", ""burst.exe"", ""cabos.exe"", ""coolstreaming.exe"", ""dcplusplus.exe"", ""deluge.exe"", ""entropy.exe"", ""frostwire.exe"", ""gnucleus.exe"", ""grokster.exe"", ""hydranode.exe"", ""iceshare.exe"", ""jubster.exe"", ""kceasy.exe"", ""kiwialpha.exe"", ""limewire.exe"", ""luckywire.exe"", ""mlnet.exe"", ""napigator.exe"", ""overnet.exe"", ""peercast.exe"", ""phex.exe"", ""piolet.exe"", ""popcorn-time.exe"", ""pplive.exe"", ""pruna.exe"", ""qtorrent.exe"", ""strongdc.exe"", ""tribler.exe"", ""tvants.exe"", ""tvprunner.exe"", ""tvuplayer.exe"", ""utorrent.exe"", ""vuze.exe"", ""warez.exe"", ""xolox.exe"", ""zultrax.exe"") OR procName REGEXP "".*torrent.*\.exe$"" OR fileExt = "".torrent"" ) AND user NOT REGEXP "".*\$$|dwn-.*|dwm-.*|umfd-.*|.*SYSTEM.*|.*ANONYMOUS.*"" |
| Unusually Large ICMP Echo Packets | Security | Detects large (> 200 bytes/pkt) ICMP echo request and response packets - this is unusual since ICMP packets carry minimal information and are small in size. This may indicate that some other traffic is being carried over ICMP protocol. | Unusually Large ICMP Echo Packets | ipProto = 1 AND icmpType = 0 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Unusually Large ICMP Echo Packets | Security | Detects large (> 200 bytes/pkt) ICMP echo request and response packets - this is unusual since ICMP packets carry minimal information and are small in size. This may indicate that some other traffic is being carried over ICMP protocol. | Unusually Large ICMP Echo Packets | ipProto = 1 AND icmpType = 8 AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Windows Torrent Client | Security | Detects Torrent Client. Torrent is a method of file sharing over the Internet | Windows Torrent Client | eventType CONTAIN ""FINS-Windows-"" AND procName IN (""bittorrent.exe"",""limewire.exe"",""zultrax.exe"",""mlnet.exe"",""kiwialpha.exe"",""kceasy.exe"",""gnucleus.exe"",""amule.exe"",""ares.exe"",""warez.exe"",""azureus.exe"",""bitcomet.exe"",""bitspirit.exe"",""bittornado.exe"",""bitlord.exe"",""burst.exe"",""utorrent.exe"",""qtorrent.exe"",""tribler.exe"",""dcplusplus.exe"",""strongdc.exe"",""hydranode.exe"",""jubster.exe"",""pruna.exe"",""entropy.exe"",""bearshare.exe"",""cabos.exe"",""grokster.exe"",""frostwire.exe"",""xolox.exe"",""phex.exe"",""piolet.exe"",""blubster.exe"",""napigator.exe"",""overnet.exe"",""tvuplayer.exe"",""tvprunner.exe"",""coolstreaming.exe"",""tvants.exe"",""pplive.exe"",""peercast.exe"",""iceshare.exe"",""deluge.exe"",""vuze.exe"",""luckywire.exe"",""popcorn-time.exe"") |
| Windows: Anydesk Temporary Artefact | Security | An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_anydesk_artefact.yml | Windows: Anydesk Temporary Artefact | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\AppData\\Roaming\\AnyDesk\\system\.conf.*|.*\\AppData\\Roaming\\AnyDesk\\user\.conf.*"" AND fileName REGEXP "".*\.temp"" |
| Windows: AppInstaller Attempts From URL by DNS | Security | AppInstaller.exe is spawned by the default handler for the ""ms-appinstaller"" URI. It attempts to load/install a package from the referenced URL. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_lolbin_appinstaller.yml | Windows: AppInstaller Attempts From URL by DNS | eventType=""Win-Sysmon-22-DNS-Query"" AND procName REGEXP ""C:\\Program Files\\WindowsApps\\Microsoft\.DesktopAppInstaller_.*"" AND procName REGEXP "".*\\AppInstaller\.exe"" |
| Windows: Atera Agent Installation | Security | Detects successful installation of Atera Remote Monitoring & Management (RMM) agent as recently found to be used by Conti operators. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/msiinstaller/win_software_atera_rmm_agent_install.yml | Windows: Atera Agent Installation | eventType=""Win-App-MsiInstaller-1033"" AND msg REGEXP "".*AteraAgent.*"" |
| Windows: Command Line Execution with Suspicious URL and AppData Strings | Security | Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_http_appdata.yml | Windows: Command Line Execution with Suspicious URL and AppData Strings | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\cmd\.exe"" AND command REGEXP "".*http.*"" AND command REGEXP "".*://.*"" AND command REGEXP "".*%AppData%.*"" |
| Windows: Communication To Ngrok Tunneling Service | Security | Detects an executable accessing an ngrok tunneling endpoint, which could be a sign of forbidden exfiltration of data exfiltration by malicious actors. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_ngrok_tunnel.yml | Windows: Communication To Ngrok Tunneling Service | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND destName REGEXP "".*tunnel\.ap\.ngrok\.com.*|.*tunnel\.au\.ngrok\.com.*|.*tunnel\.eu\.ngrok\.com.*|.*tunnel\.in\.ngrok\.com.*|.*tunnel\.jp\.ngrok\.com.*|.*tunnel\.sa\.ngrok\.com.*|.*tunnel\.us\.ngrok\.com.*"" |
| Windows: Connection Initiated Via Certutil.EXE | Security | Detects a network connection initiated by the certutil.exe tool. Attackers can abuse the utility in order to download malware or additional payloads. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_certutil_initiated_connection.yml | Windows: Connection Initiated Via Certutil.EXE | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND procName REGEXP "".*\\certutil\.exe"" AND initiated=""true"" AND destIpPort IN (135,443,445,80) |
| Windows: Curl Download And Execute Combination | Security | Adversaries can use curl to download payloads remotely and execute them. Curl is included by default in Windows 10 build 17063 and later. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_curl_download_exec_combo.yml | Windows: Curl Download And Execute Combination | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* /c .*"" AND command REGEXP "".*curl .*"" AND command REGEXP "".*http.*"" AND command REGEXP "".*-o.*"" AND command REGEXP "".*&.*"" |
| Windows: Curl.EXE Execution | Security | Detects a curl process start on Windows, which could indicates a file download from a remote location or a simple web request to a remote server. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_curl_execution.yml | Windows: Curl.EXE Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\curl\.exe"" OR product=""The curl executable"") |
| Windows: DNS Exfiltration and Tunneling Tools Execution | Security | Well-known DNS Exfiltration tools execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dns_exfiltration_tools_execution.yml | Windows: DNS Exfiltration and Tunneling Tools Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\iodine\.exe"" OR procName REGEXP "".*\\dnscat2.*"") |
| Windows: Dnscat Execution | Security | Detects Dnscat tool execution. DNScat is a exfiltration tool that can tunnel traffic through DNS servers. It creates a command and control tunnel over the DNS protocol which lets an attacker work in stealth mode. You can access any data along with uploading and downloading files and to get a shell. It provides a bi-directional communication through DNS servers, and in conjunction with PPP, can be used to set up a virtual private network. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_dnscat_execution.yml | Windows: Dnscat Execution | eventType=""Win-PowerShell-4104"" AND script REGEXP ( "".*Start-Dnscat2.*"" ) |
| Windows: Download a File with IMEWDBLD.exe | Security | Use IMEWDBLD.exe (built-in to windows) to download a file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_imewdbld.yml | Windows: Download a File with IMEWDBLD.exe | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND initiated=""true"" AND procName REGEXP "".*\\IMEWDBLD\.exe"" |
| Windows: Download Files Using Notepad GUP Utility | Security | Detects execution of the Notepad++ updater (gup) from a process other than Notepad++ to download files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_gup_download.yml | Windows: Download Files Using Notepad GUP Utility | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\GUP\.exe"" OR srcFileName=""gup.exe"") AND (command REGEXP "".* -unzipTo .*"" AND command REGEXP "".*http.*"")) AND (parentProcName NOT REGEXP "".*\\notepad\+\+\.exe"") |
| Windows: Exfiltration and Tunneling Tools Execution | Security | Execution of well known tools for data exfiltration and tunneling. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_exfiltration_and_tunneling_tools_execution.yml | Windows: Exfiltration and Tunneling Tools Execution | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\httptunnel\.exe|.*\\plink\.exe|.*\\socat\.exe|.*\\stunnel\.exe"" |
| Windows: File Download Via Curl.EXE | Security | Detects file download using curl.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_curl_download.yml | Windows: File Download Via Curl.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\curl\.exe"" OR product=""The curl executable"") AND command REGEXP "".* -O.*|.*--output.*|.*--remote-name.*"" |
| Windows: File Download with Headless Browser | Security | Detects execution of chromium based browser in headless mode using the ""dump-dom"" command line to download files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_browsers_chromium_headless_file_download.yml | Windows: File Download with Headless Browser | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\brave\.exe|.*\\chrome\.exe|.*\\msedge\.exe|.*\\opera\.exe|.*\\vivaldi\.exe"" AND command REGEXP "".*--headless.*"" AND command REGEXP "".*dump-dom.*"" AND command REGEXP "".*http.*"" |
| Windows: Finger.exe Suspicious Invocation | Security | Detects suspicious aged finger.exe tool execution often used in malware attacks nowadays. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_finger_usage.yml | Windows: Finger.exe Suspicious Invocation | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""finger.exe"" OR procName REGEXP "".*\\finger\.exe"") |
| Windows: GfxDownloadWrapper.exe Downloads File from Suspicious URL | Security | Detects when GfxDownloadWrapper.exe downloads file from non standard URL. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_gfxdownloadwrapper_file_download.yml | Windows: GfxDownloadWrapper.exe Downloads File from Suspicious URL | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\GfxDownloadWrapper\.exe"" AND (command NOT REGEXP "".*gameplayapi\.intel\.com.*"" OR parentProcName NOT REGEXP "".*\\GfxDownloadWrapper\.exe|.*\\igfxEM\.exe"") |
| Windows: GoToAssist Temporary Installation Artefact | Security | An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_gotoopener_artefact.yml | Windows: GoToAssist Temporary Installation Artefact | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\AppData\\Local\\Temp\\LogMeInInc\\GoToAssist Remote Support Expert\\.*"" |
| Windows: Gpg4Win Decrypt Files From Suspicious Locations | Security | Detects usage of the Gpg4win to decrypt files located in suspicious locations from CLI. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_gpg4win_susp_usage.yml | Windows: Gpg4Win Decrypt Files From Suspicious Locations | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\gpg2\.exe"" OR product=""GNU Privacy Guard (GnuPG)"" OR company=""g10 Code GmbH"") AND command REGEXP "".*-passphrase.*"" AND command REGEXP "".*C:\\Perflogs\\.*|.*C:\\Windows\\Temp\\.*|.*C:\\temp.*|.*\\AppData\\Roaming\\.*"" |
| Windows: HackTool - SharpChisel Execution | Security | Detects usage of the Sharp Chisel via the commandline arguments. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_sharp_chisel.yml | Windows: HackTool - SharpChisel Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\SharpChisel\.exe"" OR product=""SharpChisel"") |
| Windows: Import LDAP Data Interchange Format File Via Ldifde.EXE | Security | Detects the execution of ""Ldifde.exe"" with the import flag ""-i"". The can be abused to include HTTP-based arguments which will allow the arbitrary download of files from a remote server. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ldifde_file_load.yml | Windows: Import LDAP Data Interchange Format File Via Ldifde.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\ldifde\.exe"" OR srcFileName=""ldifde.exe"") AND (command REGEXP "".*-i.*"" AND command REGEXP "".*-f.*"") |
| Windows: Installation of TeamViewer Desktop | Security | TeamViewer_Desktop.exe is create during install. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_install_teamviewer_desktop.yml | Windows: Installation of TeamViewer Desktop | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\TeamViewer_Desktop\.exe"" |
| Windows: Inveigh Execution Artefacts | Security | Detects the presence and execution of Inveigh via dropped artefacts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_hktl_inveigh_artefacts.yml | Windows: Inveigh Execution Artefacts | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Inveigh-Cleartext\.txt|.*\\Inveigh-FormInput\.txt|.*\\Inveigh-Log\.txt|.*\\Inveigh-NTLMv1Users\.txt|.*\\Inveigh-NTLMv1\.txt|.*\\Inveigh-NTLMv2Users\.txt|.*\\Inveigh-NTLMv2\.txt|.*\\Inveigh-Relay\.ps1|.*\\Inveigh\.dll|.*\\Inveigh\.exe|.*\\Inveigh\.ps1"" |
| Windows: Mesh Agent Service Installation | Security | Detects a Mesh Agent service installation. Mesh Agent is used to remotely manage computers. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_install_mesh_agent.yml | Windows: Mesh Agent Service Installation | (eventType=""Win-System-Service-Control-Manager-7045"") AND (serviceFileName REGEXP "".*MeshAgent\.exe.*"" OR serviceName REGEXP "".*Mesh Agent.*"") |
| Windows: Microsoft Binary Suspicious Communication Endpoint | Security | Detects an executable in the Windows folder accessing suspicious domains. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_binary_susp_com.yml | Windows: Microsoft Binary Suspicious Communication Endpoint | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (procName REGEXP ""C:\\PerfLogs.*|C:\\Temp\\.*|C:\\Users\\Public\\.*|C:\\Windows\\.*"" OR procName REGEXP "".*\\AppData\\Temp\\.*"") AND (initiated=""true"" AND destName REGEXP "".*\.ghostbin\.co|.*\.githubusercontent\.com|.*\.hastebin\.com|.*\.paste\.ee|.*\.pastebin\.com|.*anonfiles\.com|.*cdn\.discordapp\.com|.*ddns\.net|.*dl\.dropboxusercontent\.com|.*mediafire\.com|.*mega\.nz|.*paste\.ee|.*pastebin\.pl|.*pastetext\.net|.*privatlab\.com|.*privatlab\.net|.*send\.exploit\.in|.*sendspace\.com|.*transfer\.sh|.*ufile\.io"") |
| Windows: Mstsc.EXE Execution With Local RDP File | Security | Detects potential RDP connection via Mstsc using a local "".rdp"" file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mstsc_run_local_rdp_file.yml | Windows: Mstsc.EXE Execution With Local RDP File | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\mstsc\.exe"" OR srcFileName=""mstsc.exe"") AND command REGEXP "".*\.rdp|.*\.rdp\"""") AND ((parentProcName!=""C:\\Windows\\System32\\lxss\\wslhost.exe"" OR command NOT REGEXP "".*C:\\ProgramData\\Microsoft\\WSL\\wslg\.rdp.*"")) |
| Windows: New Outlook Macro Created | Security | Detects the creation of a macro file for Outlook. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_outlook_macro_creation.yml | Windows: New Outlook Macro Created | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\outlook\.exe"" AND fileName REGEXP "".*\\Microsoft\\Outlook\\VbaProject\.OTM"" |
| Windows: Pandemic Registry Key | Security | Detects Pandemic Windows Implant. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_apt_pandemic.yml | Windows: Pandemic Registry Key | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*\\SYSTEM\\CurrentControlSet\\services\\null\\Instance.*"" |
| Windows: Port Forwarding Attempt Via SSH | Security | Detects suspicious SSH tunnel port forwarding to a local port. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ssh_port_forward.yml | Windows: Port Forwarding Attempt Via SSH | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\ssh\.exe"" AND command REGEXP "".* -R .*"" |
| Windows: Potential Arbitrary File Download Via MSEdge.EXE | Security | Detects usage of the ""msedge.exe"" binary as a LOLBIN to download arbitrary file via the CLI. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_browsers_msedge_arbitrary_download.yml | Windows: Potential Arbitrary File Download Via MSEdge.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\msedge\.exe"" OR srcFileName=""msedge.exe"") AND command REGEXP "".*\.exe http.*|.*msedge http.*"" |
| Windows: Potential Data Exfiltration Via Curl.EXE | Security | Detects the execution of the ""curl"" process with ""upload"" flags. Which might indicate potential data exfiltration. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_curl_fileupload.yml | Windows: Potential Data Exfiltration Via Curl.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\curl\.exe"" OR product=""The curl executable"") AND (command REGEXP "".* --data .*|.* --data-.*|.* --form.*|.* --upload-file .*"" OR command REGEXP ""\\s-[FTd]\\s"")) AND ((command NOT REGEXP "".*://127\.0\.0\.1.*|.*://localhost.*"")) |
| Windows: Potential Dead Drop Resolvers | Security | Detects an executable, which is not an internet browser, making DNS request to legit popular websites, which were seen to be used as dead drop resolvers in previous attacks. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_dead_drop_resolvers.yml | Windows: Potential Dead Drop Resolvers | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND ((initiated=""true"" AND destName REGEXP "".*\.cloudflare\.com|.*\.githubusercontent\.com|.*cdn\.discordapp\.com|.*docs\.google\.com|.*facebook\.com|.*feeds\.rapidfeeds\.com|.*fotolog\.com|.*imgur\.com|.*livejournal\.com|.*paste\.ee|.*pastebin\.com|.*pastebin\.pl|.*pastetext\.net|.*reddit\.com|.*steamcommunity\.com|.*technet\.microsoft\.com|.*twitter\.com|.*youtube\.com"") AND ((procName NOT REGEXP "".*\\brave\.exe"") AND (procName NOT IN (""C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"",""C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"")) AND (procName NOT IN (""C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"",""C:\\Program Files\\Mozilla Firefox\\firefox.exe"")) AND (procName NOT IN (""C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe"",""C:\\Program Files\\Internet Explorer\\iexplore.exe"")) AND (procName NOT REGEXP "".*\\maxthon\.exe"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeWebView\\Application\\.*"" AND procName NOT REGEXP "".*\\WindowsApps\\MicrosoftEdge\.exe"" AND procName NOT IN (""C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe"",""C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"")) AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\EdgeCore\\.*|C:\\Program Files\\Microsoft\\EdgeCore\\.*"" OR procName NOT REGEXP "".*\\msedge\.exe|.*\\msedgewebview2\.exe"") AND (procName NOT REGEXP "".*\\opera\.exe"") AND (procName NOT REGEXP "".*\\safari\.exe"") AND (procName NOT REGEXP "".*\\seamonkey\.exe"") AND (procName NOT REGEXP "".*\\vivaldi\.exe"") AND (procName NOT REGEXP "".*\\whale\.exe""))) AND ((procName NOT REGEXP "".*\\MsMpEng\.exe|.*\\MsSense\.exe"") AND (procName NOT REGEXP "".*\\PRTG Probe\.exe"") AND (procName NOT REGEXP "".*\\Engine\.exe"")) |
| Windows: Potential Download/Upload Activity Using Type Command | Security | Detects usage of the ""type"" command to download/upload data from WebDAV server. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_type.yml | Windows: Potential Download/Upload Activity Using Type Command | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*type .*"" AND command REGEXP "".* > \\\\\.*"") OR (command REGEXP "".*type \\\\\.*"" AND command REGEXP "".* > .*"")) |
| Windows: Potential RDP Tunneling Via SSH | Security | Execution of ssh.exe to perform data exfiltration and tunneling through RDP. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ssh_rdp_tunneling.yml | Windows: Potential RDP Tunneling Via SSH | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\ssh\.exe"" AND command REGEXP "".*:3389.*"" |
| Windows: Potential RDP Tunneling Via SSH Plink | Security | Execution of plink to perform data exfiltration and tunneling. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_plink_susp_tunneling.yml | Windows: Potential RDP Tunneling Via SSH Plink | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\plink\.exe"" AND (command REGEXP "".*:127\.0\.0\.1:3389.*"" OR (command REGEXP "".*:3389.*"" AND command REGEXP "".* -P 22.*|.* -P 443.*"")) |
| Windows: Potential SocGholish Second Stage C2 DNS Query | Security | Detects a DNS query initiated from a ""wscript"" process for domains matching a specific pattern that was seen being used by SocGholish for its Command and Control traffic. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_malware_socgholish_second_stage_c2.yml | Windows: Potential SocGholish Second Stage C2 DNS Query | eventType=""Win-Sysmon-22-DNS-Query"" AND procName REGEXP "".*\\wscript\.exe"" |
| Windows: PowerShell DownloadFile | Security | Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_susp_ps_downloadfile.yml | Windows: PowerShell DownloadFile | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*powershell.*"" AND command REGEXP "".*\.DownloadFile.*"" AND command REGEXP "".*System\.Net\.WebClient.*"" |
| Windows: Powershell opening TCP Connection | Security | Detects Windows Powershell opening TCP Connection | Windows: Powershell opening TCP Connection | eventType=""Win-PowerShell-4104"" AND msg REGEXP ( "".*Invoke-PowerShellTCP.*"" ) |
| Windows: PUA - 3Proxy Execution | Security | Detects the use of 3proxy, a tiny free proxy server. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_3proxy_execution.yml | Windows: PUA - 3Proxy Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\3proxy\.exe"" OR description=""3proxy - tiny proxy server"" OR command REGEXP "".*\.exe -i127\.0\.0\.1 -p.*"") |
| Windows: PUA - Chisel Tunneling Tool Execution | Security | Detects usage of the Chisel tunneling tool via the commandline arguments. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_chisel.yml | Windows: PUA - Chisel Tunneling Tool Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\chisel\.exe"" OR (command REGEXP "".*exe client .*|.*exe server .*"" AND command REGEXP "".* r:.*|.*-reverse.*|.*-socks5.*|.*-tls-skip-verify .*|.*:127\.0\.0\.1:.*|.*:socks.*"")) |
| Windows: PUA - Netcat Suspicious Execution | Security | Detects execution of Netcat. Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_netcat.yml | Windows: PUA - Netcat Suspicious Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\nc\.exe|.*\\ncat\.exe|.*\\netcat\.exe"" OR command REGEXP "".* --lua-exec .*|.* --sh-exec .*|.* -l --proxy-type http .*|.* -l -v -p .*|.* -lv -p .*|.* -lvnp.*|.* -lvp .*|.* -vnl --exec .*|.* -vnl -e .*"") |
| Windows: PUA - Ngrok Execution | Security | Detects the use of Ngrok, a utility used for port forwarding and tunneling, often used by threat actors to make local protected services publicly available. Involved domains are bin.equinox.io for download and *.ngrok.io for connections. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_ngrok.yml | Windows: PUA - Ngrok Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".* tcp 139.*|.* tcp 3389.*|.* tcp 445.*|.* tcp 5985.*|.* tcp 5986.*"" OR (command REGEXP "".* start .*"" AND command REGEXP "".*--all.*"" AND command REGEXP "".*--config.*"" AND command REGEXP "".*\.yml.*"") OR (procName REGEXP "".*ngrok\.exe"" AND command REGEXP "".* authtoken .*|.* http .*|.* tcp .*"") OR command REGEXP "".*\.exe authtoken .*|.*\.exe start --all.*"") |
| Windows: PUA - Nimgrab Execution | Security | Detects the usage of nimgrab, a tool bundled with the Nim programming framework and used for downloading files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_nimgrab.yml | Windows: PUA - Nimgrab Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\nimgrab\.exe"" OR hashCode REGEXP "".*IMPHASH=C07FDDD21D123EA9B3A08EEF44AAAC45.*|.*MD5=2DD44C3C29D667F5C0EF5F9D7C7FFB8B.*|.*SHA256=F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559.*"" OR hashMD5=""2DD44C3C29D667F5C0EF5F9D7C7FFB8B"" OR hashSHA256=""F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559"" OR hashIMP=""C07FDDD21D123EA9B3A08EEF44AAAC45"") |
| Windows: Query Tor Onion Address | Security | Detects DNS resolution of an .onion address related to Tor routing networks. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_tor_onion.yml | Windows: Query Tor Onion Address | eventType=""Win-Sysmon-22-DNS-Query"" AND queryId REGEXP "".*\.onion.*"" |
| Windows: RDP Over Reverse SSH Tunnel | Security | Detects svchost hosting RDP termsvcs communicating with the loopback address and on TCP port 3389. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_rdp_reverse_tunnel.yml | Windows: RDP Over Reverse SSH Tunnel | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (procName REGEXP "".*\\svchost\.exe"" AND initiated=""true"" AND srcIpPort=3389) AND destIpAddr BETWEEN(127.0.0.0,127.255.255.255) |
| Windows: RDP over Reverse SSH Tunnel WFP | Security | Detects svchost hosting RDP termsvcs communicating with the loopback address. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_rdp_reverse_tunnel.yml | Windows: RDP over Reverse SSH Tunnel WFP | (eventType=""Win-Security-5156"" AND ((srcIpPort=3389 AND ( destIpAddr=""::1"" OR destIpAddr BETWEEN (127.0.0.0,127.255.255.255) )) OR (destIpPort=3389 AND ( srcIpAddr=""::1"" OR srcIpAddr BETWEEN (127.0.0.0,127.255.255.255) )))) AND ((filter!=""AppContainer Loopback"") AND (appName NOT REGEXP "".*\\thor64\.exe|.*\\thor\.exe"")) |
| Windows: RDP to HTTP or HTTPS Target Ports | Security | Detects svchost hosting RDP termsvcs communicating to target systems on TCP port 80 or 443. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_rdp_to_http.yml | Windows: RDP to HTTP or HTTPS Target Ports | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND procName REGEXP "".*\\svchost\.exe"" AND initiated=""true"" AND srcIpPort=3389 AND destIpPort IN (443,80) |
| Windows: Remote Access Tool - AnyDesk Execution | Security | An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk.yml | Windows: Remote Access Tool - AnyDesk Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\AnyDesk\.exe"" OR description=""AnyDesk"" OR product=""AnyDesk"" OR company=""AnyDesk Software GmbH"") |
| Windows: Remote Access Tool - AnyDesk Piped Password Via CLI | Security | Detects piping the password to an anydesk instance via CMD and the '--set-password' flag. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_piped_password_via_cli.yml | Windows: Remote Access Tool - AnyDesk Piped Password Via CLI | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*/c .*"" AND command REGEXP "".*echo .*"" AND command REGEXP "".*\.exe --set-password.*"" |
| Windows: Remote Access Tool - AnyDesk Silent Installation | Security | Detects AnyDesk Remote Desktop silent installation. Which can be used by attackers to gain remote access. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_silent_install.yml | Windows: Remote Access Tool - AnyDesk Silent Installation | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*--install.*"" AND command REGEXP "".*--start-with-win.*"" AND command REGEXP "".*--silent.*"" |
| Windows: Remote Access Tool - ScreenConnect Backstage Mode Anomaly | Security | Detects suspicious sub processes started by the ScreenConnect client service, which indicates the use of the so-called Backstage mode. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_anomaly.yml | Windows: Remote Access Tool - ScreenConnect Backstage Mode Anomaly | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*ScreenConnect\.ClientService\.exe"" AND procName REGEXP "".*\\cmd\.exe|.*\\powershell\.exe|.*\\pwsh\.exe"" |
| Windows: Remote File Download via Desktopimgdownldr Utility | Security | Detects the desktopimgdownldr utility being used to download a remote file. An adversary may use desktopimgdownldr to download arbitrary files as an alternative to certutil. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_desktopimgdownldr_remote_file_download.yml | Windows: Remote File Download via Desktopimgdownldr Utility | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\desktopimgdownldr\.exe"" AND parentProcName REGEXP "".*\\desktopimgdownldr\.exe"" AND command REGEXP "".*/lockscreenurl:http.*"" |
| Windows: Replace.exe Usage | Security | Detects the use of Replace.exe which can be used to replace file with another file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_replace.yml | Windows: Replace.exe Usage | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\replace\.exe"" AND command REGEXP "".*-a.*|.*/a.*"" |
| Windows: ScreenConnect Temporary Installation Artefact | Security | An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_remote_access_tools_screenconnect_artefact.yml | Windows: ScreenConnect Temporary Installation Artefact | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Bin\\ScreenConnect\..*"" |
| Windows: Script Initiated Connection | Security | Detects a script interpreter wscript/cscript opening a network connection. Adversaries may use script to download malicious payloads. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_script.yml | Windows: Script Initiated Connection | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND initiated=""true"" AND procName REGEXP "".*\\cscript\.exe|.*\\wscript\.exe"" |
| Windows: Script Initiated Connection to Non-Local Network | Security | Detects a script interpreter wscript/cscript opening a network connection to a non-local network. Adversaries may use script to download malicious payloads. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_script_wan.yml | Windows: Script Initiated Connection to Non-Local Network | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (initiated=""true"" AND procName REGEXP "".*\\cscript\.exe|.*\\wscript\.exe"") AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) |
| Windows: Suspicious ADSI-Cache Usage By Unknown Tool | Security | Detects the usage of ADSI (LDAP) operations by tools. This may also detect tools like LDAPFragger. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_adsi_cache_usage.yml | Windows: Suspicious ADSI-Cache Usage By Unknown Tool | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP "".*\\Local\\Microsoft\\Windows\\SchCache\\.*"" AND fileName REGEXP "".*\.sch"") AND ((procName NOT IN (""C:\\Program Files\\Cylance\\Desktop\\CylanceSvc.exe"",""C:\\Windows\\CCM\\CcmExec.exe"",""C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"",""C:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe"",""C:\\windows\\system32\\dllhost.exe"",""C:\\windows\\system32\\mmc.exe"",""C:\\windows\\system32\\svchost.exe"")) AND (procName NOT REGEXP ""C:\\Program Files\\SentinelOne\\Sentinel Agent.*|C:\\Windows\\ccmsetup\\autoupgrade\\ccmsetup.*"") AND (procName NOT REGEXP "".*\\LANDesk\\LDCLient\\ldapwhoami\.exe"") AND (procName NOT IN (""C:\\Windows\\system32\\dsac.exe"",""C:\\Windows\\system32\\efsui.exe"")) AND (procName NOT REGEXP "".*:\\Program Files\\Citrix\\Receiver StoreFront\\Services\\DefaultDomainServices\\Citrix\.DeliveryServices\.DomainServices\.ServiceHost\.exe"")) |
| Windows: Suspicious Binary Writes Via AnyDesk | Security | Detects AnyDesk writing binary files to disk other than ""gcapi.dll"". According to RedCanary research it is highly abnormal for AnyDesk to write executable files to disk besides gcapi.dll, which is a legitimate DLL that is part of the Google Chrome web browser used to interact with the Google Cloud API. (See reference section for more details) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_anydesk_writing_susp_binaries.yml | Windows: Suspicious Binary Writes Via AnyDesk | eventType=""Win-Sysmon-11-FileCreate"" AND (procName REGEXP "".*\\anydesk\.exe"" AND fileName REGEXP "".*\.dll|.*\.exe"") AND ((fileName NOT REGEXP "".*\\gcapi\.dll"")) |
| Windows: Suspicious Certreq Command to Download | Security | Detects a suspicious certreq execution taken from the LOLBAS examples, which can be abused to download (small) files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_susp_certreq_download.yml | Windows: Suspicious Certreq Command to Download | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\certreq\.exe"" OR srcFileName=""CertReq.exe"") AND (command REGEXP "".* -Post .*"" AND command REGEXP "".* -config .*"" AND command REGEXP "".* http.*"" AND command REGEXP "".* C:\\windows\\win\.ini .*"") |
| Windows: Suspicious Cobalt Strike DNS Beaconing | Security | Detects a program that invoked suspicious DNS queries known from Cobalt Strike beacons. Cobalt Strike (https://www.cobaltstrike.com/) is an adversary simulation tool with a post-exploitation agent and covert channels to emulate a quiet long-term embedded actor in your network. It uses Process injection, a defense evasion technique that runs custom code within the address space of another process, thereby avoiding detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_mal_cobaltstrike.yml | Windows: Suspicious Cobalt Strike DNS Beaconing | eventType=""Win-Sysmon-22-DNS-Query"" AND (queryId REGEXP ""aaa\.stage\..*|post\.1.*"" OR queryId REGEXP "".*\.stage\.123456\..*"") |
| Windows: Suspicious Curl Change User Agents | Security | Detects execution of curl.exe with custom useragent options. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_curl_useragent.yml | Windows: Suspicious Curl Change User Agents | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\curl\.exe"" OR product=""The curl executable"") AND command REGEXP "".* --user-agent .*|.* -A .*"" |
| Windows: Suspicious Curl.EXE Download | Security | Detects a suspicious curl process start on Windows and outputs the requested document to a local file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_curl_susp_download.yml | Windows: Suspicious Curl.EXE Download | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\curl\.exe"" OR product=""The curl executable"") AND (command REGEXP "".*%AppData%.*|.*%Public%.*|.*%Temp%.*|.*%tmp%.*|.*C:\\PerfLogs\\.*|.*C:\\ProgramData\\.*|.*C:\\Windows\\Temp\\.*|.*\\AppData\\.*|.*\\Desktop\\.*|.*\\Temp\\.*|.*\\Users\\Public\\.*"" OR command REGEXP "".*\.dll|.*\.gif|.*\.jpeg|.*\.jpg|.*\.png|.*\.temp|.*\.tmp|.*\.txt|.*\.vbe|.*\.vbs"")) AND ((parentProcName!=""C:\\Program Files\\Git\\usr\\bin\\sh.exe"" OR procName!=""C:\\Program Files\\Git\\mingw64\\bin\\curl.exe"" OR command NOT REGEXP "".*--silent --show-error --output .*"" OR command NOT REGEXP "".*gfw-httpget-.*"" OR command NOT REGEXP "".*AppData.*"")) |
| Windows: Suspicious Desktopimgdownldr Command | Security | Detects a suspicious Microsoft desktopimgdownldr execution with parameters used to download files from the Internet. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_desktopimgdownldr_susp_execution.yml | Windows: Suspicious Desktopimgdownldr Command | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".* /lockscreenurl:.*"" AND (command NOT REGEXP "".*\.jpeg.*|.*\.jpg.*|.*\.png.*"")) OR (command REGEXP "".*reg delete.*"" AND command REGEXP "".*\\PersonalizationCSP.*"")) |
| Windows: Suspicious Desktopimgdownldr Target File | Security | Detects a suspicious Microsoft desktopimgdownldr file creation that stores a file to a suspicious location or contains a file with a suspicious extension. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_desktopimgdownldr_file.yml | Windows: Suspicious Desktopimgdownldr Target File | eventType=""Win-Sysmon-11-FileCreate"" AND ((procName REGEXP "".*\\svchost\.exe"" AND fileName REGEXP "".*\\Personalization\\LockScreenImage\\.*"") AND (fileName NOT REGEXP "".*C:\\Windows\\.*"")) AND (fileName NOT REGEXP "".*\.jpeg.*|.*\.jpg.*|.*\.png.*"") |
| Windows: Suspicious Diantz Download and Compress Into a CAB File | Security | Download and compress a remote file and store it in a cab file on local machine. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_diantz_remote_cab.yml | Windows: Suspicious Diantz Download and Compress Into a CAB File | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*diantz\.exe.*"" AND command REGEXP "".* \\\\\.*"" AND command REGEXP "".*\.cab.*"" |
| Windows: Suspicious Extrac32 Execution | Security | Download or Copy file with Extrac32. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_extrac32.yml | Windows: Suspicious Extrac32 Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*extrac32\.exe.*"" OR procName REGEXP "".*\\extrac32\.exe"" OR srcFileName=""extrac32.exe"") AND command REGEXP "".*\.cab.*"" AND command REGEXP "".* \\\\\.*|.*/C.*|.*/Y.*"" |
| Windows: Suspicious File Download Using Office Application | Security | Detects the usage of one of three Microsoft office applications (Word, Excel, PowerPoint) to download arbitrary files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_office.yml | Windows: Suspicious File Download Using Office Application | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\excel\.exe|.*\\powerpnt\.exe|.*\\winword\.exe"" AND command REGEXP "".*http.*"" |
| Windows: Suspicious File Download via CertOC.exe | Security | Detects when a user downloads file by using CertOC.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_certoc_download.yml | Windows: Suspicious File Download via CertOC.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\certoc\.exe"" OR srcFileName=""CertOC.exe"") AND command REGEXP "".*-GetCACAPS.*"" |
| Windows: Suspicious Invoke-WebRequest Execution | Security | Detects a suspicious call to Invoke-WebRequest cmdlet where the and output is located in a suspicious location. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_invoke_webrequest_download.yml | Windows: Suspicious Invoke-WebRequest Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".*Invoke-WebRequest.*|.*curl .*|.*iwr .*|.*wget .*"" AND command REGEXP "".* -o.*|.* -ur.*"" AND command REGEXP "".*%AppData%.*|.*%Public%.*|.*%Temp%.*|.*%tmp%.*|.*C:\\Windows\\.*|.*\\AppData\\.*|.*\\Desktop\\.*|.*\\Temp\\.*|.*\\Users\\Public\\.*"" |
| Windows: Suspicious Invoke-WebRequest Execution With DirectIP | Security | Detects calls to PowerShell with Invoke-WebRequest cmdlet using direct IP access. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_invoke_webrequest_direct_ip.yml | Windows: Suspicious Invoke-WebRequest Execution With DirectIP | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".*Invoke-WebRequest.*|.*curl .*|.*iwr .*|.*wget .*"" AND command REGEXP "".*://1.*|.*://2.*|.*://3.*|.*://4.*|.*://5.*|.*://6.*|.*://7.*|.*://8.*|.*://9.*"" |
| Windows: Suspicious LDAP-Attributes Used | Security | Detects the usage of particular AttributeLDAPDisplayNames, which are known for data exchange via LDAP by the tool LDAPFragger and are additionally not commonly used in companies. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_ldap_dataexchange.yml | Windows: Suspicious LDAP-Attributes Used | eventType=""Win-Security-5136"" AND propValue REGEXP "".*"" AND propName IN (""otherFacsimileTelephoneNumber"",""primaryInternationalISDNNumber"",""primaryTelexNumber"") |
| Windows: Suspicious Mstsc.EXE Execution With Local RDP File | Security | Detects potential RDP connection via Mstsc using a local "".rdp"" file located in suspicious locations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mstsc_run_local_rdp_file_susp_location.yml | Windows: Suspicious Mstsc.EXE Execution With Local RDP File | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\mstsc\.exe"" OR srcFileName=""mstsc.exe"") AND command REGEXP "".*\.rdp|.*\.rdp\"""" AND command REGEXP "".*:\\Users\\Public\\.*|.*:\\Windows\\System32\\Tasks_Migrated .*|.*:\\Windows\\System32\\spool\\drivers\\color.*|.*:\\Windows\\Tasks\\.*|.*:\\Windows\\Temp\\.*|.*:\\Windows\\Tracing\\.*|.*\\AppData\\Local\\Temp\\.*|.*\\Downloads\\.*"" |
| Windows: Suspicious Outlook Macro Created | Security | Detects the creation of a macro file for Outlook. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_outlook_susp_macro_creation.yml | Windows: Suspicious Outlook Macro Created | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Microsoft\\Outlook\\VbaProject\.OTM"" AND (procName NOT REGEXP "".*\\outlook\.exe"") |
| Windows: Suspicious Plink Port Forwarding | Security | Detects suspicious Plink tunnel port forwarding to a local port. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_plink_port_forwarding.yml | Windows: Suspicious Plink Port Forwarding | eventType=""Win-Sysmon-1-Create-Process"" AND description=""Command-line SSH, Telnet, and Rlogin client"" AND command REGEXP "".* -R .*"" |
| Windows: Suspicious Program Location with Network Connections | Security | Detects programs with network connections running in suspicious files system locations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_susp_prog_location_network_connection.yml | Windows: Suspicious Program Location with Network Connections | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND (procName REGEXP "".*\\Users\\All Users\\.*|.*\\Users\\Contacts\\.*|.*\\Users\\Default\\.*|.*\\Users\\Public\\.*|.*\\Users\\Searches\\.*|.*\\Windows\\Fonts\\.*|.*\\Windows\\IME\\.*|.*\\Windows\\addins\\.*|.*\\config\\systemprofile\\.*"" OR procName REGEXP "".*\\\$Recycle\.bin"" OR procName REGEXP ""C:\\Perflogs\\.*"") AND ((procName NOT REGEXP ""C:\\Users\\Public\\IBM\\ClientSolutions\\Start_Programs\\.*"")) |
| Windows: Suspicious TeamViewer Domain Access | Security | Detects DNS queries to a TeamViewer domain only resolved by a TeamViewer client by an image that isn't named TeamViewer (sometimes used by threat actors for obfuscation). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_susp_teamviewer.yml | Windows: Suspicious TeamViewer Domain Access | eventType=""Win-Sysmon-22-DNS-Query"" AND queryId IN (""taf.teamviewer.com"",""udp.ping.teamviewer.com"") AND (procName NOT REGEXP "".*TeamViewer.*"") |
| Windows: Suspicious TSCON Start as SYSTEM | Security | Detects a tscon.exe start as LOCAL SYSTEM. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_tscon_localsystem.yml | Windows: Suspicious TSCON Start as SYSTEM | eventType=""Win-Sysmon-1-Create-Process"" AND domain REGEXP "".*AUTHORI.*|.*AUTORI.*"" AND procName REGEXP "".*\\tscon\.exe"" |
| Windows: Suspicious Typical Malware Back Connect Ports | Security | Detects programs that connect to typical malware back connect ports based on statistical analysis from two different sandbox system databases. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_malware_backconnect_ports.yml | Windows: Suspicious Typical Malware Back Connect Ports | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND ((initiated=""true"" AND destIpPort IN (100,10101,12102,12103,12322,13145,13394,13504,13505,13506,13507,14102,14103,14154,1443,1515,1777,1817,1904,1960,198,200,243,2443,2448,3360,3675,3939,4040,4433,4438,4443,4444,4455,473,49180,5445,5552,5649,65520,65535,6625,666,700,7210,743,777,8080,8143,8843,8888,9631,9943)) AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)) AND ((procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"")) |
| Windows: TacticalRMM Service Installation | Security | Detects a TacticalRMM service installation. Tactical RMM is a remote monitoring & management tool. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_service_install_tacticalrmm.yml | Windows: TacticalRMM Service Installation | (eventType=""Win-System-Service-Control-Manager-7045"") AND (serviceFileName REGEXP "".*tacticalrmm\.exe.*"" OR serviceName REGEXP "".*TacticalRMM Agent Service.*"") |
| Windows: TeamViewer Remote Session | Security | Detects the creation of log files during a TeamViewer remote session. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_teamviewer_remote_session.yml | Windows: TeamViewer Remote Session | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP "".*\\TeamViewer\\RemotePrinting\\tvprint\.db|.*\\TeamViewer\\TVNetwork\.log"" OR (fileName REGEXP "".*\\TeamViewer.*"" AND fileName REGEXP "".*_Logfile\.log.*"")) |
| Windows: Tor Client or Tor Browser Use | Security | Detects the use of Tor or Tor-Browser to connect to onion routing networks. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_browsers_tor_execution.yml | Windows: Tor Client or Tor Browser Use | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\Tor Browser\\Browser\\firefox\.exe|.*\\tor\.exe"" |
| Windows: Use of GoToAssist Remote Access Software | Security | An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remote_access_tools_gotoopener.yml | Windows: Use of GoToAssist Remote Access Software | eventType=""Win-Sysmon-1-Create-Process"" AND (description=""GoTo Opener"" OR product=""GoTo Opener"" OR company=""LogMeIn, Inc."") |
| Windows: Use of LogMeIn Remote Access Software | Security | An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remote_access_tools_logmein.yml | Windows: Use of LogMeIn Remote Access Software | eventType=""Win-Sysmon-1-Create-Process"" AND (description=""LMIGuardianSvc"" OR product=""LMIGuardianSvc"" OR company=""LogMeIn, Inc."") |
| Windows: Use of ScreenConnect Remote Access Software | Security | An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect.yml | Windows: Use of ScreenConnect Remote Access Software | eventType=""Win-Sysmon-1-Create-Process"" AND (description=""ScreenConnect Service"" OR product=""ScreenConnect"" OR company=""ScreenConnect Software"") |
| Windows: Use of UltraViewer Remote Access Software | Security | An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remote_access_software_ultraviewer.yml | Windows: Use of UltraViewer Remote Access Software | eventType=""Win-Sysmon-1-Create-Process"" AND (product=""UltraViewer"" OR company=""DucFabulous Co,ltd"" OR srcFileName=""UltraViewer_Desktop.exe"") |
| Windows: Use of UltraVNC Remote Access Software | Security | An adversary may use legitimate desktop support and remote access software,to establish an interactive command and control channel to target systems within networks. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ultravnc.yml | Windows: Use of UltraVNC Remote Access Software | eventType=""Win-Sysmon-1-Create-Process"" AND (description=""VNCViewer"" OR product=""UltraVNC VNCViewer"" OR company=""UltraVNC"" OR srcFileName=""VNCViewer.exe"") |
| Windows: Windows Update Client LOLBIN | Security | Detects code execution via the Windows Update client (wuauclt). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wuauclt_execution.yml | Windows: Windows Update Client LOLBIN | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\wuauclt\.exe"" OR srcFileName=""wuauclt.exe"") AND (command REGEXP "".*/UpdateDeploymentProvider.*"" AND command REGEXP "".*/RunHandlerComServer.*"" AND command REGEXP "".*\.dll.*"")) AND (command NOT REGEXP "".* /ClassId .*|.* wuaueng\.dll .*"") |
| ICS Alert: Commonly Used Port | Security | An ICS monitoring system has detected an event containing Mitre ICS Technique ID T0885 - Commonly Used Port. Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend in with normal network activity, to avoid more detailed inspection. | ICS Alert: Commonly Used Port | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0885(,T\d+)*$"" |
| ICS Alert: Connection Proxy | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0884 - Connection Proxy. Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications. | ICS Alert: Connection Proxy | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0884(,T\d+)*$"" |
| ICS Alert: Standard Application Layer Protocol | Security | An ICS monitoring system has detected an event containing MITRE ICS Technique ID T0869 - Standard Application Layer Protocol. Adversaries may establish command and control capabilities over commonly used application layer protocols such as HTTP(S), OPC, RDP, telnet, DNP3, and modbus. | ICS Alert: Standard Application Layer Protocol | (eventType CONTAIN ""FortiDeceptor-"" OR eventType CONTAIN ""Dragos-"" OR eventType CONTAIN ""Nozomi-"") AND attackTechniqueId REGEXP ""^(T\d+,)*T0869(,T\d+)*$"" |
| Cisco Call Manager CPU High | Performance | Cisco Call Manager CPU constantly over configured threshold for a period of time | Cisco Call Manager CPU High | eventType = ""Cisco_UC_RTMT_CpuPegging"" |
| Cisco CallManager Node High CPU | Performance | A node in the cluster that services phones is experiencing high CPU load for a sustained period of time. | Cisco CallManager Node High CPU | eventType = ""Cisco_UC_RTMT_CallProcessingNodeCpuPegging"" |
| Account Locked: Domain | Security | Detects account lockout caused by excessive logon failures | Account Locked: Domain | eventType IN (Group@PH_SYS_EVENT_DomainAccountLocked) AND reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER) |
| Account Locked: FortiSIEM | Security | Detects system (FortiSIEM) account lockout caused by excessive logon failures | Account Locked: FortiSIEM | eventType = ""PH_AUDIT_ACCOUNT_LOCKED"" |
| Account Locked: Network Device | Security | Detects account lockout caused by excessive logon failures | Account Locked: Network Device | eventType IN (Group@PH_SYS_EVENT_HostAccountLocked) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Account Locked: Server | Security | Detects account lockout caused by excessive logon failures | Account Locked: Server | eventType IN (Group@PH_SYS_EVENT_HostAccountLocked) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Server) AND reptDevIpAddr NOT IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER) AND eventType != ""PH_AUDIT_ACCOUNT_LOCKED"" |
| ARP Exploit | Security | Detects ARP attack | ARP Exploit | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_ARPExploit) |
| AWS Access Secret in Secrets Manager | Security | An adversary may attempt to access the secrets in secrets manager to steal certificates, credentials, or other sensitive material | AWS Access Secret in Secrets Manager | eventType CONTAIN ""AWS-CloudTrail-SECRETSMANAGER-GetSecretValue"" |
| AWS IAM Brute Force of Assume Role Policy | Security | Identifies a high number of failed attempts to assume an AWS Identity and Access Management (IAM) role. IAM roles are used to delegate access to users or services. An adversary may attempt to enumerate IAM roles in order to determine if a role exists before attempting to assume or hijack the discovered role. | AWS IAM Brute Force of Assume Role Policy | eventType CONTAIN ""AWS-CloudTrail-IAM-UpdateAssumeRolePolicy"" AND errorString = ""MalformedPolicyDocumentException"" |
| AWS Management Console Brute Force of Root User Identity | Security | Identifies a high number of failed authentication attempts to the AWS management console for the Root user identity. An adversary may attempt to brute force the password for the Root user identity, as it has complete access to all services and resources for the AWS account. | AWS Management Console Brute Force of Root User Identity | eventType CONTAIN ""AWS-CloudTrail-SIGNIN-ConsoleLogin"" AND userType = ""Root"" |
| AWS SecHub: Tactics: Credential Access Detected | Security | AWS Security Hub detected Credential Access tactics. Adversary is trying to steal account names and passwords. | AWS SecHub: Tactics: Credential Access Detected | eventType = ""AWS-Hub-TTPs-Credential_Access"" |
| Azure Key Vault Modified | Security | Identifies modifications to a Key Vault in Azure. The Key Vault is a service that safeguards encryption keys and secrets like certificates, connection strings, and passwords. Because this data is sensitive and business critical, access to key vaults should be secured to allow only authorized applications and users. | Azure Key Vault Modified | eventType = ""MS_EvtHub_keyvault_vaults_write"" |
| Azure Storage Account Key Regenerated | Security | Identifies a rotation to storage account access keys in Azure. Regenerating access keys can affect any applications or Azure services that are dependent on the storage account key. Adversaries may regenerate a key as a means of acquiring credentials to access systems and resources. | Azure Storage Account Key Regenerated | eventType = ""MS_EvtHub_storage_storageaccounts_regeneratekey_action"" |
| Brute Force App Login Success | Security | Detects an unusual condition where a source has authentication failures followed by a successful authentication at the same app within 15 minutes | Brute Force App Login Success | eventType IN (Group@PH_SYS_EVENT_MultipleVPNLogonFailure,Group@PH_SYS_EVENT_MultipleDBLogonFailure,Group@PH_SYS_EVENT_MultipleWebLogonFailure,Group@PH_SYS_EVENT_MultipleAppLogonFailure) AND user IS NOT NULL |
| Brute Force App Login Success | Security | Detects an unusual condition where a source has authentication failures followed by a successful authentication at the same app within 15 minutes | Brute Force App Login Success | eventType IN (Group@PH_SYS_EVENT_VPNLogonFailure,Group@PH_SYS_EVENT_DBLogonFailure,Group@PH_SYS_EVENT_WebLogonFailure,Group@PH_SYS_EVENT_AppLogonFailure) AND user IS NOT NULL |
| Brute Force App Login Success | Security | Detects an unusual condition where a source has authentication failures followed by a successful authentication at the same app within 15 minutes | Brute Force App Login Success | eventType IN (Group@PH_SYS_EVENT_VPNLogonSuccess,Group@PH_SYS_EVENT_DBLogonSuccess,Group@PH_SYS_EVENT_WebLogonSuccess,Group@PH_SYS_EVENT_AppLogonSuccess) AND user IS NOT NULL |
| Brute Force Host Login Success | Security | Detects an unusual condition where a source has authentication failures followed by a successful authentication at the same host within 15 minutes | Brute Force Host Login Success | eventType IN (Group@PH_SYS_EVENT_HostLogonFailure,Group@PH_SYS_EVENT_VMware_LogonFailure,Group@PH_SYS_EVENT_DomainLogonFailure) AND user IS NOT NULL |
| Brute Force Host Login Success | Security | Detects an unusual condition where a source has authentication failures followed by a successful authentication at the same host within 15 minutes | Brute Force Host Login Success | eventType IN (Group@PH_SYS_EVENT_HostLogonSuccess,Group@PH_SYS_EVENT_VMware_LogonSuccess,Group@PH_SYS_EVENT_DomainLogonSuccess) AND user IS NOT NULL |
| Brute Force Host Login Success | Security | Detects an unusual condition where a source has authentication failures followed by a successful authentication at the same host within 15 minutes | Brute Force Host Login Success | eventType IN (Group@PH_SYS_EVENT_MultipleHostLogonFailure,Group@PH_SYS_EVENT_MultipleDomainLogonFailure) AND user IS NOT NULL |
| Cisco Call Manager EMCC Login Failure | Security | Cisco Extension Mobility Cross Cluster (EMCC) login failure due to invalid user input due to invalid user credentials or the credentials have expired | Cisco Call Manager EMCC Login Failure | eventType = ""Cisco_UC_RTMT_UserInputFailure"" |
| Cisco CallManager Excessive Authentication Failure | Security | Number of AuthenticationFailed events exceeds configured limit | Cisco CallManager Excessive Authentication Failure | eventType = ""Cisco_UC_RTMT_AuthenticationFailed"" |
| Concurrent Failed Authentications To Same Account From Multiple Cities | Security | Detects simultaneous failed authentications to the same system and the same account from different cities. This may indicate stolen credentials unless it is an administrative account and is supposed to be accessed by administrators from multiple cities. | Concurrent Failed Authentications To Same Account From Multiple Cities | eventType IN (Group@PH_SYS_EVENT_HostLogonFailure,Group@PH_SYS_EVENT_DomainLogonFailure) AND user IS NOT NULL AND srcGeoCity IS NOT NULL |
| Concurrent Failed Authentications To Same Account From Multiple Countries | Security | Detects simultaneous failed authentications to the same system and the same account from different countries. This may indicate stolen credentials unless it is an administrative account and is supposed to be accessed by administrators from multiple countries. | Concurrent Failed Authentications To Same Account From Multiple Countries | eventType IN (Group@PH_SYS_EVENT_HostLogonFailure,Group@PH_SYS_EVENT_DomainLogonFailure) AND user IS NOT NULL AND srcGeoCountry IS NOT NULL |
| Concurrent Successful Authentications To Same Account From Multiple Cities | Security | Detects simultaneous successful server/network device/domain authentications to the same system and the same account from different cities. This may indicate stolen credentials unless it is an administrative account and is supposed to be accessed by administrators from multiple cities. | Concurrent Successful Authentications To Same Account From Multiple Cities | eventType IN (Group@PH_SYS_EVENT_HostLogonSuccess,Group@PH_SYS_EVENT_DomainLogonSuccess) AND user IS NOT NULL AND srcGeoCity IS NOT NULL |
| Concurrent Successful Authentications To Same Account From Multiple Countries | Security | Detects simultaneous successful server/network device/domain authentications to the same system and the same account from different countries. This may indicate stolen credentials unless it is an administrative account and is supposed to be accessed by administrators from multiple countries. | Concurrent Successful Authentications To Same Account From Multiple Countries | eventType IN (Group@PH_SYS_EVENT_HostLogonSuccess,Group@PH_SYS_EVENT_DomainLogonSuccess) AND user IS NOT NULL AND srcGeoCountry IS NOT NULL |
| Concurrent Successful VPN Authentications To Same Account From Different Countries | Security | Detects simultaneous successful VPN authentications to the same account within a short period of time from different countries. This may indicate a stolen credential. | Concurrent Successful VPN Authentications To Same Account From Different Countries | eventType IN (Group@PH_SYS_EVENT_VPNLogonSuccess) AND user IS NOT NULL AND user != ""N/A"" AND srcGeoCountry IS NOT NULL AND srcGeoCountry != ""N/A"" |
| Crowdstrike: Credential Theft Detected | Security | Crowdstrike agent detected credential theft | Crowdstrike: Credential Theft Detected | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Credential-Theft"" |
| CyberArk Vault Blocked Operations | Security | Detects CyberArk Vault blocked operations | CyberArk Vault Blocked Operations | eventType IN (""CyberArk-Vault-403"",""CyberArk-Vault-408"",""CyberArk-Vault-409"") |
| CyberArk Vault CPM Password Disabled | Security | Detects CyberArk Vault password being disabled via CPM | CyberArk Vault CPM Password Disabled | eventType = ""CyberArk-Vault-130"" |
| CyberArk Vault Excessive Failed PSM Connections | Security | Detects excessive failed connections to CyberArk Vault via Privileged Session Manager | CyberArk Vault Excessive Failed PSM Connections | eventType IN (""CyberArk-Vault-301"",""CyberArk-Vault-379"") |
| CyberArk Vault Excessive Impersonations | Security | Detects excessive CyberArk Privileged Session Manager Session Monitoring Failures | CyberArk Vault Excessive Impersonations | eventType IN (""CyberArk-Vault-15"",""CyberArk-Vault-18"") |
| CyberArk Vault Excessive Password Release Failure | Security | Detects excessive password release failures from CyberArk Vault Central Policy Manager | CyberArk Vault Excessive Password Release Failure | eventType = ""CyberArk-Vault-137"" |
| CyberArk Vault Excessive PSM Keystroke Logging Failure | Security | Detects CyberArk vault keystroke logging and audit failures via Privileged Session Manager | CyberArk Vault Excessive PSM Keystroke Logging Failure | eventType IN (""CyberArk-Vault-362"",""CyberArk-Vault-413"") |
| CyberArk Vault Excessive PSM Session Monitoring Failure | Security | Detects excessive CyberArk Privileged Session Manager Session Monitoring Failures | CyberArk Vault Excessive PSM Session Monitoring Failure | eventType = ""CyberArk-Vault-375"" |
| CyberArk Vault File Operation Failure | Security | Detects CyberArk Vault file operation failures | CyberArk Vault File Operation Failure | eventType IN (""CyberArk-Vault-204"",""CyberArk-Vault-205"") |
| CyberArk Vault Object Content Validation Failure | Security | Detects CyberArk Vault Object Content Validation Failures | CyberArk Vault Object Content Validation Failure | eventType = ""CyberArk-Vault-366"" |
| CyberArk Vault Unauthorized User Stations | Security | Detects excessive unauthorized CyberArk user Stations | CyberArk Vault Unauthorized User Stations | eventType IN (""CyberArk-Vault-5"",""CyberArk-Vault-10"") |
| Disabled Windows Account Logon Attempts | Security | Detects logon attempts to disabled accounts | Disabled Windows Account Logon Attempts | eventType = ""Win-Security-531"" OR ( eventType = ""Win-Security-4625"" AND winLogonFailCode2 CONTAIN ""0xC0000072"" ) |
| Failed Account Activity On Prior Disabled Account | Security | Detects failed account activity to a recently disabled account | Failed Account Activity On Prior Disabled Account | eventType IN (Group@PH_SYS_EVENT_HostLogonFailure,Group@PH_SYS_EVENT_DomainLogonFailure) |
| Failed Account Activity On Prior Disabled Account | Security | Detects failed account activity to a recently disabled account | Failed Account Activity On Prior Disabled Account | eventType IN (""Win-Security-629"",""Win-Security-4725"") |
| Failed VPN Logon From Outside My Country | Security | Detects VPN logon from outside my country. My Country is set to ""United States"" and may need to be changed for outside United States deployments. | Failed VPN Logon From Outside My Country | eventType IN (Group@PH_SYS_EVENT_VPNLogonFailure) AND srcGeoCountry NOT IN (Group@PH_COUNTRY_GROUP_MYHOME) |
| Identity Spoofing Exploit | Security | Detects IP Address spoofing exploits | Identity Spoofing Exploit | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_SpoofExploit) |
| Inbound insecure protocol traffic detected | Security | Detects inbound usage of insecure protocols that use clear text passwords e.g. FTP, Telnet, POP | Inbound insecure protocol traffic detected | destIpPort IN (21,23,109,110,143) AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Linux: Network Sniffing via Tcpdump | Security | Detects tcpdump program running on a Linux host. Tcpdump is a network monitoring or packet sniffing tool that can be used to capture insecure credentials or data in motion. Sniffing can also be used to discover details of network services as a prelude to lateral movement or defense evasion. Some normal use of this command may originate from server or network administrators engaged in network troubleshooting. This requires process monitoring via FortiSIEM Linux agent. | Linux: Network Sniffing via Tcpdump | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""tcpdump"" |
| Linux: Searching for Passwords in Files | Security | Detects attempt to search local file systems and remote file shares for files containing passwords. | Linux: Searching for Passwords in Files | eventType = ""LINUX_PROCESS_EXEC"" AND procName IN (""cat"",""grep"") AND swParam REGEXP "".*\.bash_history.*|.*passwd.*|.*password.*"" |
| Logon Time Restriction Violation | Security | Detects logon attempts at times which are not permitted by policy | Logon Time Restriction Violation | eventType = ""Win-Security-530"" |
| MS 365 Defender: LSASS Memory - Credential Access Alert | Security | MS 365 Defender Alert that indicates credential access from LSASS Memory. Local Security Authority Subsystem Service (LSASS.exe) manages system-level authentication. | MS 365 Defender: LSASS Memory - Credential Access Alert | (eventType = ""MS-Defender-Endpoint-Alert-CredentialAccess"" OR eventType CONTAIN ""M365Defender-Alert"") AND attackTechniqueId = ""T1003.001"" |
| MS 365 Defender: OS Credential Dumping - Suspicious Activity Alert | Security | OS Credential Dumping - Suspicious Activity Alert from MS 365 Defender | MS 365 Defender: OS Credential Dumping - Suspicious Activity Alert | (eventType = ""MS-Defender-Endpoint-Alert-SuspiciousActivity"" OR eventType CONTAIN ""M365Defender-Alert"") AND attackTechniqueId = ""T1003"" |
| Multiple Login Failures: Net Device | Security | Detects excessive logon failures at a network device - 5 consecutive failures in a 10 minute period. This rule triggers for network devices that report a source IP address. | Multiple Login Failures: Net Device | eventType IN (Group@PH_SYS_EVENT_HostLogonFailure) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Network) AND srcIpAddr IS NOT NULL |
| Multiple Login Failures: Net Device | Security | Detects excessive logon failures at a network device - 5 consecutive failures in a 10 minute period. This rule triggers for network devices that report a source IP address. | Multiple Login Failures: Net Device | eventType IN (Group@PH_SYS_EVENT_MultipleHostLogonFailure) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Network) AND srcIpAddr IS NOT NULL |
| Multiple Login Failures: Net Device: No Source IP | Security | Detects multiple logon failures at a network device - 5 consecutive failures in a 10 minute period. This rule triggers for network devices that do not report a source IP address. | Multiple Login Failures: Net Device: No Source IP | eventType IN (Group@PH_SYS_EVENT_HostLogonFailure) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Network) AND srcIpAddr IS NULL |
| Multiple Login Failures: Net Device: No Source IP | Security | Detects multiple logon failures at a network device - 5 consecutive failures in a 10 minute period. This rule triggers for network devices that do not report a source IP address. | Multiple Login Failures: Net Device: No Source IP | eventType IN (Group@PH_SYS_EVENT_MultipleHostLogonFailure) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Network) AND srcIpAddr IS NULL |
| Multiple Logon Failures: Database | Security | Detects excessive database logon failures - 5 consecutive failures in a 10 minute period | Multiple Logon Failures: Database | eventType IN (Group@PH_SYS_EVENT_DBLogonFailure) |
| Multiple Logon Failures: Domain | Security | Detects multiple Windows domain logon failures - 5 consecutive failures in a 10 minute period | Multiple Logon Failures: Domain | eventType IN (Group@PH_SYS_EVENT_DomainLogonFailure) AND reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER) AND user NOT CONTAIN ""$"" |
| Multiple Logon Failures: Misc App | Security | Detects excessive application logon failures - 5 consecutive failures in a 10 minute period. Application logsons include the one that may require authentication for accessing the authentication, such as HTTP, SNMP, FTP, POP3, IMAP etc. | Multiple Logon Failures: Misc App | srcIpAddr IS NOT NULL AND eventType IN (Group@PH_SYS_EVENT_AppLogonFailure) AND eventType NOT IN (Group@PH_SYS_EVENT_AAALogonFailure) |
| Multiple Logon Failures: Misc App | Security | Detects excessive application logon failures - 5 consecutive failures in a 10 minute period. Application logsons include the one that may require authentication for accessing the authentication, such as HTTP, SNMP, FTP, POP3, IMAP etc. | Multiple Logon Failures: Misc App | srcIpAddr IS NULL AND eventType IN (Group@PH_SYS_EVENT_AppLogonFailure) AND eventType NOT IN (Group@PH_SYS_EVENT_AAALogonFailure) |
| Multiple Logon Failures: Same Src and Dest and Multiple Accounts | Security | Detects same source having excessive login failures at the same destination host but multiple distinct accounts are used during the logon failure | Multiple Logon Failures: Same Src and Dest and Multiple Accounts | eventType IN (Group@PH_SYS_EVENT_HostLogonFailure) |
| Multiple Logon Failures: Same Src and Multiple Dest | Security | Detects the same source having excessive logon failures at more than 10 distinct hosts | Multiple Logon Failures: Same Src and Multiple Dest | eventType IN (Group@PH_SYS_EVENT_HostLogonFailure) |
| Multiple Logon Failures: Server | Security | Detects excessive logon failures at a server - 5 consecutive failures in a 10 minute period | Multiple Logon Failures: Server | eventType IN (Group@PH_SYS_EVENT_HostLogonFailure) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Server) AND reptDevIpAddr NOT IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER) AND user NOT CONTAIN ""$"" |
| Multiple Logon Failures: Server | Security | Detects excessive logon failures at a server - 5 consecutive failures in a 10 minute period | Multiple Logon Failures: Server | eventType IN (Group@PH_SYS_EVENT_MultipleHostLogonFailure) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Server) AND reptDevIpAddr NOT IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER) AND user NOT CONTAIN ""$"" |
| Multiple Logon Failures: VPN | Security | Detects multiple VPN logon failures - 5 consecutive failures in a 10 minute period | Multiple Logon Failures: VPN | eventType IN (Group@PH_SYS_EVENT_VPNLogonFailure) |
| Multiple Logon Failures: Web Server | Security | Detects excessive Web Server logon failures - 5 consecutive failures in a 15 minute period. | Multiple Logon Failures: Web Server | eventType IN (Group@PH_SYS_EVENT_WebLogonFailure) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS,Group@PH_SYS_DEVICE_FSM) |
| Multiple Logon Failures: WLAN | Security | Detects multiple Wireless logon failures - 5 consecutive failures in a 10 minute period | Multiple Logon Failures: WLAN | eventType IN (Group@PH_SYS_EVENT_WirelessLogonFailure) |
| Multiple Privileged Logon Failures: Server | Security | Detects excessive privileged logon failures at a server - 3 consecutive failures in a 10 minute period | Multiple Privileged Logon Failures: Server | (eventType IN (Group@PH_SYS_EVENT_HostPrivLogonFailure) OR (eventType IN (""PH_RULE_EXCESS_FAILED_LOGON_SERVER"",""PH_RULE_EXCESS_FAILED_LOGON_DOMAIN"") AND user CONTAIN ""Admin"")) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Office365: Brute Force Login Attempts - Same Source | Security | Office365 has reported more than 5 login failure attempts from the same source IP in a 15 minute period. | Office365: Brute Force Login Attempts - Same Source | eventType IN (""MS_OFFICE365_EntraID_UserLoginFailed"",""MS_OFFICE365_EntraID_StsLogon_UserLoginFailed"") |
| Office365: Brute Force Login Attempts - Same User | Security | Office365 has reported more than 5 login failure attempts to the same user from at least 2 distinct sources in a 15 minute period. | Office365: Brute Force Login Attempts - Same User | eventType IN (""MS_OFFICE365_EntraID_UserLoginFailed"",""MS_OFFICE365_EntraID_StsLogon_UserLoginFailed"") |
| Office365: Brute Force Logon Success | Security | Office365 Analytics Reported Brute Force Logon Attempts, including attempts that were seen as successful from the same source during the same period. | Office365: Brute Force Logon Success | eventType = ""MS_OFFICE365_o365_brute_force"" |
| Outbound insecure protocol traffic from non guest network detected | Security | Detects outbound usage of protocols that use clear text passwords e.g. FTP, Telnet, POP from non-guest network | Outbound insecure protocol traffic from non guest network detected | destIpPort IN (21,23,109,110,143) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_GUEST) AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Possible Consent Grant Attack via Azure-Registered Application | Security | Identifies when a user grants permissions to an Azure-registered application or when an administrator grants tenant-wide permissions to an application. An adversary may create an Azure-registered application that requests access to data such as contact information, email, or documents. | Possible Consent Grant Attack via Azure-Registered Application | eventType = ""MS_EvtHub_consent_to_application"" |
| Repeated Multiple Login Failures: Net Device | Security | Detects repeating occurrences of multiple logon failures at a network device | Repeated Multiple Login Failures: Net Device | eventType = ""PH_RULE_EXCESS_FAILED_LOGON_2_NET_DEV"" |
| Repeated Multiple Logon Failures: Database | Security | Detects repeating occurrences of multiple database logon failures | Repeated Multiple Logon Failures: Database | eventType = ""PH_RULE_EXCESS_FAILED_LOGON_DB"" |
| Repeated Multiple Logon Failures: Domain | Security | Detects repeating occurrences of multiple domain logon failures | Repeated Multiple Logon Failures: Domain | eventType = ""PH_RULE_EXCESS_FAILED_LOGON_DOMAIN"" |
| Repeated Multiple Logon Failures: Misc App | Security | Detects repeating occurrences of multiple application logon failures. Application logsons include the one that may require authentication for accessing the authentication, such as HTTP, SNMP, FTP, POP3, IMAP etc. | Repeated Multiple Logon Failures: Misc App | srcIpAddr IS NOT NULL AND eventType = ""PH_RULE_EXCESS_FAILED_LOGON_APPL"" |
| Repeated Multiple Logon Failures: Misc App | Security | Detects repeating occurrences of multiple application logon failures. Application logsons include the one that may require authentication for accessing the authentication, such as HTTP, SNMP, FTP, POP3, IMAP etc. | Repeated Multiple Logon Failures: Misc App | srcIpAddr IS NULL AND eventType = ""PH_RULE_EXCESS_FAILED_LOGON_APPL"" |
| Repeated Multiple Logon Failures: Server | Security | Detects repeating occurrences of multiple logon failures at a server from the same user. | Repeated Multiple Logon Failures: Server | eventType = ""PH_RULE_EXCESS_FAILED_LOGON_SERVER"" |
| Repeated Multiple Logon Failures: VPN | Security | Detects repeating occurrences of excessive VPN logon failures | Repeated Multiple Logon Failures: VPN | eventType = ""PH_RULE_EXCESS_FAILED_LOGON_VPN"" |
| Repeated Multiple Logon Failures: Web Server | Security | Detects repeating occurrences of multiple Web Server logon failures | Repeated Multiple Logon Failures: Web Server | eventType = ""PH_RULE_EXCESS_FAILED_LOGON_APPL"" |
| Repeated Multiple Logon Failures: WLAN | Security | Detects repeating occurrences of excessive wireless LAN logon failures | Repeated Multiple Logon Failures: WLAN | eventType = ""PH_RULE_EXCESS_FAILED_LOGON_WIRELESS"" |
| Replay Exploit | Security | Detects replay exploits | Replay Exploit | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_ReplayExploit) |
| Session Hijacking Exploit | Security | Detects seesion hijacking exploits | Session Hijacking Exploit | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_SessionHijackExploit) |
| Successful Account Activity On a Prior Disabled Account | Security | Detects successful account activity to a recently disabled account | Successful Account Activity On a Prior Disabled Account | eventType IN (Group@PH_SYS_EVENT_HostLogonSuccess, Group@PH_SYS_EVENT_DomainLogonSuccess) |
| Successful Account Activity On a Prior Disabled Account | Security | Detects successful account activity to a recently disabled account | Successful Account Activity On a Prior Disabled Account | eventType IN (""Win-Security-629"",""Win-Security-4725"") |
| Successful VPN Logon From Outside My Country | Security | Detects VPN logon from outside my country. My Country is set to ""United States"" and may need to be changed for outside United States deployments | Successful VPN Logon From Outside My Country | eventType IN (Group@PH_SYS_EVENT_VPNLogonSuccess, Group@PH_SYS_EVENT_VPNLogoff) AND srcGeoCountry NOT IN (Group@PH_COUNTRY_GROUP_MYHOME) AND eventType NOT IN (""ASA-713049-SiteToSite-VPN-Logon-success"") |
| Successful Windows Dormant Account Logon | Security | Detects that an account that has been dormant for more than 60 days have been successfully logged on to. | Successful Windows Dormant Account Logon | eventType IN (Group@PH_SYS_EVENT_HostLogonSuccess,Group@PH_SYS_EVENT_DomainLogonSuccess) |
| Successful Windows Dormant Account Logon | Security | Detects that an account that has been dormant for more than 60 days have been successfully logged on to. | Successful Windows Dormant Account Logon | eventType = ""PH_DISCOV_ADS_DORMANT_ACCT"" AND daysSinceLastLogon >= 60 |
| Sudden User Location Change | Security | Detects location change for a user unfeasible in the period of time. This may indicate a stolen credential. | Sudden User Location Change | eventType = ""PH_USER_MON_SUDDEN_LOC_CHANGE"" |
| Suspicious logon attempt | Security | Detects suspicious logon attempts that indicate policy violations, e.g. root logon to database servers, default passwords, attempts to bypass authentication, root logon over unencrypted protocols such as Telnet, ftp, anonymous logons etc. | Suspicious logon attempt | eventType IN (Group@PH_SYS_EVENT_SuspiciousLogon) |
| Suspicious Logon Failure without following successful login | Security | Detects an unusual condition where a source has authentication failures at a host but that is not followed by a successful authentication at the same host within 2 hours | Suspicious Logon Failure without following successful login | eventType IN (Group@PH_SYS_EVENT_HostLogonSuccess, Group@PH_SYS_EVENT_HostPrivLogonSuccess, Group@PH_SYS_EVENT_DomainLogonSuccess, Group@PH_SYS_EVENT_VPNLogonSuccess, Group@PH_SYS_EVENT_WirelessLogonSuccess, Group@PH_SYS_EVENT_AppLogonSuccess) |
| Suspicious Logon Failure without following successful login | Security | Detects an unusual condition where a source has authentication failures at a host but that is not followed by a successful authentication at the same host within 2 hours | Suspicious Logon Failure without following successful login | eventType IN (""PH_RULE_EXCESS_FAILED_LOGON_NET_DEV"",""PH_RULE_EXCESS_FAILED_LOGON_SERVER"",""PH_RULE_EXCESS_FAILED_PRIV_LOGON_SERVER"",""PH_RULE_EXCESS_FAILED_LOGON_DB"", ""PH_RULE_REPEAT_EXCESS_FAILED_LOGON_WEB"", ""PH_RULE_EXCESS_FAILED_LOGON_APPL"",""PH_RULE_EXCESS_FAILED_LOGON_DOMAIN"", ""PH_RULE_EXCESS_FAILED_LOGON_VPN"",""PH_RULE_EXCESS_FAILED_LOGON_WIRELESS"") |
| Windows: Active Directory Database Snapshot Via ADExplorer | Security | Detects the execution of Sysinternals ADExplorer with the ""-snapshot"" flag in order to save a local copy of the active directory database. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_adexplorer_execution.yml | Windows: Active Directory Database Snapshot Via ADExplorer | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\ADExplorer\.exe"" OR srcFileName=""AdExp"") AND command REGEXP "".*snapshot.*"" |
| Windows: Active Directory Replication from Non Machine Account | Security | Detects potential abuse of Active Directory Replication Service (ADRS) from a non-machine account to request credentials. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_ad_replication_non_machine_account.yml | Windows: Active Directory Replication from Non Machine Account | (eventType=""Win-Security-4662"" AND fileAccess=""0x100"" AND propName REGEXP "".*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2.*|.*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2.*|.*89e95b76-444d-4c62-991a-0facbeda640c.*"") AND (user NOT REGEXP "".*\$"" AND user NOT REGEXP ""MSOL_.*"") |
| Windows: Automated Collection Command Prompt | Security | Detects automated techniques for collecting internal data using FINDSTR.exe. Findstr is a very powerful command line tool that makes it easy to search through files and folders based on criteria missing in the standard File Explorer search. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_automated_collection.yml | Windows: Automated Collection Command Prompt | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\.doc.*|.*\.docx.*|.*\.pdf.*|.*\.ppt.*|.*\.pptx.*|.*\.rtf.*|.*\.txt.*|.*\.xls.*|.*\.xlsx.*"" AND ((command REGEXP "".*dir .*"" AND command REGEXP "".* /b .*"" AND command REGEXP "".* /s .*"") OR (srcFileName=""FINDSTR.EXE"" AND command REGEXP "".* /e .*|.* /si .*"")) |
| Windows: Copying Sensitive Files with Credential Data | Security | Detects copying of well-known sensitive files containing credential data using esentutl.exe. Sensitive files include ntds.dit, sam This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_esentutl_sensitive_file_copy.yml | Windows: Copying Sensitive Files with Credential Data | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\esentutl\.exe"" OR srcFileName=""\\esentutl.exe"") AND command REGEXP "".* /m .*|.* /y .*|.*vss.*"") OR command REGEXP "".*\\config\\RegBack\\sam.*|.*\\config\\RegBack\\security.*|.*\\config\\RegBack\\system.*|.*\\config\\sam.*|.*\\config\\security.*|.*\\config\\system .*|.*\\repair\\sam.*|.*\\repair\\security.*|.*\\repair\\system.*|.*\\windows\\ntds\\ntds\.dit.*"") |
| Windows: CrackMapExec File Creation Patterns | Security | Detects suspicious file creation patterns found in logs when CrackMapExec is used. Crackmapexec is a versatile Windows/Active Directory pentesting framework, from enumerating logged on users and spidering SMB shares to executing psexec style attacks, auto-injecting Mimikatz/Shellcode/DLLâ€™s into memory using Powershell, dumping the NTDS.dit and more. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_crackmapexec_patterns.yml | Windows: CrackMapExec File Creation Patterns | eventType=""Win-Sysmon-11-FileCreate"" AND user REGEXP "".*AUTHORI.*|.*AUTORI.*"" AND ((fileName REGEXP ""C:\\Windows\\Temp\\.*"" AND procName=""C:\\WINDOWS\\system32\\rundll32.exe"" AND fileName REGEXP "".*\.cfg|.*\.cpl|.*\.csv|.*\.cur|.*\.db|.*\.dll|.*\.doc|.*\.docx|.*\.drv|.*\.fon|.*\.icns|.*\.ini|.*\.jpg|.*\.odt|.*\.otf|.*\.pdf|.*\.rtf|.*\.sys|.*\.tar|.*\.tex|.*\.tmp|.*\.ttf|.*\.txt|.*\.wpd|.*\.xml"") OR fileName=""C:\\Windows\\Temp\\procdump.exe"") |
| Windows: CreateDump Process Dump | Security | Detects uses of the createdump.exe LOLBIN utility to dump process memory. Crashdump.exe is Microsoft .NET Runtime Crash Dump Generator. LOLBin refers to executables that are a part of the operating system (OS) and can be exploited to support an attack. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_createdump_lolbin_execution.yml | Windows: CreateDump Process Dump | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\createdump\.exe"" OR srcFileName=""FX_VER_INTERNALNAME_STR"") AND command REGEXP "".* --full .*|.* --name .*|.* -f .*|.* -u .*|.*\.dmp .*"" |
| Windows: Cred Dump Tools Dropped Files | Security | Detects creation of files that may be part of or generated by credential dumping software. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_cred_dump_tools_dropped_files.yml | Windows: Cred Dump Tools Dropped Files | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP "".*\\fgdump-log.*|.*\\kirbi.*|.*\\pwdump.*|.*\\pwhashes.*|.*\\wce_ccache.*|.*\\wce_krbtkts.*"" OR fileName REGEXP "".*\\DumpExt\.dll|.*\\DumpSvc\.exe|.*\\Dumpy\.exe|.*\\NTDS\.out|.*\\SAM\.out|.*\\SECURITY\.out|.*\\SYSTEM\.out|.*\\cachedump64\.exe|.*\\cachedump\.exe|.*\\fgexec\.exe|.*\\lsremora64\.dll|.*\\lsremora\.dll|.*\\procdump64\.exe|.*\\pstgdump\.exe|.*\\pwdump\.exe|.*\\servpw64\.exe|.*\\servpw\.exe|.*\\test\.pwd|.*\\wceaux\.dll"") |
| Windows: Credential Dumping by LaZagne | Security | Detects Local Security Authority Subsystem Service (LSASS.exe) process access by LaZagne for credential dumping. LaZagne is a post-exploitation, open-source tool used to recover stored passwords on a system, including browsers and applications, as a low privileged user. Lazagne also has the ability to drop password hashes from LSASS, but you need admin privileges to do that.. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_lazagne_cred_dump_lsass_access.yml | Windows: Credential Dumping by LaZagne | eventType=""Win-Sysmon-10-ProcessAccess"" AND targetProcName REGEXP "".*\\lsass\.exe"" AND procPath REGEXP "".*C:\\Windows\\SYSTEM32\\ntdll\.dll\+.*"" AND procPath REGEXP "".*\|C:\\Windows\\System32\\KERNELBASE\.dll\+.*"" AND procPath REGEXP "".*_ctypes\.pyd\+.*"" AND procPath REGEXP "".*python27\.dll\+.*"" AND accessKeyId=""0x1FFFFF"" |
| Windows: Credential Dumping by Pypykatz | Security | Detects LSASS process access by pypykatz for credential dumping. Local Security Authority Subsystem Service (LSASS.exe) manages system-level authentication. The program pypykatz is a python implementation of Mimikatz, an open source program commonly used by hackers and security professionals to extract sensitive information, such as passwords and credentials, from a system's memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_pypykatz_cred_dump_lsass_access.yml | Windows: Credential Dumping by Pypykatz | eventType=""Win-Sysmon-10-ProcessAccess"" AND targetProcName REGEXP "".*\\lsass\.exe"" AND procPath REGEXP "".*C:\\Windows\\SYSTEM32\\ntdll\.dll\+.*"" AND procPath REGEXP "".*C:\\Windows\\System32\\KERNELBASE\.dll\+.*"" AND procPath REGEXP "".*libffi-7\.dll.*"" AND procPath REGEXP "".*_ctypes\.pyd\+.*"" AND procPath REGEXP "".*python3.*\.dll\+.*"" AND accessKeyId=""0x1FFFFF"" |
| Windows: Credential Dumping Tools Accessing LSASS Memory | Security | Detects processes requesting access to Local Security Authority Subsystem Service (LSASS.exe) memory via suspicious access masks. This is typical for credentials dumping tools. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_cred_dump_lsass_access.yml | Windows: Credential Dumping Tools Accessing LSASS Memory | eventType=""Win-Sysmon-10-ProcessAccess"" AND (targetProcName REGEXP "".*\\lsass\.exe"" AND accessKeyId REGEXP ""0x100000.*|0x1410.*|0x1418.*|0x1438.*|0x143a.*|0x1f0fff.*|0x1f1fff.*|0x1f2fff.*|0x1f3fff.*|0x40.*"") AND ((procName NOT IN (""C:\\WINDOWS\\system32\\taskmgr.exe"",""C:\\Windows\\System32\\perfmon.exe"")) AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"" OR accessKeyId NOT IN (""0x1410"",""0x410"")) AND (procName NOT REGEXP ""C:\\Program Files\\Microsoft Security Client\\MsMpEng\.exe.*|C:\\Program Files\\Windows Defender\\.*|C:\\ProgramData\\Microsoft\\Windows Defender\\.*"" OR procName NOT REGEXP "".*\\MsMpEng\.exe"") AND (procName!=""C:\\Windows\\System32\\svchost.exe"" OR procPath NOT REGEXP "".*\|C:\\ProgramData\\Microsoft\\Windows Defender\\Definition Updates\\\{.*"" OR procPath NOT REGEXP "".*\}\\mpengine\.dll\+.*"" OR accessKeyId!=""0x1418"") AND (procPath NOT REGEXP "".*\|c:\\program files\\windows defender\\MpClient\.dll.*|.*\|c:\\program files\\windows defender\\mprtp\.dll.*"") AND (procName NOT REGEXP ""C:\\Program Files\\WindowsApps\\.*"" OR procName NOT REGEXP "".*\\GamingServices\.exe"" OR accessKeyId NOT IN (""0x1410"",""0x410"")) AND (procName NOT REGEXP "".*C:\\WINDOWS\\system32\\taskhostw\.exe|.*\\MBAMInstallerService\.exe|.*\\PROCEXP64\.EXE|.*\\PROCEXP\.EXE"" OR accessKeyId NOT IN (""0x1410"",""0x40"",""0x410"")) AND (procName NOT IN (""C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe"",""C:\\Windows\\System32\\msiexec.exe"",""C:\\Windows\\syswow64\\MsiExec.exe"") OR accessKeyId NOT IN (""0x1410"",""0x1f1fff"",""0x1f3fff"",""0x410"")) AND (procName NOT IN (""C:\\Windows\\System32\\lsass.exe"",""C:\\Windows\\system32\\wininit.exe"") OR accessKeyId!=""0x1000000"") AND (procName NOT REGEXP ""C:\\ProgramData\\VMware\\VMware Tools\\.*"" OR procName NOT REGEXP "".*\\vmtoolsd\.exe"") AND (procName!=""C:\\WINDOWS\\system32\\svchost.exe"" OR accessKeyId NOT IN (""0x100000"",""0x1410"")) AND (procName NOT REGEXP "".*\\aurora-agent-64\.exe|.*\\aurora-agent\.exe|.*\\thor64\.exe|.*\\thor\.exe"" OR accessKeyId NOT IN (""0x1010"",""0x40"")) AND (procName NOT REGEXP "".*\\explorer\.exe"" OR accessKeyId!=""0x401"") AND (procName!=""C:\\Windows\\system32\\MRT.exe"" OR accessKeyId NOT IN (""0x1410"",""0x1418"")) AND (accessKeyId!=""0x40"" OR procName NOT REGEXP "".*\\handle64\.exe|.*\\handle\.exe"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft\\Edge\\Application\\.*"" OR procName NOT REGEXP "".*\\Installer\\setup\.exe"") AND (procName NOT REGEXP "".*\\AppData\\Local\\WebEx\\WebexHost\.exe"" OR accessKeyId!=""0x401"") AND (procName!=""C:\\PROGRAMDATA\\MALWAREBYTES\\MBAMSERVICE\\ctlrupdate\\mbupdatr.exe"" OR accessKeyId!=""0x1410"") AND (procName NOT REGEXP "".*:\\Windows\\Temp\\.*|.*\\AppData\\Local\\Temp\\.*"" OR procName NOT REGEXP "".*\.tmp\\DropboxUpdate\.exe"" OR accessKeyId NOT IN (""0x1410"",""0x410"")) AND (procName NOT REGEXP ""C:\\Program Files\\Microsoft Visual Studio\\.*"" OR procName NOT REGEXP "".*\\MSBuild\\Current\\Bin\\MSBuild\.exe"" OR accessKeyId!=""0x1F3FFF"") AND (procName NOT REGEXP "".*\\SteamLibrary\\steamapps\\.*"")) |
| Windows: DPAPI Domain Backup Key Extraction | Security | Detects tools extracting LSA secret DPAPI domain backup key from Domain Controllers. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_dpapi_domain_backupkey_extraction.yml | Windows: DPAPI Domain Backup Key Extraction | eventType=""Win-Security-4662"" AND osObjType=""SecretObject"" AND fileAccess=""0x2"" AND osObjName REGEXP "".*BCKUPKEY.*"" |
| Windows: DPAPI Domain Master Key Backup Attempt | Security | Detects anyone attempting a backup for the DPAPI Master Key. This events gets generated at the source and not the Domain Controller. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_dpapi_domain_masterkey_backup_attempt.yml | Windows: DPAPI Domain Master Key Backup Attempt | eventType=""Win-Security-4692"" |
| Windows: Dropping Of Password Filter DLL | Security | Detects dropping of dll files in system32 that may be used to retrieve user credentials from Local Security Authority Subsystem Service (LSASS.exe), which manages system-level authentication. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_credential_access_via_password_filter.yml | Windows: Dropping Of Password Filter DLL | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa.*"" AND command REGEXP "".*scecli\\0.*"" AND command REGEXP "".*reg add.*"" |
| Windows: Dumpert Process Dumper | Security | Detects the use of Dumpert process dumper, which dumps the lsass.exe process memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/sysmon_hack_dumpert.yml | Windows: HackTool - Dumpert Process Dumper Execution | eventType=""Win-Sysmon-1-Create-Process"" AND hashIMP=""09D278F9DE118EF09163C6140255C690"" |
| Windows: Dumping of Sensitive Hives Via Reg.EXE | Security | Detects the usage of reg.exe to dump sensitive registry hives, including SAM, SYSTEM and SECURITY. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_dumping_sensitive_hives.yml | Windows: Dumping of Sensitive Hives Via Reg.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\reg\.exe"" OR srcFileName=""reg.exe"") AND command REGEXP "".*export.*|.*e.port.*|.*save.*"" AND command REGEXP "".*hkey_local_machine.*|.*hkey_loca._machine.*|.*hkey_.ocal_machine.*|.*hkey_.oca._machine.*|.*hklm.*|.*hk.m.*"" AND command REGEXP "".*\\sam.*|.*\\security.*|.*\\system.*|.*\\sy.tem.*|.*\\.am.*|.*\\.ecurity.*|.*\\.ystem.*|.*\\.y.tem.*"" |
| Windows: Dumping Process via Sqldumper.exe | Security | Detects process dump via legitimate sqldumper.exe binary. The Sqldumper.exe utility, included with Microsoft SQL Server, generates memory dumps of SQL Server and of related processes for debugging purposes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_susp_sqldumper_activity.yml | Windows: Dumping Process via Sqldumper.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\sqldumper\.exe"" AND command REGEXP "".*0x0110.*|.*0x01100:40.*"" |
| Windows: DumpMinitool Execution | Security | Detects the use of ""DumpMinitool.exe"", a tool that allows the dump of process memory via the use of the ""MiniDumpWriteDump"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dumpminitool_execution.yml | Windows: DumpMinitool Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\DumpMinitool\.arm64\.exe|.*\\DumpMinitool\.exe|.*\\DumpMinitool\.x86\.exe"" OR srcFileName IN (""DumpMinitool.arm64.exe"",""DumpMinitool.exe"",""DumpMinitool.x86.exe"")) AND command REGEXP "".* Full.*|.* Mini.*|.* WithHeap.*"" |
| Windows: Enumeration for 3rd Party Creds From CLI | Security | Detects processes that query known 3rd party registry keys that holds credentials via commandline. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_registry_enumeration_for_credentials_cli.yml | Windows: Enumeration for 3rd Party Creds From CLI | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\Software\\Aerofox\\FoxmailPreview.*|.*\\Software\\Aerofox\\Foxmail\\V3\.1.*|.*\\Software\\DownloadManager\\Passwords.*|.*\\Software\\FTPWare\\COREFTP\\Sites.*|.*\\Software\\IncrediMail\\Identities.*|.*\\Software\\Martin Prikryl\\WinSCP 2\\Sessions.*|.*\\Software\\Mobatek\\MobaXterm\\.*|.*\\Software\\ORL\\WinVNC3\\Password.*|.*\\Software\\OpenSSH\\Agent\\Keys.*|.*\\Software\\OpenVPN-GUI\\configs.*|.*\\Software\\Qualcomm\\Eudora\\CommandLine.*|.*\\Software\\RealVNC\\WinVNC4.*|.*\\Software\\RimArts\\B2\\Settings.*|.*\\Software\\SimonTatham\\PuTTY\\Sessions.*|.*\\Software\\SimonTatham\\PuTTY\\SshHostKeys\\.*|.*\\Software\\TightVNC\\Server.*|.*\\Software\\WOW6432Node\\Radmin\\v3\.0\\Server\\Parameters\\Radmin.*"" |
| Windows: Enumeration for Credentials in Registry | Security | Detects attempts to search the Registry on compromised systems for insecurely stored credentials. The Windows Registry stores configuration information that can be used by the system or other programs. Adversaries may query the Registry looking for credentials and passwords that have been stored for use by other programs or services . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_enumeration_for_credentials_in_registry.yml | Windows: Enumeration for Credentials in Registry | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\reg\.exe"" AND command REGEXP "".* query .*"" AND command REGEXP "".*/t .*"" AND command REGEXP "".*REG_SZ.*"" AND command REGEXP "".*/s.*"") AND ((command REGEXP "".*/f .*"" AND command REGEXP "".*HKLM.*"") OR (command REGEXP "".*/f .*"" AND command REGEXP "".*HKCU.*"") OR command REGEXP "".*HKCU\\Software\\SimonTatham\\PuTTY\\Sessions.*"") |
| Windows: Esentutl Gather Credentials | Security | Conti recommendation to its affiliates to use esentutl to access NTDS dumped file. The esentutl is a command-line tool that provides database utilities for the Windows Extensible Storage Engine. NTDS.dit file is a database that stores the Active Directory data (including users, groups, security descriptors and password hashes). Trickbot also uses this utilities to get MSEdge info via its module pwgrab. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_esentutl_params.yml | Windows: Esentutl Gather Credentials | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*esentutl.*"" AND command REGEXP "".* /p.*"" |
| Windows: Esentutl Volume Shadow Copy Service Keys | Security | Detects the volume shadow copy service initialization and processing via esentutl. Microsoft ESENTUTL utility (Esentutl.exe) is a command-line utility for database maintenance and recovery operations for Windows Extensible Storage Engine. Registry keys such as HKLM\\System\\CurrentControlSet\\Services\\VSS\\Diag\\VolSnap\\Volume are captured. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_esentutl_volume_shadow_copy_service_keys.yml | Windows: Esentutl Volume Shadow Copy Service Keys | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND (regKeyPath REGEXP "".*System\\CurrentControlSet\\Services\\VSS.*"" AND procName REGEXP "".*esentutl\.exe"") AND (regKeyPath NOT REGEXP "".*System\\CurrentControlSet\\Services\\VSS\\Start.*"") |
| Windows: Failed to execute Privileged Service LsaRegisterLogonProcess | Security | Detects failure to execute Privileged Service LsaRegisterLogonProcess, which verifies that the application making the function call is a logon process, by checking that it has the SeTcbPrivilege privilege set. It is possible that Rubeus, a toolkit for Kerberos interaction and abuses, is trying to get a handle to LSA. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_user_couldnt_call_priv_service_lsaregisterlogonprocess.yml | Windows: Failed to execute Privileged Service LsaRegisterLogonProcess | eventType=""Win-Security-4673"" AND serviceName=""LsaRegisterLogonProcess()"" AND msg=""0x8010000000000000"" |
| Windows: Findstr GPP Passwords | Security | Detects encrypted cpassword value within Group Policy Preference files on the Domain Controller. A cpassword is a component of Active Directoryâ€™s Group Policy Preferences that allows administrators to set passwords via Group Policy. Microsoft used a very weak AES 32-byte encryption algorithm and then published the key on the support site. This value can be decrypted with gpp-decrypt. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_findstr_gpp_passwords.yml | Windows: Findstr GPP Passwords | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\findstr\.exe"" OR srcFileName=""FINDSTR.EXE"") AND (command REGEXP "".*cpassword.*"" AND command REGEXP "".*\\sysvol\\.*"" AND command REGEXP "".*\.xml.*"") |
| Windows: Findstr LSASS | Security | Detects findstr commands that include the keyword lsass, which indicates recon actviity for the LSASS process PID. Local Security Authority Subsystem Service (LSASS.exe), which manages system-level authentication. Findstr is a very powerful command line tool that makes it easy to search through files and folders based on criteria missing in the standard File Explorer search. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_findstr_lsass.yml | Windows: Findstr LSASS | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\findstr\.exe"" OR srcFileName=""FINDSTR.EXE"") AND command REGEXP "".*lsass.*"") OR command REGEXP "".* /i \""lsass.*|.* /i lsass\.exe.*|.*findstr \""lsass.*|.*findstr lsass.*|.*findstr\.exe \""lsass.*|.*findstr\.exe lsass.*"") |
| Windows: Generic Password Dumper Activity on LSASS | Security | Detects process handle onLocal Security Authority Subsystem Service (LSASS.exe) process with certain access mask which may indicate attempt to dump passwords, since LSASS manages system-level authentication. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_lsass_dump_generic.yml | Windows: Generic Password Dumper Activity on LSASS | (osObjName REGEXP "".*\\lsass\.exe"" AND ((eventType=""Win-Security-4656"" AND fileAccess REGEXP "".*0x100000.*|.*0x1010.*|.*0x1400.*|.*0x1410.*|.*0x1418.*|.*0x1438.*|.*0x143a.*|.*0x1f0fff.*|.*0x1f1fff.*|.*0x1f2fff.*|.*0x1f3fff.*|.*0x40.*"") OR (eventType=""Win-Security-4663"" AND fileAccess REGEXP "".*4416.*|.*4484.*""))) AND ((procName NOT REGEXP "".*RtkAudUService64|.*\\GamingServices\.exe|.*\\MRT\.exe|.*\\MicrosoftEdgeUpdate\.exe|.*\\MsMpEng\.exe|.*\\VsTskMgr\.exe|.*\\csrss\.exe|.*\\lsm\.exe|.*\\minionhost\.exe|.*\\procexp64\.exe|.*\\procexp\.exe|.*\\svchost\.exe|.*\\taskmgr\.exe|.*\\thor64\.exe|.*\\thor\.exe|.*\\vmtoolsd\.exe|.*\\wininit\.exe|.*\\wmiprvse\.exe"" OR procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*|C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\.*|C:\\Windows\\SysNative\\.*|C:\\Windows\\SysWow64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\Temp\\asgard2-agent\\.*"") AND (procName NOT REGEXP ""C:\\Program Files.*"") AND (procName NOT IN (""C:\\Windows\\CCM\\CcmExec.exe"",""C:\\Windows\\System32\\msiexec.exe"",""C:\\Windows\\System32\\taskhostw.exe"")) AND (procName!=""C:\\Windows\\Sysmon64.exe"" OR fileAccess NOT REGEXP "".*%%4484.*"") AND (procName NOT REGEXP ""C:\\Windows\\Temp\\asgard2-agent-sc\\aurora\\.*"" OR procName NOT REGEXP "".*\\aurora-agent-64\.exe"" OR fileAccess NOT REGEXP "".*%%4484.*"") AND (procName NOT REGEXP "".*\\x64\\SCENARIOENGINE\.EXE"" OR fileAccess NOT REGEXP "".*%%4484.*"") AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\Temp\\is-.*"" OR procName NOT REGEXP "".*\\avira_system_speedup\.tmp"" OR fileAccess NOT REGEXP "".*%%4484.*"")) |
| Windows: HackTool - CrackMapExec Process Patterns | Security | Detects suspicious process patterns found in logs when CrackMapExec is used. Crackmapexec is a versatile Windows/Active Directory pentesting framework, from enumerating logged on users and spidering SMB shares to executing psexec style attacks, auto-injecting Mimikatz/Shellcode/DLLâ€™s into memory using Powershell, dumping the NTDS.dit and more. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_patterns.yml | Windows: HackTool - CrackMapExec Process Patterns | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*tasklist /fi .*"" AND command REGEXP "".*Imagename eq lsass\.exe.*"" AND command REGEXP "".*cmd /c .*|.*cmd /k .*|.*cmd /r .*|.*cmd\.exe /c .*|.*cmd\.exe /k .*|.*cmd\.exe /r .*"" AND user REGEXP "".*AUTHORI.*|.*AUTORI.*"") OR (command REGEXP "".*do rundll32\.exe C:\\windows\\System32\\comsvcs\.dll, MiniDump.*"" AND command REGEXP "".*\\Windows\\Temp\\.*"" AND command REGEXP "".* full.*"" AND command REGEXP "".*%%B.*"") OR (command REGEXP "".*tasklist /v /fo csv.*"" AND command REGEXP "".*findstr /i \""lsass\"".*"")) |
| Windows: HackTool - CreateMiniDump Execution | Security | Detects the use of CreateMiniDump hacking tool used to dump the LSASS process memory for credential extraction on the attacker's machine. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_createminidump.yml | Windows: HackTool - CreateMiniDump Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\CreateMiniDump\.exe"" OR hashIMP=""4a07f944a83e8a7c2525efa35dd30e2f"" OR hashCode REGEXP "".*IMPHASH=4a07f944a83e8a7c2525efa35dd30e2f.*"") |
| Windows: HackTool - Dumpert Process Dumper Default File | Security | Detects the creation of the default dump file used by Outflank Dumpert tool to dump the process memory of Local Security Authority Subsystem Service (LSASS.exe), which manages system-level authentication. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_hktl_dumpert.yml | Windows: HackTool - Dumpert Process Dumper Default File | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*dumpert\.dmp"" |
| Windows: HackTool - Dumpert Process Dumper Execution | Security | Detects the use of Dumpert process dumper, which dumps the lsass.exe process memory. Local Security Authority Subsystem Service (LSASS.exe), manages system-level authentication. Dumpert can work with using direct system calls. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_dumpert.yml | Windows: HackTool - Dumpert Process Dumper Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (hashCode REGEXP "".*09D278F9DE118EF09163C6140255C690.*"" OR command REGEXP "".*Dumpert\.dll.*"") |
| Windows: HackTool - HandleKatz LSASS Dumper Execution | Security | Detects the use of HandleKatz, a tool that demonstrates the usage of cloned handles to Lsass in order to create an obfuscated memory dump of the same. Local Security Authority Subsystem Service (LSASS.exe), which manages system-level authentication. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_handlekatz.yml | Windows: HackTool - HandleKatz LSASS Dumper Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\loader\.exe"" AND command REGEXP "".*--pid:.*"") OR (hashIMP IN (""0e2216679ca6e1094d63322e3412d650"",""38d9e015591bbfd4929e0d0f47fa0055"") OR hashCode IN (""IMPHASH=0E2216679CA6E1094D63322E3412D650"",""IMPHASH=38D9E015591BBFD4929E0D0F47FA0055"")) OR (command REGEXP "".*--pid:.*"" AND command REGEXP "".*--outfile:.*"" AND command REGEXP "".*\.dmp.*|.*\.obf.*|.*dump.*|.*lsass.*"")) |
| Windows: HackTool - Inveigh Execution | Security | Detects the use of Inveigh a cross-platform .NET IPv4/IPv6 machine-in-the-middle (MITM) tool. In an MITM attack, the adversary positions himself in a conversation between a user and an application, either to eavesdrop or to impersonate one of the parties, making it appear as if a normal exchange of information is underway. The goal of an attack is to steal personal information, such as login credentials, account details and credit card numbers. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_inveigh.yml | Windows: HackTool - Inveigh Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\Inveigh\.exe"" OR srcFileName IN (""\\Inveigh.dll"",""\\Inveigh.exe"") OR description=""Inveigh"" OR command REGEXP "".* -ReplyToDomains .*|.* -ReplyToIPs .*|.* -ReplyToMACs .*|.* -SnifferIP.*|.* -SpooferIP.*"") |
| Windows: HackTool - KrbRelay Execution | Security | Detects the use of KrbRelay, a Kerberos relaying tool. KrbRelay is a tool for forced authentication issue in Windows that can be used by a low-privileged domain user to take over a Windows computer, potentially becoming a local or domain admin. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_krbrelay.yml | Windows: HackTool - KrbRelay Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\KrbRelay\.exe"" OR srcFileName=""KrbRelay.exe"") OR (command REGEXP "".* -spn .*"" AND command REGEXP "".* -clsid .*"" AND command REGEXP "".* -rbcd .*"") OR (command REGEXP "".*shadowcred.*"" AND command REGEXP "".*clsid.*"" AND command REGEXP "".*spn.*"") OR (command REGEXP "".*spn .*"" AND command REGEXP "".*session .*"" AND command REGEXP "".*clsid .*"")) |
| Windows: HackTool - KrbRelayUp Execution | Security | Detects KrbRelayUp used to perform a universal no-fix local privilege escalation in windows domain environments where LDAP signing is not enforced. KrbRelayUp is a wrapper that can streamline the use of some features in hacking tools like Rubeus, KrbRelay, SCMUACBypass, PowerMad/SharpMad, Whisker, and ADCSPwn tools in attacks. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_krbrelayup.yml | Windows: HackTool - KrbRelayUp Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\KrbRelayUp\.exe"" OR srcFileName=""KrbRelayUp.exe"") OR (command REGEXP "".* relay .*"" AND command REGEXP "".* -Domain .*"" AND command REGEXP "".* -ComputerName .*"") OR (command REGEXP "".* krbscm .*"" AND command REGEXP "".* -sc .*"") OR (command REGEXP "".* spawn .*"" AND command REGEXP "".* -d .*"" AND command REGEXP "".* -cn .*"" AND command REGEXP "".* -cp .*"")) |
| Windows: HackTool - Mimikatz Execution | Security | Detection well-known mimikatz command line arguments. Mimikatz is a open source malware program that is commonly used by hackers and security professionals to extract sensitive information, such as passwords and credentials, from a system's memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_mimikatz_command_line.yml | Windows: HackTool - Mimikatz Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*DumpCreds.*|.*mimikatz.*"" OR command REGEXP "".*::aadcookie.*|.*::detours.*|.*::memssp.*|.*::mflt.*|.*::mstsc.*|.*::multirdp.*|.*::ncroutemon.*|.*::ngcsign.*|.*::preshutdown.*|.*::printnightmare.*|.*::skeleton.*"" OR command REGEXP "".*crypto::.*|.*dpapi::.*|.*kerberos::.*|.*lsadump::.*|.*privilege::.*|.*process::.*|.*rpc::.*|.*sekurlsa::.*|.*token::.*|.*vault::.*"") |
| Windows: HackTool - Quarks PwDump Execution | Security | Detects usage of the Quarks PwDump tool via commandline arguments. Quarks PwDump is a native Win32 tool to extract credentials from Windows operating systems. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_quarks_pwdump.yml | Windows: HackTool - Quarks PwDump Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\QuarksPwDump\.exe"" OR command IN ("" --dump-bitlocker"","" --dump-hash-domain "","" --dump-hash-domain-cached"","" --dump-hash-local"","" -dhd "","" -dhdc"","" -dhl"",""--ntds-file"")) |
| Windows: HackTool - Rubeus Execution | Security | Detects the execution of the hacking tool Rubeus via PE information of command line parameters. Rubeus is a toolkit for Kerberos interaction and abuses. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_rubeus.yml | Windows: HackTool - Rubeus Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\Rubeus\.exe"" OR srcFileName=""Rubeus.exe"" OR description=""Rubeus"" OR command REGEXP "".*/impersonateuser:.*|.*asktgt /user:.*|.*asreproast .*|.*createnetonly /program:.*|.*dump /luid:0x.*|.*dump /service:krbtgt .*|.*golden /aes256:.*|.*harvest /interval:.*|.*hash /password:.*|.*kerberoast .*|.*ptt /ticket:.*|.*renew /ticket:.*|.*s4u /ticket:.*|.*s4u /user:.*|.*silver /user:.*"") |
| Windows: HackTool - SafetyKatz Execution | Security | Detects the execution of the hacktool SafetyKatz via PE information and default Image name. SafetyKatz is a combination of modified version of Mimikatz project and .NET PE Loader. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_safetykatz.yml | Windows: HackTool - SafetyKatz Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\SafetyKatz\.exe"" OR srcFileName=""SafetyKatz.exe"" OR description=""SafetyKatz"") |
| Windows: HackTool - Windows Credential Editor WCE Execution | Security | Detects the use of Windows Credential Editor (WCE). WCE is a security tool to list logon sessions and add, change, list and delete associated credentials (e.g. NTLM hashes, plaintext passwords and Kerberos tickets). It is widely used by security professionals to assess the security of Windows networks via Penetration Testing. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_wce.yml | Windows: HackTool - Windows Credential Editor WCE Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((hashIMP IN (""a53a02b997935fd8eedcb5f7abab9b9f"",""e96a73c7bf33a464c510ede582318bf2"") OR hashCode REGEXP "".*IMPHASH=a53a02b997935fd8eedcb5f7abab9b9f.*|.*IMPHASH=e96a73c7bf33a464c510ede582318bf2.*"") OR (command REGEXP "".*\.exe -S"" AND parentProcName REGEXP "".*\\services\.exe"")) AND (procName NOT REGEXP "".*\\clussvc\.exe"") |
| Windows: Harvesting Of Wifi Credentials Via Netsh.EXE | Security | Detect the harvesting of wifi credentials using netsh.exe. Netsh.exe is a command-line scripting utility that allows you to display or modify the network configuration on Windows hosts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_wifi_credential_harvesting.yml | Windows: Harvesting Of Wifi Credentials Via Netsh.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\netsh\.exe"" OR srcFileName=""netsh.exe"") AND (command REGEXP "".*wlan.*"" AND command REGEXP "".* s.*"" AND command REGEXP "".* p.*"" AND command REGEXP "".* k.*"" AND command REGEXP "".*=clear.*"") |
| Windows: Hijack Legit RDP Session to Move Laterally | Security | Detects the usage of tsclient share to place a backdoor on the RDP source machine's startup folder. Terminal Server Client (tsclient) is a discontinued frontend for remote desktop tools, which allow remotely controlling one computer from another. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_tsclient_filewrite_startup.yml | Windows: Hijack Legit RDP Session to Move Laterally | eventType=""Win-Sysmon-11-FileCreate"" AND procName REGEXP "".*\\mstsc\.exe"" AND fileName REGEXP "".*\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\.*"" |
| Windows: Hydra Password Guessing Hack Tool | Security | Detects command line parameters used by Hydra password guessing hack tool. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_hydra.yml | Windows: Hydra Password Guessing Hack Tool | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*-u .*"" AND command REGEXP "".*-p .*"" AND command REGEXP "".*\^PASS\^.*|.*\^USER\^.*"" |
| Windows: Invocation of Active Directory Diagnostic Tool ntdsutil.exe | Security | Detects execution of ntdsutil.exe, which can be used for various attacks against the NTDS database (NTDS.DIT), that stores the Active Directory data, including users, groups, security descriptors and password hashes. Regular ntdsutil.exe use cases includes performing AD database maintenance. Regular NTDS maintenance activities can lead to false positives. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ntdsutil_usage.yml | Windows: Invocation of Active Directory Diagnostic Tool ntdsutil.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\ntdsutil\.exe"" |
| Windows: Kerberos Manipulation | Security | Detects rare Kerberos Failure Codes caused by manipulations of Kerberos messages. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_kerberos_manipulation.yml | Windows: Kerberos Manipulation | eventType IN (""Win-Security-4768-failure"",""Win-Security-4768-success"",""Win-Security-4769-failure"",""Win-Security-4769-success"",""Win-Security-4771"",""Win-Security-675"") AND winKerbFailCode IN (""0x10"",""0x11"",""0x13"",""0x14"",""0x1A"",""0x1F"",""0x21"",""0x22"",""0x23"",""0x24"",""0x26"",""0x27"",""0x28"",""0x29"",""0x2C"",""0x2D"",""0x2E"",""0x2F"",""0x31"",""0x32"",""0x3E"",""0x3F"",""0x40"",""0x41"",""0x43"",""0x44"",""0x9"",""0xA"",""0xB"",""0xF"") |
| Windows: Load Of Dbghelp/Dbgcore DLL From Suspicious Process | Security | Detects the load of dbghelp/dbgcore DLL (used to make memory dumps) by suspicious processes. Tools like ProcessHacker and some attacker tradecraft use MiniDumpWriteDump API found in dbghelp.dll or dbgcore.dll. As an example, SilentTrynity C2 Framework has a module that leverages this API to dump the contents of Local Security Authority Subsystem Service (LSASS.exe), which manages system-level authentication, and transfer it over the network back to the attacker's machine. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_dll_dbghelp_dbgcore_susp_load.yml | Windows: Load Of Dbghelp/Dbgcore DLL From Suspicious Process | eventType=""Win-Sysmon-7-Image-Loaded"" AND (loadedProcName REGEXP "".*\\dbgcore\.dll|.*\\dbghelp\.dll"" AND procName REGEXP "".*\\bash\.exe|.*\\cmd\.exe|.*\\cscript\.exe|.*\\dnx\.exe|.*\\excel\.exe|.*\\monitoringhost\.exe|.*\\msbuild\.exe|.*\\mshta\.exe|.*\\outlook\.exe|.*\\powerpnt\.exe|.*\\regsvcs\.exe|.*\\rundll32\.exe|.*\\sc\.exe|.*\\scriptrunner\.exe|.*\\winword\.exe|.*\\wmic\.exe|.*\\wscript\.exe"") AND ((command NOT REGEXP ""C:\\WINDOWS\\winsxs\\.*"" OR command NOT REGEXP "".*\\TiWorker\.exe -Embedding"")) |
| Windows: LSASS Access from Non System Account | Security | Detects potential mimikatz-like tools accessing LSASS from non system account. Mimikatz is a open source malware program that is commonly used by hackers and security professionals to extract sensitive information, such as passwords and credentials, from a system's memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_lsass_access_non_system_account.yml | Windows: LSASS Access from Non System Account | (eventType IN (""Win-Security-4656"",""Win-Security-4663"") AND fileAccess IN (""0x100000"",""0x1010"",""0x1400"",""0x1410"",""0x1418"",""0x1438"",""0x143a"",""0x1f0fff"",""0x1f1fff"",""0x1f2fff"",""0x1f3fff"",""0x40"",""1000"",""100000"",""1010"",""1400"",""1410"",""1418"",""1438"",""143a"",""1f0fff"",""1f1fff"",""1f2fff"",""1f3fff"",""40"") AND osObjType=""Process"" AND osObjName REGEXP "".*\\lsass\.exe"") AND ((user NOT REGEXP "".*\$"") AND (procName NOT REGEXP ""C:\\Program Files.*"") AND (procName!=""C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"" OR fileAccess!=""0x1410"") AND (procName NOT REGEXP "".*\\SteamLibrary\\steamapps\\.*"")) |
| Windows: LSASS Access From Program in Potentially Suspicious Folder | Security | Detects process access to LSASS memory with suspicious access flags and from a potentially suspicious folder. Updaters and installers are typical false positives. Apply custom filters depending on your environment. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_susp_proc_access_lsass_susp_source.yml | Windows: LSASS Access From Program in Potentially Suspicious Folder | eventType=""Win-Sysmon-10-ProcessAccess"" AND (targetProcName REGEXP "".*\\lsass\.exe"" AND accessKeyId REGEXP "".*0x14C2|.*10|.*18|.*1A|.*30|.*38|.*3A|.*50|.*58|.*5A|.*70|.*78|.*7A|.*90|.*98|.*9A|.*B0|.*B8|.*BA|.*D0|.*D8|.*DA|.*F0|.*F8|.*FA|.*FF"" AND procName REGEXP "".*\\AppData\\.*|.*\\PerfLogs\\.*|.*\\Temp\\.*|.*\\Temporary.*|.*\\Users\\Public\\.*"") AND ((procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\.*"" OR procName NOT REGEXP "".*\\DropboxUpdate\.exe|.*\\JetBrains\\Toolbox\\bin\\jetbrains-toolbox\.exe|.*\\MBAMInstallerService\.exe|.*\\Microsoft VS Code\\Code\.exe|.*\\WebEx\\WebexHost\.exe|.*\\WebexMTA\.exe|.*\\software_reporter_tool\.exe"" OR accessKeyId!=""0x410"") AND (procName NOT REGEXP ""C:\\Windows\\Temp\\.*"" OR procName NOT REGEXP "".*\.tmp\\DropboxUpdate\.exe"" OR accessKeyId NOT IN (""0x1410"",""0x410"")) AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\Temp\\.*"" OR procName NOT REGEXP "".*\.tmp\\DropboxUpdate\.exe"" OR accessKeyId!=""0x1410"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Dropbox\\.*|C:\\Program Files\\Dropbox\\.*"" OR procName NOT REGEXP "".*\\DropboxUpdate\.exe"" OR accessKeyId!=""0x1410"") AND (procName NOT REGEXP ""C:\\Windows\\Temp\\asgard2-agent-sc\\.*|C:\\Windows\\Temp\\asgard2-agent\\.*"" OR procName NOT REGEXP "".*\\aurora-agent-64\.exe|.*\\aurora-agent\.exe|.*\\thor64\.exe|.*\\thor\.exe"" OR accessKeyId NOT IN (""0x1010"",""0x101010"",""0x1fffff"")) AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\Temp\\.*"" OR procName NOT REGEXP "".*\\vs_bootstrapper_.*"" OR accessKeyId!=""0x1410"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Google\\Temp\\.*"" OR procName NOT REGEXP "".*\.tmp\\GoogleUpdate\.exe"" OR accessKeyId NOT IN (""0x1410"",""0x410"")) AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\Keybase\\keybase\.exe"" OR accessKeyId!=""0x1fffff"") AND (procName NOT REGEXP "".*\\AppData\\Local\\Temp\\is-.*"" OR procName NOT REGEXP "".*\.tmp\\avira_system_speedup\.tmp"" OR accessKeyId!=""0x1410"") AND (procName NOT REGEXP ""C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Roaming\\ViberPC\\.*"" OR procName NOT REGEXP "".*\\updater\.exe"" OR targetProcName NOT REGEXP "".*\\winlogon\.exe"" OR accessKeyId!=""0x1fffff"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\Common Files\\Adobe\\ARM\\.*|C:\\Program Files\\Common Files\\Adobe\\ARM\\.*"" OR procName NOT REGEXP "".*\\AdobeARMHelper\.exe"" OR accessKeyId!=""0x1410"")) |
| Windows: LSASS Access from White-Listed Processes | Security | Detects a possible process memory dump that uses the white-listed filename like TrolleyExpress.exe as a way to dump the lsass process memory without Microsoft Defender interference. TrolleyExpress.exe is known as Citrix ICA Client. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_lsass_memdump_evasion.yml | Windows: LSASS Access from White-Listed Processes | eventType=""Win-Sysmon-10-ProcessAccess"" AND targetProcName REGEXP "".*\\lsass\.exe"" AND procName REGEXP "".*\\ProcessDump\.exe|.*\\TrolleyExpress\.exe|.*\\dump64\.exe"" AND accessKeyId REGEXP "".*0x14C2|.*10|.*18|.*1A|.*30|.*38|.*3A|.*50|.*58|.*5A|.*70|.*78|.*7A|.*90|.*98|.*9A|.*B0|.*B8|.*BA|.*D0|.*D8|.*DA|.*F0|.*F8|.*FA|.*FF"" |
| Windows: LSASS Memory Access by Tool Named Dump | Security | Detects a possible process memory dump if the process name contains the word dump. Rarely programs that contain the word dump in their name and access lsass can produce false positives. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_lsass_memdump_indicators.yml | Windows: LSASS Memory Access by Tool Named Dump | eventType=""Win-Sysmon-10-ProcessAccess"" AND targetProcName REGEXP "".*\\lsass\.exe"" AND procName REGEXP "".*dump.*"" AND accessKeyId REGEXP "".*0x14C2|.*10|.*18|.*1A|.*30|.*38|.*3A|.*50|.*58|.*5A|.*70|.*78|.*7A|.*90|.*98|.*9A|.*B0|.*B8|.*BA|.*D0|.*D8|.*DA|.*F0|.*F8|.*FA|.*FF"" |
| Windows: LSASS Memory Dump | Security | Detects Local Security Authority Subsystem Service (LSASS.exe) memory dump using Mimikatz, NanoDump, Invoke-Mimikatz, Procdump or Taskmgr based on the CallTrace pointing to ntdll.dll, dbghelp.dll or dbgcore.dll for win10, server2016 and up. Mimikatz is a open source malware program that is commonly used by hackers and security professionals to extract sensitive information, such as passwords and credentials, from a system's memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_lsass_memdump.yml | Windows: LSASS Memory Dump | eventType=""Win-Sysmon-10-ProcessAccess"" AND (targetProcName REGEXP "".*\\lsass\.exe"" AND accessKeyId REGEXP "".*0x1038.*|.*0x1438.*|.*0x143a.*"" AND procPath REGEXP "".*dbgcore\.dll.*|.*dbghelp\.dll.*|.*ntdll\.dll.*"") AND ((procPath NOT REGEXP "".*\|C:\\Windows\\Temp\\asgard2-agent\\.*"" OR procPath NOT REGEXP "".*\\thor\\thor64\.exe\+.*"" OR procPath NOT REGEXP "".*\|UNKNOWN\(.*"" OR accessKeyId!=""0x103800"") AND (procName!=""C:\\Windows\\Sysmon64.exe"")) |
| Windows: LSASS Memory Dump File Creation | Security | Detects Local Security Authority Subsystem Service (LSASS.exe) memory dump creation using operating systems utilities. Procdump will use process name in output file if no name is specified. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_lsass_memory_dump_file_creation.yml | Windows: LSASS Memory Dump File Creation | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*lsass.*"" AND fileName REGEXP "".*dmp"" |
| Windows: Lsass Memory Dump via Comsvcs DLL | Security | Detects adversaries leveraging the MiniDump export function from comsvcs.dll via rundll32 to perform a memory dump from Local Security Authority Subsystem Service (LSASS). LSASS manages system-level authentication and its memory dump contains passwords. This is an attempt tp dump Lsass memory contents without Mimikatz tool. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_lsass_dump_comsvcs_dll.yml | Windows: Lsass Memory Dump via Comsvcs DLL | eventType=""Win-Sysmon-10-ProcessAccess"" AND targetProcName REGEXP "".*\\lsass\.exe"" AND procName=""C:\\Windows\\System32\\rundll32.exe"" AND procPath REGEXP "".*comsvcs\.dll.*"" |
| Windows: LSASS Memory Dumping | Security | Detect creation of dump files containing the memory space of Local Security Authority Subsystem Service (LSASS.exe), which contains sensitive credentials. Identifies usage of Sysinternals procdump.exe to export the memory space of lsass.exe which contains sensitive credentials. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_lsass_dump.yml | Windows: LSASS Memory Dumping | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*lsass.*"" AND command REGEXP "".*\.dmp.*"") AND (procName NOT REGEXP "".*\\werfault\.exe"") |
| Windows: LSASS Process Dump Artefact In CrashDumps Folder | Security | Detects the presence of an LSASS dump file in the ""CrashDumps"" folder. This could be a sign of LSASS credential dumping. Techniques such as the LSASS Shtinkering have been seen abusing the Windows Error Reporting to dump said process. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_lsass_shtinkering.yml | Windows: LSASS Process Dump Artefact In CrashDumps Folder | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP ""C:\\Windows\\System32\\config\\systemprofile\\AppData\\Local\\CrashDumps\\.*"" AND fileName REGEXP "".*lsass\.exe\..*"" AND fileName REGEXP "".*\.dmp"" |
| Windows: LSASS Process Memory Dump Files | Security | Detects file names used by different memory dumping tools to create a memory dump of the Local Security Authority Subsystem Service (LSASS.exe) process memory, which contains user credentials. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_lsass_dump.yml | Windows: LSASS Process Memory Dump Files | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP "".*\\Andrew\.dmp|.*\\Coredump\.dmp|.*\\Temp\\dumpert\.dmp|.*\\lsass\.dmp|.*\\lsass\.rar|.*\\lsass\.zip"" OR fileName REGEXP "".*\\lsass_2.*|.*\\lsassdmp.*|.*\\lsassdump.*"" OR (fileName REGEXP "".*\\lsass.*"" AND fileName REGEXP "".*\.dmp.*"") OR (fileName REGEXP "".*SQLDmpr.*"" AND fileName REGEXP "".*\.mdmp"") OR (fileName REGEXP ""nanodump.*"" AND fileName REGEXP "".*\.dmp"")) |
| Windows: Mimikatz DC Sync | Security | Detects Mimikatz DC sync security events. Mimikatz is a open source malware program that is commonly used by hackers and security professionals to extract sensitive information, such as passwords and credentials, from a system's memory. Mimkatz â€œDCSyncâ€ feature effectively â€œimpersonatesâ€ a Domain Controller and requests account password data from the targeted Domain Controller. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_dcsync.yml | Windows: Mimikatz DC Sync | (eventType=""Win-Security-4662"" AND propName REGEXP "".*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2.*|.*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2.*|.*89e95b76-444d-4c62-991a-0facbeda640c.*|.*9923a32a-3607-11d2-b9be-0000f87a36b2.*|.*Replicating Directory Changes All.*"" AND fileAccess=""0x100"") AND ((domain!=""Window Manager"") AND (user NOT REGEXP ""MSOL_.*|NT AUT.*"") AND (user NOT REGEXP "".*\$"")) |
| Windows: New Generic Credentials Added Via Cmdkey.EXE | Security | Detects usage of cmdkey to add generic credentials. The Windows Cmdkey command creates, lists and deletes stored user names and passwords form a computer. The primary purpose is to help administrators troubleshooting access issues. As an example, this has to be used before connecting to an RDP session via command line interface. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmdkey_adding_generic_creds.yml | Windows: New Generic Credentials Added Via Cmdkey.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmdkey\.exe"" OR srcFileName=""cmdkey.exe"") AND (command REGEXP "".* /g.*"" AND command REGEXP "".* /u.*"" AND command REGEXP "".* /p.*"") |
| Windows: New Network Trace Capture Started Via Netsh.EXE | Security | Detects the execution of netsh.exe with the ""trace"" flag in order to start a network capture. Netsh.exe is a command-line scripting utility that allows you to display or modify the network configuration on Windows hosts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_packet_capture.yml | Windows: New Network Trace Capture Started Via Netsh.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\netsh\.exe"" OR srcFileName=""netsh.exe"") AND (command REGEXP "".*trace.*"" AND command REGEXP "".*start.*"") |
| Windows: NTDS.DIT Created | Security | Detects creation of a file named ""ntds.dit"" (Active Directory Database). NTDS.dit file is a database that stores the Active Directory data (including users, groups, security descriptors and password hashes). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_ntds_dit_creation.yml | Windows: NTDS.DIT Created | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*ntds\.dit"" |
| Windows: NTDS.DIT Creation By Uncommon Parent Process | Security | Detects creation of a file named ""ntds.dit"" by an uncommon parent process or directory. NTDS.dit file is a database that stores the Active Directory data (including users, groups, security descriptors and password hashes). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_ntds_dit_uncommon_parent_process.yml | Windows: NTDS.DIT Creation By Uncommon Parent Process | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\ntds\.dit"" AND (parentProcName REGEXP "".*\\cscript\.exe|.*\\httpd\.exe|.*\\nginx\.exe|.*\\php-cgi\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\w3wp\.exe|.*\\wscript\.exe"" OR parentProcName REGEXP "".*\\AppData\\.*|.*\\PerfLogs\\.*|.*\\Public\\.*|.*\\Temp\\.*|.*\\apache.*|.*\\tomcat.*"") |
| Windows: NTDS.DIT Creation By Uncommon Process | Security | Detects creation of a file named ""ntds.dit"" by an uncommon process or a process located in a suspicious directory. NTDS.dit file is a database that stores the Active Directory data (including users, groups, security descriptors and password hashes). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_ntds_dit_uncommon_process.yml | Windows: NTDS.DIT Creation By Uncommon Process | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\ntds\.dit"" AND (procName REGEXP "".*\\cmd\.exe|.*\\cscript\.exe|.*\\mshta\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\wscript\.exe|.*\\wsl\.exe|.*\\wt\.exe"" OR procName REGEXP "".*\\AppData\\.*|.*\\PerfLogs\\.*|.*\\Public\\.*|.*\\Temp\\.*"") |
| Windows: Password Cracking with Hashcat | Security | Detectsexecution of Hashcat.exe with provided SAM file from Windows registry and Password list to crack against. Hashcat is a popular and effective password cracker. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_hashcat.yml | Windows: Password Cracking with Hashcat | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\hashcat\.exe"" OR (command REGEXP "".*-a .*"" AND command REGEXP "".*-m 1000 .*"" AND command REGEXP "".*-r .*"")) |
| Windows: Password Dumper Activity on LSASS | Security | Detects process handle on Local Security Authority Subsystem Service (LSASS.exe) with certain access mask and object type SAM_DOMAIN. LSASS.exe manages system-level authentication and this could indicate password dumping activity. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_lsass_dump.yml | Windows: Password Dumper Activity on LSASS | eventType=""Win-Security-4656"" AND procName REGEXP "".*\\lsass\.exe"" AND fileAccess=""0x705"" AND osObjType=""SAM_DOMAIN"" |
| Windows: Permission Misconfiguration Reconnaissance Via Findstr.EXE | Security | Detects usage of findstr with the ""EVERYONE"" or ""BUILTIN"" keywords. This is seen being used in combination with ""icacls"" to look for misconfigured files or folders permissions. Findstr is a very powerful command line tool that makes it easy to search through files and folders based on criteria missing in the standard File Explorer search. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_findstr_recon_everyone.yml | Windows: Permission Misconfiguration Reconnaissance Via Findstr.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\findstr\.exe"" OR srcFileName=""FINDSTR.EXE"") AND command REGEXP "".*'BUILTIN\\'.*|.*'Everyone'.*|.*\""BUILTIN\\\"".*|.*\""Everyone\"".*"") OR (command REGEXP "".*icacls .*"" AND command REGEXP "".*findstr .*"" AND command REGEXP "".*Everyone.*"")) |
| Windows: PetitPotam Suspicious Kerberos TGT Request | Security | Detect suspicious Kerberos TGT requests. Once an attacer obtains a computer certificate by abusing Active Directory Certificate Services in combination with PetitPotam, the next step would be to leverage the certificate for malicious purposes. One way of doing this is to request a Kerberos Ticket Granting Ticket using a tool like Rubeus. This request will generate a 4768 event with some unusual fields depending on the environment. This analytic will require tuning, we recommend filtering Account_Name to the Domain Controller computer accounts. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_petitpotam_susp_tgt_request.yml | Windows: PetitPotam Suspicious Kerberos TGT Request | (eventType IN (""Win-Security-4768-success"",""Win-Security-4768-failure"") AND user REGEXP "".*\$"" AND certThumbprint REGEXP "".*"") AND ((srcIpAddr!=::1) AND (certThumbprint IS NOT NULL)) |
| Windows: Possible Impacket SecretDump Remote Activity | Security | Detect AD credential dumping using impacket secretdump HKTL. â€‹Impacket's secretsdump (Python based) can be used to dump SAM and LSA secrets, either remotely, or from local files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_impacket_secretdump.yml | Windows: Possible Impacket SecretDump Remote Activity | eventType=""Win-Security-5145"" AND fileName REGEXP ""\\\\\*\\ADMIN\$"" AND targetName REGEXP "".*SYSTEM32\\.*"" AND targetName REGEXP "".*\.tmp.*"" |
| Windows: Possible PetitPotam Coerce Authentication Attempt | Security | Detect PetitPotam coerced authentication activity. PetitPotam is a tool that can coerce Windows hosts to authenticate to other machines. By manipulating the data being exchanged between the attacker and the server, the attacker can force the server to authenticate the attacker as a legitimate user, in whatâ€™s known as an NTLM Relay attack. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_petitpotam_network_share.yml | Windows: Possible PetitPotam Coerce Authentication Attempt | eventType=""Win-Security-5145"" AND fileName REGEXP ""\\\\\.*"" AND fileName REGEXP "".*\\IPC\$"" AND targetName=""lsarpc"" AND user=""ANONYMOUS LOGON"" |
| Windows: Potential Browser Data Stealing | Security | Detects attempts to read credentials from web browsers. Web browsers commonly save credentials such as website usernames and passwords in an encrypted format within a credential store, so that they do not need to be entered manually in the future. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_browser_data.yml | Windows: Potential Browser Data Stealing | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".* cp .*|.* mi .*|.* mv .*|.*copy .*|.*copy-item.*|.*cpi .*|.*move .*|.*move-item.*"" OR procName REGEXP "".*\\robocopy\.exe|.*\\xcopy\.exe"" OR srcFileName IN (""XCOPY.EXE"",""robocopy.exe"")) AND command REGEXP "".*\\Google\\Chrome\\User Data\\.*|.*\\Microsoft\\Edge\\User Data\\.*|.*\\Mozilla\\Firefox\\Profiles.*|.*\\Opera Software\\Opera Stable\\.*"" |
| Windows: Potential Credential Dumping Attempt Via PowerShell | Security | Detects PowerShell processes requesting access to Local Security Authority Subsystem Service (LSASS.exe), which manages system-level authentication. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_winapi_in_powershell_credentials_dumping.yml | Windows: Potential Credential Dumping Attempt Via PowerShell | eventType=""Win-Sysmon-10-ProcessAccess"" AND procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" AND targetProcName REGEXP "".*\\lsass\.exe"" |
| Windows: Potential Credential Dumping Via WER | Security | Detects potential credential dumping via Windows Error Reporting LSASS Shtinkering technique which uses the Windows Error Reporting to dump lsass. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_werfault_lsass_shtinkering.yml | Windows: Potential Credential Dumping Via WER | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\Werfault\.exe"" OR srcFileName=""WerFault.exe"") AND (userGrp REGEXP "".*AUTHORI.*|.*AUTORI.*"" AND user REGEXP "".*AUTHORI.*|.*AUTORI.*"" AND command REGEXP "".* -u -p .*"" AND command REGEXP "".* -ip .*"" AND command REGEXP "".* -s .*"")) AND ((parentProcName!=""C:\\Windows\\System32\\lsass.exe"")) |
| Windows: Potential Credential Dumping Via WER - Application | Security | Detects windows error reporting event where the crashed process is Local Security Authority Subsystem Service (LSASS.exe), which manages system-level authentication. This could be the cause of an intentional crash by techniques such as Lsass-Shtinkering to dump credential. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/application_error/win_werfault_susp_lsass_credential_dump.yml | Windows: Potential Credential Dumping Via WER - Application | eventType=""Win-App-Application-Error-1000"" AND appName=""lsass.exe"" AND errorCode=""c0000001"" |
| Windows: Potential CVE-2021-42287 Exploitation Attempt | Security | Detects attempts to exploit CVE-2021-42287 (sAMAccountName spoofing, deceiving the KDC) by creating a computer object and clearing the attribute ServicePrincipalName on the computer object. Being the CREATOR OWNER, user gets granted additional permissions and can do many changes to the object. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/microsoft_windows_directory_services_sam/win_system_exploit_cve_2021_42287.yml | Windows: Potential CVE-2021-42287 Exploitation Attempt | eventType IN (""Win-System-Microsoft-Windows-Directory-Services-SAM-16990"",""Win-System-Microsoft-Windows-Directory-Services-SAM-16991"") |
| Windows: Potential LSASS Process Dump Via Procdump | Security | Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter to create a dump of the lsass.exe process. This way we are also able to catch cases in which the attacker has renamed the procdump executable. Local Security Authority Subsystem Service (LSASS.exe) manages system-level authentication. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_procdump_lsass.yml | Windows: Potential LSASS Process Dump Via Procdump | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* -ma .*|.* /ma .*"" AND command REGEXP "".* ls.*"" |
| Windows: Potential Network Sniffing Activity Using Network Tools | Security | Detects potential network sniffing via use of network tools such as ""tshark"", ""windump"". Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_network_sniffing.yml | Windows: Potential Network Sniffing Activity Using Network Tools | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\tshark\.exe"" AND command REGEXP "".*-i.*"") OR procName REGEXP "".*\\windump\.exe"") |
| Windows: Potential Reconnaissance For Cached Credentials Via Cmdkey.EXE | Security | Detects usage of built-in Windows utility cmdkey to list cached credentials on the system. The Windows Cmdkey command creates, lists and deletes stored user names and passwords form a computer. The primary purpose is to help administrators troubleshooting access issues. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmdkey_recon.yml | Windows: Potential Reconnaissance For Cached Credentials Via Cmdkey.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmdkey\.exe"" OR srcFileName=""cmdkey.exe"") AND command REGEXP "".* -l.*|.* /l.*"" |
| Windows: Potential SAM Database Dump | Security | Detects the creation of files that look like exports of the local SAM (Security Account Manager). The Security Accounts Manager (SAM) is a database file in the Microsoft Windows operating system (OS) that contains usernames and passwords.This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_sam_dump.yml | Windows: Potential SAM Database Dump | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP "".*:\\sam|.*\\AppData\\Local\\sam|.*\\AppData\\Roaming\\sam|.*\\Documents\\SAM\.export|.*\\Intel\\sam|.*\\Perflogs\\sam|.*\\ProgramData\\sam|.*\\Temp\\sam|.*\\Users\\Public\\sam|.*\\sam\.hive|.*\\sam\.sav|.*_ShadowSteal\.zip"" OR fileName REGEXP "".*\\hive_sam_.*|.*\\sam\.backup.*|.*\\sam\.bck.*|.*\\sam\.export.*|.*\\sam\.save.*|.*\\sam_backup.*|.*\\~reg_sam\.save.*"") |
| Windows: Potential SPN Enumeration Via Setspn.EXE | Security | Detects Service Principal Name (SPN) enumeration used for Kerberoasting. A SPN is a unique identifier of a service instance. Kerberos authentication uses SPNs to associate a service instance with a service sign-in account. Kerberoasting is a post-exploitation attack technique that attempts to obtain a password hash of an Active Directory account that has a SPN. Administration activity can lead to false positives. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_setspn_spn_enumeration.yml | Windows: Potential SPN Enumeration Via Setspn.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\setspn\.exe"" OR srcFileName=""setspn.exe"" OR (description REGEXP "".*Query or reset the computer.*"" AND description REGEXP "".*SPN attribute.*"")) AND command REGEXP "".*-q.*"" |
| Windows: PowerShell Get-Process LSASS | Security | Detects a ""Get-Process"" cmdlet and it's aliases on lsass process, which is in almost all cases a sign of malicious activity. Local Security Authority Subsystem Service (LSASS.exe) manages system-level authentication. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_getprocess_lsass.yml | Windows: PowerShell Get-Process LSASS | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Get-Process lsas.*|.*gps lsas.*|.*ps lsas.*"" |
| Windows: PowerShell SAM Copy | Security | Detects suspicious PowerShell scripts accessing Security Account Manager (SAM) registry hives. SAM contains user password hashes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_sam_access.yml | Windows: PowerShell SAM Copy | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\HarddiskVolumeShadowCopy.*"" AND command REGEXP "".*System32\\config\\sam.*"" AND command REGEXP "".*Copy-Item.*|.*\.File\]::Copy\(.*|.*copy \$_\..*|.*cp \$_\..*|.*cpi \$_\..*"" |
| Windows: Private Keys Reconnaissance Via CommandLine Tools | Security | Detects attempts to search for private key certificate files on compromised systems for insecurely stored credential. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_private_keys_recon.yml | Windows: Private Keys Reconnaissance Via CommandLine Tools | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\.asc.*|.*\.cer.*|.*\.gpg.*|.*\.key.*|.*\.p12.*|.*\.p7b.*|.*\.pem.*|.*\.pfx.*|.*\.pgp.*|.*\.ppk.*"" AND (((procName REGEXP "".*\\cmd\.exe"" OR srcFileName=""Cmd.Exe"") AND command REGEXP "".*dir .*"") OR ((procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".*Get-ChildItem .*"") OR procName REGEXP "".*\\findstr\.exe"" OR srcFileName=""FINDSTR.EXE"") |
| Windows: Procdump Evasion | Security | Detects uses of the SysInternals ProcDump utility in which ProcDump or its output get renamed, or a dump file is moved or copied to a different name. his approach can be used to dump the lsass.exe process, which contains the credentials, and then give this dump to mimikatz to extract Windows plaintexts passwords, hashes, PIN code and kerberos tickets from memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_procdump_evasion.yml | Windows: Procdump Evasion | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*copy procdump.*|.*move procdump.*"" OR (command REGEXP "".*copy .*"" AND command REGEXP "".*\.dmp .*"" AND command REGEXP "".*2\.dmp.*|.*lsass.*|.*out\.dmp.*"") OR command REGEXP "".*copy lsass\.exe_.*|.*move lsass\.exe_.*"") |
| Windows: Procdump Execution | Security | Detects usage of the SysInternals Procdump utility. This approach can be used to dump the lsass.exe process, which contains the credentials, and then give this dump to mimikatz to extract Windows plaintexts passwords, hashes, PIN code and kerberos tickets from memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_procdump.yml | Windows: Procdump Execution | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\procdump64\.exe|.*\\procdump\.exe"" |
| Windows: Process Dumping Via Comsvcs.DLL | Security | Detects a process memory dump via ""comsvcs.dll"" using rundll32, covering multiple different techniques (ordinal, minidump function, etc.). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_process_dump_via_comsvcs.yml | Windows: Process Dumping Via Comsvcs.DLL | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"" OR command REGEXP "".*rundll32.*"") AND (command REGEXP "".*comsvcs.*"" AND command REGEXP "".*full.*"" AND command REGEXP "".*#24.*|.*#\+24.*|.*24 .*|.*MiniDump.*"")) OR command REGEXP "".*#-4294967272.*"") |
| Windows: Process Memory Dump via RdrLeakDiag.EXE | Security | Detects the use of the Microsoft Windows Resource Leak Diagnostic tool rdrleakdiag.exe to dump process memory. his approach can be used to dump the lsass.exe process, which contains the credentials, and then give this dump to mimikatz to extract Windows plaintexts passwords, hashes, PIN code and kerberos tickets from memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rdrleakdiag_process_dumping.yml | Windows: Process Memory Dump via RdrLeakDiag.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*-memdmp.*|.*/memdmp.*|.*fullmemdmp.*"" AND ((command REGEXP "".* -o .*|.* /o .*"" AND command REGEXP "".* -p .*|.* /p .*"") OR (procName REGEXP "".*\\rdrleakdiag\.exe"" OR srcFileName=""RdrLeakDiag.exe"")) |
| Windows: PUA - DIT Snapshot Viewer | Security | Detects the use of Ditsnap tool, an inspection tool for Active Directory database, ntds.dit. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_ditsnap.yml | Windows: PUA - DIT Snapshot Viewer | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\ditsnap\.exe"" OR command REGEXP "".*ditsnap\.exe.*"") |
| Windows: PUA - WebBrowserPassView Execution | Security | Detects the execution of WebBrowserPassView.exe, a password recovery tool that reveals the passwords stored by the following Web browsers, Internet Explorer (Version 4.0 - 11.0), Mozilla Firefox (All Versions), Google Chrome, Safari, and Opera. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_webbrowserpassview.yml | Windows: PUA - WebBrowserPassView Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (description=""Web Browser Password Viewer"" OR procName REGEXP "".*\\WebBrowserPassView\.exe"") |
| Windows: QuarksPwDump Clearing Access History | Security | Detects QuarksPwDump clearing access history in hive. Quarks PwDump is a native Win32 tool to extract credentials from Windows operating systems. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/microsoft_windows_kernel_general/win_system_quarkspwdump_clearing_hive_access_history.yml | Windows: QuarksPwDump Clearing Access History | eventType=""Win-System-Microsoft-Windows-Kernel-General-16"" AND procName REGEXP "".*\\AppData\\Local\\Temp\\SAM.*"" AND procName REGEXP "".*\.dmp"" |
| Windows: QuarksPwDump Dump File | Security | Detects a dump file written by Quarks PwDump password dumper. It can dump various types of Windows credentials: local account, domain accounts, cached domain credentials and bitlocker. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_hktl_quarkspw_filedump.yml | Windows: QuarksPwDump Dump File | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\AppData\\Local\\Temp\\SAM-.*"" AND fileName REGEXP "".*\.dmp.*"" |
| Windows: Rare GrantedAccess Flags on LSASS Access | Security | Detects process access to LSASS memory with suspicious Granted Access flags 0x410 and 0x01410 (spin-off of similar rule). Local Security Authority Subsystem Service (LSASS.exe) manages system-level authentication. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_rare_proc_access_lsass.yml | Windows: Rare GrantedAccess Flags on LSASS Access | eventType=""Win-Sysmon-10-ProcessAccess"" AND (targetProcName REGEXP "".*\\lsass\.exe"" AND accessKeyId REGEXP "".*10"") AND ((procName NOT IN (""C:\\PROGRAMDATA\\MALWAREBYTES\\MBAMSERVICE\\ctlrupdate\\mbupdatr.exe"",""C:\\Program Files\\Common Files\\McAfee\\MMSSHost\\MMSSHOST.exe"",""C:\\Program Files\\Malwarebytes\\Anti-Malware\\MBAMService.exe"",""C:\\Program Files\\Windows Defender\\MsMpEng.exe"",""C:\\WINDOWS\\System32\\perfmon.exe"",""C:\\WINDOWS\\system32\\taskhostw.exe"",""C:\\WINDOWS\\system32\\taskmgr.exe"",""C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe"",""C:\\Windows\\SysWOW64\\msiexec.exe"",""C:\\Windows\\System32\\lsass.exe"",""C:\\Windows\\System32\\msiexec.exe"",""C:\\Windows\\sysWOW64\\wbem\\wmiprvse.exe"")) AND (procName NOT REGEXP ""C:\\ProgramData\\Microsoft\\Windows Defender\\.*"" OR procName NOT REGEXP "".*\\MsMpEng\.exe"") AND (procName NOT REGEXP ""C:\\Program Files\\WindowsApps\\.*"" OR procName NOT REGEXP "".*\\GamingServices\.exe"") AND (procName NOT REGEXP "".*\\PROCEXP64\.EXE|.*\\PROCEXP\.EXE"") AND (procName NOT REGEXP ""C:\\ProgramData\\VMware\\VMware Tools\\.*"" OR procName NOT REGEXP "".*\\vmtoolsd\.exe"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"" OR procName NOT REGEXP "".*Antivirus.*"") AND (procName NOT REGEXP "".*\\aurora-agent-64\.exe|.*\\aurora-agent\.exe|.*\\thor64\.exe|.*\\thor\.exe"") AND (procName NOT REGEXP "".*\\AppData\\Local\\Temp\\.*"" OR procName NOT REGEXP "".*\\vs_bootstrapper_.*"" OR accessKeyId!=""0x1410"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*|C:\\WINDOWS\\system32\\.*"") AND (command!=""C:\\WINDOWS\\system32\\wermgr.exe -upload"") AND (procName NOT REGEXP "".*C:\\Users\\.*"" OR procName NOT REGEXP "".*\\AppData\\Local\\.*"" OR procName NOT REGEXP "".*\\DropboxUpdate\.exe|.*\\JetBrains\\Toolbox\\bin\\jetbrains-toolbox\.exe|.*\\MBAMInstallerService\.exe|.*\\Microsoft VS Code\\Code\.exe|.*\\Programs\\Microsoft VS Code\\Code\.exe|.*\\WebEx\\WebexHost\.exe|.*\\software_reporter_tool\.exe"") AND (procName NOT REGEXP "".*\\xampp-control\.exe"" OR accessKeyId!=""0x410"") AND (procName NOT REGEXP "".*\\SteamLibrary\\steamapps\\.*"" OR accessKeyId NOT IN (""0x10"",""0x410""))) |
| Windows: Register new Logon Process by Rubeus | Security | Detects potential use of Rubeus via registered new trusted logon process. Rubeus is a toolkit for Kerberos interaction and abuses. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_register_new_logon_process_by_rubeus.yml | Windows: Register new Logon Process by Rubeus | eventType=""Win-Security-4611"" AND procName=""User32LogonProcesss"" |
| Windows: Registry Parse with Pypykatz | Security | Detects the usage of ""pypykatz"" to obtain stored credentials. Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database through Windows registry where the SAM database is stored. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_pypykatz.yml | Windows: Registry Parse with Pypykatz | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\pypykatz\.exe|.*\\python\.exe"" AND command REGEXP "".*live.*"" AND command REGEXP "".*registry.*"" |
| Windows: Renamed BrowserCore.EXE Execution | Security | Detects process creation with a renamed BrowserCore.exe (used to extract Azure tokens). a core component of Windows 10 and it serves as a browser add-on that allows Microsoft users to connect via Azure and Microsoft websites. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_browsercore.yml | Windows: Renamed BrowserCore.EXE Execution | eventType=""Win-Sysmon-1-Create-Process"" AND srcFileName=""BrowserCore.exe"" AND ((procName NOT REGEXP "".*\\BrowserCore\.exe"")) |
| Windows: Renamed CreateDump Utility Execution | Security | Detects uses of a renamed legitimate createdump.exe LOLBIN utility to dump process memory. Living off the Land Binaries (LOLBin) refers to executables that are a part of the operating system (OS) and can be exploited to support an attack. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_createdump.yml | Windows: Renamed CreateDump Utility Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""FX_VER_INTERNALNAME_STR"" OR (command REGEXP "".* -u .*"" AND command REGEXP "".* -f .*"" AND command REGEXP "".*\.dmp.*"") OR (command REGEXP "".* --full .*"" AND command REGEXP "".* --name .*"" AND command REGEXP "".*\.dmp.*"")) AND (procName NOT REGEXP "".*\\createdump\.exe"") |
| Windows: SafetyKatz Default Dump Filename | Security | Detects default lsass dump filename from SafetyKatz. SafetyKatz is a combination of modified version of Mimikatz project and .NET PE Loader. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_hktl_safetykatz.yml | Windows: SafetyKatz Default Dump Filename | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Temp\\debug\.bin"" |
| Windows: SAM Dump to AppData | Security | Detects suspicious Security Access Manager (SAM) dump activity as cause by QuarksPwDump and other password dumpers. Quarks PwDump is a native Win32 tool to extract credentials from Windows operating systems. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/microsoft_windows_kernel_general/win_system_susp_sam_dump.yml | Windows: SAM Dump to AppData | eventType=""Win-System-Microsoft-Windows-Kernel-General-16"" AND rawEventMsg REGEXP "".*\\AppData\\Local\\Temp\\SAM-.*\.dmp.*"" |
| Windows: SAM Registry Hive Handle Request | Security | Detects handles requested to SAM registry hive. The Security Accounts Manager (SAM) is a database file in the Microsoft Windows operating system (OS) that contains usernames and passwords. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_sam_registry_hive_handle_request.yml | Windows: SAM Registry Hive Handle Request | eventType=""Win-Security-4656"" AND osObjType=""Key"" AND osObjName REGEXP "".*\\SAM"" |
| Windows: Shadow Copies Creation Using Operating Systems Utilities | Security | Shadow Copies creation using operating systems utilities, possible credential access. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_shadow_copies_creation.yml | Windows: Shadow Copies Creation Using Operating Systems Utilities | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe|.*\\vssadmin\.exe|.*\\wmic\.exe"" OR srcFileName IN (""PowerShell.EXE"",""VSSADMIN.EXE"",""pwsh.dll"",""wmic.exe"")) AND (command REGEXP "".*shadow.*"" AND command REGEXP "".*create.*"") |
| Windows: SilentProcessExit Monitor Registration for LSASS | Security | Detects changes to the Registry in which a monitor program gets registered to dump process memory of the lsass.exe process memory. Local Security Authority Subsystem Service (LSASS.exe) manages system-level authentication. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_silentprocessexit_lsass.yml | Windows: SilentProcessExit Monitor Registration for LSASS | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\lsass\.exe.*"" |
| Windows: SQLite Chromium Profile Data DB Access | Security | Detect usage of the ""sqlite"" binary to query databases in Chromium-based browsers for potential data stealing. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sqlite_chromium_profile_data.yml | Windows: SQLite Chromium Profile Data DB Access | eventType=""Win-Sysmon-1-Create-Process"" AND (product=""SQLite"" OR procName REGEXP "".*\\sqlite3\.exe|.*\\sqlite\.exe"") AND command REGEXP "".*\\ChromiumViewer\\.*|.*\\Opera Software\\.*|.*\\User Data\\.*"" AND command REGEXP "".*Bookmarks.*|.*Cookies.*|.*History.*|.*Login Data.*|.*Web Data.*"" |
| Windows: SQLite Firefox Profile Data DB Access | Security | Detect usage of the ""sqlite"" binary to query databases in Firefox and other Gecko-based browsers for potential data stealing. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sqlite_firefox_gecko_profile_data.yml | Windows: SQLite Firefox Profile Data DB Access | eventType=""Win-Sysmon-1-Create-Process"" AND (product=""SQLite"" OR procName REGEXP "".*\\sqlite3\.exe|.*\\sqlite\.exe"") AND command REGEXP "".*cookies\.sqlite.*|.*places\.sqlite.*"" |
| Windows: Suspicious Active Directory Database Snapshot Via ADExplorer | Security | Detects the execution of Sysinternals ADExplorer with the ""-snapshot"" flag in order to save a local copy of the active directory database to a suspicious directory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysinternals_adexplorer_susp_execution.yml | Windows: Suspicious Active Directory Database Snapshot Via ADExplorer | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\ADExplorer\.exe"" OR srcFileName=""AdExp"") AND command REGEXP "".*snapshot.*"" AND command REGEXP "".*\\AppData\\.*|.*\\Downloads\\.*|.*\\Users\\Public\\.*|.*\\Windows\\Temp\\.*"" |
| Windows: Suspicious Command With Teams Objects Paths | Security | Detects an access to authentication tokens and accounts of Microsoft Teams desktop application. There is a security vulnerability that Microsoft Teams stores user authentication tokens as cleartext in Windows, Linux, Mac. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_teams_suspicious_command_line_cred_access.yml | Windows: Suspicious Command With Teams Objects Paths | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\Microsoft\\Teams\\Cookies.*|.*\\Microsoft\\Teams\\Local Storage\\leveldb.*"" AND (procName NOT REGEXP "".*\\Microsoft\\Teams\\current\\Teams\.exe"") |
| Windows: Suspicious Dump64.exe Execution | Security | Detects when a user bypasses MS Defender by renaming a tool to dump64.exe and placing it in a Visual Studio folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_dump64.yml | Windows: Suspicious Dump64.exe Execution | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\dump64\.exe"" AND ((procName NOT REGEXP "".*\\Installer\\Feedback\\dump64\.exe.*"") OR command REGEXP "".* -ma .*|.*accepteula.*"") |
| Windows: Suspicious File Event With Teams Objects | Security | Detects an access to authentication tokens and accounts of Microsoft Teams desktop application. There is a security vulnerability that Microsoft Teams stores user authentication tokens as cleartext in Windows, Linux, Mac. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_access_susp_teams.yml | Windows: Suspicious File Event With Teams Objects | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\Microsoft\\Teams\\Cookies.*|.*\\Microsoft\\Teams\\Local Storage\\leveldb.*"" AND (procName NOT REGEXP "".*\\Microsoft\\Teams\\current\\Teams\.exe.*"") |
| Windows: Suspicious GrantedAccess Flags on LSASS Access | Security | Detects process access to LSASS memory with suspicious access flags. Local Security Authority Subsystem Service (LSASS.exe) manages system-level authentication. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_susp_proc_access_lsass.yml | Windows: Suspicious GrantedAccess Flags on LSASS Access | eventType=""Win-Sysmon-10-ProcessAccess"" AND (targetProcName REGEXP "".*\\lsass\.exe"" AND accessKeyId REGEXP "".*0x14C2|.*18|.*1A|.*30|.*38|.*3A|.*50|.*58|.*5A|.*70|.*78|.*7A|.*90|.*98|.*9A|.*B0|.*B8|.*BA|.*D0|.*D8|.*DA|.*F0|.*F8|.*FA"") AND ((( procName NOT IN (""C:\\PROGRAMDATA\\MALWAREBYTES\\MBAMSERVICE\\ctlrupdate\\mbupdatr.exe"",""C:\\Program Files (x86)\\Cisco\\Cisco AnyConnect Secure Mobility Client\\vpnagent.exe"",""C:\\Program Files\\Cisco\\Cisco AnyConnect Secure Mobility Client\\vpnagent.exe"",""C:\\Program Files\\Malwarebytes\\Anti-Malware\\MBAMService.exe"",""C:\\Program Files\\Windows Defender\\MsMpEng.exe"",""C:\\WINDOWS\\System32\\perfmon.exe"",""C:\\WINDOWS\\system32\\taskhostw.exe"",""C:\\WINDOWS\\system32\\taskmgr.exe"",""C:\\Windows\\SysWOW64\\msiexec.exe"",""C:\\Windows\\System32\\MRT.exe"",""C:\\Windows\\System32\\lsass.exe"",""C:\\Windows\\System32\\msiexec.exe"") AND procName NOT REGEXP ""C:\\Users\\.*\\AppData\\Local\\Programs\\Microsoft VS Code\\Code\.exe"" )) AND (procName NOT REGEXP ""C:\\ProgramData\\Microsoft\\Windows Defender\\.*"" OR procName NOT REGEXP "".*\\MsMpEng\.exe"") AND (procPath NOT REGEXP "".*\|C:\\ProgramData\\Microsoft\\Windows Defender\\Definition Updates\\\{.*"" OR procPath NOT REGEXP "".*\}\\mpengine\.dll\+.*"" OR accessKeyId!=""0x1418"") AND (procName!=""C:\\Program Files\\Microsoft Security Client\\MsMpEng.exe"" OR accessKeyId!=""0x1418"") AND (procName NOT REGEXP ""C:\\ProgramData\\VMware\\VMware Tools\\.*"" OR procName NOT REGEXP "".*\\vmtoolsd\.exe"") AND (procName NOT REGEXP ""C:\\Program Files \(x86\)\\.*|C:\\Program Files\\.*"" OR procName NOT REGEXP "".*Antivirus.*"") AND (procName!=""C:\\WINDOWS\\system32\\MRT.exe"" OR accessKeyId!=""0x1418"") AND (procName!=""C:\\Program Files\\Common Files\\McAfee\\MMSSHost\\MMSSHOST.exe"") AND (procName NOT REGEXP ""C:\\Windows\\Temp\\asgard2-agent\\.*"" OR procName NOT REGEXP "".*\\thor64\.exe|.*\\thor\.exe"" OR accessKeyId!=""0x1fffff"")) |
| Windows: Suspicious Kerberos RC4 Ticket Encryption | Security | Detects service ticket requests using RC4 encryption type. RC4 is a common and early stream cipher and widely used, but RC4 is considered to pose many security risks. RC4 usage should be rare on a modern network since Windows Vista & Windows Sever 2008 and newer support AES Kerberos encryption. This activity may indicate Kerberoasting activity, which is a post-exploitation attack technique that attempts to obtain a password hash of an Active Directory account that has a Service Principal Name (â€œSPNâ€). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_rc4_kerberos.yml | Windows: Suspicious Kerberos RC4 Ticket Encryption | (eventType IN (""Win-Security-4769-failure"",""Win-Security-4769-success"") AND kerbTicketOption=""0x40810000"" AND encryptAlgo=""0x17"") AND (serviceName NOT REGEXP "".*\$"") |
| Windows: Suspicious Key Manager Access | Security | Detects the invocation of the Stored User Names and Passwords dialogue via Windows Key Manager or Credential Manager. Windows Credentials Manager stores your usernames and passwords, as well as other login details. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_keymgr.yml | Windows: Suspicious Key Manager Access | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"") AND (command REGEXP "".*keymgr.*"" AND command REGEXP "".*KRShowKeyMgr.*"") |
| Windows: Suspicious LSASS Access Via MalSecLogon | Security | Detects suspicious access to Lsass handle via a call trace to seclogon.dll. The process known as Secondary Logon Service DLL, distributed by Microsoft, allows a user to start a command or application with a different account's credentials, such as an administrator working on another user's computer, only using their administrative account to run certain commands or applications. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_susp_seclogon.yml | Windows: Suspicious LSASS Access Via MalSecLogon | eventType=""Win-Sysmon-10-ProcessAccess"" AND targetProcName REGEXP "".*\\lsass\.exe"" AND procName REGEXP "".*\\svchost\.exe"" AND accessKeyId=""0x14c0"" AND procPath REGEXP "".*seclogon\.dll.*"" |
| Windows: Suspicious LSASS Process Clone | Security | Detects a suspicious LSASS process process clone that could be a sign of process dumping activity. Local Security Authority Subsystem Service (LSASS.exe), which manages system-level authentication. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_lsass_clone.yml | Windows: Suspicious LSASS Process Clone | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\Windows\\System32\\lsass\.exe"" AND parentProcName REGEXP "".*\\Windows\\System32\\lsass\.exe"" |
| Windows: Suspicious NTDS Exfil Filename Patterns | Security | Detects creation of files with specific name patterns seen used in various tools that export the NTDS.DIT for exfiltration. NTDS.dit file is a database that stores the Active Directory data (including users, groups, security descriptors and password hashes). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_ntds_exfil_tools.yml | Windows: Suspicious NTDS Exfil Filename Patterns | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\.ntds\.cleartext|.*\\All\.cab"" |
| Windows: Suspicious NTLM Authentication on the Printer Spooler Service | Security | Detects a privilege elevation attempt by coercing NTLM authentication on the Printer Spooler service. An adversary may use this primitive in combination with other techniques to elevate privileges on a compromised system. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_ntlmrelay.yml | Windows: Suspicious NTLM Authentication on the Printer Spooler Service | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"") AND (command REGEXP "".*C:\\windows\\system32\\davclnt\.dll,DavSetCookie.*"" AND command REGEXP "".*http.*"" AND command REGEXP "".*/print/pipe/.*|.*spoolss.*|.*srvsvc.*"") |
| Windows: Suspicious Office Token Search Via CLI | Security | Detects possible search for office tokens via CLI by looking for the string ""eyJ0eX"". This string is used as an anchor to look for the start of the JWT token used by office and similar apps. JSON web token (JWT) is an open standard (RFC 7519) that defines a way for securely transmitting information between parties as a JSON object. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_office_token_search.yml | Windows: Suspicious Office Token Search Via CLI | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* 'eyJ0eX'.*|.* \""eyJ0eX\"".*|.* eyJ0eX.*|.*eyJ0eXAiOi.*"" |
| Windows: Suspicious PFX File Creation | Security | Detects processes creating PFX files. A Personal Information Exchange (.pfx) file is password protected file certificate commonly used for code signing your application. It derives from the PKCS 12 archive file format certificate, and stores multiple cryptographic objects such as X.509 public key certificates. This could be an indicator of an adversary exporting a local certificate to a PFX file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_pfx_file_creation.yml | Windows: Suspicious PFX File Creation | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\.pfx"" AND ((fileName NOT REGEXP "".*\\Templates\\Windows\\Windows_TemporaryKey\.pfx.*"" OR fileName NOT REGEXP "".*\\CMake\\.*"")) |
| Windows: Suspicious Process Patterns NTDS.DIT Exfil | Security | Detects suspicious process patterns used in NTDS.DIT exfiltration. NTDS.dit file is a database that stores the Active Directory data (including users, groups, security descriptors and password hashes). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_ntds.yml | Windows: Suspicious Process Patterns NTDS.DIT Exfil | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\NTDSDumpEx\.exe|.*\\NTDSDump\.exe"" OR (command REGEXP "".*ntds\.dit.*"" AND command REGEXP "".*system\.hiv.*"") OR command REGEXP "".*NTDSgrab\.ps1.*"") OR (command REGEXP "".*ac i ntds.*"" AND command REGEXP "".*create full.*"") OR (command REGEXP "".*/c copy .*"" AND command REGEXP "".*\\windows\\ntds\\ntds\.dit.*"") OR (command REGEXP "".*activate instance ntds.*"" AND command REGEXP "".*create full.*"") OR (command REGEXP "".*powershell.*"" AND command REGEXP "".*ntds\.dit.*"")) OR (command REGEXP "".*ntds\.dit.*"" AND (parentProcName REGEXP "".*\\AppData\\.*|.*\\PerfLogs\\.*|.*\\Public\\.*|.*\\Temp\\.*|.*\\apache.*|.*\\tomcat.*"" OR procName REGEXP "".*\\AppData\\.*|.*\\PerfLogs\\.*|.*\\Public\\.*|.*\\Temp\\.*|.*\\apache.*|.*\\tomcat.*""))) |
| Windows: Suspicious Rejected SMB Guest Logon From IP | Security | Detects PrintNightmare (CVE-2021-1675) Remote Code Execution attempt in Windows Spooler Service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/smbclient/security/win_smbclient_security_susp_failed_guest_logon.yml | Windows: Suspicious Rejected SMB Guest Logon From IP | eventType REGEXP ""Win-.*-31017[^\d]*"" AND user IS NULL AND serverName REGEXP ""\\1.*"" |
| Windows: Suspicious Renamed Comsvcs DLL Loaded By Rundll32 | Security | Detects rundll32 loading a renamed comsvcs.dll to dump process memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_dll_comsvcs_load_renamed_version_by_rundll32.yml | Windows: Suspicious Renamed Comsvcs DLL Loaded By Rundll32 | eventType=""Win-Sysmon-7-Image-Loaded"" AND (procName REGEXP "".*\\rundll32\.exe"" AND hashCode REGEXP "".*IMPHASH=281d618f4e6271e527e6386ea6f748de.*|.*IMPHASH=407ca0f7b523319d758a40d7c0193699.*|.*IMPHASH=5e0dbdec1fce52daae251a110b4f309d.*|.*IMPHASH=eadbccbb324829acb5f2bbe87e5549a8.*|.*IMPHASH=eed93054cb555f3de70eaa9787f32ebb.*"") AND (loadedProcName NOT REGEXP "".*\\comsvcs\.dll"") |
| Windows: Suspicious SYSVOL Domain Group Policy Access | Security | Detects access to Domain Group Policies stored in SYSVOL. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_sysvol_access.yml | Windows: Suspicious SYSVOL Domain Group Policy Access | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\SYSVOL\\.*"" AND command REGEXP "".*\\policies\\.*"" |
| Windows: Suspicious Teams Application Related ObjectAcess Event | Security | Detects an access to authentication tokens and accounts of Microsoft Teams desktop application. There is a security vulnerability that Microsoft Teams stores user authentication tokens as cleartext in Windows, Linux, Mac. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_teams_suspicious_objectaccess.yml | Windows: Suspicious Teams Application Related ObjectAcess Event | (eventType=""Win-Security-4663"" AND osObjName REGEXP "".*\\Microsoft\\Teams\\Cookies.*|.*\\Microsoft\\Teams\\Local Storage\\leveldb.*"") AND (procName NOT REGEXP "".*\\Microsoft\\Teams\\current\\Teams\.exe.*"") |
| Windows: Suspicious Unattend.xml File Access | Security | Detects attempts to access unattend.xml, within the Panther directory where installation logs are stored. If these files exist, their contents will be displayed. The unattend.xml files are used to store credentials/answers during the unattended windows install process . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_access_susp_unattend_xml.yml | Windows: Suspicious Unattend.xml File Access | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\unattend\.xml"" |
| Windows: Suspicious Unsigned Dbghelp/Dbgcore DLL Loaded | Security | Detects the load of dbghelp/dbgcore DLL (used to make memory dumps) by suspicious processes. Tools like ProcessHacker and some attacker tradecract use MiniDumpWriteDump API found in dbghelp.dll or dbgcore.dll. As an example, SilentTrynity C2 Framework has a module that leverages this API to dump the contents of Lsass.exe and transfer it over the network back to the attacker's machine. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_dll_dbghelp_dbgcore_unsigned_load.yml | Windows: Suspicious Unsigned Dbghelp/Dbgcore DLL Loaded | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\dbgcore\.dll|.*\\dbghelp\.dll"" AND authResult=""false"" |
| Windows: Suspicious Usage Of Active Directory Diagnostic Tool ntdsutil.exe | Security | Detects execution of ntdsutil.exe to perform different actions such as restoring snapshots. The primary purpose of ntdsutil.exe is to perform Active Directory Database maintenance. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ntdsutil_susp_usage.yml | Windows: Suspicious Usage Of Active Directory Diagnostic Tool ntdsutil.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\ntdsutil\.exe"" OR srcFileName=""ntdsutil.exe"") AND ((command REGEXP "".*snapshot.*"" AND command REGEXP "".*mount .*"") OR (command REGEXP "".*ac.*"" AND command REGEXP "".* i.*"" AND command REGEXP "".* ntds.*"")) |
| Windows: Time Travel Debugging Utility Usage: Sysmon V1 | Security | Detects usage of Time Travel Debugging Utility. Time Travel Debugging is a tool that allows you to capture a trace of your process as it executes and then replay it later both forwards and backwards. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_tttracer_mod_load.yml | Windows: Time Travel Debugging Utility Usage: Sysmon V1 | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\ttdloader\.dll|.*\\ttdrecord\.dll|.*\\ttdwriter\.dll"" |
| Windows: Time Travel Debugging Utility Usage: Sysmon V2 | Security | Detects usage of Time Travel Debugging Utility. Time Travel Debugging is a tool that allows you to capture a trace of your process as it executes and then replay it later both forwards and backwards. Adversaries can execute dump processes, such as lsass.exe, via tttracer.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_tttracer_mod_load.yml | Windows: Time Travel Debugging Utility Usage: Sysmon V2 | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\tttracer\.exe"" |
| Windows: Transferring Files with Credential Data via Network Shares | Security | Detects file transfer of well-known filenames (sensitive files with credential data) using network shares. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_transf_files_with_cred_data_via_network_shares.yml | Windows: Transferring Files with Credential Data via Network Shares | eventType=""Win-Security-5145"" AND targetName REGEXP "".*\\hiberfil.*|.*\\lsass.*|.*\\mimidrv.*|.*\\ntds\.dit.*|.*\\sam.*|.*\\security.*|.*\\sqldmpr.*|.*\\windows\\minidump\\.*"" |
| Windows: Typical HiveNightmare SAM File Export | Security | Detects files written by the different tools that exploit HiveNightmare. â€œHiveNightmareâ€ tracked as CVE-2021-36934 (https://cve.MITRE.org/cgi-bin/cvename.cgi?name=CVE-2021-36934), is an access control list (ACL) flaw. Upon exploitation, non-privileged users may potentially gain access to execute arbitrary code or read sensitive data. Specifically, attackers may leverage this vulnerability to extract registry hive data, including hashed passwords, which can in turn be used to further elevate privilege.This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_hktl_hivenightmare_file_exports.yml | Windows: Typical HiveNightmare SAM File Export | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName REGEXP "".*\\SAM-2021-.*|.*\\SAM-2022-.*|.*\\SAM-2023-.*|.*\\SAM-haxx.*|.*\\Sam\.save.*|.*\\hive_sam_.*"" OR fileName=""C:\\windows\\temp\\sam"") |
| Windows: Unsigned Image Loaded Into LSASS Process | Security | Detects loading unsigned image (DLL, EXE) into Local Security Authority Subsystem Service (LSASS.exe) process, which manages system-level authentication. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_unsigned_image_loaded_into_lsass.yml | Windows: Unsigned Image Loaded Into LSASS Process | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\lsass\.exe"" AND authResult=""false"" |
| Windows: Use of Adplus.exe | Security | Detects the execution of AdPlus.exe binary that is part of the Windows SDK and can be used as a Living-off-the-Land Binaries (LOLBIN) to dump process memory and execute arbitrary commands. LOLBin refers to executables that are a part of the operating system (OS) and can be exploited to support an attack. ADPlus, console-based Visual Basic script, automates the Microsoft debugger to produce and collect memory dumps and log files containing debug information for one or more processes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_adplus.yml | Windows: Use of Adplus.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\adplus\.exe"" OR srcFileName=""Adplus.exe"") AND command REGEXP "".* -c .*|.* -hang .*|.* -p .*|.* -pmn .*|.* -pn .*|.* -po .*|.* -sc .*"" |
| Windows: Use of PktMon.exe | Security | Detects tools to Capture Network Packets on the windows 10 with October 2018 Update or later. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_pktmon.yml | Windows: Use of PktMon.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\pktmon\.exe"" OR srcFileName=""PktMon.exe"") |
| Windows: Volume Shadow Copy Mount | Security | Detects volume shadow copy mount via windows event log. It is possible to dump all user hashes from the Domain Controller by creating a shadow copy of the C drive using vssadmin. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/microsoft_windows_ntfs/win_system_volume_shadow_copy_mount.yml | Windows: Volume Shadow Copy Mount | eventType=""Win-System-Microsoft-Windows-Ntfs-98"" AND hostName REGEXP "".*HarddiskVolumeShadowCopy.*"" |
| Windows: VolumeShadowCopy Symlink Creation Via Mklink | Security | Detects shadow copy storage symbolic link creation using operating systems utilities. It is possible to dump all user hashes from the Domain Controller by creating a shadow copy of the C drive using tools like vssadmin.. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_mklink_shadow_copies_access_symlink.yml | Windows: VolumeShadowCopy Symlink Creation Via Mklink | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*mklink.*"" AND command REGEXP "".*HarddiskVolumeShadowCopy.*"" |
| Windows: VSSAudit Security Event Source Registration | Security | Detects the registration of the security event source VSSAudit. It would usually trigger when volume shadow copy operations happen. It is possible to dump all user hashes from the Domain Controller by creating a shadow copy of the C drive. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_vssaudit_secevent_source_registration.yml | Windows: VSSAudit Security Event Source Registration | resourceName=""VSSAudit"" AND eventType IN (""Win-Security-4904"",""Win-Security-4905"") |
| Windows: Weak Encryption Enabled and Kerberoast | Security | Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_alert_enable_weak_encryption.yml | Windows: Weak Encryption Enabled and Kerberoast | eventType=""Win-Security-4738"" AND userAcctControl REGEXP ( "".*DES.*|.*Encrypted.*|.*Preauth.*"" ) AND userAcctControl REGEXP ( "".*Enabled.*"" ) |
| Windows: WerFault Accessing LSASS | Security | Detects process LSASS memory dump using Mimikatz, NanoDump, Invoke-Mimikatz, Procdump or Taskmgr based on the CallTrace pointing to ntdll.dll, dbghelp.dll or dbgcore.dll for win10, server2016 and up. Mimikatz is a open source malware program that is commonly used by hackers and security professionals to extract sensitive information, such as passwords and credentials, from a system's memory. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_lsass_werfault.yml | Windows: WerFault Accessing LSASS | eventType=""Win-Sysmon-10-ProcessAccess"" AND procName REGEXP "".*\\WerFault\.exe"" AND targetProcName REGEXP "".*\\lsass\.exe"" AND accessKeyId=""0x1FFFFF"" |
| Windows: WerFault LSASS Process Memory Dump | Security | Detects WerFault creating a dump file with a name that indicates that the dump file could be an LSASS process memory, which contains user credentials. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_lsass_werfault_dump.yml | Windows: WerFault LSASS Process Memory Dump | eventType=""Win-Sysmon-11-FileCreate"" AND procName=""C:\\WINDOWS\\system32\\WerFault.exe"" AND fileName REGEXP "".*\\lsass.*|.*lsass\.exe.*"" |
| Windows: Windows Credential Editor Install Via Registry | Security | Detects the use of Windows Credential Editor (WCE). WCE is a security tool to list logon sessions and add, change, list and delete associated credentials (e.g. NTLM hashes, plaintext passwords and Kerberos tickets). It is widely used by security professionals to assess the security of Windows networks via Penetration Testing. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_hack_wce_reg.yml | Windows: Windows Credential Editor Install Via Registry | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*Services\\WCESERVICE\\Start.*"" |
| Windows: Windows Credential Manager Access via VaultCmd | Security | List credentials currently stored in Windows Credential Manager via the native Windows utility vaultcmd.exe. Windows Credentials Manager stores your usernames and passwords, as well as other login details. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_vaultcmd_list_creds.yml | Windows: Windows Credential Manager Access via VaultCmd | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\VaultCmd\.exe"" OR srcFileName=""VAULTCMD.EXE"") AND command REGEXP "".*/listcreds:.*"" |
| Windows: Windows Pcap Drivers | Security | Detects Windows Pcap driver installation based on a list of associated .sys files. This driver enables you to capture network traffic which can contain (hashed) credentials. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_pcap_drivers.yml | Windows: Windows Pcap Drivers | eventType=""Win-Security-4697"" AND serviceFileName REGEXP "".*USBPcap.*|.*ndiscap.*|.*nm3.*|.*nmnt.*|.*npcap.*|.*npf.*|.*pcap.*|.*pktmon.*|.*windivert.*"" |
| Windows: XORDump Use | Security | Detects suspicious use of XORDump.exe process memory dumping utility to collect a dump of the lsass.exe. Local Security Authority Subsystem Service (LSASS.exe), which manages system-level authentication. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_xordump.yml | Windows: XORDump Use | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\xordump\.exe"" OR command REGEXP "".* -m comsvcs .*|.* -m dbgcore .*|.* -m dbghelp .*|.* -process lsass\.exe .*"") |
| Wireless MITM attack detected by Network IPS | Security | Detects traffic that indicates a man in the middle attack | Wireless MITM attack detected by Network IPS | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_WirelessMITM) |
| Excessively Slow Oracle DB Query | Performance | Detects that an Oracle query took more than 5 minute to complete | Excessively Slow Oracle DB Query | eventType = ""PH_DEV_MON_PERF_ORADB_TOP_QUERIES"" |
| Excessively Slow SQL Server DB Query | Performance | Detects that an SQL Server query took more than 5 minute to complete | Excessively Slow SQL Server DB Query | eventType = ""PH_DEV_MON_PERF_MSSQL_TOP_QUERIES"" |
| High Oracle Non-System Table Space Usage | Performance | Detects high Oracle non-SYSTEM tablespace usage | High Oracle Non-System Table Space Usage | eventType = ""PH_DEV_MON_PERF_ORADB_TABLESPACE"" AND tablespaceName != ""SYSTEM"" |
| High Oracle System Table Space Usage | Performance | Detects that Oracle SYSTEM tablespace utilization is more than 80% | High Oracle System Table Space Usage | eventType = ""PH_DEV_MON_PERF_ORADB_TABLESPACE"" AND tablespaceName = ""SYSTEM"" |
| Oracle Database not backed up for 1 day | Performance | Detects that Oracle database has not been backed up for more than 1 day | Oracle Database not backed up for 1 day | eventType = ""PH_DEV_MON_PERF_ORADB"" |
| Oracle DB Alert Log Error | Performance | Detects Oracle database alert log errors | Oracle DB Alert Log Error | eventType CONTAIN ""ORADB-ORA"" |
| Oracle DB Low Buffer Cache Hit Ratio | Performance | Detects that average Oracle database buffer cache hit ratio is less than 90 for 2 successive readings | Oracle DB Low Buffer Cache Hit Ratio | eventType = ""PH_DEV_MON_PERF_ORADB"" |
| Oracle DB Low Library Cache Hit Ratio | Performance | Detects that average Oracle database library cache hit ratio is less than 90 for 2 successive readings | Oracle DB Low Library Cache Hit Ratio | eventType = ""PH_DEV_MON_PERF_ORADB"" |
| Oracle DB Low Row Cache Hit Ratio | Performance | Detects that average Oracle database row cache hit ratio is less than 90 for 2 successive readings | Oracle DB Low Row Cache Hit Ratio | eventType = ""PH_DEV_MON_PERF_ORADB"" |
| Slow MySQL DB Query | Performance | Detects more than 2 slow queries on a MySQL Server. The threshold on query execution time is set on the database server. | Slow MySQL DB Query | eventType = ""PH_DEV_MON_PERF_MYSQLDB"" |
| SQL Server Excessive Blocking | Performance | Detects a particular SQL Server process/user blocked for more than 2 sec | SQL Server Excessive Blocking | eventType = ""PH_DEV_MON_PERF_MSSQL_BLOCKBY_INFO"" |
| SQL Server Excessive Deadlock | Performance | Detects excessive SQL Server deadlocks ( larger 2/sec over 2 succesive readings) | SQL Server Excessive Deadlock | eventType = ""PH_DEV_MON_PERF_MSSQL_SYS"" |
| SQL Server Excessive Page Read/Write | Performance | Detects excessive SQL Server page read/write ( larger than 90 over 2 succesive readings) | SQL Server Excessive Page Read/Write | eventType = ""PH_DEV_MON_PERF_MSSQL_SYS"" |
| SQL Server Low Buffer Cache Hit Ratio | Performance | Detects that average Oracle buffer cache hit ratio is less than 90 for 2 successive readings | SQL Server Low Buffer Cache Hit Ratio | eventType = ""PH_DEV_MON_PERF_MSSQL_SYS"" |
| SQL Server Low Free Pages in Buffer Pool | Performance | Detects low free pages in SQL Server buffer pool (less than 640 over 2 succesive readings) | SQL Server Low Free Pages in Buffer Pool | eventType = ""PH_DEV_MON_PERF_MSSQL_SYS"" |
| SQL Server Low Log Cache Hit Ratio | Performance | Detects that SQL Server log buffer cache hit ratio is less than 90 for 2 successive readings | SQL Server Low Log Cache Hit Ratio | eventType = ""PH_DEV_MON_PERF_MSSQL_SYS"" |
| SQL Server scheduled job failed | Performance | Detects that an SQL Server scheduled job failed | SQL Server scheduled job failed | eventType = ""Win-App-SQLSERVERAGENT-208"" |
| Agent FIM: Linux Directory Ownership or Permission Changed | Change | FortiSIEM Linux Agent FIM detected that a directory ownership or permission changed | Agent FIM: Linux Directory Ownership or Permission Changed | eventType = ""FSM_LINUX_FILE_ATTRIB_CHANGE"" AND targetOsObjType = ""Directory"" |
| Agent FIM: Linux File Changed From Baseline | Change | FortiSIEM Linux Agent FIM detected that a file changed from its baseline | Agent FIM: Linux File Changed From Baseline | eventType = ""FSM_LINUX_FILE_CHANGE_BASELINE"" |
| Agent FIM: Linux File Content Modified | Change | Detects that a user modified either the content or the attributes of a file or directory | Agent FIM: Linux File Content Modified | eventType = ""FSM_LINUX_FILE_MODIFY"" OR (eventType = ""FSM_LINUX_FILE_DELETE_SELF"" AND targetOsObjName = ""/etc/passwd"") |
| Agent FIM: Linux File or Directory Deleted | Change | FortiSIEM Linux Agent FIM detected that a file or a directory was deleted | Agent FIM: Linux File or Directory Deleted | eventType = ""FSM_LINUX_FILE_DELETE"" |
| Agent FIM: Linux File Ownership or Permission Changed | Change | FortiSIEM Linux agent FIM detected that a file ownership or permission changed | Agent FIM: Linux File Ownership or Permission Changed | eventType = ""FSM_LINUX_FILE_ATTRIB_CHANGE"" AND targetOsObjType = ""File"" |
| Agent FIM: Windows File Changed From Baseline | Change | FortiSIEM Windows Agent FIM detected that a file changed from its baseline | Agent FIM: Windows File Changed From Baseline | eventType = ""AO-WUA-FileMon-BaselineChange"" |
| Agent FIM: Windows File Content Modified | Change | FortiSIEM Windows Agent FIM detected that a file content was modified | Agent FIM: Windows File Content Modified | eventType = ""AO-WUA-FileMon-Modified"" |
| Agent FIM: Windows File or Directory Archive Bit Changed | Change | FortiSIEM Windows Agent FIM detected that a file archive bit changed | Agent FIM: Windows File or Directory Archive Bit Changed | eventType = ""AO-WUA-FileMon-ArchivedBitChange"" |
| Agent FIM: Windows File or Directory Deleted | Change | FortiSIEM Windows Agent FIM detected that a file or a directory was deleted | Agent FIM: Windows File or Directory Deleted | eventType = ""AO-WUA-FileMon-Removed"" |
| Agent FIM: Windows File Ownership Changed | Change | FortiSIEM Windows Agent FIM detected that a file ownership changed | Agent FIM: Windows File Ownership Changed | eventType = ""AO-WUA-FileMon-OwnershipChange"" |
| Agent FIM: Windows File Permission Changed | Change | FortiSIEM Windows Agent FIM detected that a file permission changed | Agent FIM: Windows File Permission Changed | eventType = ""AO-WUA-FileMon-PermissionChange"" |
| Agentless FIM: Audited file or directory deleted | Change | FortiSIEM agentless file monitoring detected that a file or a directory was deleted | Agentless FIM: Audited file or directory deleted | eventType = ""PH_DEV_MON_CUST_FILE_DELETE"" |
| Agentless FIM: Audited file or directory ownership or permission changed | Change | FortiSIEM agentless file monitoring detected that a file or a directory ownership or permission changed | Agentless FIM: Audited file or directory ownership or permission changed | eventType = ""PH_DEV_MON_CUST_FILE_CHANGE_ATTRIB"" |
| Agentless FIM: Audited target file content modified | Change | FortiSIEM agentless file monitoring detected that a file content is different than its target file | Agentless FIM: Audited target file content modified | eventType = ""PH_DEV_MON_TARGET_FILE_CONTENT_CHANGE"" |
| Audited file or directory content modified in SVN | Change | FortiSIEM file monitoring detected that a file or a directory content was modified and the changes are in SVN | Audited file or directory content modified in SVN | eventType = ""PH_DEV_MON_FILE_CONTENT_CHANGE"" |
| AWS CloudTrail Important Changes | Security | This method detects disabling, deleting and updating of a AWS CloudTrail | AWS CloudTrail Important Changes | eventType IN (""AWS-CloudTrail-CLOUDTRAIL-StopLogging"",""AWS-CloudTrail-CLOUDTRAIL-DeleteTrail"",""AWS-CloudTrail-CLOUDTRAIL-UpdateTrail"") |
| AWS CloudTrail Log Deleted | Security | Identifies the deletion of an AWS log trail. An adversary may delete trails in an attempt to evade defenses. | AWS CloudTrail Log Deleted | eventType CONTAIN ""AWS-CloudTrail-CLOUDTRAIL-DeleteTrail"" |
| AWS CloudTrail Log Setting Updated | Security | Identifies an update to an AWS log trail setting that specifies the delivery of log files. | AWS CloudTrail Log Setting Updated | eventType CONTAIN ""AWS-CloudTrail-CLOUDTRAIL-UpdateTrail"" |
| AWS CloudTrail Log Suspended | Security | Identifies suspending the recording of AWS API calls and log file delivery for the specified trail. An adversary may suspend trails in an attempt to evade defenses. | AWS CloudTrail Log Suspended | eventType CONTAIN ""AWS-CloudTrail-CLOUDTRAIL-StopLogging"" |
| AWS CloudWatch Alarm Deleted | Security | Identifies the deletion of an AWS CloudWatch alarm. An adversary may delete alarms in an attempt to evade defenses. | AWS CloudWatch Alarm Deleted | eventType CONTAIN ""AWS-CloudTrail-MONITORING-DeleteAlarms"" |
| AWS CloudWatch Log Group Deleted | Security | Identifies the deletion of a specified AWS CloudWatch log group. When a log group is deleted, all the archived log events associated with the log group are also permanently deleted. | AWS CloudWatch Log Group Deleted | eventType CONTAIN ""AWS-CloudTrail-LOGS-DeleteLogGroup"" |
| AWS CloudWatch Log Stream Deleted | Security | Identifies the deletion of an AWS CloudWatch log stream, which permanently deletes all associated archived log events with the stream. | AWS CloudWatch Log Stream Deleted | eventType CONTAIN ""AWS-CloudTrail-LOGS-DeleteLogStream"" |
| AWS Config Service Tampering | Security | Identifies attempts to delete an AWS Config Service rule. An adversary may tamper with Config rules in order to reduce visibility into the security posture of an account and / or its workload instances. | AWS Config Service Tampering | eventType CONTAIN ""AWS-CloudTrail-CONFIG-DeleteConfigRule"" |
| AWS Configuration Recorder Stopped | Security | Identifies an AWS configuration change to stop recording a designated set of resources. | AWS Configuration Recorder Stopped | eventType CONTAIN ""AWS-CloudTrail-CONFIG-StopConfigurationRecorder"" |
| AWS EC2 Encryption Disabled | Security | Identifies disabling of Amazon Elastic Block Store (EBS) encryption by default in the current region. Disabling encryption by default does not change the encryption status of your existing volumes. | AWS EC2 Encryption Disabled | eventType CONTAIN ""AWS-CloudTrail-EC2-DisableEbsEncryptionByDefault"" |
| AWS EC2 Flow Log Deleted | Security | Identifies the deletion of one or more flow logs in AWS Elastic Compute Cloud (EC2). An adversary may delete flow logs in an attempt to evade defenses. | AWS EC2 Flow Log Deleted | eventType CONTAIN ""AWS-CloudTrail-EC2-DeleteFlowLogs"" |
| AWS EC2 Network Access Control List Deleted | Security | Identifies the deletion of an Amazon Elastic Compute Cloud (EC2) network access control list (ACL) or one of its ingress/egress entries. | AWS EC2 Network Access Control List Deleted | eventType IN (""AWS-CloudTrail-EC2-DeleteNetworkAcl"",""AWS-CloudTrail-EC2-DeleteNetworkAclEntry"") |
| AWS EC2 Snapshot Attribute Modified | Security | An attempt was made to modify AWS EC2 snapshot attributes. Snapshots are sometimes shared by threat actors in order to exfiltrate bulk data from an EC2 fleet. If the permissions were modified, verify the snapshot was not shared with an unauthorized or unexpected AWS account. | AWS EC2 Snapshot Attribute Modified | eventType CONTAIN ""AWS-CloudTrail-EC2-ModifySnapshotAttribute"" |
| AWS EC2 User Data Download | Security | This method detects bulk downloading of User Data associated with AWS EC2 instances. Instance User Data may include installation scripts and hard-coded secrets for deployment | AWS EC2 User Data Download | eventType = ""AWS-CloudTrail-EC2-DescribeInstanceAttribute"" AND rawEventMsg CONTAIN ""requestParameters/userData"" |
| AWS GuardDuty Detector Deleted | Security | Identifies the deletion of an Amazon GuardDuty detector. Upon deletion, GuardDuty stops monitoring the environment and all existing findings are lost. | AWS GuardDuty Detector Deleted | eventType CONTAIN ""AWS-CloudTrail-GUARDDUTY-DeleteDetector"" |
| AWS S3 Bucket Configuration Deleted | Security | Identifies the deletion of various Amazon Simple Storage Service (S3) bucket configuration components. | AWS S3 Bucket Configuration Deleted | eventType IN (""AWS-CloudTrail-S3-DeleteBucketPolicy"",""AWS-CloudTrail-S3-DeleteBucketReplication"",""AWS-CloudTrail-S3-DeleteBucketCors"",""AWS-CloudTrail-S3-DeleteBucketEncryption"",""AWS-CloudTrail-S3-DeleteBucketLifecycle"") |
| AWS SecHub: Tactics: Defense Evasion Detected | Security | AWS Security Hub detected Defense Evasion tactics. Adversary is trying to avoid getting detected. | AWS SecHub: Tactics: Defense Evasion Detected | eventType = ""AWS-Hub-TTPs-Defense_Evasion"" |
| AWS WAF Access Control List Deleted | Security | Identifies the deletion of a specified AWS Web Application Firewall (WAF) access control list. | AWS WAF Access Control List Deleted | eventType CONTAIN ""AWS-CloudTrail-.*-DeleteWebACL"" |
| AWS WAF Rule or Rule Group Deleted | Security | Identifies the deletion of a specified AWS Web Application Firewall (WAF) rule or rule group. | AWS WAF Rule or Rule Group Deleted | eventType REGEXP (""AWS-CloudTrail-.*-DeleteRule|AWS-CloudTrail-.*-DeleteRuleGroup"") |
| Azure Automation Runbook Deleted | Security | Identifies when an Azure Automation runbook is deleted. An adversary may delete an Azure Automation runbook in order to disrupt their target's automated business operations or to remove a malicious runbook that was used for persistence. | Azure Automation Runbook Deleted | eventType = ""MS_EvtHub_automation_automationaccounts_runbooks_delete"" |
| Azure Diagnostic Settings Deleted | Security | Identifies the deletion of diagnostic settings in Azure, which send platform logs and metrics to different destinations. An adversary may delete diagnostic settings in an attempt to evade defenses. | Azure Diagnostic Settings Deleted | eventType = ""MS_EvtHub_insights_diagnosticsettings_delete"" |
| Azure Event Hub Deleted | Security | Identifies an Event Hub deletion in Azure. An Event Hub is an event processing service that ingests and processes large volumes of events and data. An adversary may delete an Event Hub in an attempt to evade detection. | Azure Event Hub Deleted | eventType = ""MS_EvtHub_eventhub_namespaces_eventhubs_delete"" |
| Azure Firewall Policy Deleted | Security | Identifies the deletion of a firewall policy in Azure. An adversary may delete a firewall policy in an attempt to evade defenses and/or to eliminate barriers in carrying out their initiative. | Azure Firewall Policy Deleted | eventType = ""MS_EvtHub_network_firewallpolicies_delete"" |
| Azure Network Watcher Deleted | Security | Identifies the deletion of a Network Watcher in Azure. Network Watchers are used to monitor, diagnose, view metrics, and enable or disable logs for resources in an Azure virtual network. An adversary may delete a Network Watcher in an attempt to evade defenses. | Azure Network Watcher Deleted | eventType = ""MS_EvtHub_network_networkwatchers_delete"" |
| Barracuda WAF: Config Change Detected | Change | Barracuda WAF Audit Event for Config Change seen | Barracuda WAF: Config Change Detected | eventType = ""Barracuda-Audit-CONFIG"" |
| Crowdstrike: Evade Detection | Security | Crowdstrike agent detected attempts by malware to evade detection on the host | Crowdstrike: Evade Detection | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Evade-Detection"" |
| Crowdstrike: Social Engineering | Security | Crowdstrike agent detected suspicious activity indicating social engineering | Crowdstrike: Social Engineering | eventType = ""Crowdstrike-Falcon-DetectionSummaryEvent-Social-Engineering"" |
| CyberArk Vault User History Clear | Security | Detects CyberArk Vault user history being cleared | CyberArk Vault User History Clear | eventType = ""CyberArk-Vault-82"" |
| GCP: Firewall Rule Created | Change | Google Cloud Platform: An instance Firewall Rule has been created | GCP: Firewall Rule Created | eventType = ""GCP_Audit_activity_compute_firewalls_insert"" |
| GCP: Firewall Rule Deleted | Change | Google Cloud Platform: An instance Firewall Rule has been deleted | GCP: Firewall Rule Deleted | eventType = ""GCP_Audit_activity_compute_firewalls_delete"" |
| GCP: Firewall Rule Updated | Change | Google Cloud Platform: An instance Firewall Rule has been patched / updated | GCP: Firewall Rule Updated | eventType = ""GCP_Audit_activity_compute_firewalls_patch"" |
| GCP: Logging Sink Deleted | Change | Google Cloud Platform: A logging Sink was deleted | GCP: Logging Sink Deleted | eventType = ""GCP_Audit_activity_DeleteSink"" |
| GCP: Logging Sink Updated | Change | Google Cloud Platform: A logging Sink was updated | GCP: Logging Sink Updated | eventType = ""GCP_Audit_activity_UpdateSink"" |
| GCP: Pub/Sub Subscription Deleted | Change | Google Cloud Platform: A Pub/Sub Subscription has been removed from a topic. A subscription is required for each application that would like to ingest data from a topic. | GCP: Pub/Sub Subscription Deleted | eventType = ""GCP_Audit_activity_Subscriber_DeleteSubscription"" |
| GCP: Pub/Sub Topic Deleted | Change | Google Cloud Platform: A Pub/Sub Topic has been deleted. Pub/Sub topics can be used to extract large amounts of audit or arbitrary data from GCP cloud, depending on what data is being published to the topic. FortiSIEM and other products use pub/sub topics to ingest audit log data. | GCP: Pub/Sub Topic Deleted | eventType = ""GCP_Audit_activity_Publisher_DeleteTopic"" |
| GCP: Storage or Logging Bucket Deleted | Change | Google Cloud Platform: A Storage or Logging Bucket has been deleted | GCP: Storage or Logging Bucket Deleted | eventType IN (""GCP_Audit_activity_DeleteBucket"",""GCP_Audit_activity_storage_buckets_delete"") |
| Group Policy Object Created | Security | Detects Group Policy Object creation | Group Policy Object Created | eventType=""Win-Security-5136"" |
| Group Policy Object Modified | Security | Detects Group Policy Object modification | Group Policy Object Modified | eventType=""Win-Security-5136"" |
| IPS/AV Evasion attempts | Security | Detects NIPS evasion attempts | IPS/AV Evasion attempts | reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType IN (Group@PH_SYS_EVENT_EvasionExploit) |
| Linux: Attempt to Disable CarbonBlack Service | Security | Adversaries may attempt to disable the CarbonBlack HIDS service in an attempt to an attempt to disrupt detection by security controls. This requires process monitoring via FortiSIEM Linux agent. | Linux: Attempt to Disable CarbonBlack Service | eventType = ""LINUX_PROCESS_EXEC"" AND ((procName = ""systemctl"" AND swParam REGEXP "".*stop\s+cbdaemon.*|.*disable\s+cbdaemon.*"") OR (procName = ""service"" AND swParam REGEXP "".*cbdaemon\s+stop.*"") OR (procName = ""chkconfig"" AND swParam REGEXP "".*off\s+cbdaemon.*"")) |
| Linux: Attempt to Disable Crowdstrike Service | Security | Adversaries may attempt to disable the Crowdstrike HIDS service in an attempt to an attempt to disrupt detection by security controls. This requires process monitoring via FortiSIEM Linux agent. | Linux: Attempt to Disable Crowdstrike Service | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""systemctl"" AND swParam REGEXP "".*stop\s+falcon-sensor\.service.*|.*disable\s+falcon-sensor.service.*"" |
| Linux: Attempt to Disable Syslog Service | Security | Adversaries may attempt to disable the syslog service in an attempt to an attempt to disrupt event logging and evade detection by security controls. This requires process monitoring via FortiSIEM Linux agent. | Linux: Attempt to Disable Syslog Service | eventType = ""LINUX_PROCESS_EXEC"" AND ((procName = ""service"" AND swParam CONTAIN ""stop"") OR (procName = ""chkconfig"" AND swParam CONTAIN ""off"") OR (procName = ""systemctl"" AND swParam REGEXP ("".*disable.*|.*stop.*|.*kill.*""))) AND swParam REGEXP ("".*syslog.*|.*rsyslog.*|.*syslog-ng.*"") |
| Linux: Attempts to Disable IPTables or Firewall | Security | Adversaries may attempt to disable the iptables or firewall service in an attempt to affect how a host is allowed to receive or send network traffic. This requires process monitoring via FortiSIEM Linux agent. | Linux: Attempts to Disable IPTables or Firewall | (eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""ufw"" AND swParam REGEXP ("".*allow.*|.*disable.*|.*reset.*"")) OR (((procName = ""service"" AND swParam CONTAIN ""stop"") OR (procName = ""chkconfig"" AND swParam CONTAIN ""off"") OR (procName = ""systemctl"" AND swParam REGEXP ("".*disable.*|.*stop.*|.*kill.*""))) AND swParam REGEXP ("".*firewalld.*|.*iptables.*|.*ip6tables.*"")) |
| Linux: Base16/32/64 Encoding/Decoding Activity | Security | Adversaries may encode/decode data in an attempt to evade detection by host or network-based security controls. Automated tools such as Jenkins may encode or decode files as part of their normal behavior. This requires process monitoring via FortiSIEM Linux agent. | Linux: Base16/32/64 Encoding/Decoding Activity | eventType = ""LINUX_PROCESS_EXEC"" AND procName REGEXP ("".*base16.*|.*base32.*|.*base32plain.*|.*base32hex.*|.*base64.*|.*base64plain.*|.*base64url.*|.*base64mime.*|.*base64pem.*"") |
| Linux: Clear System Logs | Security | Detects System Logs being deleted. This could be a defense evasion attempt. This requires process monitoring via FortiSIEM Linux agent. | Linux: Clear System Logs | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""rm"" AND swParam REGEXP ("".*/var/log/messages.*|.*/var/log/secure.*|.*/var/log/auth.log.*|.*/var/log/utmp.*|.* /var/log/wtmp.*|.*/var/log/kern.log.*|.*/var/log/cron.log.*|.*/var/log/maillog.*|.*/var/log/httpd/.*"") |
| Linux: Command Line History Deleted | Security | Adversaries may attempt to clear the bash command line history in an attempt to evade detection or forensic investigations. This requires process monitoring via FortiSIEM Linux agent. | Linux: Command Line History Deleted | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""rm"" AND swParam REGEXP "".*/\.bash_history"" |
| Linux: File Deletion via Shred | Security | Detects attempts to delete files via shred command. Malware or other files dropped or created on a system by an adversary may leave traces behind as to what was done within a network and how. Adversaries may remove these files over the course of an intrusion to keep their footprint low or remove them at the end as part of the post-intrusion cleanup process. This requires process monitoring via FortiSIEM Linux agent. | Linux: File Deletion via Shred | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""shred"" AND swParam REGEXP ("".*-u.*|.*--remove.*|.*-z.*|.*--zero.*"") |
| Linux: File Permission Modification in Writable Absolute Directory By non-root user | Security | Identifies file permission modifications in common writable directories by a non-root user. Adversaries often drop files or payloads into a writable directory and change permissions prior to execution. This requires process monitoring via FortiSIEM Linux agent. Note that auditd PATH events will only trigger this rule, as operations such as chmod, when executed outside a target directory such as /tmp will show a absolute path name in the PATH auditd log | Linux: File Permission Modification in Writable Absolute Directory By non-root user | eventType IN (""LINUX_PROCESS_EXEC"",""LINUX_Auditd_SYSCALL"") AND procName IN (""chattr"",""chgrp"",""chmod"",""chown"") AND userId != ""0"" |
| Linux: File Permission Modification in Writable Absolute Directory By non-root user | Security | Identifies file permission modifications in common writable directories by a non-root user. Adversaries often drop files or payloads into a writable directory and change permissions prior to execution. This requires process monitoring via FortiSIEM Linux agent. Note that auditd PATH events will only trigger this rule, as operations such as chmod, when executed outside a target directory such as /tmp will show a absolute path name in the PATH auditd log | Linux: File Permission Modification in Writable Absolute Directory By non-root user | eventType = ""LINUX_Auditd_PATH"" AND osObjName REGEXP ""^\/dev\/shm|^\/tmp|^\/var\/tmp"" |
| Linux: File Permission Modification in Writable Relative Directory By non-root user | Security | Identifies file permission modifications in common writable directories by a non-root user. Adversaries often drop files or payloads into a writable directory and change permissions prior to execution. This requires process monitoring via FortiSIEM Linux agent. Note that auditd CWD events will only trigger this rule, as operations such as chmod, when executed within target directory such as /tmp will show a relative path name in the PATH auditd log | Linux: File Permission Modification in Writable Relative Directory By non-root user | eventType IN (""LINUX_PROCESS_EXEC"",""LINUX_Auditd_SYSCALL"") AND procName IN (""chattr"",""chgrp"",""chmod"",""chown"") AND userId != ""0"" |
| Linux: File Permission Modification in Writable Relative Directory By non-root user | Security | Identifies file permission modifications in common writable directories by a non-root user. Adversaries often drop files or payloads into a writable directory and change permissions prior to execution. This requires process monitoring via FortiSIEM Linux agent. Note that auditd CWD events will only trigger this rule, as operations such as chmod, when executed within target directory such as /tmp will show a relative path name in the PATH auditd log | Linux: File Permission Modification in Writable Relative Directory By non-root user | eventType = ""LINUX_Auditd_CWD"" AND commandPath REGEXP ""^\/dev\/shm|^\/tmp|^\/var\/tmp"" |
| Linux: Hidden Files and Directories Created | Security | Detects hidden files or folders in common writable directories. Users can mark specific files as hidden simply by putting a ""."" as the first character in the file or folder name. Adversaries can use this to their advantage to hide files and folders on the system for persistence and defense evasion. This requires process monitoring via FortiSIEM Linux agent. | Linux: Hidden Files and Directories Created | eventType IN (""LINUX_PROCESS_EXEC"",""LINUX_Auditd_SYSCALL"") AND procName NOT IN (""ls"",""find"") |
| Linux: Hidden Files and Directories Created | Security | Detects hidden files or folders in common writable directories. Users can mark specific files as hidden simply by putting a ""."" as the first character in the file or folder name. Adversaries can use this to their advantage to hide files and folders on the system for persistence and defense evasion. This requires process monitoring via FortiSIEM Linux agent. | Linux: Hidden Files and Directories Created | eventType = ""LINUX_Auditd_PATH"" AND objType = ""CREATE"" AND osObjName REGEXP ""^\.[^\/]+|\/\.[^\/]+"" |
| Linux: Kernel Module Removed | Security | Detects attempts to remove a kernel module. Kernel modules are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. This requires process monitoring via FortiSIEM Linux agent. | Linux: Kernel Module Removed | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""sudo"" AND (swParam CONTAIN ""rmmod"" OR (swParam CONTAIN ""modprobe"" AND swParam REGEXP ("".*--remove.*|.*--r.*""))) |
| Linux: Processes with Trailing Spaces | Security | Detects processes running with a trailing space, which can be used to look like an ordinary file while evading default file handlers. | Linux: Processes with Trailing Spaces | eventType = ""LINUX_PROCESS_EXEC"" AND procName REGEXP ("".* "") |
| Linux: SELinux Disabled | Security | Detects attempts to disable Security-Enhanced Linux (SELinux), which is a Linux kernel security feature to support access control policies. Adversaries may disable security tools to avoid possible detection of their tools and activities. This requires process monitoring via FortiSIEM Linux agent. | Linux: SELinux Disabled | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""setenforce"" AND swParam IS NULL |
| Linux: Timestomping using Touch Command | Security | Detects attempts to modify file time attributes. Timestomping is an anti-forensics technique to modify the timestamps of a file, often to mimic files that are in the same folder, so that they do not appear conspicuous to forensic investigators or file analysis tools. This requires process monitoring via FortiSIEM Linux agent. | Linux: Timestomping using Touch Command | eventType = ""LINUX_PROCESS_EXEC"" AND procName = ""touch"" AND swParam REGEXP (""-[amrt]+.*"") |
| Linux: Unusual Process Execution from Temp | Security | Identifies processes running in a temporary folder. This is sometimes done by adversaries to hide malware. This requires process monitoring via FortiSIEM Linux agent. | Linux: Unusual Process Execution from Temp | eventType IN (""LINUX_PROCESS_EXEC"",""LINUX_Auditd_SYSCALL"") AND (commandPath REGEXP ""^\/tmp|^\/var\/tmp"" OR command REGEXP ""^\/tmp|^\/var\/tmp"" ) |
| Modification of ld.so.preload | Security | Detects modification of ld.so.preload for shared object injection. This technique is used by attackers to load arbitrary code into processes. | Modification of ld.so.preload | eventType REGEXP (""FSM_LINUX_FILE_.*"") AND targetOsObjName CONTAIN ""/etc/ld.so.preload"" |
| MS 365 Defender: Masquerading - Execution Alert | Security | Masquerading - Execution Alert from MS 365 Defender | MS 365 Defender: Masquerading - Execution Alert | (eventType = ""MS-Defender-Endpoint-Alert-Execution"" OR eventType CONTAIN ""M365Defender-Alert"") AND attackTechniqueId = ""T1036"" |
| MS 365 Defender: Process Injection - Defense Evasion Alert | Security | Process Injection - Defense Evasion Alert from MS 365 Defender | MS 365 Defender: Process Injection - Defense Evasion Alert | (eventType = ""MS-Defender-Endpoint-Alert-DefenseEvasion"" OR eventType CONTAIN ""M365Defender-Alert"") AND attackTechniqueId = ""T1055"" |
| Multiple Windows Accounts Disabled by Administrator | Security | Detects that multiple (more than 3) accounts were disabled by administrator in a short period of time | Multiple Windows Accounts Disabled by Administrator | eventType IN (""Win-Security-629"",""Win-Security-4725"") |
| Network Installed Software Change | Change | Detects that a new software has been installed on a network device or an existing software has been deleted. | Network Installed Software Change | eventType = ""PH_DEV_MON_CHANGE_INST_SW"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) |
| Oracle OCI: Policy Created | Security | Oracle OCI Policy Created. Policies define access to resources in OCI. | Oracle OCI: Policy Created | eventType = ""Oracle-OCI-identitycontrolplane-createpolicy"" |
| Oracle OCI: Policy Deleted | Security | Oracle OCI Policy Deleted. Policies define access to resources in OCI. | Oracle OCI: Policy Deleted | eventType = ""Oracle-OCI-identitycontrolplane-deletepolicy"" |
| Outbreak: BURNTCIGAR MS Signed Driver Malware detected on Host | Security | BURNTCIGAR Microsoft Signed Driver Malware detected on host | Outbreak: BURNTCIGAR MS Signed Driver Malware detected on Host | eventType IN (Group@PH_SYS_EVENT_FortiClient_AV_Detected) AND (ipsSignatureId IN (10116089,10115947) OR virusName IN (""W64/BURNTCIGAR.BS!tr"",""W64/BURNTCIGAR.BS!tr.rkit"")) |
| Outbreak: BURNTCIGAR MS Signed Driver Malware detected on Network | Security | BURNTCIGAR Microsoft Signed Driver Malware detected on network | Outbreak: BURNTCIGAR MS Signed Driver Malware detected on Network | eventType IN (Group@PH_SYS_EVENT_FortiGate_AV_Detected) AND ipsSignatureId IN (10116089,10115947) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Outbreak: Control Web Panel Login Exploit Detected on Host | Security | Control Web Panel Login Exploit detected (CVE-2022-44877) on host. Details: https://www.fortiguard.com/outbreak-alert/cwp-os-command-injection | Outbreak: Control Web Panel Login Exploit Detected on Host | eventType = ""FortiClient-vulnerabilityscan-vulnerability-record"" AND vulnId = 4716 |
| Outbreak: Control Web Panel Login Exploit Detected on Network | Security | Control Web Panel Login Exploit detected (CVE-2022-44877) on network. Details: https://www.fortiguard.com/outbreak-alert/cwp-os-command-injection | Outbreak: Control Web Panel Login Exploit Detected on Network | eventType IN (Group@PH_SYS_EVENT_FortiGate_AV_Detected,""FortiGate-ips-signature-52548"",""FortiProxy-ips-signature-52548"") AND ipsSignatureId IN (52548,10120789) AND (srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) OR (destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND fwAction NOT IN (""deny"",""dropped"",""block"",""blocked"",""ban-ip"",""alert_deny""))) |
| Running Config Change | Change | Detects that the configuration of a network device (router or firewall) has changed. This is achieved via logging in and keeping track of the last change | Running Config Change | eventType = ""PH_DEV_MON_CHANGE_RUN_CONFIG"" |
| Running Config Change: with login info | Change | Detects that the configuration of a network device (router or firewall) has changed. This is achieved via logging in and keeping track of the last config. The IP address of the user likely to have executed the change, is obtained from a preceding syslog that indicates a prior login. This rule requires the network devices to forward syslog to the monitoring system. | Running Config Change: with login info | eventType = ""IOS-SYS-CONFIG_I"" OR eventType = ""ASA-605005"" OR eventType = ""Foundry-Ironware-Running-Config-Change"" |
| Running Config Change: with login info | Change | Detects that the configuration of a network device (router or firewall) has changed. This is achieved via logging in and keeping track of the last config. The IP address of the user likely to have executed the change, is obtained from a preceding syslog that indicates a prior login. This rule requires the network devices to forward syslog to the monitoring system. | Running Config Change: with login info | eventType = ""PH_DEV_MON_CHANGE_RUN_CONFIG"" |
| Server Installed Software Change | Change | Detects that a new software has been installed on a server or an existing software has been deleted. | Server Installed Software Change | eventType = ""PH_DEV_MON_CHANGE_INST_SW"" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) |
| Startup Config Change | Change | Detects that the configuration of a network device (router or firewall) has changed. This is achieved via logging in and keeping track of the last change | Startup Config Change | eventType = ""PH_DEV_MON_CHANGE_STARTUP_CONFIG"" |
| Startup Config Change: with login | Change | Detects that the configuration of a network device (router or firewall) has changed. This is achieved via logging in and keeping track of the last configuration. The IP address of the user likely to have executed the change, is obtained from a preceding syslog that indicates a prior login. This rule requires the network devices to forward syslog to the monitoring system. | Startup Config Change: with login | eventType = ""IOS-SYS-CONFIG_I"" OR eventType = ""ASA-605005"" OR eventType = ""Foundry-Ironware-Startup-Config-Change"" |
| Startup Config Change: with login | Change | Detects that the configuration of a network device (router or firewall) has changed. This is achieved via logging in and keeping track of the last configuration. The IP address of the user likely to have executed the change, is obtained from a preceding syslog that indicates a prior login. This rule requires the network devices to forward syslog to the monitoring system. | Startup Config Change: with login | eventType = ""PH_DEV_MON_CHANGE_STARTUP_CONFIG"" |
| Uncommon AWS Console Login | Security | Detects uncommon AWS console logins that have not been seen in the AWSLoginCountry lookup table. By default, the lookup table captures results for 1 day. | Uncommon AWS Console Login | eventType=""AWS-CloudTrail-SIGNIN-ConsoleLogin-Success"" AND LookupTableHas(AWSLoginCountry_3,phCustId,user,srcGeoCountry) = 0 |
| Uncommon Azure Portal Login | Security | Detects uncommon Azure portal logins that have not been seen in the AzurePortalLoginCountry lookup table. By default, the lookup table captures results for 1 day. | Uncommon Azure Portal Login | eventType IN (""MS_OFFICE365_EntraID_UserLoggedIn"",""MS_OFFICE365_UserLoggedIn_Succeeded"",""MS_OFFICE365_EntraID_StsLogon_UserLoggedIn"") AND LookupTableHas(AzurePortalLoginCountry_3,phCustId,user,srcGeoCountry) = 0 |
| Uncommon GSuite Login | Security | Detects uncommon Gsuite logins that have not been seen in the GSuiteLoginCountry lookup table. By default, the lookup table captures results for 1 day. | Uncommon GSuite Login | eventType=""Google_Apps_login_login_success"" AND LookupTableHas(GSuiteLoginCountry_3,phCustId,user,srcGeoCountry) = 0 |
| Uncommon Linux process Created | Security | Detects uncommon Linux process creation that has not been seen in the CommonLinuxProcess lookup table. By default, the lookup table captures results for 1 day. | Uncommon Linux process Created | eventType=""LINUX_PROCESS_EXEC"" AND LookupTableHas(LinuxProcess_0,procName) = 0 |
| Uncommon Linux SSH Login | Security | Detects uncommon server logins that have not been seen in the LinuxSSHLogin lookup table. By default, the lookup table captures results for 1 day. This means that either user never logs in to the host. | Uncommon server logins not seen in LinuxServerLogin lookup table | eventType = ""Generic_Unix_Successful_SSH_Login"" AND LookupTableHas(LinuxSSHLogin_3,phCustId,reptDevName,user) = 0 |
| Uncommon Office365 Mail Login | Security | Detects uncommon Office365 mail logins from users that have not been seen in the O365MailLoginCountry lookup table. By default, the lookup table captures results for 1 day. | Uncommon Office365 Mail Login | eventType=""MS_OFFICE365_UserLoggedIn_Succeeded"" AND LookupTableHas(O365MailLoginCountry_3,phCustId,user,srcGeoCountry) = 0 |
| Uncommon Server Login | Security | Detects uncommon server logins that have not been seen in the ServerLogin lookup table. By default, the lookup table captures results for 1 day. | Uncommon Server Login | eventType = ""Win-Security-4624"" AND winLogonType = 10 AND LookupTableHas(WinRDPLogin_3,phCustId,reptDevName,user) = 0 |
| Uncommon VPN Login | Security | Detects uncommon VPN logins that have not been seen in the VPNLoginCountry lookup table. By default, the lookup table captures results for 1 day. | Uncommon VPN Login | eventType IN (Group@PH_SYS_EVENT_VPNLogonSuccess) AND LookupTableHas(VPNLoginCountry_3,phCustId,user,srcGeoCountry) = 0 |
| Uncommon Windows process Created | Security | Detects uncommon windows process creation that has not been seen in the CommonWindowsProcess lookup table. By default, the lookup table captures results for 1 day. | Uncommon Windows process Created | eventType = ""PH_OSQUERY_WIN_PARENT_CHILD_PROCESS"" AND LookupTableHas(WinProcessOSQuery_0,procName,filePath,parentProcName,hashSHA256) = 0 |
| Uncommon Windows process via Sysmon | Security | Detects uncommon windows process creation that has not been seen in the WinProcessSysmon lookup table. By default, the lookup table captures results for 1 day. | Uncommon windows process creation seen in WinProcessSysmon lookup table | eventType=""Win-Sysmon-1-Create-Process"" AND LookupTableHas(WinProcessSysmon_0,procName,filePath,parentProcName,hashSHA256) = 0 |
| Uncommon Windows Service | Security | Detects uncommon Windows Service that have not been seen in the WinService_0 lookup table. By default, the lookup table captures results for 1 day. This means that either no windows host is running that service on the specified path. | Uncommon Windows Service not seen in WinService_0 lookup table | eventType = ""PH_OSQUERY_WIN_SERVICES"" AND totalNum >= 1 AND LookupTableHas(WinService_0,serviceName,servicePath) = 0 |
| Unusual ICMP Traffic | Security | Detects unusual ( more than 10 in 3 minutes) ICMP types, namely other than echo request/reply and destination unreachables | Unusual ICMP Traffic | ipProto = 1 AND icmpType NOT IN (0,3,8) AND eventType IN (Group@PH_SYS_EVENT_PermitNetTraffic, Group@PH_SYS_EVENT_NetflowTraffic, Group@PH_SYS_EVENT_BiNetflowTraffic) |
| Windows Audit Policy Changed | Security | Detects that a user changed Windows audit policy | Windows Audit Policy Changed | eventType IN (""Win-Security-4719"",""Win-Security-612"") |
| Windows Logging Service Shutdown | Security | Detects that the windows logging service was shutdown | Windows Logging Service Shutdown | eventType = ""Win-Security-1100"" |
| Windows Process Tampering Detected | Security | Detected manipulating the initial image/process to be something different than the process it was launched with | Windows Process Tampering Detected | eventType = ""Win-Sysmon-25-Process-Tampering"" |
| Windows Process with deleted binaries | Security | Detects a running Windows processes whose binaries have been deleted from disk. This is related to MITRE Technique Indicator Removal (T1070) and Tactic File Deletion (004) | Windows Process with deleted binaries | eventType = ""PH_OSQUERY_WIN_RUNNING_PROC_DELETED"" AND totalNum >= 1 |
| Windows Security Log Cleared | Security | Detects that a user cleared the windows security log | Windows Security Log Cleared | eventType IN (""Win-Security-517"",""Win-Security-1102"") |
| Windows Security Log is Full | Security | Detects that the windows security log buffer is full | Windows Security Log is Full | eventType = ""Win-Security-1104"" |
| Windows: Abuse of Service Permissions to Hide Services Via Set-Service | Security | Detects usage of the ""Set-Service"" powershell cmdlet to configure a new SecurityDescriptor that allows a service to be hidden from other utilities such as ""sc.exe"", ""Get-Service""...etc. (Works only in powershell 7). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_hide_services_via_set_service.yml | Windows: Abuse of Service Permissions to Hide Services Via Set-Service | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\pwsh\.exe"" OR srcFileName=""pwsh.dll"") AND (command REGEXP "".*Set-Service .*"" AND command REGEXP "".*DCLCWPDTSD.*"") AND command REGEXP "".*-SecurityDescriptorSddl .*|.*-sd .*"" |
| Windows: Abusing Findstr for Defense Evasion | Security | Attackers can use findstr to hide their artifacts or search specific strings and evade defense mechanism. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_findstr.yml | Windows: Abusing Findstr for Defense Evasion | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*findstr.*"" OR procName REGEXP "".*findstr\.exe"" OR srcFileName=""FINDSTR.EXE"") AND ((command REGEXP "".* -v .*|.* /v .*"" AND command REGEXP "".* -l .*|.* /l .*"") OR (command REGEXP "".* -s .*|.* /s .*"" AND command REGEXP "".* -i .*|.* /i .*"")) |
| Windows: AD Object WriteDAC Access | Security | Detects WRITE_DAC access to a domain object. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_ad_object_writedac_access.yml | Windows: AD Object WriteDAC Access | eventType=""Win-Security-4662"" AND serverName=""DS"" AND fileAccess=""0x40000"" AND osObjType IN (""19195a5b-6da0-11d0-afd3-00c04fd930c9"",""domainDNS"") |
| Windows: Add SafeBoot Keys Via Reg Utility | Security | Detects execution of ""reg.exe"" commands with the ""add"" or ""copy"" flags on safe boot registry keys. Often used by attacker to allow the ransomware to work in safe mode as some security products do not. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_add_safeboot.yml | Windows: Add SafeBoot Keys Via Reg Utility | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*reg\.exe"" OR srcFileName=""reg.exe"") AND command REGEXP "".*\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot.*"" AND command REGEXP "".* add .*|.* copy .*"" |
| Windows: Admin User Remote Logon | Security | Detect remote login by Administrator user (depending on internal pattern). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/account_management/win_security_admin_rdp_login.yml | Windows: Admin User Remote Logon | eventType=""Win-Security-4624"" AND winLogonType=10 AND authenMethod=""Negotiate"" AND user REGEXP ""Admin.*"" |
| Windows: Always Install Elevated MSI Spawned Cmd And Powershell | Security | Detects Windows Installer service (msiexec.exe) spawning ""cmd"" or ""powershell"". This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_elavated_msi_spawned_shell.yml | Windows: Always Install Elevated MSI Spawned Cmd And Powershell | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe|.*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""Cmd.Exe"",""PowerShell.EXE"",""pwsh.dll"")) AND (parentProcName REGEXP "".*\\Windows\\Installer\\.*"" AND parentProcName REGEXP "".*msi.*"" AND parentProcName REGEXP "".*tmp"") |
| Windows: Always Install Elevated Windows Installer | Security | Detects Windows Installer service (msiexec.exe) trying to install MSI packages with SYSTEM privilege. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_always_install_elevated_windows_installer.yml | Windows: Always Install Elevated Windows Installer | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\Windows\\Installer\\.*"" AND procName REGEXP "".*msi.*"" AND procName REGEXP "".*tmp"") OR (procName REGEXP "".*\\msiexec\.exe"" AND integrityLevel=""System"")) AND user REGEXP "".*AUTHORI.*|.*AUTORI.*"") AND ((parentProcName!=""C:\\Windows\\System32\\services.exe"") AND (command NOT REGEXP "".*\\system32\\msiexec\.exe /V"" AND parentCommand NOT REGEXP "".*\\system32\\msiexec\.exe /V"") AND (parentProcName NOT REGEXP ""C:\\ProgramData\\Sophos\\.*"") AND (parentProcName NOT REGEXP ""C:\\ProgramData\\Avira\\.*"") AND (parentProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Avast Software\\.*|C:\\Program Files\\Avast Software\\.*"") AND (parentProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Google\\Update\\.*|C:\\Program Files\\Google\\Update\\.*"")) |
| Windows: Application Whitelisting Bypass via Bginfo | Security | Execute VBscript code that is referenced within the *.bgi file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_bginfo.yml | Windows: Application Whitelisting Bypass via Bginfo | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\bginfo\.exe"" AND command REGEXP "".*/popup.*"" AND command REGEXP "".*/nolicprompt.*"" |
| Windows: Application Whitelisting Bypass via DLL Loaded by odbcconf.exe | Security | Detects defence evasion attempt via odbcconf.exe execution to load DLL. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_odbcconf_susp_exec.yml | Windows: Application Whitelisting Bypass via DLL Loaded by odbcconf.exe | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\odbcconf\.exe"" OR srcFileName=""odbcconf.exe"") AND command REGEXP "".*-a.*|.*-f.*|.*/a.*|.*/f.*|.*regsvr.*"") OR (parentProcName REGEXP "".*\\odbcconf\.exe"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE""))) |
| Windows: Application Whitelisting Bypass via Dnx.exe | Security | Execute C# code located in the consoleapp folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_dnx.yml | Windows: Application Whitelisting Bypass via Dnx.exe | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\dnx\.exe"" |
| Windows: Arbitrary Command Execution Using WSL | Security | Detects potential abuse of Windows Subsystem for Linux (WSL) binary as a LOLBIN to execute arbitrary linux and windows commands. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wsl_lolbin_execution.yml | Windows: Arbitrary Command Execution Using WSL | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\wsl\.exe"" OR srcFileName=""wsl.exe"") AND command REGEXP "".* --exec.*|.* --shell-type .*|.* --system.*|.* --user root.*|.* -e .*|.* -u root.*|.* /mnt/c.*|.*--debug-shell.*"") AND ((parentProcName NOT REGEXP "".*\\cmd\.exe"" OR command NOT REGEXP "".* -d .*"" OR command NOT REGEXP "".* -e kill .*"")) |
| Windows: Aruba Network Service Potential DLL Sideloading | Security | Detects potential DLL sideloading activity via the Aruba Networks Virtual Intranet Access ""arubanetsvc.exe"" process using DLL Search Order Hijacking. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_aruba_networks_virtual_intranet_access.yml | Windows: Aruba Network Service Potential DLL Sideloading | eventType=""Win-Sysmon-7-Image-Loaded"" AND (procName REGEXP "".*\\arubanetsvc\.exe"" AND loadedProcName REGEXP "".*\\cryptbase\.dll|.*\\cryptsp\.dll|.*\\dbgcore\.dll|.*\\dbghelp\.dll|.*\\dpapi\.dll|.*\\iphlpapi\.dll|.*\\msvcp100\.dll|.*\\msvcr100\.dll|.*\\profapi\.dll|.*\\sspicli\.dll|.*\\version\.dll|.*\\wininet\.dll|.*\\winsta\.dll|.*\\wldp\.dll|.*\\wtsapi32\.dll"") AND (loadedProcName NOT REGEXP ""C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\WinSxS\\.*"") |
| Windows: Audit Policy Tampering Via Auditpol | Security | Threat actors can use auditpol binary to change audit policy configuration to impair detection capability. This can be carried out by selectively disabling/removing certain audit policies as well as restoring a custom policy owned by the threat actor. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_auditpol_susp_execution.yml | Windows: Audit Policy Tampering Via Auditpol | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\auditpol\.exe"" OR srcFileName=""AUDITPOL.EXE"") AND command REGEXP "".*clear.*|.*disable.*|.*remove.*|.*restore.*"" |
| Windows: Audit Policy Tampering Via NT Resource Kit Auditpol | Security | Threat actors can use an older version of the auditpol binary available inside the NT resource kit to change audit policy configuration to impair detection capability. This can be carried out by selectively disabling/removing certain audit policies as well as restoring a custom policy owned by the threat actor. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_auditpol_nt_resource_kit_usage.yml | Windows: Audit Policy Tampering Via NT Resource Kit Auditpol | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*/logon:none.*|.*/object:none.*|.*/policy:none.*|.*/privilege:none.*|.*/process:none.*|.*/sam:none.*|.*/system:none.*"" |
| Windows: Backup Catalog Deleted | Security | Detects backup catalog deletions. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/microsoft_windows_backup/win_susp_backup_delete.yml | Windows: Backup Catalog Deleted | eventType=""Win-App-Microsoft-Windows-Backup-524"" |
| Windows: Bad Opsec Defaults Sacrificial Processes With Improper Arguments | Security | Detects attackers using tooling with bad opsec defaults. E.g. spawning a sacrificial process to inject a capability into the process without taking into account how the process is normally run. One trivial example of this is using rundll32.exe without arguments as a sacrificial process (default in CS, now highlighted by c2lint), running WerFault without arguments (Kraken - credit am0nsec), and other examples. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_bad_opsec_sacrificial_processes.yml | Windows: Bad Opsec Defaults Sacrificial Processes With Improper Arguments | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\WerFault\.exe"" AND command REGEXP "".*WerFault\.exe"") OR (procName REGEXP "".*\\rundll32\.exe"" AND command REGEXP "".*rundll32\.exe"") OR (procName REGEXP "".*\\regsvcs\.exe"" AND command REGEXP "".*regsvcs\.exe"") OR (procName REGEXP "".*\\regasm\.exe"" AND command REGEXP "".*regasm\.exe"") OR (procName REGEXP "".*\\regsvr32\.exe"" AND command REGEXP "".*regsvr32\.exe"")) AND ((parentProcName NOT REGEXP ""C:\\Users\\.*"" OR parentProcName NOT REGEXP "".*\\AppData\\Local\\Microsoft\\EdgeUpdate\\Install\\\{.*"" OR parentProcName NOT REGEXP "".*\\setup\.exe"" OR parentCommand NOT REGEXP "".*\\setup\.exe\"" --install-archive=\""C:\\Users\\.*"")) |
| Windows: BITS Transfer Job Download From Direct IP | Security | Detects a BITS transfer job downloading file(s) from a direct IP address. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/bits_client/win_bits_client_new_transfer_via_ip_address.yml | Windows: BITS Transfer Job Download From Direct IP | (eventType REGEXP ""Win-.*-16403[^\d]*"" AND targetName REGEXP "".*http://1.*|.*http://2.*|.*http://3.*|.*http://4.*|.*http://5.*|.*http://6.*|.*http://7.*|.*http://8.*|.*http://9.*|.*https://1.*|.*https://2.*|.*https://3.*|.*https://4.*|.*https://5.*|.*https://6.*|.*https://7.*|.*https://8.*|.*https://9.*"") AND ((targetName NOT REGEXP "".*://10\..*|.*://127\..*|.*://169\.254\..*|.*://172\.16\..*|.*://172\.17\..*|.*://172\.18\..*|.*://172\.19\..*|.*://172\.20\..*|.*://172\.21\..*|.*://172\.22\..*|.*://172\.23\..*|.*://172\.24\..*|.*://172\.25\..*|.*://172\.26\..*|.*://172\.27\..*|.*://172\.28\..*|.*://172\.29\..*|.*://172\.30\..*|.*://172\.31\..*|.*://192\.168\..*"") AND (targetName NOT REGEXP "".*http://7-.*|.*https://7-.*"")) |
| Windows: BITS Transfer Job Download From File Sharing Domains | Security | Detects BITS transfer job downloading files from a file sharing domain. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/bits_client/win_bits_client_new_transfer_via_file_sharing_domains.yml | Windows: BITS Transfer Job Download From File Sharing Domains | eventType REGEXP ""Win-.*-16403[^\d]*"" AND targetName REGEXP "".*\.ghostbin\.co/.*|.*\.hastebin\.com.*|.*\.paste\.ee.*|.*anonfiles\.com.*|.*cdn\.discordapp\.com/attachments/.*|.*ddns\.net.*|.*gist\.githubusercontent\.com.*|.*mediafire\.com.*|.*mega\.nz.*|.*paste\.ee.*|.*pastebin\.com.*|.*pastebin\.pl.*|.*pastetext\.net.*|.*privatlab\.com.*|.*privatlab\.net.*|.*raw\.githubusercontent\.com.*|.*send\.exploit\.in.*|.*sendspace\.com.*|.*storage\.googleapis\.com.*|.*transfer\.sh.*|.*ufile\.io.*"" |
| Windows: BITS Transfer Job Download To Potential Suspicious Folder | Security | Detects new BITS transfer job where the LocalName/Saved file is stored in a potentially suspicious location. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/bits_client/win_bits_client_new_trasnfer_susp_local_folder.yml | Windows: BITS Transfer Job Download To Potential Suspicious Folder | eventType = ""Win-App-Microsoft-Windows-Bits-Client-16403"" AND filePath REGEXP "".*C:\\PerfLogs\\.*|.*C:\\Users\\Public\\.*|.*\\Desktop\\.*"" |
| Windows: BITS Transfer Job Downloading File Potential Suspicious Extension | Security | Detects new BITS transfer job saving local files with potential suspicious extensions. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/bits_client/win_bits_client_new_transfer_saving_susp_extensions.yml | Windows: BITS Transfer Job Downloading File Potential Suspicious Extension | (eventType REGEXP ""Win-.*-16403[^\d]*"" AND filePath REGEXP "".*\.bat|.*\.dll|.*\.exe|.*\.hta|.*\.ps1|.*\.psd1|.*\.sh|.*\.vbe|.*\.vbs"") AND ((filePath NOT REGEXP "".*\\AppData\\.*"" OR targetName NOT REGEXP "".*\.com.*"")) |
| Windows: BITS Transfer Job With Uncommon Or Suspicious Remote TLD | Security | Detects a suspicious download using the BITS client from a FQDN that is unusual. Adversaries may abuse BITS jobs to persistently execute or clean up after malicious payloads. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/bits_client/win_bits_client_new_transfer_via_uncommon_tld.yml | Windows: BITS Transfer Job With Uncommon Or Suspicious Remote TLD | eventType = ""Win-App-Microsoft-Windows-Bits-Client-16403"" AND ((targetName NOT REGEXP "".*\.azureedge\.net/.*|.*\.com/.*|.*\.sfx\.ms/.*|.*download\.mozilla\.org/.*"")) |
| Windows: Bypass UAC via CMSTP | Security | Detect commandline usage of Microsoft Connection Manager Profile Installer (cmstp.exe) to install specially formatted local .INF files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_cmstp.yml | Windows: Bypass UAC via CMSTP | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmstp\.exe"" OR srcFileName=""CMSTP.EXE"") AND command REGEXP "".*-au.*|.*-ni.*|.*-s.*|.*/au.*|.*/ni.*|.*/s.*"" |
| Windows: Bypass UAC via WSReset.exe | Security | Detects use of WSReset.exe to bypass User Account Control (UAC). Adversaries use this technique to execute privileged processes. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_wsreset.yml | Windows: Bypass UAC via WSReset.exe | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\wsreset\.exe"" AND (procName NOT REGEXP "".*\\conhost\.exe"" AND srcFileName!=""CONHOST.EXE"") |
| Windows: CleanWipe Usage | Security | Detects the use of CleanWipe a tool usually used to delete Symantec antivirus. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_pua_cleanwipe.yml | Windows: CleanWipe Usage | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\SepRemovalToolNative_x64\.exe"" OR (procName REGEXP "".*\\CATClean\.exe"" AND command REGEXP "".*--uninstall.*"") OR (procName REGEXP "".*\\NetInstaller\.exe"" AND command REGEXP "".*-r.*"") OR (procName REGEXP "".*\\WFPUnins\.exe"" AND command REGEXP "".*/uninstall.*"" AND command REGEXP "".*/enterprise.*"")) |
| Windows: CMSTP Execution Process Creation | Security | Detects various indicators of Microsoft Connection Manager Profile Installer execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmstp_execution_by_creation.yml | Windows: CMSTP Execution Process Creation | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\cmstp\.exe"" |
| Windows: CMSTP Execution Registry Event | Security | Detects various indicators of Microsoft Connection Manager Profile Installer execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_cmstp_execution_by_registry.yml | Windows: CMSTP Execution Registry Event | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*\\cmmgr32\.exe.*"" |
| Windows: Cmstp Making Network Connection | Security | Detects suspicious network connection by Cmstp. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_susp_cmstp.yml | Windows: Cmstp Making Network Connection | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND procName REGEXP "".*\\cmstp\.exe"" AND initiated=""true"" |
| Windows: CMSTP UAC Bypass via COM Object Access | Security | Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects (e.g. UACMe ID of 41, 43, 58 or 65). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_cmstp_com_object_access.yml | Windows: CMSTP UAC Bypass via COM Object Access | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\DllHost\.exe"" AND parentCommand REGEXP "".* /Processid:\{3E000D72-A845-4CD9-BD83-80C07C3B881F\}.*|.* /Processid:\{3E5FC7F9-9A51-4367-9063-A120244FBEC7\}.*|.* /Processid:\{BD54C901-076B-434E-B6C7-17C531F4AB41\}.*|.* /Processid:\{D2E7041B-2927-42FB-8E9F-7CE93B6DC937\}.*|.* /Processid:\{E9495B87-D950-4AB5-87A5-FF6D70BF3E90\}.*"" AND integrityLevel IN (""High"",""System"") |
| Windows: Cobalt Strike Load by Rundll32 | Security | Detects use of Rundll32 by Cobalt Strike with StartW function to load DLLs from the command line. Cobalt Strike (https://www.cobaltstrike.com/) is an adversary simulation tool with a post-exploitation agent and covert channels to emulate a quiet long-term embedded actor in your network. It uses Process injection, a defense evasion technique that runs custom code within the address space of another process, thereby avoiding detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_load_by_rundll32.yml | Windows: Cobalt Strike Load by Rundll32 | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"" OR command REGEXP "".*rundll32 .*|.*rundll32\.exe.*"") AND (command REGEXP "".*\.dll.*"" AND command REGEXP "".* StartW|.*,StartW"") |
| Windows: CobaltStrike BOF Injection Pattern | Security | Detects a typical pattern of a CobaltStrike Beacon Inject File (BOF) which inject into other processes. Cobalt Strike (https://www.cobaltstrike.com/) is an adversary simulation tool with a post-exploitation agent and covert channels to emulate a quiet long-term embedded actor in your network. It uses Process injection, a defense evasion technique that runs custom code within the address space of another process, thereby avoiding detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_cobaltstrike_bof_injection_pattern.yml | Windows: CobaltStrike BOF Injection Pattern | eventType=""Win-Sysmon-10-ProcessAccess"" AND accessKeyId IN (""0x1028"",""0x1fffff"") |
| Windows: Code Execution via Pcwutl.dll | Security | Detects launch of executable by calling the LaunchApplication function from pcwutl.dll library. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_pcwutl.yml | Windows: Code Execution via Pcwutl.dll | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\rundll32\.exe"" OR srcFileName=""RUNDLL32.EXE"") AND (command REGEXP "".*pcwutl.*"" AND command REGEXP "".*LaunchApplication.*"") |
| Windows: Conhost Parent Process Executions | Security | Detects the conhost execution as parent process. Can be used to evaded defense mechanism. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_conhost_susp_child_process.yml | Windows: Conhost Parent Process Executions | eventType=""Win-Sysmon-1-Create-Process"" AND parentProcName REGEXP "".*\\conhost\.exe"" AND ((procName NOT REGEXP "".*\\git\.exe"" OR parentCommand NOT REGEXP "".* cat-file -s .*|.* show --textconv .*"") AND (parentCommand NOT REGEXP "".*C:\\WINDOWS\\system32\\conhost\.exe 0x4.*"" OR command NOT REGEXP "".* cat-file -s .*|.* show --textconv .*"") AND (parentCommand NOT REGEXP "".* cat-file -s .*|.*show --textconv.*"" OR procName!=""C:\\Windows\\System32\\conhost.exe"") AND (parentCommand NOT IN (""\\\?\?\\C:\\WINDOWS\\system32\\conhost.exe 0x4"",""\\\?\?\\C:\\WINDOWS\\system32\\conhost.exe 0xffffffff -ForceV1"") OR procName!=""C:\\Windows\\System32\\conhost.exe"") AND (parentCommand NOT IN (""\\\?\?\\C:\\WINDOWS\\system32\\conhost.exe 0x4'"",""\\\?\?\\C:\\WINDOWS\\system32\\conhost.exe 0xffffffff -ForceV1'"") OR procName!=""C:\\Program Files\\Git\\mingw64\\bin\\git.exe"")) |
| Windows: Control Panel Items | Security | Detects the malicious use of a control panel item. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_control_panel_item.yml | Windows: Control Panel Items | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\reg\.exe"" OR srcFileName=""reg.exe"") AND (command REGEXP "".*add.*"" AND command REGEXP "".*CurrentVersion\\Control Panel\\CPLs.*"")) OR (command REGEXP "".*\.cpl"" AND ((command NOT REGEXP "".*%System%.*|.*\\System32\\.*"") AND (command NOT REGEXP "".*regsvr32 .*"" OR command NOT REGEXP "".* /s .*"" OR command NOT REGEXP "".*igfxCPL\.cpl.*"")))) |
| Windows: Creation of an WerFault.exe in Unusual Folder | Security | Detects WerFault copoed to a suspicious folder, which could be a sign of WerFault DLL hijacking. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_werfault_dll_hijacking.yml | Windows: Creation of an WerFault.exe in Unusual Folder | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\WerFault\.exe|.*\\wer\.dll"" AND (fileName NOT REGEXP "".*\\SysWOW64\\.*|.*\\System32\\.*|.*\\WinSxS\\.*"") |
| Windows: Creation Of Non-Existent System DLL | Security | Detects the creation of system dlls that are not present on the system. Usually to achieve dll hijacking. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_create_non_existent_dlls.yml | Windows: Creation Of Non-Existent System DLL | eventType=""Win-Sysmon-11-FileCreate"" AND (fileName IN (""C:\\Windows\\System32\\TSMSISrv.dll"",""C:\\Windows\\System32\\TSVIPSrv.dll"",""C:\\Windows\\System32\\WLBSCTRL.dll"",""C:\\Windows\\System32\\WptsExtensions.dll"",""C:\\Windows\\System32\\wbem\\wbemcomn.dll"",""C:\\Windows\\System32\\wow64log.dll"") OR fileName REGEXP "".*\\SprintCSP\.dll"") AND (procName NOT REGEXP ""C:\\Windows\\System32\\.*"") |
| Windows: Detect Virtualbox Driver Installation OR Starting Of VMs | Security | Adversaries can carry out malicious operations using a virtual instance to avoid detection. This rule is built to detect the registration of the Virtualbox driver or start of a Virtualbox VM. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_virtualbox_execution.yml | Windows: Detect Virtualbox Driver Installation OR Starting Of VMs | eventType=""Win-Sysmon-1-Create-Process"" AND (command REGEXP "".*VBoxC\.dll.*|.*VBoxDrv\.sys.*|.*VBoxRT\.dll,RTR3Init.*"" OR command REGEXP "".*controlvm.*|.*startvm.*"") |
| Windows: DHCP Server Error Failed Loading the CallOut DLL | Security | This rule detects a DHCP server error in which a specified Callout DLL (in registry) could not be loaded. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/microsoft_windows_dhcp_server/win_system_susp_dhcp_config_failed.yml | Windows: DHCP Server Error Failed Loading the CallOut DLL | eventType IN (""Win-System-Microsoft-Windows-DHCP-Server-1031"",""Win-System-Microsoft-Windows-DHCP-Server-1032"",""Win-System-Microsoft-Windows-DHCP-Server-1034"") |
| Windows: DHCP Server Loaded the CallOut DLL | Security | This rule detects a DHCP server in which a specified Callout DLL (in registry) was loaded. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/microsoft_windows_dhcp_server/win_system_susp_dhcp_config.yml | Windows: DHCP Server Loaded the CallOut DLL | eventType=""Win-System-Microsoft-Windows-DHCP-Server-1033"" |
| Windows: Directory Removal Via Rmdir | Security | Detects execution of the builtin ""rmdir"" command in order to delete directories. Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_rmdir_execution.yml | Windows: Directory Removal Via Rmdir | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe"" OR srcFileName=""Cmd.Exe"") AND command REGEXP "".*rmdir.*"" AND command REGEXP "".*/q.*|.*/s.*"" |
| Windows: Disable of ETW Trace | Security | Detects a command that clears or disables any ETW trace log which could indicate a logging evasion. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_etw_trace_evasion.yml | Windows: Disable of ETW Trace | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*cl.*"" AND command REGEXP "".*/Trace.*"") OR (command REGEXP "".*clear-log.*"" AND command REGEXP "".*/Trace.*"") OR (command REGEXP "".*sl.*"" AND command REGEXP "".*/e:false.*"") OR (command REGEXP "".*set-log.*"" AND command REGEXP "".*/e:false.*"") OR (command REGEXP "".*logman.*"" AND command REGEXP "".*update.*"" AND command REGEXP "".*trace.*"" AND command REGEXP "".*--p.*"" AND command REGEXP "".*-ets.*"") OR command REGEXP "".*Remove-EtwTraceProvider.*"" OR (command REGEXP "".*Set-EtwTraceProvider.*"" AND command REGEXP "".*0x11.*"")) |
| Windows: Disable Security Events Logging Adding Reg Key MiniNt | Security | Detects the addition of a key 'MiniNt' to the registry. Upon a reboot, Windows Event Log service will stopped write events. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_disable_security_events_logging_adding_reg_key_minint.yml | Windows: Disable Security Events Logging Adding Reg Key MiniNt | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND ((regKeyPath=""HKLM\\SYSTEM\\CurrentControlSet\\Control\\MiniNt"" AND osObjAction=""CreateKey"") OR newObjValue=""HKLM\\SYSTEM\\CurrentControlSet\\Control\\MiniNt"") |
| Windows: Disable Windows Defender AV Security Monitoring | Security | Detects attackers attempting to disable Windows Defender using Powershell. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_disable_defender_av_security_monitoring.yml | Windows: Disable Windows Defender AV Security Monitoring | eventType=""Win-Sysmon-1-Create-Process"" AND (((procName REGEXP "".*\\powershell\.exe|.*\\pwsh\.exe"" OR srcFileName IN (""PowerShell.EXE"",""pwsh.dll"")) AND command REGEXP "".*-DisableBehaviorMonitoring \$true.*|.*-DisableRuntimeMonitoring \$true.*"") OR ((procName REGEXP "".*\\sc\.exe"" OR srcFileName=""sc.exe"") AND (command REGEXP "".*WinDefend.*"" AND (command REGEXP "".*stop.*"" OR command REGEXP "".*delete.*"" OR (command REGEXP "".*config.*"" AND command REGEXP "".*start=disabled.*""))))) |
| Windows: Disable Windows IIS HTTP Logging | Security | Disables HTTP logging on a Windows IIS web server as seen by Threat Group 3390 (Bronze Union). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_iis_appcmd_http_logging.yml | Windows: Disable Windows IIS HTTP Logging | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\appcmd\.exe"" OR srcFileName=""appcmd.exe"") AND (command REGEXP "".*set.*"" AND command REGEXP "".*config.*"" AND command REGEXP "".*section:httplogging.*"" AND command REGEXP "".*dontLog:true.*"") |
| Windows: Disabled IE Security Features | Security | Detects command lines that indicate unwanted modifications to registry keys that disable important Internet Explorer security features. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_disable_ie_features.yml | Windows: Disabled IE Security Features | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".* -name IEHarden .*"" AND command REGEXP "".* -value 0 .*"") OR (command REGEXP "".* -name DEPOff .*"" AND command REGEXP "".* -value 1 .*"") OR (command REGEXP "".* -name DisableFirstRunCustomize .*"" AND command REGEXP "".* -value 2 .*"")) |
| Windows: Disabled RestrictedAdminMode For RDS - ProcCreation | Security | Detect activation of DisableRestrictedAdmin to desable RestrictedAdmin mode. RestrictedAdmin mode prevents the transmission of reusable credentials to the remote system to which you connect using Remote Desktop. This prevents your credentials from being harvested during the initial connection process if the remote server has been compromise . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_lsa_disable_restricted_admin.yml | Windows: Disabled RestrictedAdminMode For RDS - ProcCreation | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*\\System\\CurrentControlSet\\Control\\Lsa\\.*"" AND command REGEXP "".*DisableRestrictedAdmin.*"" AND command REGEXP "".* 1.*"" |
| Windows: Disabled Volume Snapshots | Security | Detects commands that temporarily turn off Volume Snapshots. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_volsnap_disable.yml | Windows: Disabled Volume Snapshots | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*reg.*"" AND command REGEXP "".* add .*"" AND command REGEXP "".*\\Services\\VSS\\Diag.*"" AND command REGEXP "".*/d Disabled.*"" |
| Windows: Disabling Windows Event Auditing | Security | Detects scenarios where system auditing (ie: windows event log auditing) is disabled. This may be used in a scenario where an entity would want to bypass local logging to evade detection when windows event logging is enabled and reviewed. Also, it is recommended to turn off ""Local Group Policy Object Processing"" via GPO, which will make sure that Active Directory GPOs take precedence over local/edited computer policies via something such as ""gpedit.msc"". Please note, that disabling ""Local Group Policy Object Processing"" may cause an issue in scenarios of one off specific GPO modifications -- however it is recommended to perform these modifications in Active Directory anyways. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_disable_event_logging.yml | Windows: Disabling Windows Event Auditing | eventType=""Win-Security-4719"" AND actionName REGEXP "".*%%8448.*|.*%%8450.*"" |
| Windows: Dism Remove Online Package | Security | Deployment Image Servicing and Management tool. DISM is used to enumerate, install, uninstall, configure, and update features and packages in Windows images. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dsim_remove.yml | Windows: Dism Remove Online Package | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\DismHost\.exe"" AND parentCommand REGEXP "".*/Online.*"" AND parentCommand REGEXP "".*/Disable-Feature.*"") OR (procName REGEXP "".*\\Dism\.exe"" AND command REGEXP "".*/Online.*"" AND command REGEXP "".*/Disable-Feature.*"")) |
| Windows: DLL Loaded From Suspicious Location Via Cmspt.EXE | Security | Detects cmstp loading ""dll"" or ""ocx"" files from suspicious locations. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_cmstp_load_dll_from_susp_location.yml | Windows: DLL Loaded From Suspicious Location Via Cmspt.EXE | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\cmstp\.exe"" AND loadedProcName REGEXP "".*C:\\Temp\\.*|.*\\PerfLogs\\.*|.*\\ProgramData\\.*|.*\\Users\\.*|.*\\Windows\\Temp\\.*"" AND loadedProcName REGEXP "".*\.dll|.*\.ocx"" |
| Windows: DLL Search Order Hijackig Via Additional Space in Path | Security | Detects when an attacker create a similar folder structure to windows system folders such as (Windows, Program Files...) but with a space in order to trick DLL load search order and perform a ""DLL Search Order Hijacking"" attack . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_dll_sideloading_space_path.yml | Windows: DLL Search Order Hijackig Via Additional Space in Path | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP ""C:\\Program Files \(x86\) \\.*|C:\\Program Files \\.*|C:\\Windows \\.*"" AND fileName REGEXP "".*\.dll"" |
| Windows: DLL Sideloading by Microsoft Defender | Security | Detects execution of Microsoft Defender's CLI process (MpCmdRun.exe) from the non-default directory which may be an attempt to sideload arbitrary DLL. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mpcmdrun_dll_sideload_defender.yml | Windows: DLL Sideloading by Microsoft Defender | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\MpCmdRun\.exe"" AND (procName NOT REGEXP ""C:\\Program Files\\Microsoft Security Client\\MpCmdRun\.exe.*|C:\\Program Files\\Windows Defender\\.*|C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\.*|C:\\Windows\\winsxs\\.*"") |
| Windows: DLL Sideloading by VMware Xfer Utility | Security | Detects execution of VMware Xfer utility (VMwareXferlogs.exe) from the non-default directory which may be an attempt to sideload arbitrary DLL. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dll_sideload_vmware_xfer.yml | Windows: DLL Sideloading by VMware Xfer Utility | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\VMwareXferlogs\.exe"" AND (procName NOT REGEXP ""C:\\Program Files\\VMware\\.*"") |
| Windows: DLL Sideloading Of ShellChromeAPI.DLL | Security | Detects processes loading the non-existent DLL ""ShellChromeAPI"". One known example is the ""DeviceEnroller"" binary in combination with the ""PhoneDeepLink"" flag tries to load this DLL. Adversaries can drop their own renamed DLL and execute it via DeviceEnroller.exe using this parameter . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_shell_chrome_api.yml | Windows: DLL Sideloading Of ShellChromeAPI.DLL | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\ShellChromeAPI\.dll"" |
| Windows: DllUnregisterServer Function Call Via Msiexec.EXE | Security | Detects MsiExec loading a DLL and calling its DllUnregisterServer function. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msiexec_dll.yml | Windows: DllUnregisterServer Function Call Via Msiexec.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\msiexec\.exe"" OR srcFileName=""\\msiexec.exe"") AND command REGEXP "".* -z .*|.* /z .*"" AND command REGEXP "".*\.dll.*"" |
| Windows: Dynamic C Sharp Compile Artefact | Security | When C# is compiled dynamically, a .cmdline file will be created as a part of the process. Certain processes are not typically observed compiling C# code, but can do so without touching disk. This can be used to unpack a payload for execution . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_csharp_compile_artefact.yml | Windows: Dynamic C Sharp Compile Artefact | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\.cmdline"" |
| Windows: Empire PowerShell UAC Bypass | Security | Detects some Empire PowerShell UAC bypass methods. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_empire_powershell_uac_bypass.yml | Windows: Empire PowerShell UAC Bypass | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* -NoP -NonI -c \$x=\$\(\(gp HKCU:Software\\Microsoft\\Windows Update\)\.Update\);.*|.* -NoP -NonI -w Hidden -c \$x=\$\(\(gp HKCU:Software\\Microsoft\\Windows Update\)\.Update\).*"" |
| Windows: Eventlog Cleared | Security | One of the Windows Eventlogs has been cleared. e.g. caused by ""wevtutil cl"" command execution. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/microsoft_windows_eventlog/win_system_eventlog_cleared.yml | Windows: Eventlog Cleared | (eventType=""Win-System-Microsoft-Windows-Eventlog-104"") AND (activityType NOT IN (""Application"",""Security"",""System"")) |
| Windows: EVTX Created In Uncommon Location | Security | Detects the creation of new files with the "".evtx"" extension in non-common locations. Which could indicate tampering with default evtx locations in order to evade security controls. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_create_evtx_non_common_locations.yml | Windows: EVTX Created In Uncommon Location | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\.evtx"" AND ((fileName NOT REGEXP ""C:\\Windows\\System32\\winevt\\Logs\\.*"") AND (fileName NOT REGEXP ""C:\\ProgramData\\Microsoft\\Windows\\Containers\\BaseImages\\.*"" OR fileName NOT REGEXP "".*\\Windows\\System32\\winevt\\Logs\\"") AND (procName NOT IN (""C:\\Windows\\explorer.exe"",""C:\\Windows\\system32\\dllhost.exe""))) |
| Windows: Execute Arbitrary Commands Using MSDT.EXE: V1 | Security | Detects processes leveraging the ""ms-msdt"" handler or the ""msdt.exe"" binary to execute arbitrary commands as seen in the follina (CVE-2022-30190) vulnerability. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msdt_arbitrary_command_execution.yml | Windows: Execute Arbitrary Commands Using MSDT.EXE: V1 | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\msdt\.exe"" OR srcFileName=""msdt.exe"") AND (command REGEXP "".*IT_BrowseForFile=.*"" OR (command REGEXP "".* PCWDiagnostic.*"" AND command REGEXP "".* -af .*|.* /af .*"")) |
| Windows: Execute From Alternate Data Streams | Security | Detects execution from an Alternate Data Stream (ADS). Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_alternate_data_streams.yml | Windows: Execute From Alternate Data Streams | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*txt:.*"" AND ((command REGEXP "".*type .*"" AND command REGEXP "".* > .*"") OR (command REGEXP "".*makecab .*"" AND command REGEXP "".*\.cab.*"") OR (command REGEXP "".*reg .*"" AND command REGEXP "".* export .*"") OR (command REGEXP "".*regedit .*"" AND command REGEXP "".* /E .*"") OR (command REGEXP "".*esentutl .*"" AND command REGEXP "".* /y .*"" AND command REGEXP "".* /d .*"" AND command REGEXP "".* /o .*"")) |
| Windows: Explorer NOUACCHECK Flag | Security | Detects suspicious starts of explorer.exe that use the /NOUACCHECK flag that allows to run all sub processes of that newly started explorer.exe without any UAC checks. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_explorer_nouaccheck.yml | Windows: Explorer NOUACCHECK Flag | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\explorer\.exe"" AND command REGEXP "".*/NOUACCHECK.*"") AND ((parentCommand!=""C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule"" AND parentProcName!=""C:\\Windows\\System32\\svchost.exe"")) |
| Windows: F-Secure C3 Load by Rundll32 | Security | F-Secure C3 produces DLLs with a default exported StartNodeRelay function. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_c3_rundll32_pattern.yml | Windows: F-Secure C3 Load by Rundll32 | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*rundll32\.exe.*"" AND command REGEXP "".*\.dll.*"" AND command REGEXP "".*StartNodeRelay.*"" |
| Windows: Failed Code Integrity Checks | Security | Detects code integrity failures such as missing page hashes or corrupted drivers due unauthorized modification. This could be a sign of tampered binaries. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_codeintegrity_check_failure.yml | Windows: Failed Code Integrity Checks | eventType IN (""Win-Security-5038"",""Win-Security-6281"") |
| Windows: Fax Service DLL Search Order Hijack | Security | The Fax service attempts to load ualapi.dll, which is non-existent. An attacker can then (side)load their own malicious DLL using this service. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_ualapi.yml | Windows: Fax Service DLL Search Order Hijack | eventType=""Win-Sysmon-7-Image-Loaded"" AND (procName REGEXP "".*\\fxssvc\.exe"" AND loadedProcName REGEXP "".*ualapi\.dll"") AND (loadedProcName NOT REGEXP ""C:\\Windows\\WinSxS\\.*"") |
| Windows: File Deletion Via Del | Security | Detects execution of the builtin ""del""/""erase"" commands in order to delete files. Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_del_execution.yml | Windows: File Deletion Via Del | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe"" OR srcFileName=""Cmd.Exe"") AND command REGEXP "".*del .*|.*erase .*"" AND command REGEXP "".* /f.*|.* /q.*|.* /s.*"" |
| Windows: File Download Via Bitsadmin | Security | Detects usage of bitsadmin downloading a file. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bitsadmin_download.yml | Windows: File Download Via Bitsadmin | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\bitsadmin\.exe"" OR srcFileName=""bitsadmin.exe"") AND (command REGEXP "".* /transfer .*"" OR (command REGEXP "".* /addfile .*|.* /create .*"" AND command REGEXP "".*http.*"")) |
| Windows: File Download Via Bitsadmin To A Suspicious Target Folder | Security | Detects usage of bitsadmin downloading a file to a suspicious target folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bitsadmin_download_susp_targetfolder.yml | Windows: File Download Via Bitsadmin To A Suspicious Target Folder | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\bitsadmin\.exe"" OR srcFileName=""bitsadmin.exe"") AND command REGEXP "".* /addfile .*|.* /create .*|.* /transfer .*"" AND command REGEXP "".*%ProgramData%.*|.*%public%.*|.*C:\\Perflogs.*|.*C:\\ProgramData\\.*|.*C:\\Temp.*|.*C:\\Users\\Public\\.*|.*C:\\Windows\\.*|.*\\Desktop\\.*"" |
| Windows: File Download Via Bitsadmin To An Uncommon Target Folder | Security | Detects usage of bitsadmin downloading a file to uncommon target folder. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bitsadmin_download_uncommon_targetfolder.yml | Windows: File Download Via Bitsadmin To An Uncommon Target Folder | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\bitsadmin\.exe"" OR srcFileName=""bitsadmin.exe"") AND command REGEXP "".* /addfile .*|.* /create .*|.* /transfer .*"" AND command REGEXP "".*%AppData%.*|.*%temp%.*|.*%tmp%.*|.*C:\\Windows\\Temp\\.*|.*\\AppData\\Local\\.*"" |
| Windows: File or Folder Permissions Modifications | Security | Detects a file or folder's permissions being modified or tampered with. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_file_permission_modifications.yml | Windows: File or Folder Permissions Modifications | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\cacls\.exe|.*\\icacls\.exe|.*\\net1\.exe|.*\\net\.exe"" AND command REGEXP "".*/grant.*|.*/inheritance:r.*|.*/setowner.*"") OR (procName REGEXP "".*\\attrib\.exe"" AND command REGEXP "".*-r.*"") OR procName REGEXP "".*\\takeown\.exe"") AND ((command NOT REGEXP "".*ICACLS C:\\ProgramData\\dynatrace\\gateway\\config\\connectivity\.history /reset"") AND (command NOT REGEXP "".*ICACLS C:\\ProgramData\\dynatrace\\gateway\\config\\config\.properties /grant :r .*"" OR command NOT REGEXP "".*S-1-5-19:F.*"") AND (command NOT REGEXP "".*\\AppData\\Local\\Programs\\Microsoft VS Code.*"" AND parentProcName NOT REGEXP "".*\\Microsoft VS Code\\Code\.exe"")) |
| Windows: File With Suspicious Extension Downloaded Via Bitsadmin | Security | Detects usage of bitsadmin downloading a file with a suspicious extension. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bitsadmin_download_susp_extensions.yml | Windows: File With Suspicious Extension Downloaded Via Bitsadmin | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\bitsadmin\.exe"" OR srcFileName=""bitsadmin.exe"") AND command REGEXP "".* /addfile .*|.* /create .*|.* /transfer .*"" AND command REGEXP "".*\.asax.*|.*\.ashx.*|.*\.asmx.*|.*\.asp.*|.*\.aspx.*|.*\.bat.*|.*\.cfm.*|.*\.cgi.*|.*\.chm.*|.*\.cmd.*|.*\.dll.*|.*\.gif.*|.*\.jpeg.*|.*\.jpg.*|.*\.jsp.*|.*\.jspx.*|.*\.png.*|.*\.ps1.*|.*\.psm1.*|.*\.rar.*|.*\.scf.*|.*\.sct.*|.*\.txt.*|.*\.vbe.*|.*\.vbs.*|.*\.war.*|.*\.wsf.*|.*\.wsh.*|.*\.zip.*"" |
| Windows: Files With System Process Name In Unsuspected Locations | Security | Detects the creation of an executable with a system process name in folders other than the system ones (System32, SysWOW64...etc). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_creation_system_file.yml | Windows: Files With System Process Name In Unsuspected Locations | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*\\AtBroker\.exe|.*\\LogonUI\.exe|.*\\LsaIso\.exe|.*\\RuntimeBroker\.exe|.*\\SearchFilterHost\.exe|.*\\SearchIndexer\.exe|.*\\SearchProtocolHost\.exe|.*\\SecurityHealthService\.exe|.*\\SecurityHealthSystray\.exe|.*\\ShellAppRuntime\.exe|.*\\SystemSettingsBroker\.exe|.*\\Taskmgr\.exe|.*\\TiWorker\.exe|.*\\WSReset\.exe|.*\\WUDFHost\.exe|.*\\WWAHost\.exe|.*\\WerFaultSecure\.exe|.*\\WerFault\.exe|.*\\WinRTNetMUAHostServer\.exe|.*\\WmiPrvSE\.exe|.*\\audiodg\.exe|.*\\backgroundTaskHost\.exe|.*\\bcdedit\.exe|.*\\bitsadmin\.exe|.*\\cmdl32\.exe|.*\\cmstp\.exe|.*\\conhost\.exe|.*\\csrss\.exe|.*\\dasHost\.exe|.*\\dfrgui\.exe|.*\\dllhost\.exe|.*\\dwm\.exe|.*\\eventcreate\.exe|.*\\eventvwr\.exe|.*\\explorer\.exe|.*\\extrac32\.exe|.*\\fontdrvhost\.exe|.*\\ipconfig\.exe|.*\\iscsicli\.exe|.*\\iscsicpl\.exe|.*\\logman\.exe|.*\\lsass\.exe|.*\\lsm\.exe|.*\\msiexec\.exe|.*\\msinfo32\.exe|.*\\mstsc\.exe|.*\\nbtstat\.exe|.*\\odbcconf\.exe|.*\\powershell\.exe|.*\\pwsh\.exe|.*\\regini\.exe|.*\\regsvr32\.exe|.*\\rundll32\.exe|.*\\schtasks\.exe|.*\\services\.exe|.*\\sihost\.exe|.*\\smartscreen\.exe|.*\\smss\.exe|.*\\spoolsv\.exe|.*\\svchost\.exe|.*\\taskhost\.exe|.*\\taskhostw\.exe|.*\\vssadmin\.exe|.*\\w32tm\.exe|.*\\wermgr\.exe|.*\\wevtutil\.exe|.*\\wininit\.exe|.*\\winlogon\.exe|.*\\winrshost\.exe|.*\\wlanext\.exe|.*\\wlrmdr\.exe|.*\\wslhost\.exe"" AND ((fileName NOT REGEXP ""C:\\Windows\\SoftwareDistribution\\.*|C:\\Windows\\SysWOW64\\.*|C:\\Windows\\System32\\.*|C:\\Windows\\WinSxS\\.*|\\SystemRoot\\System32\\.*"" OR procName NOT REGEXP "".*\\TiWorker\.exe|.*\\Windows\\System32\\dism\.exe"") AND (fileName NOT REGEXP ""C:\\\$WINDOWS\.~BT\\.*"" OR procName!=""C:\\$WINDOWS.~BT\\Sources\\SetupHost.exe"") AND (fileName NOT REGEXP "".*\\RuntimeBroker\.exe"" OR procName!=""C:\\Windows\\system32\\wbengine.exe"") AND (procName NOT REGEXP "".*:\\Windows\\system32\\svchost\.exe"" OR fileName NOT REGEXP ""C:\\Windows\\SoftwareDistribution\\Download\\.*"" OR fileName NOT REGEXP "".*\\bcdedit\.exe|.*\\spoolsv\.exe"") AND (procName NOT REGEXP "".*:\\Windows\\system32\\svchost\.exe"" OR fileName NOT REGEXP ""C:Program Files\\WindowsApps\\.*"") AND (procName!=""C:\\Windows\\System32\\wuauclt.exe"") AND (fileName!=""C:\\Windows\\explorer.exe"") AND (procName!=""C:\\WINDOWS\\system32\\msiexec.exe"" OR fileName!=""C:\\Program Files\\PowerShell\\7\\pwsh.exe"") AND (fileName NOT REGEXP ""C:\\Windows\\System32\\SecurityHealth\\.*"" OR fileName NOT REGEXP "".*\\SecurityHealthSystray\.exe"" OR procName NOT REGEXP "".*\\SecurityHealthSetup\.exe"")) |
| Windows: Filter Driver Unloaded Via Fltmc.EXE | Security | Detect filter driver unloading activity via fltmc.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_fltmc_unload_driver.yml | Windows: Filter Driver Unloaded Via Fltmc.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\fltMC\.exe"" OR srcFileName=""fltMC.exe"") AND command REGEXP "".*unload.*"") AND ((command NOT REGEXP "".*unload rtp_filesystem_filter"")) |
| Windows: Findstr Launching .lnk File | Security | Detects usage of findstr to identify and execute a lnk file as seen within the HHS redirect attack. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_findstr_lnk.yml | Windows: Findstr Launching .lnk File | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\findstr\.exe"" OR srcFileName=""FINDSTR.EXE"") AND command REGEXP "".*\.lnk"" |
| Windows: Firewall Disabled via Netsh.EXE | Security | Detects netsh commands that turns off the Windows firewall. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_fw_disable.yml | Windows: Firewall Disabled via Netsh.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\netsh\.exe"" OR srcFileName=""netsh.exe"") AND (command REGEXP "".*set.*"" AND ((command REGEXP "".*firewall.*"" AND command REGEXP "".*opmode.*"" AND command REGEXP "".*disable.*"") OR (command REGEXP "".*advfirewall.*"" AND command REGEXP "".*state.*"" AND command REGEXP "".*off.*""))) |
| Windows: Firewall Rule Deleted Via Netsh.EXE | Security | Detects the removal of a port or application rule in the Windows Firewall configuration using netsh. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_fw_delete_rule.yml | Windows: Firewall Rule Deleted Via Netsh.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\netsh\.exe"" OR srcFileName=""netsh.exe"") AND (command REGEXP "".*firewall.*"" AND command REGEXP "".*delete .*"")) AND (parentProcName NOT REGEXP "".*\\Dropbox\.exe"" OR command NOT REGEXP "".*name=Dropbox.*"") |
| Windows: FlowCloud Malware | Security | Detects FlowCloud malware from threat group TA410. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_mal_flowcloud.yml | Windows: FlowCloud Malware | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND (regKeyPath IN (""HKLM\\HARDWARE\\{2DB80286-1784-48b5-A751-B6ED1F490303}"",""HKLM\\HARDWARE\\{804423C2-F490-4ac3-BFA5-13DEDE63A71A}"",""HKLM\\HARDWARE\\{A5124AF5-DF23-49bf-B0ED-A18ED3DEA027}"") OR regKeyPath REGEXP ""HKLM\\SYSTEM\\Setup\\PrintResponsor\\.*"") |
| Windows: FromBase64String Command Line | Security | Detects usage of the ""FromBase64String"" function in the commandline which is used to decode a base64 encoded string. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_frombase64string.yml | Windows: FromBase64String Command Line | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*::FromBase64String\(.*"" |
| Windows: Greedy File Deletion Using Del | Security | Detects execution of the ""del"" builtin command to remove files using greedy/wildcard expression. This is often used by malware to delete content of folders that perhaps contains the initial malware infection or to delete evidence. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_del_greedy_deletion.yml | Windows: Greedy File Deletion Using Del | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\cmd\.exe"" OR srcFileName=""Cmd.Exe"") AND command REGEXP "".*del .*|.*erase .*"" AND command REGEXP "".*\\\.*\.dll.*|.*\\\.*\.exe.*"" |
| Windows: HackTool - Covenant PowerShell Launcher | Security | Detects suspicious command lines used in Covenant luanchers. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_covenant.yml | Windows: HackTool - Covenant PowerShell Launcher | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*-Sta.*"" AND command REGEXP "".*-Nop.*"" AND command REGEXP "".*-Window.*"" AND command REGEXP "".*Hidden.*"" AND command REGEXP "".*-Command.*|.*-EncodedCommand.*"") OR command REGEXP "".*-EncodedCommand cwB2ACAAbwAgA.*|.*GruntHTTP.*|.*mshta file\.hta.*|.*sv o \(New-Object IO\.MemorySteam\);sv d .*"") |
| Windows: HackTool - Impersonate Execution | Security | Detects execution of the Impersonate tool. Which can be used to manipulate tokens on a Windows computers remotely (PsExec/WmiExec) or interactively. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_impersonate.yml | Windows: HackTool - Impersonate Execution | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*impersonate\.exe.*"" AND command REGEXP "".* adduser .*|.* exec .*|.* list .*"") OR (hashCode REGEXP "".*IMPHASH=0A358FFC1697B7A07D0E817AC740DF62.*|.*MD5=9520714AB576B0ED01D1513691377D01.*|.*SHA256=E81CC96E2118DC4FBFE5BAD1604E0AC7681960143E2101E1A024D52264BB0A8A.*"" OR hashMD5=""9520714AB576B0ED01D1513691377D01"" OR hashSHA256=""E81CC96E2118DC4FBFE5BAD1604E0AC7681960143E2101E1A024D52264BB0A8A"" OR hashIMP=""0A358FFC1697B7A07D0E817AC740DF62"")) |
| Windows: HackTool - PowerTool Execution | Security | Detects the execution of the tool PowerTool which has the ability to kill a process, delete its process file, unload drivers, and delete the driver files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_powertool.yml | Windows: HackTool - PowerTool Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\PowerTool64\.exe|.*\\PowerTool\.exe"" OR srcFileName=""PowerTool.exe"") |
| Windows: HackTool - PPID Spoofing SelectMyParent Tool Execution | Security | Detects the use of parent process ID spoofing tools like Didier Stevens tool SelectMyParent. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_selectmyparent.yml | Windows: HackTool - PPID Spoofing SelectMyParent Tool Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\SelectMyParent\.exe"" OR command REGEXP "".* -spawnto .*|.*PPID-spoof.*|.*ppid_spoof.*|.*ppidspoof.*|.*spoof-ppid.*|.*spoof_ppid.*|.*spoofedppid.*|.*spoofppid.*"" OR srcFileName REGEXP "".*PPID-spoof.*|.*ppid_spoof.*|.*ppidspoof.*|.*spoof-ppid.*|.*spoof_ppid.*|.*spoofedppid.*|.*spoofppid.*"" OR description=""SelectMyParent"" OR hashIMP IN (""04d974875bd225f00902b4cad9af3fbc"",""89059503d7fbf470e68f7e63313da3ad"",""a782af154c9e743ddf3f3eb2b8f3d16e"",""ca28337632625c8281ab8a130b3d6bad"") OR hashCode REGEXP "".*IMPHASH=04D974875BD225F00902B4CAD9AF3FBC.*|.*IMPHASH=89059503D7FBF470E68F7E63313DA3AD.*|.*IMPHASH=A782AF154C9E743DDF3F3EB2B8F3D16E.*|.*IMPHASH=CA28337632625C8281AB8A130B3D6BAD.*"") |
| Windows: HackTool - RedMimicry Winnti Playbook Execution | Security | Detects actions caused by the RedMimicry Winnti playbook a automated breach emulations utility. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_redmimicry_winnti_playbook.yml | Windows: HackTool - RedMimicry Winnti Playbook Execution | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\cmd\.exe|.*\\rundll32\.exe"" AND command REGEXP "".*\\Windows\\Temp\\tmp\.bat.*|.*gthread-3\.6\.dll.*|.*sigcmm-2\.4\.dll.*"" |
| Windows: HackTool - SharpEvtMute DLL Load | Security | Detects the load of EvtMuteHook.dll, a key component of SharpEvtHook, a tool that tampers with the Windows event logs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_hktl_sharpevtmute.yml | Windows: HackTool - SharpEvtMute DLL Load | eventType=""Win-Sysmon-7-Image-Loaded"" AND (hashCode REGEXP "".*IMPHASH=330768A4F172E10ACB6287B87289D83B.*"" OR hashIMP=""330768a4f172e10acb6287b87289d83b"") |
| Windows: HackTool - SharpEvtMute Execution | Security | Detects the use of SharpEvtHook, a tool that tampers with the Windows event logs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_sharpevtmute.yml | Windows: HackTool - SharpEvtMute Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\SharpEvtMute\.exe"" OR description=""SharpEvtMute"" OR command REGEXP "".*--Encoded --Filter \\\"".*|.*--Filter \""rule .*"") |
| Windows: HackTool - SharpImpersonation Execution | Security | Detects execution of the SharpImpersonation tool. Which can be used to manipulate tokens on a Windows computers remotely (PsExec/WmiExec) or interactively. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_sharp_impersonation.yml | Windows: HackTool - SharpImpersonation Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\SharpImpersonation\.exe"" OR srcFileName=""SharpImpersonation.exe"" OR (command REGEXP "".* user:.*"" AND command REGEXP "".* binary:.*"") OR (command REGEXP "".* user:.*"" AND command REGEXP "".* shellcode:.*"") OR command REGEXP "".* technique:CreateProcessAsUserW.*|.* technique:ImpersonateLoggedOnuser.*"") |
| Windows: HackTool - SharpUp PrivEsc Tool Execution | Security | Detects the use of SharpUp, a tool for local privilege escalation. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_sharpup.yml | Windows: HackTool - SharpUp PrivEsc Tool Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\SharpUp\.exe"" OR description=""SharpUp"" OR command REGEXP "".*CachedGPPPassword.*|.*DomainGPPPassword.*|.*HijackablePaths.*|.*ModifiableScheduledTask.*|.*ModifiableServiceBinaries.*|.*ProcessDLLHijack.*|.*UnquotedServicePath.*"") |
| Windows: HackTool - Stracciatella Execution | Security | Detects Stracciatella which executes a Powershell runspace from within C# (aka SharpPick technique) with AMSI, ETW and Script Block Logging disabled based on PE metadata characteristics. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_stracciatella_execution.yml | Windows: HackTool - Stracciatella Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\Stracciatella\.exe"" OR srcFileName=""Stracciatella.exe"" OR description=""Stracciatella"" OR hashCode REGEXP "".*SHA256=9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956.*|.*SHA256=fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a.*"" OR hashSHA256 IN (""9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956"",""fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a"")) |
| Windows: Hacktool Ruler | Security | This events that are generated when using the hacktool Ruler by Sensepost. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_alert_ruler.yml | Windows: Hacktool Ruler | (eventType=""Win-Security-4776"" AND computer=""RULER"") OR (eventType IN (""Win-Security-4624"",""Win-Security-4625"") AND computer=""RULER"") |
| Windows: HH.EXE Execution | Security | Detects the usage of ""hh.exe"" to execute "".chm"" files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hh_chm_execution.yml | Windows: HH.EXE Execution | eventType=""Win-Sysmon-1-Create-Process"" AND (srcFileName=""HH.exe"" OR procName REGEXP "".*\\hh\.exe"") AND command REGEXP "".*\.chm.*"" |
| Windows: HH.EXE Network Connections | Security | Detects network connections made by the ""hh.exe"" process, which could indicate the execution/download of remotely hosted .chm files. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_hh.yml | Windows: HH.EXE Network Connections | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND procName REGEXP "".*\\hh\.exe"" AND initiated=""true"" AND destIpPort IN (135,443,445,80) |
| Windows: Hiding Files with Attrib.exe | Security | Detects usage of attrib.exe to hide files from users. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_attrib_hiding_files.yml | Windows: Hiding Files with Attrib.exe | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\attrib\.exe"" OR srcFileName=""ATTRIB.EXE"") AND command REGEXP "".* \+h .*"") AND ((command NOT REGEXP "".*\\desktop\.ini .*"") AND (parentProcName NOT REGEXP "".*\\cmd\.exe"" OR command NOT REGEXP ""\+R \+H \+S \+A \\\.*\.cui"" OR parentCommand NOT REGEXP ""C:\\WINDOWS\\system32\\\.*\.bat"")) |
| Windows: High Integrity Sdclt Process | Security | A General detection for sdclt being spawned as an elevated process. This could be an indicator of sdclt being used for bypass UAC techniques. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_sdclt.yml | Windows: High Integrity Sdclt Process | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*sdclt\.exe"" AND integrityLevel=""High"" |
| Windows: Imports Registry Key From a File | Security | Detects the import of the specified file to the registry with regedit.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regedit_import_keys.yml | Windows: Imports Registry Key From a File | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\regedit\.exe"" OR srcFileName=""REGEDIT.EXE"") AND command REGEXP "".* /i .*|.* /s .*|.*\.reg.*"") AND ((command NOT REGEXP "".* -a .*|.* -c .*|.* -e .*|.* /a .*|.* /c .*|.* /e .*"") OR (command NOT REGEXP "":[^ \\\\]"")) |
| Windows: Imports Registry Key From an ADS | Security | Detects the import of a alternate datastream to the registry with regedit.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regedit_import_keys_ads.yml | Windows: Imports Registry Key From an ADS | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\regedit\.exe"" OR srcFileName=""REGEDIT.EXE"") AND (command REGEXP "".* /i .*|.*\.reg.*"")) AND (command NOT REGEXP "".* -a .*|.* -c .*|.* -e .*|.* /a .*|.* /c .*|.* /e .*"") |
| Windows: Launch-VsDevShell.PS1 Proxy Execution | Security | Detects the use of the 'Launch-VsDevShell.ps1' Microsoft signed script to execute commands. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_launch_vsdevshell.yml | Windows: Launch-VsDevShell.PS1 Proxy Execution | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*Launch-VsDevShell\.ps1.*"" AND command REGEXP "".*VsInstallationPath .*|.*VsWherePath .*"" |
| Windows: Load Undocumented Autoelevated COM Interface | Security | COM interface (EditionUpgradeManager) that is not used by standard executables. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_load_undocumented_autoelevated_com_interface.yml | Windows: Load Undocumented Autoelevated COM Interface | eventType=""Win-Sysmon-10-ProcessAccess"" AND procPath REGEXP "".*editionupgrademanagerobj\.dll.*"" |
| Windows: LOLBIN Execution Of The FTP.EXE Binary | Security | Detects execution of ftp.exe script execution with the ""-s"" flag and any child processes ran by ftp.exe. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_ftp.yml | Windows: LOLBIN Execution Of The FTP.EXE Binary | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName REGEXP "".*\\ftp\.exe"" OR ((procName REGEXP "".*\\ftp\.exe"" OR srcFileName=""ftp.exe"") AND command REGEXP "".*-s:.*"")) |
| Windows: Lolbin Ssh.exe Use As Proxy | Security | Detect usage of the ""ssh.exe"" binary as a proxy to launch other programs. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_ssh.yml | Windows: Lolbin Ssh.exe Use As Proxy | eventType=""Win-Sysmon-1-Create-Process"" AND (parentProcName=""C:\\Windows\\System32\\OpenSSH\\sshd.exe"" OR (procName REGEXP "".*\\ssh\.exe"" AND (command REGEXP "".*ProxyCommand=.*"" OR (command REGEXP "".*PermitLocalCommand.*"" AND command REGEXP "".*LocalCommand.*"")))) |
| Windows: Malicious DLL File Dropped in the Teams or OneDrive Folder | Security | Detects creation of a malicious DLL file in the location where the OneDrive or Team applications Upon execution of the Teams or OneDrive application, the dropped malicious DLL file iphlpapi.dll is sideloaded . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_iphlpapi_dll_sideloading.yml | Windows: Malicious DLL File Dropped in the Teams or OneDrive Folder | eventType=""Win-Sysmon-11-FileCreate"" AND fileName REGEXP "".*iphlpapi\.dll.*"" AND fileName REGEXP "".*\\AppData\\Local\\Microsoft.*"" |
| Windows: Mavinject Inject DLL Into Running Process | Security | Detects process injection using the signed Windows tool ""Mavinject"" via the ""INJECTRUNNING"" flag. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_mavinject_process_injection.yml | Windows: Mavinject Inject DLL Into Running Process | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* /INJECTRUNNING .*"" AND (parentProcName!=""C:\\Windows\\System32\\AppVClient.exe"") |
| Windows: Meterpreter or Cobalt Strike Getsystem Service Installation - System | Security | Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service installation. Cobalt Strike (https://www.cobaltstrike.com/) is an adversary simulation tool with a post-exploitation agent and covert channels to emulate a quiet long-term embedded actor in your network. It uses Process injection, a defense evasion technique that runs custom code within the address space of another process, thereby avoiding detection. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/service_control_manager/win_system_meterpreter_or_cobaltstrike_getsystem_service_installation.yml | Windows: Meterpreter or Cobalt Strike Getsystem Service Installation - System | (eventType=""Win-System-Service-Control-Manager-7045"") AND ((serviceFileName REGEXP "".*cmd.*"" AND serviceFileName REGEXP "".*/c.*"" AND serviceFileName REGEXP "".*echo.*"" AND serviceFileName REGEXP "".*\\pipe\\.*"") OR (serviceFileName REGEXP "".*%COMSPEC%.*"" AND serviceFileName REGEXP "".*/c.*"" AND serviceFileName REGEXP "".*echo.*"" AND serviceFileName REGEXP "".*\\pipe\\.*"") OR (serviceFileName REGEXP "".*cmd\.exe.*"" AND serviceFileName REGEXP "".*/c.*"" AND serviceFileName REGEXP "".*echo.*"" AND serviceFileName REGEXP "".*\\pipe\\.*"") OR (serviceFileName REGEXP "".*rundll32.*"" AND serviceFileName REGEXP "".*\.dll,a.*"" AND serviceFileName REGEXP "".*/p:.*"") OR serviceFileName REGEXP ""\\\\127\.0\.0\.1\\ADMIN\$\\.*"") |
| Windows: Meterpreter or Cobalt Strike Service Installation: Security Log | Security | Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service installation. Cobalt Strike (https://www.cobaltstrike.com/) is an adversary simulation tool with a post-exploitation agent and covert channels to emulate a quiet long-term embedded actor in your network. It uses Process injection, a defense evasion technique that runs custom code within the address space of another process, thereby avoiding detection. . Meterpreter is a Metasploit attack payload that provides an interactive shell to the attacker from which to explore the target machine and execute code. Meterpreter is deployed using in-memory DLL injection. As a result, Meterpreter resides entirely in memory and writes nothing to disk. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_meterpreter_or_cobaltstrike_getsystem_service_install.yml | Windows: Meterpreter or Cobalt Strike Service Installation: Security Log | eventType=""Win-Security-4697"" AND ((serviceFileName REGEXP "".*cmd.*"" AND serviceFileName REGEXP "".*/c.*"" AND serviceFileName REGEXP "".*echo.*"" AND serviceFileName REGEXP "".*\\pipe\\.*"") OR (serviceFileName REGEXP "".*%COMSPEC%.*"" AND serviceFileName REGEXP "".*/c.*"" AND serviceFileName REGEXP "".*echo.*"" AND serviceFileName REGEXP "".*\\pipe\\.*"") OR (serviceFileName REGEXP "".*cmd\.exe.*"" AND serviceFileName REGEXP "".*/c.*"" AND serviceFileName REGEXP "".*echo.*"" AND serviceFileName REGEXP "".*\\pipe\\.*"") OR (serviceFileName REGEXP "".*rundll32.*"" AND serviceFileName REGEXP "".*\.dll,a.*"" AND serviceFileName REGEXP "".*/p:.*"")) |
| Windows: Microsoft Defender Blocked from Loading Unsigned DLL | Security | Detects Code Integrity (CI) engine blocking Microsoft Defender's processes (MpCmdRun and NisSrv) from loading unsigned DLLs which may be an attempt to sideload arbitrary DLL. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security_mitigations/win_security_mitigations_defender_load_unsigned_dll.yml | Windows: Microsoft Defender Blocked from Loading Unsigned DLL | eventType IN (""Win-Security-Mitigation-11"", ""Win-Security-Mitigation-12"") AND procPath REGEXP "".*\MpCmdRun\.exe|.*\NisSrv\.exe"" |
| Windows: Microsoft Defender Loading DLL from Nondefault Path | Security | Detects loading of Microsoft Defender's DLLs by its processes (MpCmdRun and NisSrv) from the non-default directory which may be an attempt to sideload arbitrary DLL. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_windows_defender.yml | Windows: Microsoft Defender Loading DLL from Nondefault Path | eventType=""Win-Sysmon-7-Image-Loaded"" AND (procName REGEXP "".*\\MpCmdRun\.exe|.*\\NisSrv\.exe"" AND loadedProcName REGEXP "".*\\mpclient\.dll"") AND (loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Windows Defender\\.*|C:\\Program Files\\Windows Defender\\.*|C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\.*"") |
| Windows: Microsoft Malware Protection Engine Crash | Security | This rule detects a suspicious crash of the Microsoft Malware Protection Engine. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/application_error/win_application_msmpeng_crash_error.yml | Windows: Microsoft Malware Protection Engine Crash | eventType=""Win-App-Application-Error-1000"" AND lineContent REGEXP "".*MsMpEng\.exe.*"" AND lineContent REGEXP "".*mpengine\.dll.*"" |
| Windows: Microsoft Malware Protection Engine Crash - WER | Security | This rule detects a suspicious crash of the Microsoft Malware Protection Engine. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/windows_error_reporting/win_application_msmpeng_crash_wer.yml | Windows: Microsoft Malware Protection Engine Crash - WER | eventType=""Win-App-Windows-Error-Reporting-1001"" AND lineContent REGEXP "".*MsMpEng\.exe.*"" AND lineContent REGEXP "".*mpengine\.dll.*"" |
| Windows: Microsoft Office DLL Sideload | Security | Detects DLL sideloading of DLLs that are part of Microsoft Office from non standard location. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_side_load_office_dlls.yml | Windows: Microsoft Office DLL Sideload | eventType=""Win-Sysmon-7-Image-Loaded"" AND loadedProcName REGEXP "".*\\outllib\.dll"" AND (loadedProcName NOT REGEXP ""C:\\Program Files \(x86\)\\Microsoft Office\\OFFICE.*|C:\\Program Files \(x86\)\\Microsoft Office\\Root\\OFFICE.*|C:\\Program Files\\Microsoft Office\\OFFICE.*|C:\\Program Files\\Microsoft Office\\Root\\OFFICE.*"") |
| Windows: Modify Group Policy Settings | Security | Detect malicious GPO modifications can be used to implement many other malicious behaviors. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_modify_group_policy_settings.yml | Windows: Modify Group Policy Settings | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\reg\.exe"" OR srcFileName=""reg.exe"") AND command REGEXP "".*\\SOFTWARE\\Policies\\Microsoft\\Windows\\System.*"" AND command REGEXP "".*EnableSmartScreen.*|.*GroupPolicyRefreshTime.*|.*GroupPolicyRefreshTimeDC.*|.*GroupPolicyRefreshTimeOffset.*|.*GroupPolicyRefreshTimeOffsetDC.*|.*ShellSmartScreenLevel.*"" |
| Windows: Monitoring For Persistence Via BITS | Security | BITS will allow you to schedule a command to execute after a successful download to notify you that the job is finished. When the job runs on the system the command specified in the BITS job will be executed. This can be abused by actors to create a backdoor within the system and for persistence. It will be chained in a BITS job to schedule the download of malware/additional binaries and execute the program after being downloaded. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bitsadmin_potential_persistence.yml | Windows: Monitoring For Persistence Via BITS | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".*bitsadmin.*"" AND ((command REGEXP "".*/SetNotifyCmdLine.*"" AND command REGEXP "".*%COMSPEC%.*|.*cmd\.exe.*|.*regsvr32\.exe.*"") OR (command REGEXP "".*/Addfile.*"" AND command REGEXP "".*ftp:.*|.*ftps:.*|.*http:.*|.*https:.*"")) |
| Windows: MSDT.exe Loading Diagnostic Library | Security | Detects both of CVE-2022-30190 (Follina) and DogWalk vulnerabilities exploiting msdt.exe binary to load the ""sdiageng.dll"" library. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_dll_sdiageng_load_by_msdt.yml | Windows: MSDT.exe Loading Diagnostic Library | eventType=""Win-Sysmon-7-Image-Loaded"" AND procName REGEXP "".*\\msdt\.exe"" AND loadedProcName REGEXP "".*\\sdiageng\.dll"" |
| Windows: MSHTA Suspicious Execution 01 | Security | Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mshta_susp_execution.yml | Windows: MSHTA Suspicious Execution 01 | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\mshta\.exe"" AND command REGEXP "".*\.dll.*|.*\.doc.*|.*\.jpg.*|.*\.lnk.*|.*\.png.*|.*\.xls.*|.*\.zip.*|.*vbscript.*"" |
| Windows: MSI Installation From Web | Security | Detects installation of a remote msi file from web. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/msiinstaller/win_msi_install_from_web.yml | Windows: MSI Installation From Web | eventType IN (""Win-App-MsiInstaller-1040"",""Win-App-MsiInstaller-1042"") AND lineContent REGEXP "".*://.*"" |
| Windows: Msiexec Initiated Connection | Security | Adversaries may abuse msiexec.exe to proxy execution of malicious payloads. Msiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_msiexec.yml | Windows: Msiexec Initiated Connection | eventType REGEXP ""Win-Sysmon-3-Network-Connect.*"" AND initiated=""true"" AND procName REGEXP "".*\\msiexec\.exe"" |
| Windows: Msiexec Quiet Installation | Security | Adversaries may abuse msiexec.exe to proxy execution of malicious payloads. Msiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi) . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msiexec_install_quiet.yml | Windows: Msiexec Quiet Installation | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\msiexec\.exe"" OR srcFileName=""msiexec.exe"") AND command REGEXP "".*-a.*|.*-i.*|.*-j.*|.*-package.*|.*/a.*|.*/i.*|.*/j.*|.*/package.*"" AND command REGEXP "".*-q.*|.*/q.*"") AND ((parentProcName NOT REGEXP ""C:\\Users\\.*"" OR parentProcName NOT REGEXP "".*\\AppData\\Local\\Temp\\.*"") AND (parentProcName NOT REGEXP ""C:\\Windows\\Temp\\.*"") AND (parentProcName!=""C:\\Windows\\CCM\\Ccm32BitLauncher.exe"" OR integrityLevel!=""System"")) |
| Windows: MsiExec Web Install | Security | Detects suspicious msiexec process starts with web addresses as parameter. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msiexec_web_install.yml | Windows: MsiExec Web Install | eventType=""Win-Sysmon-1-Create-Process"" AND command REGEXP "".* msiexec.*"" AND command REGEXP "".*://.*"" |
| Windows: NetNTLM Downgrade Attack | Security | Detects NetNTLM downgrade attack. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_net_ntlm_downgrade.yml | Windows: NetNTLM Downgrade Attack | eventType=""Win-Security-4657"" AND osObjName REGEXP "".*\\REGISTRY\\MACHINE\\SYSTEM.*"" AND osObjName REGEXP "".*ControlSet.*"" AND osObjName REGEXP "".*\\Control\\Lsa.*"" AND osObjValue IN (""LmCompatibilityLevel"",""NtlmMinClientSec"",""RestrictSendingNTLMTraffic"") |
| Windows: NetNTLM Downgrade Attack - Registry | Security | Detects NetNTLM downgrade attack. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_net_ntlm_downgrade.yml | Windows: NetNTLM Downgrade Attack - Registry | eventType REGEXP ""Win-Sysmon-12-Registry-.*|Win-Sysmon-13-Registry-.*|Win-Sysmon-14-Registry-.*"" AND regKeyPath REGEXP "".*SYSTEM\\.*"" AND regKeyPath REGEXP "".*ControlSet.*"" AND regKeyPath REGEXP "".*\\Control\\Lsa.*"" AND regKeyPath REGEXP "".*\\NtlmMinClientSec|.*\\RestrictSendingNTLMTraffic|.*\\lmcompatibilitylevel"" |
| Windows: Netsh Allow Group Policy on Microsoft Defender Firewall | Security | Adversaries may modify system firewalls in order to bypass controls limiting network usage. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_fw_enable_group_rule.yml | Windows: Netsh Allow Group Policy on Microsoft Defender Firewall | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\netsh\.exe"" OR srcFileName=""netsh.exe"") AND (command REGEXP "".*advfirewall.*"" AND command REGEXP "".*firewall.*"" AND command REGEXP "".*set.*"" AND command REGEXP "".*rule.*"" AND command REGEXP "".*group=.*"" AND command REGEXP "".*new.*"" AND command REGEXP "".*enable=Yes.*"") |
| Windows: New DNS ServerLevelPluginDll Installed Via Dnscmd.EXE | Security | Detects the installation of a DNS plugin DLL via ServerLevelPluginDll parameter in registry, which can be used to execute code in context of the DNS server (restart required). This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dnscmd_install_new_server_level_plugin_dll.yml | Windows: New DNS ServerLevelPluginDll Installed Via Dnscmd.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND procName REGEXP "".*\\dnscmd\.exe"" AND command REGEXP "".*/config.*"" AND command REGEXP "".*/serverlevelplugindll.*"" |
| Windows: New Firewall Rule Added Via Netsh.EXE | Security | Detects the addition of a new rule to the Windows firewall via netsh. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_fw_add_rule.yml | Windows: New Firewall Rule Added Via Netsh.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND ((procName REGEXP "".*\\netsh\.exe"" OR srcFileName=""netsh.exe"") AND (command REGEXP "".* firewall .*"" AND command REGEXP "".* add .*"")) AND ((command NOT REGEXP "".*\\netsh\.exe advfirewall firewall add rule name=Dropbox dir=in action=allow \""program=C:\\Program Files \(x86\)\\Dropbox\\Client\\Dropbox\.exe\"" enable=yes profile=Any.*|.*\\netsh\.exe advfirewall firewall add rule name=Dropbox dir=in action=allow \""program=C:\\Program Files\\Dropbox\\Client\\Dropbox\.exe\"" enable=yes profile=Any.*"") AND (parentProcName NOT REGEXP ""C:\\Windows\\Temp\\asgard2-agent\\.*"" OR parentProcName NOT REGEXP "".*\\thor64\.exe"" OR command NOT REGEXP "".*advfirewall firewall show rule name=all.*"")) |
| Windows: New Root Certificate Installed Via CertMgr.EXE | Security | Detects execution of ""certmgr"" with the ""add"" flag in order to install a new certificate on the system. Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_certmgr_certificate_installation.yml | Windows: New Root Certificate Installed Via CertMgr.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\CertMgr\.exe"" OR srcFileName=""CERTMGT.EXE"") AND (command REGEXP "".*/add.*"" AND command REGEXP "".*root.*"") |
| Windows: New Root Certificate Installed Via Certutil.EXE | Security | Detects execution of ""certutil"" with the ""addstore"" flag in order to install a new certificate on the system. Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers. . This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_certutil_certificate_installation.yml | Windows: New Root Certificate Installed Via Certutil.EXE | eventType=""Win-Sysmon-1-Create-Process"" AND (procName REGEXP "".*\\certutil\.exe"" OR srcFileName=""CertUtil.exe"") AND command REGEXP "".*-addstore.*|.*/addstore.*"" AND command REGEXP "".*root.*"" |
| Windows: Non-privileged Usage of Reg or Powershell | Security | Search for usage of reg or Powershell by non-privileged users to modify service configuration in registry. This rule is adapted from https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_non_priv_reg_or_ps.yml | Windows: Non-privileged Usage of Reg or Powershell | eventType=""Win-Sysmon-1-Create-Process"" AND ((command REGEXP "".*reg .*"" AND command REGEXP "".*add.*"") OR command REGEXP "".* sp .*|.*new-itemproperty.*|.*powershell.*|.*set-itemproperty.*"") AND (integrityLevel=""Medium"" AND command REGEXP "".*ControlSet.*"" AND command REGEXP "".*Services.*"" AND command REGEXP "".*FailureCommand.*|.*ImagePath.*|.*ServiceDLL.*"") |


### ConclusÃ£o

Os casos de uso do SIEM sÃ£o fundamentais para qualquer estratÃ©gia de seguranÃ§a cibernÃ©tica. Com a capacidade de detectar, investigar e responder a ameaÃ§as em tempo real, o SIEM torna-se uma peÃ§a central na defesa proativa da organizaÃ§Ã£o, garantindo a integridade, confidencialidade e disponibilidade dos dados.
