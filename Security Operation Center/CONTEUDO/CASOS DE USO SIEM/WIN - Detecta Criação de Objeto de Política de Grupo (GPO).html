<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detecta Cria√ß√£o de Objeto de Pol√≠tica de Grupo (GPO)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f9f9f9;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        h2 {
            font-size: 1.5em;
            margin-top: 20px;
        }
        h3 {
            font-size: 1.2em;
            margin-top: 15px;
        }
        p, ul, code {
            margin-bottom: 15px;
        }
        ul {
            list-style-type: disc;
            margin-left: 20px;
        }
        code {
            background-color: #ecf0f1;
            padding: 5px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        pre {
            background-color: #ecf0f1;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.9em;
            overflow-x: auto;
        }
        .highlight {
            color: #e74c3c;
            font-weight: bold;
        }
        .remediation {
            background-color: #fdfefe;
            border-left: 5px solid #3498db;
            padding: 10px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>WIN - Detecta Cria√ß√£o de Objeto de Pol√≠tica de Grupo (GPO)</h1>

    <h2>:dart: Descri√ß√£o da Regra</h2>
    <p>
        A regra <strong>"Detecta Cria√ß√£o de Objeto de Pol√≠tica de Grupo"</strong> foi projetada para identificar a cria√ß√£o de novos Objetos de Pol√≠tica de Grupo (GPO) no 
        <strong>Active Directory</strong>. A cria√ß√£o de GPOs pode ser um indicador de atividade administrativa ou maliciosa, e a detec√ß√£o precoce pode ajudar na investiga√ß√£o de configura√ß√µes inesperadas ou comprometidas.
    </p>

    <h2>:dart: Como a Regra Funciona</h2>

    <h3>Filtro de Condi√ß√£o</h3>
    <p>A regra utiliza os seguintes eventos para identificar a cria√ß√£o de GPOs:</p>
    <ul>
        <li><strong>eventType = "Win-Security-4732"</strong>: Este evento √© gerado quando um novo GPO √© criado ou modificado.</li>
        <li><strong>eventType = "Win-Security-4739" AND winGPOOperation CONTAIN "Create"</strong>: Esse evento ocorre quando a opera√ß√£o de cria√ß√£o de GPO √© realizada com sucesso.</li>
    </ul>

    <h2>üåê Fluxo de Detec√ß√£o de Cria√ß√£o de GPO</h2>
    <pre>
-------------------------------
|       M√°quina Cliente        |
|  (Criando ou Modificando GPO)|
-------------------------------
            |
            v
-------------------------------
|       M√°quina Alvo (AD)      |
| (Gera√ß√£o de Eventos de Log)  |
-------------------------------
            |
            v
-------------------------------
|    Wazuh (SIEM)              |
| (An√°lise e Alertas)          |
-------------------------------
    </pre>

    <h3>Poss√≠veis Falsos Positivos</h3>
    <p>A cria√ß√£o de GPOs pode ocorrer por v√°rias raz√µes administrativas leg√≠timas, incluindo:</p>
    <ul>
        <li><strong>Altera√ß√µes normais de configura√ß√£o de GPO</strong> realizadas pelos administradores de sistema.</li>
        <li><strong>Atualiza√ß√µes de pol√≠ticas de seguran√ßa</strong> aplicadas a novos dispositivos ou grupos de usu√°rios.</li>
    </ul>

    <h2>:dart: Criando a Regra no Wazuh</h2>
    <p>A regra para detectar a cria√ß√£o de GPOs pode ser configurada no <strong>Wazuh</strong> da seguinte maneira:</p>
    <pre>
<group name="windows,">
  <rule id="100010" level="7">
    <decoded_as>json</decoded_as>
    <field name="eventType">Win-Security-4732</field>
  </rule>
  <rule id="100011" level="7">
    <decoded_as>json</decoded_as>
    <field name="eventType">Win-Security-4739</field>
    <field name="winGPOOperation">Create</field>
  </rule>
</group>
    </pre>

    <h2>:dart: Remedia√ß√£o em Caso de Crises</h2>
    <p>Quando a cria√ß√£o de um <strong>GPO inesperado</strong> √© detectada, √© essencial agir rapidamente para entender a origem e a inten√ß√£o da cria√ß√£o. As a√ß√µes imediatas recomendadas incluem:</p>

    <div class="remediation">
        <h3>1. üîç Revisar o GPO Criado</h3>
        <p>
            Verifique quem foi o respons√°vel pela cria√ß√£o do GPO e qual a finalidade da pol√≠tica configurada. Isso pode ser feito no Console de Gerenciamento de Pol√≠tica de Grupo (GPMC). Para revisar o GPO no PowerShell, use o comando:
        </p>
        <pre>Get-GPO -Name "nome_do_GPO"</pre>
    </div>

    <div class="remediation">
        <h3>2. üìú Auditar os Logs de Seguran√ßa</h3>
        <p>
            Verifique os logs de eventos de seguran√ßa do Active Directory para entender as circunst√¢ncias em torno da cria√ß√£o do GPO e identificar quem fez a altera√ß√£o. Para revisar os eventos no PowerShell, use:
        </p>
        <pre>Get-WinEvent -LogName Security -ComputerName "endere√ßo_do_AD" | Where-Object {$_.Id -eq 4732}</pre>
        <p>Ou, para filtrar eventos relacionados a um GPO espec√≠fico:</p>
        <pre>Get-WinEvent -LogName Security -ComputerName "endere√ßo_do_AD" | Where-Object {$_.Message -like "*nome_do_GPO*"}</pre>
    </div>
</body>
</html>
