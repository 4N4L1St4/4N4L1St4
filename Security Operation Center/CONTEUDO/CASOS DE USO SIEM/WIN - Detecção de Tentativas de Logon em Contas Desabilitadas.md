
# WIN - Detec√ß√£o de Tentativas de Logon em Contas Desabilitadas

## :dart: Descri√ß√£o da Regra

A regra **"Tentativas de Logon em Contas Desabilitadas"** foi projetada para identificar tentativas de autentica√ß√£o em contas desabilitadas no **Active Directory**. Quando um usu√°rio ou sistema tenta fazer login em uma conta desativada, o **SIEM** gera um alerta, permitindo que a equipe de seguran√ßa investigue a atividade.

## :dart: Como a Regra Funciona

### Filtro de Condi√ß√£o

A regra utiliza os seguintes eventos para identificar tentativas de logon falhas em contas desabilitadas:

- **`eventType = "Win-Security-531"`**: Este evento √© gerado quando uma tentativa de logon √© feita em uma conta desabilitada.
  
- **`eventType = "Win-Security-4625" AND winLogonFailCode2 CONTAIN "0xC0000072"`**: Esse evento ocorre quando uma tentativa de logon em uma conta desabilitada falha, identificado pelo c√≥digo de erro `0xC0000072`.

### Tipo de Evento

O tipo de evento √© uma tentativa de logon falha, que pode ocorrer por v√°rios motivos, incluindo:

- **Senha incorreta**
- **Conta desabilitada**

## :dart: Criando a Regra no Wazuh

A regra para detectar tentativas de logon em contas desabilitadas pode ser configurada no **Wazuh** da seguinte maneira:

```bash
<group name="windows,">
  <rule id="100000" level="7">
    <decoded_as>json</decoded_as>
    <field name="eventType">Win-Security-531</field>
  </rule>
  <rule id="100001" level="7">
    <decoded_as>json</decoded_as>
    <field name="eventType">Win-Security-4625</field>
    <field name="winLogonFailCode2">0xC0000072</field>
  </rule>
</group>
```

## :dart: Remedia√ß√£o em Caso de Crises

Quando uma tentativa de logon em uma **conta desabilitada** √© detectada, √© crucial agir com rapidez e precis√£o para mitigar os riscos. As a√ß√µes imediatas recomendadas incluem:

### 1. **üîí Bloquear Tentativas Adicionais**
Implemente **pol√≠ticas de bloqueio tempor√°rio** ou **regras de firewall** para impedir que novas tentativas de logon sejam realizadas, minimizando o impacto da amea√ßa.

### 2. **üîç Revisar a Conta do Usu√°rio**
Verifique se a conta foi desabilitada **intencionalmente** ou se houve um **erro administrativo**. A√ß√µes humanas equivocadas podem ser corrigidas rapidamente, evitando alarmes falsos.

### 3. **üìú Auditar os Logs de Seguran√ßa**
Analise detalhadamente os **logs do Active Directory** e outros eventos relacionados. Isso ajudar√° a identificar se houve uma **tentativa de comprometimento** e a tra√ßar o caminho do invasor, caso tenha ocorrido.

